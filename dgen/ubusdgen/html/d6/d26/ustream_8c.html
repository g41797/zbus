<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>zbus: /home/g41797/CLionProjects/github.com/g41797/zbus/src/libs/libubox/ustream.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">zbus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_87a455bccb09a92130c26a11a880c98a.html">libs</a></li><li class="navelem"><a class="el" href="../../dir_397c898d2cf76178a72912abd1158536.html">libubox</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">ustream.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdarg.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../da/d79/ustream_8h_source.html">ustream.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ustream.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d3b/ustream_8c__incl.png" border="0" usemap="#a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2libubox_2ustream_8c" alt=""/></div>
<map name="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2libubox_2ustream_8c" id="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2libubox_2ustream_8c">
<area shape="rect" title=" " alt="" coords="201,5,487,85"/>
<area shape="rect" title=" " alt="" coords="5,133,96,167"/>
<area shape="poly" title=" " alt="" coords="232,88,111,130,110,125,230,83"/>
<area shape="rect" title=" " alt="" coords="120,133,213,167"/>
<area shape="poly" title=" " alt="" coords="277,88,209,127,206,123,274,83"/>
<area shape="rect" title=" " alt="" coords="238,133,335,167"/>
<area shape="poly" title=" " alt="" coords="324,87,305,121,300,118,320,84"/>
<area shape="rect" title=" " alt="" coords="359,133,443,167"/>
<area shape="poly" title=" " alt="" coords="368,84,387,118,383,121,364,87"/>
<area shape="rect" title=" " alt="" coords="432,215,530,248"/>
<area shape="poly" title=" " alt="" coords="411,84,436,106,458,132,473,165,481,199,476,200,468,167,454,134,433,109,408,88"/>
<area shape="rect" href="../../da/d79/ustream_8h.html" title=" " alt="" coords="518,133,634,167"/>
<area shape="poly" title=" " alt="" coords="434,83,527,124,524,129,432,88"/>
<area shape="poly" title=" " alt="" coords="558,169,514,207,510,202,555,165"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html" title=" " alt="" coords="555,215,645,248"/>
<area shape="poly" title=" " alt="" coords="583,166,593,199,588,200,578,168"/>
<area shape="rect" title=" " alt="" coords="252,296,369,330"/>
<area shape="poly" title=" " alt="" coords="555,248,385,294,383,289,554,243"/>
<area shape="rect" title=" " alt="" coords="394,296,521,330"/>
<area shape="poly" title=" " alt="" coords="572,251,500,291,498,286,570,246"/>
<area shape="rect" title=" " alt="" coords="596,378,703,412"/>
<area shape="poly" title=" " alt="" coords="595,250,583,287,582,309,586,329,599,349,615,366,612,370,595,352,581,331,576,309,578,286,589,248"/>
<area shape="rect" title=" " alt="" coords="596,296,689,330"/>
<area shape="poly" title=" " alt="" coords="611,248,629,281,624,284,606,250"/>
<area shape="rect" title=" " alt="" coords="713,296,807,330"/>
<area shape="poly" title=" " alt="" coords="633,246,715,287,713,292,631,251"/>
<area shape="rect" href="../../da/d23/list_8h.html" title=" " alt="" coords="831,296,897,330"/>
<area shape="poly" title=" " alt="" coords="646,243,816,293,815,298,644,248"/>
<area shape="poly" title=" " alt="" coords="831,329,708,375,706,370,829,324"/>
<area shape="rect" title=" " alt="" coords="816,378,912,412"/>
<area shape="poly" title=" " alt="" coords="867,330,867,363,861,363,861,330"/>
</map>
</div>
</div>
<p><a href="../../d6/d26/ustream_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ac8d0e3751152862a29010d8c8eba87b2" id="r_ac8d0e3751152862a29010d8c8eba87b2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac8d0e3751152862a29010d8c8eba87b2">CB_PENDING_READ</a>&#160;&#160;&#160;(1 &lt;&lt; 0)</td></tr>
<tr class="separator:ac8d0e3751152862a29010d8c8eba87b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a849640e76b7105d671036ef1ce1bcda0" id="r_a849640e76b7105d671036ef1ce1bcda0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a849640e76b7105d671036ef1ce1bcda0">DEFAULT_SET</a>(_f,  _default)</td></tr>
<tr class="separator:a849640e76b7105d671036ef1ce1bcda0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b85908d36fdecd13603f95c58db00c4" id="r_a6b85908d36fdecd13603f95c58db00c4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6b85908d36fdecd13603f95c58db00c4">MAX_STACK_BUFLEN</a>&#160;&#160;&#160;256</td></tr>
<tr class="separator:a6b85908d36fdecd13603f95c58db00c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3a72c25243ae144e230cc375fa016aac" id="r_a3a72c25243ae144e230cc375fa016aac"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3a72c25243ae144e230cc375fa016aac">ustream_init_buf</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *<a class="el" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, int len)</td></tr>
<tr class="separator:a3a72c25243ae144e230cc375fa016aac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64710c908502c6d43dc365d365e28370" id="r_a64710c908502c6d43dc365d365e28370"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a64710c908502c6d43dc365d365e28370">ustream_add_buf</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#da/dd1/structustream__buf__list">ustream_buf_list</a> *l, struct <a class="el" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *<a class="el" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>)</td></tr>
<tr class="separator:a64710c908502c6d43dc365d365e28370"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa67ddac4c773e0d21f6626bf2371f8d2" id="r_aa67ddac4c773e0d21f6626bf2371f8d2"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa67ddac4c773e0d21f6626bf2371f8d2">ustream_can_alloc</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#da/dd1/structustream__buf__list">ustream_buf_list</a> *l)</td></tr>
<tr class="separator:aa67ddac4c773e0d21f6626bf2371f8d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0021585123abbcd1c4a25ba6a7ffb599" id="r_a0021585123abbcd1c4a25ba6a7ffb599"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0021585123abbcd1c4a25ba6a7ffb599">ustream_alloc_default</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *s, struct <a class="el" href="../../da/d79/ustream_8h.html#da/dd1/structustream__buf__list">ustream_buf_list</a> *l)</td></tr>
<tr class="separator:a0021585123abbcd1c4a25ba6a7ffb599"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a133847346c9a2d708d19c8a056f728bc" id="r_a133847346c9a2d708d19c8a056f728bc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a133847346c9a2d708d19c8a056f728bc">ustream_free_buffers</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#da/dd1/structustream__buf__list">ustream_buf_list</a> *l)</td></tr>
<tr class="separator:a133847346c9a2d708d19c8a056f728bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55eb7ea0d6ed61f253f5689798ccf5c3" id="r_a55eb7ea0d6ed61f253f5689798ccf5c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a55eb7ea0d6ed61f253f5689798ccf5c3">ustream_free</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *s)</td></tr>
<tr class="separator:a55eb7ea0d6ed61f253f5689798ccf5c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae83a7acd40d935b0e000c15f017c2fc" id="r_aae83a7acd40d935b0e000c15f017c2fc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aae83a7acd40d935b0e000c15f017c2fc">ustream_state_change_cb</a> (struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a> *t)</td></tr>
<tr class="separator:aae83a7acd40d935b0e000c15f017c2fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fd8792e264b0d96920fc7bc741a530d" id="r_a4fd8792e264b0d96920fc7bc741a530d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4fd8792e264b0d96920fc7bc741a530d">ustream_init_defaults</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *s)</td></tr>
<tr class="separator:a4fd8792e264b0d96920fc7bc741a530d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09dacab33f0a207388ab373c77fd45b3" id="r_a09dacab33f0a207388ab373c77fd45b3"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a09dacab33f0a207388ab373c77fd45b3">ustream_should_move</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#da/dd1/structustream__buf__list">ustream_buf_list</a> *l, struct <a class="el" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *<a class="el" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, int len)</td></tr>
<tr class="separator:a09dacab33f0a207388ab373c77fd45b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63bfcff990b542772fd9fbc5b6e1f870" id="r_a63bfcff990b542772fd9fbc5b6e1f870"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a63bfcff990b542772fd9fbc5b6e1f870">ustream_free_buf</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#da/dd1/structustream__buf__list">ustream_buf_list</a> *l, struct <a class="el" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *<a class="el" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>)</td></tr>
<tr class="separator:a63bfcff990b542772fd9fbc5b6e1f870"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6665fc275e6233416683c9b76908a53f" id="r_a6665fc275e6233416683c9b76908a53f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6665fc275e6233416683c9b76908a53f">__ustream_set_read_blocked</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *s, unsigned char val)</td></tr>
<tr class="separator:a6665fc275e6233416683c9b76908a53f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9a99d5c375c49ea750fe97d0e93ada1" id="r_ad9a99d5c375c49ea750fe97d0e93ada1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad9a99d5c375c49ea750fe97d0e93ada1">ustream_set_read_blocked</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *s, bool set)</td></tr>
<tr class="separator:ad9a99d5c375c49ea750fe97d0e93ada1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e2924135643035597d360c6dcb0a294" id="r_a6e2924135643035597d360c6dcb0a294"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6e2924135643035597d360c6dcb0a294">ustream_consume</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *s, int len)</td></tr>
<tr class="separator:a6e2924135643035597d360c6dcb0a294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f850d5efa8e096ca116a2b98a68bd16" id="r_a4f850d5efa8e096ca116a2b98a68bd16"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4f850d5efa8e096ca116a2b98a68bd16">ustream_fixup_string</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *s, struct <a class="el" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *<a class="el" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>)</td></tr>
<tr class="separator:a4f850d5efa8e096ca116a2b98a68bd16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ed3a1f1af94d311249c4b34b9e937d3" id="r_a0ed3a1f1af94d311249c4b34b9e937d3"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ed3a1f1af94d311249c4b34b9e937d3">ustream_prepare_buf</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *s, struct <a class="el" href="../../da/d79/ustream_8h.html#da/dd1/structustream__buf__list">ustream_buf_list</a> *l, int len)</td></tr>
<tr class="separator:a0ed3a1f1af94d311249c4b34b9e937d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48eb6688bc7551e8fa0f5fe45c3ff767" id="r_a48eb6688bc7551e8fa0f5fe45c3ff767"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a48eb6688bc7551e8fa0f5fe45c3ff767">ustream_reserve</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *s, int len, int *maxlen)</td></tr>
<tr class="separator:a48eb6688bc7551e8fa0f5fe45c3ff767"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7150fd97e4c632a01ba95a19614fcd0" id="r_aa7150fd97e4c632a01ba95a19614fcd0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa7150fd97e4c632a01ba95a19614fcd0">ustream_fill_read</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *s, int len)</td></tr>
<tr class="separator:aa7150fd97e4c632a01ba95a19614fcd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8718ea51e10ce9d433e4346110f0653" id="r_af8718ea51e10ce9d433e4346110f0653"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af8718ea51e10ce9d433e4346110f0653">ustream_get_read_buf</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *s, int *buflen)</td></tr>
<tr class="separator:af8718ea51e10ce9d433e4346110f0653"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaa16cab137c211c77310698b210ecdf" id="r_aeaa16cab137c211c77310698b210ecdf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeaa16cab137c211c77310698b210ecdf">ustream_read</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *s, char *<a class="el" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, int buflen)</td></tr>
<tr class="separator:aeaa16cab137c211c77310698b210ecdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90259dc27343d0ee765236e3e42302da" id="r_a90259dc27343d0ee765236e3e42302da"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a90259dc27343d0ee765236e3e42302da">ustream_write_error</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *s)</td></tr>
<tr class="separator:a90259dc27343d0ee765236e3e42302da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7460ade35d8721c6dbac14e9cfab4b8c" id="r_a7460ade35d8721c6dbac14e9cfab4b8c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7460ade35d8721c6dbac14e9cfab4b8c">ustream_write_pending</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *s)</td></tr>
<tr class="separator:a7460ade35d8721c6dbac14e9cfab4b8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff14ca1c3b81e376b6033f2cf55bf75b" id="r_aff14ca1c3b81e376b6033f2cf55bf75b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aff14ca1c3b81e376b6033f2cf55bf75b">ustream_write_buffered</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *s, const char *data, int len, int wr)</td></tr>
<tr class="separator:aff14ca1c3b81e376b6033f2cf55bf75b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fd4724c3a2419db5c46a929ca2d7c9c" id="r_a0fd4724c3a2419db5c46a929ca2d7c9c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0fd4724c3a2419db5c46a929ca2d7c9c">ustream_write</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *s, const char *data, int len, bool more)</td></tr>
<tr class="separator:a0fd4724c3a2419db5c46a929ca2d7c9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61be783dcc8b068e3462484564835363" id="r_a61be783dcc8b068e3462484564835363"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a61be783dcc8b068e3462484564835363">ustream_vprintf</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *s, const char *format, va_list arg)</td></tr>
<tr class="separator:a61be783dcc8b068e3462484564835363"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cd5e3fd92cce6077f0ed0fa53c5eb56" id="r_a5cd5e3fd92cce6077f0ed0fa53c5eb56"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5cd5e3fd92cce6077f0ed0fa53c5eb56">ustream_printf</a> (struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *s, const char *format,...)</td></tr>
<tr class="separator:a5cd5e3fd92cce6077f0ed0fa53c5eb56"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ac8d0e3751152862a29010d8c8eba87b2" name="ac8d0e3751152862a29010d8c8eba87b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8d0e3751152862a29010d8c8eba87b2">&#9670;&#160;</a></span>CB_PENDING_READ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CB_PENDING_READ&#160;&#160;&#160;(1 &lt;&lt; 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00027">27</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d26/ustream_8c_source.html#l00302">ustream_fill_read()</a>.</p>

</div>
</div>
<a id="a849640e76b7105d671036ef1ce1bcda0" name="a849640e76b7105d671036ef1ce1bcda0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a849640e76b7105d671036ef1ce1bcda0">&#9670;&#160;</a></span>DEFAULT_SET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_SET</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>_f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>_default</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <span class="keywordflow">do</span> {                \</div>
<div class="line">        if (!_f)        \</div>
<div class="line">            _f = _default;  \</div>
<div class="line">    } <span class="keywordflow">while</span>(0)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d6/d26/ustream_8c_source.html#l00114">ustream_init_defaults()</a>.</p>

</div>
</div>
<a id="a6b85908d36fdecd13603f95c58db00c4" name="a6b85908d36fdecd13603f95c58db00c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b85908d36fdecd13603f95c58db00c4">&#9670;&#160;</a></span>MAX_STACK_BUFLEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_STACK_BUFLEN&#160;&#160;&#160;256</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00471">471</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d26/ustream_8c_source.html#l00473">ustream_vprintf()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6665fc275e6233416683c9b76908a53f" name="a6665fc275e6233416683c9b76908a53f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6665fc275e6233416683c9b76908a53f">&#9670;&#160;</a></span>__ustream_set_read_blocked()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __ustream_set_read_blocked </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char</td>          <td class="paramname"><span class="paramname"><em>val</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00196">196</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  197</span>{</div>
<div class="line"><span class="lineno">  198</span>    <span class="keywordtype">bool</span> changed = !!s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ad79ec597a16992c722c5156d182121f0">read_blocked</a> != !!val;</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>    s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ad79ec597a16992c722c5156d182121f0">read_blocked</a> = val;</div>
<div class="line"><span class="lineno">  201</span>    <span class="keywordflow">if</span> (changed)</div>
<div class="line"><span class="lineno">  202</span>        s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a38cb0201012c7bdcb8bd0f25b4d8bcdc">set_read_blocked</a>(s);</div>
<div class="line"><span class="lineno">  203</span>}</div>
<div class="ttc" id="austream_8h_html_a38cb0201012c7bdcb8bd0f25b4d8bcdc"><div class="ttname"><a href="../../da/d79/ustream_8h.html#a38cb0201012c7bdcb8bd0f25b4d8bcdc">ustream::set_read_blocked</a></div><div class="ttdeci">void(* set_read_blocked)(struct ustream *s)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00101">ustream.h:101</a></div></div>
<div class="ttc" id="austream_8h_html_ad79ec597a16992c722c5156d182121f0"><div class="ttname"><a href="../../da/d79/ustream_8h.html#ad79ec597a16992c722c5156d182121f0">ustream::read_blocked</a></div><div class="ttdeci">enum read_blocked_reason read_blocked</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00120">ustream.h:120</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d79/ustream_8h_source.html#l00120">ustream::read_blocked</a>, and <a class="el" href="../../da/d79/ustream_8h_source.html#l00101">ustream::set_read_blocked</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d26/ustream_8c_source.html#l00215">ustream_consume()</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00287">ustream_reserve()</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00205">ustream_set_read_blocked()</a>.</p>

</div>
</div>
<a id="a64710c908502c6d43dc365d365e28370" name="a64710c908502c6d43dc365d365e28370"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64710c908502c6d43dc365d365e28370">&#9670;&#160;</a></span>ustream_add_buf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ustream_add_buf </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#da/dd1/structustream__buf__list">ustream_buf_list</a> *</td>          <td class="paramname"><span class="paramname"><em>l</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00040">40</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   41</span>{</div>
<div class="line"><span class="lineno">   42</span>    l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a90ad967ab680e5688e3c8fc636a10adf">buffers</a>++;</div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordflow">if</span> (!l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a870d35c982e3e30d2eb7ad18c76ac686">tail</a>)</div>
<div class="line"><span class="lineno">   44</span>        l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#aa70350247646ae77f4551d297fb62fef">head</a> = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>;</div>
<div class="line"><span class="lineno">   45</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   46</span>        l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a870d35c982e3e30d2eb7ad18c76ac686">tail</a>-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab664a1d47378eec9f4feee70e9fdec4f">next</a> = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>;</div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span>    <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;next = NULL;</div>
<div class="line"><span class="lineno">   49</span>    l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a870d35c982e3e30d2eb7ad18c76ac686">tail</a> = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>;</div>
<div class="line"><span class="lineno">   50</span>    <span class="keywordflow">if</span> (!l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab50800cb2a37029cb21c964b2980d666">data_tail</a>)</div>
<div class="line"><span class="lineno">   51</span>        l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab50800cb2a37029cb21c964b2980d666">data_tail</a> = l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#aa70350247646ae77f4551d297fb62fef">head</a>;</div>
<div class="line"><span class="lineno">   52</span>}</div>
<div class="ttc" id="amkdev_8c_html_a024e65f7d9664cdc767f51c283fd8353"><div class="ttname"><a href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a></div><div class="ttdeci">static char buf[PATH_MAX]</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d9a/mkdev_8c_source.html#l00034">mkdev.c:34</a></div></div>
<div class="ttc" id="austream_8h_html_a870d35c982e3e30d2eb7ad18c76ac686"><div class="ttname"><a href="../../da/d79/ustream_8h.html#a870d35c982e3e30d2eb7ad18c76ac686">ustream_buf_list::tail</a></div><div class="ttdeci">struct ustream_buf * tail</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00036">ustream.h:36</a></div></div>
<div class="ttc" id="austream_8h_html_a90ad967ab680e5688e3c8fc636a10adf"><div class="ttname"><a href="../../da/d79/ustream_8h.html#a90ad967ab680e5688e3c8fc636a10adf">ustream_buf_list::buffers</a></div><div class="ttdeci">int buffers</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00046">ustream.h:46</a></div></div>
<div class="ttc" id="austream_8h_html_aa70350247646ae77f4551d297fb62fef"><div class="ttname"><a href="../../da/d79/ustream_8h.html#aa70350247646ae77f4551d297fb62fef">ustream_buf_list::head</a></div><div class="ttdeci">struct ustream_buf * head</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00034">ustream.h:34</a></div></div>
<div class="ttc" id="austream_8h_html_ab50800cb2a37029cb21c964b2980d666"><div class="ttname"><a href="../../da/d79/ustream_8h.html#ab50800cb2a37029cb21c964b2980d666">ustream_buf_list::data_tail</a></div><div class="ttdeci">struct ustream_buf * data_tail</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00035">ustream.h:35</a></div></div>
<div class="ttc" id="austream_8h_html_ab664a1d47378eec9f4feee70e9fdec4f"><div class="ttname"><a href="../../da/d79/ustream_8h.html#ab664a1d47378eec9f4feee70e9fdec4f">ustream_buf::next</a></div><div class="ttdeci">struct ustream_buf * next</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00129">ustream.h:129</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00046">ustream_buf_list::buffers</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00035">ustream_buf_list::data_tail</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00034">ustream_buf_list::head</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00129">ustream_buf::next</a>, and <a class="el" href="../../da/d79/ustream_8h_source.html#l00036">ustream_buf_list::tail</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d26/ustream_8c_source.html#l00062">ustream_alloc_default()</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00175">ustream_free_buf()</a>.</p>

</div>
</div>
<a id="a0021585123abbcd1c4a25ba6a7ffb599" name="a0021585123abbcd1c4a25ba6a7ffb599"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0021585123abbcd1c4a25ba6a7ffb599">&#9670;&#160;</a></span>ustream_alloc_default()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ustream_alloc_default </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#da/dd1/structustream__buf__list">ustream_buf_list</a> *</td>          <td class="paramname"><span class="paramname"><em>l</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00062">62</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   63</span>{</div>
<div class="line"><span class="lineno">   64</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>;</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="#aa67ddac4c773e0d21f6626bf2371f8d2">ustream_can_alloc</a>(l))</div>
<div class="line"><span class="lineno">   67</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>    <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> = malloc(<span class="keyword">sizeof</span>(*<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>) + l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#aab610501b2503be59efab2421948079c">buffer_len</a> + s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#af9b356adc7c07f2b279a2897ba59592b">string_data</a>);</div>
<div class="line"><span class="lineno">   70</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>)</div>
<div class="line"><span class="lineno">   71</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>    <a class="code hl_function" href="#a3a72c25243ae144e230cc375fa016aac">ustream_init_buf</a>(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#aab610501b2503be59efab2421948079c">buffer_len</a>);</div>
<div class="line"><span class="lineno">   74</span>    <a class="code hl_function" href="#a64710c908502c6d43dc365d365e28370">ustream_add_buf</a>(l, <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>);</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   77</span>}</div>
<div class="ttc" id="austream_8c_html_a3a72c25243ae144e230cc375fa016aac"><div class="ttname"><a href="#a3a72c25243ae144e230cc375fa016aac">ustream_init_buf</a></div><div class="ttdeci">static void ustream_init_buf(struct ustream_buf *buf, int len)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d26/ustream_8c_source.html#l00029">ustream.c:29</a></div></div>
<div class="ttc" id="austream_8c_html_a64710c908502c6d43dc365d365e28370"><div class="ttname"><a href="#a64710c908502c6d43dc365d365e28370">ustream_add_buf</a></div><div class="ttdeci">static void ustream_add_buf(struct ustream_buf_list *l, struct ustream_buf *buf)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d26/ustream_8c_source.html#l00040">ustream.c:40</a></div></div>
<div class="ttc" id="austream_8c_html_aa67ddac4c773e0d21f6626bf2371f8d2"><div class="ttname"><a href="#aa67ddac4c773e0d21f6626bf2371f8d2">ustream_can_alloc</a></div><div class="ttdeci">static bool ustream_can_alloc(struct ustream_buf_list *l)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d26/ustream_8c_source.html#l00054">ustream.c:54</a></div></div>
<div class="ttc" id="austream_8h_html_aab610501b2503be59efab2421948079c"><div class="ttname"><a href="../../da/d79/ustream_8h.html#aab610501b2503be59efab2421948079c">ustream_buf_list::buffer_len</a></div><div class="ttdeci">int buffer_len</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00044">ustream.h:44</a></div></div>
<div class="ttc" id="austream_8h_html_af9b356adc7c07f2b279a2897ba59592b"><div class="ttname"><a href="../../da/d79/ustream_8h.html#af9b356adc7c07f2b279a2897ba59592b">ustream::string_data</a></div><div class="ttdeci">bool string_data</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00115">ustream.h:115</a></div></div>
<div class="ttc" id="austream_8h_html_d9/dc0/structustream__buf"><div class="ttname"><a href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00128">ustream.h:128</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00044">ustream_buf_list::buffer_len</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00115">ustream::string_data</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00040">ustream_add_buf()</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00054">ustream_can_alloc()</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00029">ustream_init_buf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d26/ustream_8c_source.html#l00114">ustream_init_defaults()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d26/ustream_8c_a0021585123abbcd1c4a25ba6a7ffb599_cgraph.png" border="0" usemap="#ad6/d26/ustream_8c_a0021585123abbcd1c4a25ba6a7ffb599_cgraph" alt=""/></div>
<map name="ad6/d26/ustream_8c_a0021585123abbcd1c4a25ba6a7ffb599_cgraph" id="ad6/d26/ustream_8c_a0021585123abbcd1c4a25ba6a7ffb599_cgraph">
<area shape="rect" title=" " alt="" coords="5,63,228,96"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a64710c908502c6d43dc365d365e28370" title=" " alt="" coords="280,5,462,39"/>
<area shape="poly" title=" " alt="" coords="194,59,277,40,279,46,195,65"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#aa67ddac4c773e0d21f6626bf2371f8d2" title=" " alt="" coords="276,63,466,96"/>
<area shape="poly" title=" " alt="" coords="228,77,260,77,260,82,228,82"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a3a72c25243ae144e230cc375fa016aac" title=" " alt="" coords="283,120,459,154"/>
<area shape="poly" title=" " alt="" coords="195,94,279,113,277,119,194,100"/>
</map>
</div>

</div>
</div>
<a id="aa67ddac4c773e0d21f6626bf2371f8d2" name="aa67ddac4c773e0d21f6626bf2371f8d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa67ddac4c773e0d21f6626bf2371f8d2">&#9670;&#160;</a></span>ustream_can_alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool ustream_can_alloc </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#da/dd1/structustream__buf__list">ustream_buf_list</a> *</td>          <td class="paramname"><span class="paramname"><em>l</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00054">54</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   55</span>{</div>
<div class="line"><span class="lineno">   56</span>    <span class="keywordflow">if</span> (l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#af3b56b7094382314a5721968e453b257">max_buffers</a> &lt;= 0)</div>
<div class="line"><span class="lineno">   57</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span>    <span class="keywordflow">return</span> (l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a90ad967ab680e5688e3c8fc636a10adf">buffers</a> &lt; l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#af3b56b7094382314a5721968e453b257">max_buffers</a>);</div>
<div class="line"><span class="lineno">   60</span>}</div>
<div class="ttc" id="austream_8h_html_af3b56b7094382314a5721968e453b257"><div class="ttname"><a href="../../da/d79/ustream_8h.html#af3b56b7094382314a5721968e453b257">ustream_buf_list::max_buffers</a></div><div class="ttdeci">int max_buffers</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00043">ustream.h:43</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d79/ustream_8h_source.html#l00046">ustream_buf_list::buffers</a>, and <a class="el" href="../../da/d79/ustream_8h_source.html#l00043">ustream_buf_list::max_buffers</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d26/ustream_8c_source.html#l00062">ustream_alloc_default()</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00251">ustream_prepare_buf()</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00147">ustream_should_move()</a>.</p>

</div>
</div>
<a id="a6e2924135643035597d360c6dcb0a294" name="a6e2924135643035597d360c6dcb0a294"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e2924135643035597d360c6dcb0a294">&#9670;&#160;</a></span>ustream_consume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ustream_consume </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00215">215</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  216</span>{</div>
<div class="line"><span class="lineno">  217</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> = s-&gt;r.head;</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>    <span class="keywordflow">if</span> (!len)</div>
<div class="line"><span class="lineno">  220</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>    s-&gt;r.data_bytes -= len;</div>
<div class="line"><span class="lineno">  223</span>    <span class="keywordflow">if</span> (s-&gt;r.data_bytes &lt; 0)</div>
<div class="line"><span class="lineno">  224</span>        abort();</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>    <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno">  227</span>        <span class="keyword">struct </span><a class="code hl_struct" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab664a1d47378eec9f4feee70e9fdec4f">next</a> = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;next;</div>
<div class="line"><span class="lineno">  228</span>        <span class="keywordtype">int</span> buf_len = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;tail - <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;data;</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>        <span class="keywordflow">if</span> (len &lt; buf_len) {</div>
<div class="line"><span class="lineno">  231</span>            <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;data += len;</div>
<div class="line"><span class="lineno">  232</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  233</span>        }</div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>        len -= buf_len;</div>
<div class="line"><span class="lineno">  236</span>        <a class="code hl_function" href="#a63bfcff990b542772fd9fbc5b6e1f870">ustream_free_buf</a>(&amp;s-&gt;r, <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>);</div>
<div class="line"><span class="lineno">  237</span>        <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> = <a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab664a1d47378eec9f4feee70e9fdec4f">next</a>;</div>
<div class="line"><span class="lineno">  238</span>    } <span class="keywordflow">while</span>(len);</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>    <a class="code hl_function" href="#a6665fc275e6233416683c9b76908a53f">__ustream_set_read_blocked</a>(s, s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ad79ec597a16992c722c5156d182121f0">read_blocked</a> &amp; ~<a class="code hl_enumvalue" href="../../da/d79/ustream_8h.html#a479afe8b27077dc2b881c848deb1c873a22e5f87455357c21e4922c63c4580f77">READ_BLOCKED_FULL</a>);</div>
<div class="line"><span class="lineno">  241</span>}</div>
<div class="ttc" id="austream_8c_html_a63bfcff990b542772fd9fbc5b6e1f870"><div class="ttname"><a href="#a63bfcff990b542772fd9fbc5b6e1f870">ustream_free_buf</a></div><div class="ttdeci">static void ustream_free_buf(struct ustream_buf_list *l, struct ustream_buf *buf)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d26/ustream_8c_source.html#l00175">ustream.c:175</a></div></div>
<div class="ttc" id="austream_8c_html_a6665fc275e6233416683c9b76908a53f"><div class="ttname"><a href="#a6665fc275e6233416683c9b76908a53f">__ustream_set_read_blocked</a></div><div class="ttdeci">static void __ustream_set_read_blocked(struct ustream *s, unsigned char val)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d26/ustream_8c_source.html#l00196">ustream.c:196</a></div></div>
<div class="ttc" id="austream_8h_html_a479afe8b27077dc2b881c848deb1c873a22e5f87455357c21e4922c63c4580f77"><div class="ttname"><a href="../../da/d79/ustream_8h.html#a479afe8b27077dc2b881c848deb1c873a22e5f87455357c21e4922c63c4580f77">READ_BLOCKED_FULL</a></div><div class="ttdeci">@ READ_BLOCKED_FULL</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00030">ustream.h:30</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d26/ustream_8c_source.html#l00196">__ustream_set_read_blocked()</a>, <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00129">ustream_buf::next</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00120">ustream::read_blocked</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00030">READ_BLOCKED_FULL</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00175">ustream_free_buf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/dc0/uxc_8c_source.html#l00485">client_cb()</a>, <a class="el" href="../../d6/d5e/ustream-example_8c_source.html#l00025">client_read_cb()</a>, <a class="el" href="../../d2/d28/instance_8c_source.html#l00732">instance_console()</a>, <a class="el" href="../../d2/d28/instance_8c_source.html#l00754">instance_console_client()</a>, <a class="el" href="../../d2/d28/instance_8c_source.html#l00694">instance_stdio()</a>, <a class="el" href="../../da/dc0/uxc_8c_source.html#l00505">local_cb()</a>, <a class="el" href="../../d1/dd7/netifd_2main_8c_source.html#l00140">netifd_process_log_read_cb()</a>, <a class="el" href="../../d1/d5c/rcS_8c_source.html#l00046">pipe_cb()</a>, <a class="el" href="../../df/dc9/exec_8c_source.html#l00230">rpc_exec_epipe_read_cb()</a>, <a class="el" href="../../df/dc9/exec_8c_source.html#l00200">rpc_exec_opipe_read_cb()</a>, <a class="el" href="../../dd/d93/client_8c_source.html#l00141">test_client_fd_data_cb()</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00351">ustream_read()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d26/ustream_8c_a6e2924135643035597d360c6dcb0a294_cgraph.png" border="0" usemap="#ad6/d26/ustream_8c_a6e2924135643035597d360c6dcb0a294_cgraph" alt=""/></div>
<map name="ad6/d26/ustream_8c_a6e2924135643035597d360c6dcb0a294_cgraph" id="ad6/d26/ustream_8c_a6e2924135643035597d360c6dcb0a294_cgraph">
<area shape="rect" title=" " alt="" coords="5,52,196,85"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a6665fc275e6233416683c9b76908a53f" title=" " alt="" coords="244,5,446,62"/>
<area shape="poly" title=" " alt="" coords="196,52,228,48,228,53,197,57"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a63bfcff990b542772fd9fbc5b6e1f870" title=" " alt="" coords="254,86,436,120"/>
<area shape="poly" title=" " alt="" coords="197,79,238,85,238,91,196,85"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a64710c908502c6d43dc365d365e28370" title=" " alt="" coords="494,57,675,91"/>
<area shape="poly" title=" " alt="" coords="436,89,478,84,479,89,437,94"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a3a72c25243ae144e230cc375fa016aac" title=" " alt="" coords="497,114,672,148"/>
<area shape="poly" title=" " alt="" coords="437,111,482,116,481,122,436,116"/>
</map>
</div>

</div>
</div>
<a id="aa7150fd97e4c632a01ba95a19614fcd0" name="aa7150fd97e4c632a01ba95a19614fcd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7150fd97e4c632a01ba95a19614fcd0">&#9670;&#160;</a></span>ustream_fill_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ustream_fill_read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00302">302</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  303</span>{</div>
<div class="line"><span class="lineno">  304</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> = s-&gt;r.data_tail;</div>
<div class="line"><span class="lineno">  305</span>    <span class="keywordtype">int</span> maxlen;</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>    s-&gt;r.data_bytes += len;</div>
<div class="line"><span class="lineno">  308</span>    <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno">  309</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>)</div>
<div class="line"><span class="lineno">  310</span>            abort();</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>        maxlen = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;end - <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;tail;</div>
<div class="line"><span class="lineno">  313</span>        <span class="keywordflow">if</span> (len &lt; maxlen)</div>
<div class="line"><span class="lineno">  314</span>            maxlen = len;</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>        len -= maxlen;</div>
<div class="line"><span class="lineno">  317</span>        <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;tail += maxlen;</div>
<div class="line"><span class="lineno">  318</span>        <a class="code hl_function" href="#a4f850d5efa8e096ca116a2b98a68bd16">ustream_fixup_string</a>(s, <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>);</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>        s-&gt;r.data_tail = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>;</div>
<div class="line"><span class="lineno">  321</span>        <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;next;</div>
<div class="line"><span class="lineno">  322</span>    } <span class="keywordflow">while</span> (len);</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>    <span class="keywordflow">if</span> (s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a4959c83703e0e81996af057432cce63b">notify_read</a>) {</div>
<div class="line"><span class="lineno">  325</span>        <span class="keywordflow">if</span> (s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a3c2a65857a0fb4fa086cd7cd4dd40766">pending_cb</a> &amp; <a class="code hl_define" href="#ac8d0e3751152862a29010d8c8eba87b2">CB_PENDING_READ</a>)</div>
<div class="line"><span class="lineno">  326</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  327</span> </div>
<div class="line"><span class="lineno">  328</span>        s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a3c2a65857a0fb4fa086cd7cd4dd40766">pending_cb</a> |= <a class="code hl_define" href="#ac8d0e3751152862a29010d8c8eba87b2">CB_PENDING_READ</a>;</div>
<div class="line"><span class="lineno">  329</span>        s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a4959c83703e0e81996af057432cce63b">notify_read</a>(s, s-&gt;r.data_bytes);</div>
<div class="line"><span class="lineno">  330</span>        s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a3c2a65857a0fb4fa086cd7cd4dd40766">pending_cb</a> &amp;= ~CB_PENDING_READ;</div>
<div class="line"><span class="lineno">  331</span>    }</div>
<div class="line"><span class="lineno">  332</span>}</div>
<div class="ttc" id="austream_8c_html_a4f850d5efa8e096ca116a2b98a68bd16"><div class="ttname"><a href="#a4f850d5efa8e096ca116a2b98a68bd16">ustream_fixup_string</a></div><div class="ttdeci">static void ustream_fixup_string(struct ustream *s, struct ustream_buf *buf)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d26/ustream_8c_source.html#l00243">ustream.c:243</a></div></div>
<div class="ttc" id="austream_8c_html_ac8d0e3751152862a29010d8c8eba87b2"><div class="ttname"><a href="#ac8d0e3751152862a29010d8c8eba87b2">CB_PENDING_READ</a></div><div class="ttdeci">#define CB_PENDING_READ</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d26/ustream_8c_source.html#l00027">ustream.c:27</a></div></div>
<div class="ttc" id="austream_8h_html_a3c2a65857a0fb4fa086cd7cd4dd40766"><div class="ttname"><a href="../../da/d79/ustream_8h.html#a3c2a65857a0fb4fa086cd7cd4dd40766">ustream::pending_cb</a></div><div class="ttdeci">uint8_t pending_cb</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00118">ustream.h:118</a></div></div>
<div class="ttc" id="austream_8h_html_a4959c83703e0e81996af057432cce63b"><div class="ttname"><a href="../../da/d79/ustream_8h.html#a4959c83703e0e81996af057432cce63b">ustream::notify_read</a></div><div class="ttdeci">void(* notify_read)(struct ustream *s, int bytes_new)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00060">ustream.h:60</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00027">CB_PENDING_READ</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00060">ustream::notify_read</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00118">ustream::pending_cb</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00243">ustream_fixup_string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d70/ustream-fd_8c_source.html#l00045">ustream_fd_read_pending()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d26/ustream_8c_aa7150fd97e4c632a01ba95a19614fcd0_cgraph.png" border="0" usemap="#ad6/d26/ustream_8c_aa7150fd97e4c632a01ba95a19614fcd0_cgraph" alt=""/></div>
<map name="ad6/d26/ustream_8c_aa7150fd97e4c632a01ba95a19614fcd0_cgraph" id="ad6/d26/ustream_8c_aa7150fd97e4c632a01ba95a19614fcd0_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,184,39"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a4f850d5efa8e096ca116a2b98a68bd16" title=" " alt="" coords="232,5,448,39"/>
<area shape="poly" title=" " alt="" coords="184,20,216,20,216,25,184,25"/>
</map>
</div>

</div>
</div>
<a id="a4f850d5efa8e096ca116a2b98a68bd16" name="a4f850d5efa8e096ca116a2b98a68bd16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f850d5efa8e096ca116a2b98a68bd16">&#9670;&#160;</a></span>ustream_fixup_string()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ustream_fixup_string </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00243">243</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  244</span>{</div>
<div class="line"><span class="lineno">  245</span>    <span class="keywordflow">if</span> (!s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#af9b356adc7c07f2b279a2897ba59592b">string_data</a>)</div>
<div class="line"><span class="lineno">  246</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>    *<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;tail = 0;</div>
<div class="line"><span class="lineno">  249</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, and <a class="el" href="../../da/d79/ustream_8h_source.html#l00115">ustream::string_data</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d26/ustream_8c_source.html#l00302">ustream_fill_read()</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00251">ustream_prepare_buf()</a>.</p>

</div>
</div>
<a id="a55eb7ea0d6ed61f253f5689798ccf5c3" name="a55eb7ea0d6ed61f253f5689798ccf5c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55eb7ea0d6ed61f253f5689798ccf5c3">&#9670;&#160;</a></span>ustream_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ustream_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00094">94</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   95</span>{</div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordflow">if</span> (s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a52805da29f877d02dcae0c25b83fddce">free</a>)</div>
<div class="line"><span class="lineno">   97</span>        s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a52805da29f877d02dcae0c25b83fddce">free</a>(s);</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    <a class="code hl_function" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91">uloop_timeout_cancel</a>(&amp;s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a6edf9e3eba069a76347d6d9975cc41c5">state_change</a>);</div>
<div class="line"><span class="lineno">  100</span>    <a class="code hl_function" href="#a133847346c9a2d708d19c8a056f728bc">ustream_free_buffers</a>(&amp;s-&gt;r);</div>
<div class="line"><span class="lineno">  101</span>    <a class="code hl_function" href="#a133847346c9a2d708d19c8a056f728bc">ustream_free_buffers</a>(&amp;s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a03853611acd8f4e90eec49c1e183ee87">w</a>);</div>
<div class="line"><span class="lineno">  102</span>}</div>
<div class="ttc" id="auloop_8c_html_a6231184d2f54ac1bc945ecb73c517d91"><div class="ttname"><a href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91">uloop_timeout_cancel</a></div><div class="ttdeci">int uloop_timeout_cancel(struct uloop_timeout *timeout)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d08/uloop_8c_source.html#l00348">uloop.c:348</a></div></div>
<div class="ttc" id="austream_8c_html_a133847346c9a2d708d19c8a056f728bc"><div class="ttname"><a href="#a133847346c9a2d708d19c8a056f728bc">ustream_free_buffers</a></div><div class="ttdeci">static void ustream_free_buffers(struct ustream_buf_list *l)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d26/ustream_8c_source.html#l00079">ustream.c:79</a></div></div>
<div class="ttc" id="austream_8h_html_a03853611acd8f4e90eec49c1e183ee87"><div class="ttname"><a href="../../da/d79/ustream_8h.html#a03853611acd8f4e90eec49c1e183ee87">ustream::w</a></div><div class="ttdeci">struct ustream_buf_list r w</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00050">ustream.h:50</a></div></div>
<div class="ttc" id="austream_8h_html_a52805da29f877d02dcae0c25b83fddce"><div class="ttname"><a href="../../da/d79/ustream_8h.html#a52805da29f877d02dcae0c25b83fddce">ustream::free</a></div><div class="ttdeci">void(* free)(struct ustream *s)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00094">ustream.h:94</a></div></div>
<div class="ttc" id="austream_8h_html_a6edf9e3eba069a76347d6d9975cc41c5"><div class="ttname"><a href="../../da/d79/ustream_8h.html#a6edf9e3eba069a76347d6d9975cc41c5">ustream::state_change</a></div><div class="ttdeci">struct uloop_timeout state_change</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00051">ustream.h:51</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d79/ustream_8h_source.html#l00094">ustream::free</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00051">ustream::state_change</a>, <a class="el" href="../../d1/d08/uloop_8c_source.html#l00348">uloop_timeout_cancel()</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00079">ustream_free_buffers()</a>, and <a class="el" href="../../da/d79/ustream_8h_source.html#l00050">ustream::w</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d5e/ustream-example_8c_source.html#l00052">client_close()</a>, <a class="el" href="../../d2/d28/instance_8c_source.html#l00583">instance_free_stdio()</a>, <a class="el" href="../../d1/dd7/netifd_2main_8c_source.html#l00084">netifd_delete_process()</a>, <a class="el" href="../../d1/d5c/rcS_8c_source.html#l00109">q_initd_complete()</a>, <a class="el" href="../../df/dc9/exec_8c_source.html#l00187">rpc_exec_ipipe_write_cb()</a>, <a class="el" href="../../df/dc9/exec_8c_source.html#l00121">rpc_exec_reply()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00695">rpc_file_exec_reply()</a>, and <a class="el" href="../../da/dc0/uxc_8c_source.html#l00528">uxc_attach()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d26/ustream_8c_a55eb7ea0d6ed61f253f5689798ccf5c3_cgraph.png" border="0" usemap="#ad6/d26/ustream_8c_a55eb7ea0d6ed61f253f5689798ccf5c3_cgraph" alt=""/></div>
<map name="ad6/d26/ustream_8c_a55eb7ea0d6ed61f253f5689798ccf5c3_cgraph" id="ad6/d26/ustream_8c_a55eb7ea0d6ed61f253f5689798ccf5c3_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,148,68"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="196,5,416,39"/>
<area shape="poly" title=" " alt="" coords="148,40,180,36,181,41,149,45"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a133847346c9a2d708d19c8a056f728bc" title=" " alt="" coords="197,63,415,96"/>
<area shape="poly" title=" " alt="" coords="149,58,182,62,181,67,148,63"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="464,5,549,39"/>
<area shape="poly" title=" " alt="" coords="416,20,448,20,448,25,416,25"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="597,5,692,39"/>
<area shape="poly" title=" " alt="" coords="550,20,582,20,582,25,550,25"/>
</map>
</div>

</div>
</div>
<a id="a63bfcff990b542772fd9fbc5b6e1f870" name="a63bfcff990b542772fd9fbc5b6e1f870"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63bfcff990b542772fd9fbc5b6e1f870">&#9670;&#160;</a></span>ustream_free_buf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ustream_free_buf </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#da/dd1/structustream__buf__list">ustream_buf_list</a> *</td>          <td class="paramname"><span class="paramname"><em>l</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00175">175</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  176</span>{</div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> == l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#aa70350247646ae77f4551d297fb62fef">head</a>)</div>
<div class="line"><span class="lineno">  178</span>        l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#aa70350247646ae77f4551d297fb62fef">head</a> = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;next;</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> == l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab50800cb2a37029cb21c964b2980d666">data_tail</a>)</div>
<div class="line"><span class="lineno">  181</span>        l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab50800cb2a37029cb21c964b2980d666">data_tail</a> = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;next;</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> == l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a870d35c982e3e30d2eb7ad18c76ac686">tail</a>)</div>
<div class="line"><span class="lineno">  184</span>        l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a870d35c982e3e30d2eb7ad18c76ac686">tail</a> = NULL;</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>    <span class="keywordflow">if</span> (--l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a90ad967ab680e5688e3c8fc636a10adf">buffers</a> &gt;= l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a5b3a2241e0a59463ee3532e4ecff2618">min_buffers</a>) {</div>
<div class="line"><span class="lineno">  187</span>        free(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>);</div>
<div class="line"><span class="lineno">  188</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  189</span>    }</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>    <span class="comment">/* recycle */</span></div>
<div class="line"><span class="lineno">  192</span>    <a class="code hl_function" href="#a3a72c25243ae144e230cc375fa016aac">ustream_init_buf</a>(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;end - <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;head);</div>
<div class="line"><span class="lineno">  193</span>    <a class="code hl_function" href="#a64710c908502c6d43dc365d365e28370">ustream_add_buf</a>(l, <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>);</div>
<div class="line"><span class="lineno">  194</span>}</div>
<div class="ttc" id="austream_8h_html_a5b3a2241e0a59463ee3532e4ecff2618"><div class="ttname"><a href="../../da/d79/ustream_8h.html#a5b3a2241e0a59463ee3532e4ecff2618">ustream_buf_list::min_buffers</a></div><div class="ttdeci">int min_buffers</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00042">ustream.h:42</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00046">ustream_buf_list::buffers</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00035">ustream_buf_list::data_tail</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00094">ustream::free</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00034">ustream_buf_list::head</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00042">ustream_buf_list::min_buffers</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00036">ustream_buf_list::tail</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00040">ustream_add_buf()</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00029">ustream_init_buf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d26/ustream_8c_source.html#l00215">ustream_consume()</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00378">ustream_write_pending()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d26/ustream_8c_a63bfcff990b542772fd9fbc5b6e1f870_cgraph.png" border="0" usemap="#ad6/d26/ustream_8c_a63bfcff990b542772fd9fbc5b6e1f870_cgraph" alt=""/></div>
<map name="ad6/d26/ustream_8c_a63bfcff990b542772fd9fbc5b6e1f870_cgraph" id="ad6/d26/ustream_8c_a63bfcff990b542772fd9fbc5b6e1f870_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,188,68"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a64710c908502c6d43dc365d365e28370" title=" " alt="" coords="236,5,417,39"/>
<area shape="poly" title=" " alt="" coords="188,37,220,33,221,38,189,42"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a3a72c25243ae144e230cc375fa016aac" title=" " alt="" coords="239,63,414,96"/>
<area shape="poly" title=" " alt="" coords="189,60,223,64,223,70,188,65"/>
</map>
</div>

</div>
</div>
<a id="a133847346c9a2d708d19c8a056f728bc" name="a133847346c9a2d708d19c8a056f728bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a133847346c9a2d708d19c8a056f728bc">&#9670;&#160;</a></span>ustream_free_buffers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ustream_free_buffers </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#da/dd1/structustream__buf__list">ustream_buf_list</a> *</td>          <td class="paramname"><span class="paramname"><em>l</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00079">79</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   80</span>{</div>
<div class="line"><span class="lineno">   81</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> = l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#aa70350247646ae77f4551d297fb62fef">head</a>;</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>    <span class="keywordflow">while</span> (<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>) {</div>
<div class="line"><span class="lineno">   84</span>        <span class="keyword">struct </span><a class="code hl_struct" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab664a1d47378eec9f4feee70e9fdec4f">next</a> = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;next;</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>        free(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>);</div>
<div class="line"><span class="lineno">   87</span>        <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> = <a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab664a1d47378eec9f4feee70e9fdec4f">next</a>;</div>
<div class="line"><span class="lineno">   88</span>    }</div>
<div class="line"><span class="lineno">   89</span>    l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#aa70350247646ae77f4551d297fb62fef">head</a> = NULL;</div>
<div class="line"><span class="lineno">   90</span>    l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a870d35c982e3e30d2eb7ad18c76ac686">tail</a> = NULL;</div>
<div class="line"><span class="lineno">   91</span>    l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab50800cb2a37029cb21c964b2980d666">data_tail</a> = NULL;</div>
<div class="line"><span class="lineno">   92</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00035">ustream_buf_list::data_tail</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00034">ustream_buf_list::head</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00129">ustream_buf::next</a>, and <a class="el" href="../../da/d79/ustream_8h_source.html#l00036">ustream_buf_list::tail</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d26/ustream_8c_source.html#l00094">ustream_free()</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00104">ustream_state_change_cb()</a>.</p>

</div>
</div>
<a id="af8718ea51e10ce9d433e4346110f0653" name="af8718ea51e10ce9d433e4346110f0653"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8718ea51e10ce9d433e4346110f0653">&#9670;&#160;</a></span>ustream_get_read_buf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * ustream_get_read_buf </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>buflen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00334">334</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  335</span>{</div>
<div class="line"><span class="lineno">  336</span>    <span class="keywordtype">char</span> *data = NULL;</div>
<div class="line"><span class="lineno">  337</span>    <span class="keywordtype">int</span> len = 0;</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>    <span class="keywordflow">if</span> (s-&gt;r.head) {</div>
<div class="line"><span class="lineno">  340</span>        len = s-&gt;r.head-&gt;tail - s-&gt;r.head-&gt;data;</div>
<div class="line"><span class="lineno">  341</span>        <span class="keywordflow">if</span> (len &gt; 0)</div>
<div class="line"><span class="lineno">  342</span>            data = s-&gt;r.head-&gt;data;</div>
<div class="line"><span class="lineno">  343</span>    }</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>    <span class="keywordflow">if</span> (buflen)</div>
<div class="line"><span class="lineno">  346</span>        *buflen = len;</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>    <span class="keywordflow">return</span> data;</div>
<div class="line"><span class="lineno">  349</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d79/ustream_8h_source.html#l00131">ustream_buf::data</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/dc0/uxc_8c_source.html#l00485">client_cb()</a>, <a class="el" href="../../d6/d5e/ustream-example_8c_source.html#l00025">client_read_cb()</a>, <a class="el" href="../../d2/d28/instance_8c_source.html#l00732">instance_console()</a>, <a class="el" href="../../d2/d28/instance_8c_source.html#l00754">instance_console_client()</a>, <a class="el" href="../../d2/d28/instance_8c_source.html#l00694">instance_stdio()</a>, <a class="el" href="../../da/dc0/uxc_8c_source.html#l00505">local_cb()</a>, <a class="el" href="../../d1/dd7/netifd_2main_8c_source.html#l00140">netifd_process_log_read_cb()</a>, <a class="el" href="../../d1/d5c/rcS_8c_source.html#l00046">pipe_cb()</a>, <a class="el" href="../../df/dc9/exec_8c_source.html#l00230">rpc_exec_epipe_read_cb()</a>, <a class="el" href="../../df/dc9/exec_8c_source.html#l00200">rpc_exec_opipe_read_cb()</a>, <a class="el" href="../../dd/d93/client_8c_source.html#l00141">test_client_fd_data_cb()</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00351">ustream_read()</a>.</p>

</div>
</div>
<a id="a3a72c25243ae144e230cc375fa016aac" name="a3a72c25243ae144e230cc375fa016aac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a72c25243ae144e230cc375fa016aac">&#9670;&#160;</a></span>ustream_init_buf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ustream_init_buf </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00029">29</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   30</span>{</div>
<div class="line"><span class="lineno">   31</span>    <span class="keywordflow">if</span> (!len)</div>
<div class="line"><span class="lineno">   32</span>        abort();</div>
<div class="line"><span class="lineno">   33</span> </div>
<div class="line"><span class="lineno">   34</span>    memset(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, 0, <span class="keyword">sizeof</span>(*<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>));</div>
<div class="line"><span class="lineno">   35</span>    <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;data = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;tail = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;head;</div>
<div class="line"><span class="lineno">   36</span>    <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;end = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;head + len;</div>
<div class="line"><span class="lineno">   37</span>    *<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;head = 0;</div>
<div class="line"><span class="lineno">   38</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d26/ustream_8c_source.html#l00062">ustream_alloc_default()</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00175">ustream_free_buf()</a>.</p>

</div>
</div>
<a id="a4fd8792e264b0d96920fc7bc741a530d" name="a4fd8792e264b0d96920fc7bc741a530d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fd8792e264b0d96920fc7bc741a530d">&#9670;&#160;</a></span>ustream_init_defaults()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ustream_init_defaults </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00114">114</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  115</span>{</div>
<div class="line"><span class="lineno">  116</span><span class="preprocessor">#define DEFAULT_SET(_f, _default)   \</span></div>
<div class="line"><span class="lineno">  117</span><span class="preprocessor">    do {                \</span></div>
<div class="line"><span class="lineno">  118</span><span class="preprocessor">        if (!_f)        \</span></div>
<div class="line"><span class="lineno">  119</span><span class="preprocessor">            _f = _default;  \</span></div>
<div class="line"><span class="lineno">  120</span><span class="preprocessor">    } while(0)</span></div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>    <a class="code hl_define" href="#a849640e76b7105d671036ef1ce1bcda0">DEFAULT_SET</a>(s-&gt;r.alloc, <a class="code hl_function" href="#a0021585123abbcd1c4a25ba6a7ffb599">ustream_alloc_default</a>);</div>
<div class="line"><span class="lineno">  123</span>    <a class="code hl_define" href="#a849640e76b7105d671036ef1ce1bcda0">DEFAULT_SET</a>(s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a03853611acd8f4e90eec49c1e183ee87">w</a>.<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a01e751d790a82b7a8e2041423665ea66">alloc</a>, <a class="code hl_function" href="#a0021585123abbcd1c4a25ba6a7ffb599">ustream_alloc_default</a>);</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>    <a class="code hl_define" href="#a849640e76b7105d671036ef1ce1bcda0">DEFAULT_SET</a>(s-&gt;r.min_buffers, 1);</div>
<div class="line"><span class="lineno">  126</span>    <a class="code hl_define" href="#a849640e76b7105d671036ef1ce1bcda0">DEFAULT_SET</a>(s-&gt;r.max_buffers, 1);</div>
<div class="line"><span class="lineno">  127</span>    <a class="code hl_define" href="#a849640e76b7105d671036ef1ce1bcda0">DEFAULT_SET</a>(s-&gt;r.buffer_len, 4096);</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>    <a class="code hl_define" href="#a849640e76b7105d671036ef1ce1bcda0">DEFAULT_SET</a>(s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a03853611acd8f4e90eec49c1e183ee87">w</a>.<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a5b3a2241e0a59463ee3532e4ecff2618">min_buffers</a>, 2);</div>
<div class="line"><span class="lineno">  130</span>    <a class="code hl_define" href="#a849640e76b7105d671036ef1ce1bcda0">DEFAULT_SET</a>(s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a03853611acd8f4e90eec49c1e183ee87">w</a>.<a class="code hl_variable" href="../../da/d79/ustream_8h.html#af3b56b7094382314a5721968e453b257">max_buffers</a>, -1);</div>
<div class="line"><span class="lineno">  131</span>    <a class="code hl_define" href="#a849640e76b7105d671036ef1ce1bcda0">DEFAULT_SET</a>(s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a03853611acd8f4e90eec49c1e183ee87">w</a>.<a class="code hl_variable" href="../../da/d79/ustream_8h.html#aab610501b2503be59efab2421948079c">buffer_len</a>, 256);</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span><span class="preprocessor">#undef DEFAULT_SET</span></div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>    s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a6edf9e3eba069a76347d6d9975cc41c5">state_change</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a7b331d0a02bb53b37ae38716956c97bd">cb</a> = <a class="code hl_function" href="#aae83a7acd40d935b0e000c15f017c2fc">ustream_state_change_cb</a>;</div>
<div class="line"><span class="lineno">  136</span>    s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab5a83f668de8533f03f594fd4851a8fc">write_error</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  137</span>    s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a0a033ab27c8b83cc83765b571e7e3a03">eof</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  138</span>    s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ad79ec597a16992c722c5156d182121f0">read_blocked</a> = 0;</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>    s-&gt;r.buffers = 0;</div>
<div class="line"><span class="lineno">  141</span>    s-&gt;r.data_bytes = 0;</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>    s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a03853611acd8f4e90eec49c1e183ee87">w</a>.<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a90ad967ab680e5688e3c8fc636a10adf">buffers</a> = 0;</div>
<div class="line"><span class="lineno">  144</span>    s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a03853611acd8f4e90eec49c1e183ee87">w</a>.<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a2cb8be7b642a24ce03d0d8910b98500d">data_bytes</a> = 0;</div>
<div class="line"><span class="lineno">  145</span>}</div>
<div class="ttc" id="auloop_8h_html_a7b331d0a02bb53b37ae38716956c97bd"><div class="ttname"><a href="../../dc/d56/uloop_8h.html#a7b331d0a02bb53b37ae38716956c97bd">uloop_timeout::cb</a></div><div class="ttdeci">uloop_timeout_handler cb</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d56/uloop_8h_source.html#l00077">uloop.h:77</a></div></div>
<div class="ttc" id="austream_8c_html_a0021585123abbcd1c4a25ba6a7ffb599"><div class="ttname"><a href="#a0021585123abbcd1c4a25ba6a7ffb599">ustream_alloc_default</a></div><div class="ttdeci">static int ustream_alloc_default(struct ustream *s, struct ustream_buf_list *l)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d26/ustream_8c_source.html#l00062">ustream.c:62</a></div></div>
<div class="ttc" id="austream_8c_html_a849640e76b7105d671036ef1ce1bcda0"><div class="ttname"><a href="#a849640e76b7105d671036ef1ce1bcda0">DEFAULT_SET</a></div><div class="ttdeci">#define DEFAULT_SET(_f, _default)</div></div>
<div class="ttc" id="austream_8c_html_aae83a7acd40d935b0e000c15f017c2fc"><div class="ttname"><a href="#aae83a7acd40d935b0e000c15f017c2fc">ustream_state_change_cb</a></div><div class="ttdeci">static void ustream_state_change_cb(struct uloop_timeout *t)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d26/ustream_8c_source.html#l00104">ustream.c:104</a></div></div>
<div class="ttc" id="austream_8h_html_a01e751d790a82b7a8e2041423665ea66"><div class="ttname"><a href="../../da/d79/ustream_8h.html#a01e751d790a82b7a8e2041423665ea66">ustream_buf_list::alloc</a></div><div class="ttdeci">int(* alloc)(struct ustream *s, struct ustream_buf_list *l)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00038">ustream.h:38</a></div></div>
<div class="ttc" id="austream_8h_html_a0a033ab27c8b83cc83765b571e7e3a03"><div class="ttname"><a href="../../da/d79/ustream_8h.html#a0a033ab27c8b83cc83765b571e7e3a03">ustream::eof</a></div><div class="ttdeci">bool eof</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00117">ustream.h:117</a></div></div>
<div class="ttc" id="austream_8h_html_a2cb8be7b642a24ce03d0d8910b98500d"><div class="ttname"><a href="../../da/d79/ustream_8h.html#a2cb8be7b642a24ce03d0d8910b98500d">ustream_buf_list::data_bytes</a></div><div class="ttdeci">int data_bytes</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00040">ustream.h:40</a></div></div>
<div class="ttc" id="austream_8h_html_ab5a83f668de8533f03f594fd4851a8fc"><div class="ttname"><a href="../../da/d79/ustream_8h.html#ab5a83f668de8533f03f594fd4851a8fc">ustream::write_error</a></div><div class="ttdeci">bool write_error</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00116">ustream.h:116</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d79/ustream_8h_source.html#l00038">ustream_buf_list::alloc</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00044">ustream_buf_list::buffer_len</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00046">ustream_buf_list::buffers</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00077">uloop_timeout::cb</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00040">ustream_buf_list::data_bytes</a>, <a class="el" href="#a849640e76b7105d671036ef1ce1bcda0">DEFAULT_SET</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00117">ustream::eof</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00043">ustream_buf_list::max_buffers</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00042">ustream_buf_list::min_buffers</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00120">ustream::read_blocked</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00051">ustream::state_change</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00062">ustream_alloc_default()</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00104">ustream_state_change_cb()</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00050">ustream::w</a>, and <a class="el" href="../../da/d79/ustream_8h_source.html#l00116">ustream::write_error</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d70/ustream-fd_8c_source.html#l00160">ustream_fd_init()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d26/ustream_8c_a4fd8792e264b0d96920fc7bc741a530d_cgraph.png" border="0" usemap="#ad6/d26/ustream_8c_a4fd8792e264b0d96920fc7bc741a530d_cgraph" alt=""/></div>
<map name="ad6/d26/ustream_8c_a4fd8792e264b0d96920fc7bc741a530d_cgraph" id="ad6/d26/ustream_8c_a4fd8792e264b0d96920fc7bc741a530d_cgraph">
<area shape="rect" title=" " alt="" coords="5,121,225,155"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a0021585123abbcd1c4a25ba6a7ffb599" title=" " alt="" coords="292,77,514,111"/>
<area shape="poly" title=" " alt="" coords="225,119,276,111,277,116,225,124"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#aae83a7acd40d935b0e000c15f017c2fc" title=" " alt="" coords="273,149,533,183"/>
<area shape="poly" title=" " alt="" coords="225,146,257,149,257,155,225,151"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a64710c908502c6d43dc365d365e28370" title=" " alt="" coords="599,5,780,39"/>
<area shape="poly" title=" " alt="" coords="472,74,605,41,606,46,474,79"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#aa67ddac4c773e0d21f6626bf2371f8d2" title=" " alt="" coords="595,63,785,96"/>
<area shape="poly" title=" " alt="" coords="514,86,579,82,579,88,515,91"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a3a72c25243ae144e230cc375fa016aac" title=" " alt="" coords="602,120,777,154"/>
<area shape="poly" title=" " alt="" coords="515,108,587,119,586,124,514,113"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a133847346c9a2d708d19c8a056f728bc" title=" " alt="" coords="581,177,798,211"/>
<area shape="poly" title=" " alt="" coords="534,176,566,179,565,185,533,182"/>
</map>
</div>

</div>
</div>
<a id="a0ed3a1f1af94d311249c4b34b9e937d3" name="a0ed3a1f1af94d311249c4b34b9e937d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ed3a1f1af94d311249c4b34b9e937d3">&#9670;&#160;</a></span>ustream_prepare_buf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool ustream_prepare_buf </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#da/dd1/structustream__buf__list">ustream_buf_list</a> *</td>          <td class="paramname"><span class="paramname"><em>l</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00251">251</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  252</span>{</div>
<div class="line"><span class="lineno">  253</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>;</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span>    <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> = l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab50800cb2a37029cb21c964b2980d666">data_tail</a>;</div>
<div class="line"><span class="lineno">  256</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>) {</div>
<div class="line"><span class="lineno">  257</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="#a09dacab33f0a207388ab373c77fd45b3">ustream_should_move</a>(l, <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, len)) {</div>
<div class="line"><span class="lineno">  258</span>            <span class="keywordtype">int</span> len = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;tail - <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;data;</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>            memmove(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;head, <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;data, len);</div>
<div class="line"><span class="lineno">  261</span>            <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;data = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;head;</div>
<div class="line"><span class="lineno">  262</span>            <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;tail = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;data + len;</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>            <span class="keywordflow">if</span> (l == &amp;s-&gt;r)</div>
<div class="line"><span class="lineno">  265</span>                <a class="code hl_function" href="#a4f850d5efa8e096ca116a2b98a68bd16">ustream_fixup_string</a>(s, <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>);</div>
<div class="line"><span class="lineno">  266</span>        }</div>
<div class="line"><span class="lineno">  267</span>        <span class="comment">/* some chunks available at the tail */</span></div>
<div class="line"><span class="lineno">  268</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;tail != <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;end)</div>
<div class="line"><span class="lineno">  269</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  270</span>        <span class="comment">/* next buf available */</span></div>
<div class="line"><span class="lineno">  271</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;next) {</div>
<div class="line"><span class="lineno">  272</span>            l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab50800cb2a37029cb21c964b2980d666">data_tail</a> = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;next;</div>
<div class="line"><span class="lineno">  273</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  274</span>        }</div>
<div class="line"><span class="lineno">  275</span>    }</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="#aa67ddac4c773e0d21f6626bf2371f8d2">ustream_can_alloc</a>(l))</div>
<div class="line"><span class="lineno">  278</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>    <span class="keywordflow">if</span> (l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a01e751d790a82b7a8e2041423665ea66">alloc</a>(s, l) &lt; 0)</div>
<div class="line"><span class="lineno">  281</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>    l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab50800cb2a37029cb21c964b2980d666">data_tail</a> = l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a870d35c982e3e30d2eb7ad18c76ac686">tail</a>;</div>
<div class="line"><span class="lineno">  284</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  285</span>}</div>
<div class="ttc" id="austream_8c_html_a09dacab33f0a207388ab373c77fd45b3"><div class="ttname"><a href="#a09dacab33f0a207388ab373c77fd45b3">ustream_should_move</a></div><div class="ttdeci">static bool ustream_should_move(struct ustream_buf_list *l, struct ustream_buf *buf, int len)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d26/ustream_8c_source.html#l00147">ustream.c:147</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d79/ustream_8h_source.html#l00038">ustream_buf_list::alloc</a>, <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00035">ustream_buf_list::data_tail</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00036">ustream_buf_list::tail</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00054">ustream_can_alloc()</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00243">ustream_fixup_string()</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00147">ustream_should_move()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d26/ustream_8c_source.html#l00287">ustream_reserve()</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00473">ustream_vprintf()</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00419">ustream_write_buffered()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d26/ustream_8c_a0ed3a1f1af94d311249c4b34b9e937d3_cgraph.png" border="0" usemap="#ad6/d26/ustream_8c_a0ed3a1f1af94d311249c4b34b9e937d3_cgraph" alt=""/></div>
<map name="ad6/d26/ustream_8c_a0ed3a1f1af94d311249c4b34b9e937d3_cgraph" id="ad6/d26/ustream_8c_a0ed3a1f1af94d311249c4b34b9e937d3_cgraph">
<area shape="rect" title=" " alt="" coords="5,26,223,59"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#aa67ddac4c773e0d21f6626bf2371f8d2" title=" " alt="" coords="547,27,737,61"/>
<area shape="poly" title=" " alt="" coords="192,22,270,10,385,3,499,10,560,20,559,26,499,16,385,8,271,16,193,28"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a4f850d5efa8e096ca116a2b98a68bd16" title=" " alt="" coords="277,26,493,59"/>
<area shape="poly" title=" " alt="" coords="223,40,261,40,261,45,223,45"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a09dacab33f0a207388ab373c77fd45b3" title=" " alt="" coords="271,83,499,117"/>
<area shape="poly" title=" " alt="" coords="197,57,288,77,287,82,196,62"/>
<area shape="poly" title=" " alt="" coords="465,80,546,62,547,67,466,85"/>
</map>
</div>

</div>
</div>
<a id="a5cd5e3fd92cce6077f0ed0fa53c5eb56" name="a5cd5e3fd92cce6077f0ed0fa53c5eb56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cd5e3fd92cce6077f0ed0fa53c5eb56">&#9670;&#160;</a></span>ustream_printf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ustream_printf </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>format</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>...</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00540">540</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  541</span>{</div>
<div class="line"><span class="lineno">  542</span>    va_list arg;</div>
<div class="line"><span class="lineno">  543</span>    <span class="keywordtype">int</span> ret;</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>    <span class="keywordflow">if</span> (s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab5a83f668de8533f03f594fd4851a8fc">write_error</a>)</div>
<div class="line"><span class="lineno">  546</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span>    va_start(arg, format);</div>
<div class="line"><span class="lineno">  549</span>    ret = <a class="code hl_function" href="#a61be783dcc8b068e3462484564835363">ustream_vprintf</a>(s, format, arg);</div>
<div class="line"><span class="lineno">  550</span>    va_end(arg);</div>
<div class="line"><span class="lineno">  551</span> </div>
<div class="line"><span class="lineno">  552</span>    <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno">  553</span>}</div>
<div class="ttc" id="austream_8c_html_a61be783dcc8b068e3462484564835363"><div class="ttname"><a href="#a61be783dcc8b068e3462484564835363">ustream_vprintf</a></div><div class="ttdeci">int ustream_vprintf(struct ustream *s, const char *format, va_list arg)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d26/ustream_8c_source.html#l00473">ustream.c:473</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d26/ustream_8c_source.html#l00473">ustream_vprintf()</a>, and <a class="el" href="../../da/d79/ustream_8h_source.html#l00116">ustream::write_error</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d5e/ustream-example_8c_source.html#l00025">client_read_cb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d26/ustream_8c_a5cd5e3fd92cce6077f0ed0fa53c5eb56_cgraph.png" border="0" usemap="#ad6/d26/ustream_8c_a5cd5e3fd92cce6077f0ed0fa53c5eb56_cgraph" alt=""/></div>
<map name="ad6/d26/ustream_8c_a5cd5e3fd92cce6077f0ed0fa53c5eb56_cgraph" id="ad6/d26/ustream_8c_a5cd5e3fd92cce6077f0ed0fa53c5eb56_cgraph">
<area shape="rect" title=" " alt="" coords="5,91,163,124"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a61be783dcc8b068e3462484564835363" title=" " alt="" coords="211,91,379,124"/>
<area shape="poly" title=" " alt="" coords="163,105,195,105,195,110,163,110"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a0ed3a1f1af94d311249c4b34b9e937d3" title=" " alt="" coords="921,23,1138,56"/>
<area shape="poly" title=" " alt="" coords="367,87,427,75,553,58,681,46,905,37,905,42,682,52,554,63,427,81,368,92"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a0fd4724c3a2419db5c46a929ca2d7c9c" title=" " alt="" coords="427,117,579,151"/>
<area shape="poly" title=" " alt="" coords="380,115,412,120,411,125,379,121"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#aff14ca1c3b81e376b6033f2cf55bf75b" title=" " alt="" coords="627,67,867,100"/>
<area shape="poly" title=" " alt="" coords="380,100,612,88,612,93,380,106"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a90259dc27343d0ee765236e3e42302da" title=" " alt="" coords="644,160,850,194"/>
<area shape="poly" title=" " alt="" coords="329,122,375,144,428,161,530,176,629,179,629,184,529,181,426,166,373,148,327,127"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#aa67ddac4c773e0d21f6626bf2371f8d2" title=" " alt="" coords="1483,7,1674,40"/>
<area shape="poly" title=" " alt="" coords="1110,19,1192,7,1263,3,1336,3,1468,10,1468,15,1336,8,1263,9,1192,13,1111,24"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a4f850d5efa8e096ca116a2b98a68bd16" title=" " alt="" coords="1198,23,1414,56"/>
<area shape="poly" title=" " alt="" coords="1139,37,1182,37,1182,42,1139,42"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a09dacab33f0a207388ab373c77fd45b3" title=" " alt="" coords="1192,80,1420,114"/>
<area shape="poly" title=" " alt="" coords="1115,54,1207,74,1206,79,1113,59"/>
<area shape="poly" title=" " alt="" coords="1379,77,1420,66,1503,42,1505,48,1421,71,1380,82"/>
<area shape="poly" title=" " alt="" coords="579,116,647,101,648,106,580,121"/>
<area shape="poly" title=" " alt="" coords="580,145,632,154,631,159,579,150"/>
<area shape="poly" title=" " alt="" coords="859,63,905,56,906,61,860,69"/>
<area shape="rect" href="../../da/d79/ustream_8h.html#add76dce88c832892b8971ab19c766aab" title=" " alt="" coords="915,160,1144,194"/>
<area shape="poly" title=" " alt="" coords="850,174,899,174,899,179,850,179"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="1212,160,1401,194"/>
<area shape="poly" title=" " alt="" coords="1145,174,1196,174,1196,179,1145,179"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a941864296983cb342a79afe55055f8d3" title=" " alt="" coords="1502,103,1655,136"/>
<area shape="poly" title=" " alt="" coords="1389,157,1487,136,1488,141,1390,162"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07" title=" " alt="" coords="1480,160,1677,194"/>
<area shape="poly" title=" " alt="" coords="1401,174,1465,174,1465,179,1401,179"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="1468,217,1689,251"/>
<area shape="poly" title=" " alt="" coords="1390,191,1481,211,1480,216,1389,197"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="1737,103,1866,136"/>
<area shape="poly" title=" " alt="" coords="1647,157,1688,146,1721,137,1723,143,1689,151,1648,162"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a76f33118cba0a358482528fad8c0f4cd" title=" " alt="" coords="1762,160,1841,194"/>
<area shape="poly" title=" " alt="" coords="1677,174,1747,174,1747,179,1677,179"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="1914,103,2015,136"/>
<area shape="poly" title=" " alt="" coords="1867,117,1898,117,1898,122,1867,122"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="1759,217,1844,251"/>
<area shape="poly" title=" " alt="" coords="1689,231,1743,231,1743,237,1689,237"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="1918,217,2012,251"/>
<area shape="poly" title=" " alt="" coords="1844,231,1902,231,1902,237,1844,237"/>
</map>
</div>

</div>
</div>
<a id="aeaa16cab137c211c77310698b210ecdf" name="aeaa16cab137c211c77310698b210ecdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaa16cab137c211c77310698b210ecdf">&#9670;&#160;</a></span>ustream_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ustream_read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>buflen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00351">351</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  352</span>{</div>
<div class="line"><span class="lineno">  353</span>    <span class="keywordtype">char</span> *chunk;</div>
<div class="line"><span class="lineno">  354</span>    <span class="keywordtype">int</span> chunk_len;</div>
<div class="line"><span class="lineno">  355</span>    <span class="keywordtype">int</span> len = 0;</div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span>    <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno">  358</span>        chunk = <a class="code hl_function" href="#af8718ea51e10ce9d433e4346110f0653">ustream_get_read_buf</a>(s, &amp;chunk_len);</div>
<div class="line"><span class="lineno">  359</span>        <span class="keywordflow">if</span> (!chunk)</div>
<div class="line"><span class="lineno">  360</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  361</span>        <span class="keywordflow">if</span> (chunk_len &gt; buflen - len)</div>
<div class="line"><span class="lineno">  362</span>            chunk_len = buflen - len;</div>
<div class="line"><span class="lineno">  363</span>        memcpy(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> + len, chunk, chunk_len);</div>
<div class="line"><span class="lineno">  364</span>        <a class="code hl_function" href="#a6e2924135643035597d360c6dcb0a294">ustream_consume</a>(s, chunk_len);</div>
<div class="line"><span class="lineno">  365</span>        len += chunk_len;</div>
<div class="line"><span class="lineno">  366</span>    } <span class="keywordflow">while</span> (len &lt; buflen);</div>
<div class="line"><span class="lineno">  367</span> </div>
<div class="line"><span class="lineno">  368</span>    <span class="keywordflow">return</span> len;</div>
<div class="line"><span class="lineno">  369</span>}</div>
<div class="ttc" id="austream_8c_html_a6e2924135643035597d360c6dcb0a294"><div class="ttname"><a href="#a6e2924135643035597d360c6dcb0a294">ustream_consume</a></div><div class="ttdeci">void ustream_consume(struct ustream *s, int len)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d26/ustream_8c_source.html#l00215">ustream.c:215</a></div></div>
<div class="ttc" id="austream_8c_html_af8718ea51e10ce9d433e4346110f0653"><div class="ttname"><a href="#af8718ea51e10ce9d433e4346110f0653">ustream_get_read_buf</a></div><div class="ttdeci">char * ustream_get_read_buf(struct ustream *s, int *buflen)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d26/ustream_8c_source.html#l00334">ustream.c:334</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00215">ustream_consume()</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00334">ustream_get_read_buf()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d26/ustream_8c_aeaa16cab137c211c77310698b210ecdf_cgraph.png" border="0" usemap="#ad6/d26/ustream_8c_aeaa16cab137c211c77310698b210ecdf_cgraph" alt=""/></div>
<map name="ad6/d26/ustream_8c_aeaa16cab137c211c77310698b210ecdf_cgraph" id="ad6/d26/ustream_8c_aeaa16cab137c211c77310698b210ecdf_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,153,115"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a6e2924135643035597d360c6dcb0a294" title=" " alt="" coords="219,52,409,85"/>
<area shape="poly" title=" " alt="" coords="153,86,203,79,204,85,153,91"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#af8718ea51e10ce9d433e4346110f0653" title=" " alt="" coords="201,109,427,143"/>
<area shape="poly" title=" " alt="" coords="153,104,186,108,185,113,153,109"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a6665fc275e6233416683c9b76908a53f" title=" " alt="" coords="475,5,677,62"/>
<area shape="poly" title=" " alt="" coords="409,53,459,46,460,52,410,58"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a63bfcff990b542772fd9fbc5b6e1f870" title=" " alt="" coords="485,86,667,120"/>
<area shape="poly" title=" " alt="" coords="410,78,470,86,469,92,409,84"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a64710c908502c6d43dc365d365e28370" title=" " alt="" coords="725,57,907,91"/>
<area shape="poly" title=" " alt="" coords="668,89,710,84,710,89,668,94"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a3a72c25243ae144e230cc375fa016aac" title=" " alt="" coords="728,114,904,148"/>
<area shape="poly" title=" " alt="" coords="668,111,713,116,713,122,668,116"/>
</map>
</div>

</div>
</div>
<a id="a48eb6688bc7551e8fa0f5fe45c3ff767" name="a48eb6688bc7551e8fa0f5fe45c3ff767"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48eb6688bc7551e8fa0f5fe45c3ff767">&#9670;&#160;</a></span>ustream_reserve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * ustream_reserve </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>maxlen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00287">287</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  288</span>{</div>
<div class="line"><span class="lineno">  289</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>;</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="#a0ed3a1f1af94d311249c4b34b9e937d3">ustream_prepare_buf</a>(s, &amp;s-&gt;r, len)) {</div>
<div class="line"><span class="lineno">  292</span>        <a class="code hl_function" href="#a6665fc275e6233416683c9b76908a53f">__ustream_set_read_blocked</a>(s, s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ad79ec597a16992c722c5156d182121f0">read_blocked</a> | <a class="code hl_enumvalue" href="../../da/d79/ustream_8h.html#a479afe8b27077dc2b881c848deb1c873a22e5f87455357c21e4922c63c4580f77">READ_BLOCKED_FULL</a>);</div>
<div class="line"><span class="lineno">  293</span>        *maxlen = 0;</div>
<div class="line"><span class="lineno">  294</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  295</span>    }</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>    <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> = s-&gt;r.data_tail;</div>
<div class="line"><span class="lineno">  298</span>    *maxlen = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;end - <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;tail;</div>
<div class="line"><span class="lineno">  299</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;tail;</div>
<div class="line"><span class="lineno">  300</span>}</div>
<div class="ttc" id="austream_8c_html_a0ed3a1f1af94d311249c4b34b9e937d3"><div class="ttname"><a href="#a0ed3a1f1af94d311249c4b34b9e937d3">ustream_prepare_buf</a></div><div class="ttdeci">static bool ustream_prepare_buf(struct ustream *s, struct ustream_buf_list *l, int len)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d26/ustream_8c_source.html#l00251">ustream.c:251</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d26/ustream_8c_source.html#l00196">__ustream_set_read_blocked()</a>, <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00120">ustream::read_blocked</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00030">READ_BLOCKED_FULL</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00251">ustream_prepare_buf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d70/ustream-fd_8c_source.html#l00045">ustream_fd_read_pending()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d26/ustream_8c_a48eb6688bc7551e8fa0f5fe45c3ff767_cgraph.png" border="0" usemap="#ad6/d26/ustream_8c_a48eb6688bc7551e8fa0f5fe45c3ff767_cgraph" alt=""/></div>
<map name="ad6/d26/ustream_8c_a48eb6688bc7551e8fa0f5fe45c3ff767_cgraph" id="ad6/d26/ustream_8c_a48eb6688bc7551e8fa0f5fe45c3ff767_cgraph">
<area shape="rect" title=" " alt="" coords="5,52,181,85"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a6665fc275e6233416683c9b76908a53f" title=" " alt="" coords="236,5,439,62"/>
<area shape="poly" title=" " alt="" coords="181,53,221,48,221,53,182,59"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a0ed3a1f1af94d311249c4b34b9e937d3" title=" " alt="" coords="229,86,446,120"/>
<area shape="poly" title=" " alt="" coords="182,78,214,83,213,88,181,83"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#aa67ddac4c773e0d21f6626bf2371f8d2" title=" " alt="" coords="770,88,961,121"/>
<area shape="poly" title=" " alt="" coords="415,83,494,71,608,63,723,71,783,81,782,86,722,76,608,69,494,76,416,88"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a4f850d5efa8e096ca116a2b98a68bd16" title=" " alt="" coords="500,86,716,120"/>
<area shape="poly" title=" " alt="" coords="447,100,484,100,484,106,447,106"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a09dacab33f0a207388ab373c77fd45b3" title=" " alt="" coords="494,144,722,177"/>
<area shape="poly" title=" " alt="" coords="421,118,511,137,510,142,420,123"/>
<area shape="poly" title=" " alt="" coords="688,140,769,122,770,128,690,145"/>
</map>
</div>

</div>
</div>
<a id="ad9a99d5c375c49ea750fe97d0e93ada1" name="ad9a99d5c375c49ea750fe97d0e93ada1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9a99d5c375c49ea750fe97d0e93ada1">&#9670;&#160;</a></span>ustream_set_read_blocked()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ustream_set_read_blocked </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>set</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00205">205</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  206</span>{</div>
<div class="line"><span class="lineno">  207</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> val = s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ad79ec597a16992c722c5156d182121f0">read_blocked</a> &amp; ~READ_BLOCKED_USER;</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>    <span class="keywordflow">if</span> (set)</div>
<div class="line"><span class="lineno">  210</span>        val |= <a class="code hl_enumvalue" href="../../da/d79/ustream_8h.html#a479afe8b27077dc2b881c848deb1c873a9aa15061cf346a26036de7f024b1d726">READ_BLOCKED_USER</a>;</div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>    <a class="code hl_function" href="#a6665fc275e6233416683c9b76908a53f">__ustream_set_read_blocked</a>(s, val);</div>
<div class="line"><span class="lineno">  213</span>}</div>
<div class="ttc" id="austream_8h_html_a479afe8b27077dc2b881c848deb1c873a9aa15061cf346a26036de7f024b1d726"><div class="ttname"><a href="../../da/d79/ustream_8h.html#a479afe8b27077dc2b881c848deb1c873a9aa15061cf346a26036de7f024b1d726">READ_BLOCKED_USER</a></div><div class="ttdeci">@ READ_BLOCKED_USER</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00029">ustream.h:29</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d26/ustream_8c_source.html#l00196">__ustream_set_read_blocked()</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00120">ustream::read_blocked</a>, and <a class="el" href="../../da/d79/ustream_8h_source.html#l00029">READ_BLOCKED_USER</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d5e/ustream-example_8c_source.html#l00062">client_notify_write()</a>, and <a class="el" href="../../d6/d5e/ustream-example_8c_source.html#l00025">client_read_cb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d26/ustream_8c_ad9a99d5c375c49ea750fe97d0e93ada1_cgraph.png" border="0" usemap="#ad6/d26/ustream_8c_ad9a99d5c375c49ea750fe97d0e93ada1_cgraph" alt=""/></div>
<map name="ad6/d26/ustream_8c_ad9a99d5c375c49ea750fe97d0e93ada1_cgraph" id="ad6/d26/ustream_8c_ad9a99d5c375c49ea750fe97d0e93ada1_cgraph">
<area shape="rect" title=" " alt="" coords="5,17,270,51"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a6665fc275e6233416683c9b76908a53f" title=" " alt="" coords="318,5,520,62"/>
<area shape="poly" title=" " alt="" coords="270,31,302,31,302,36,270,36"/>
</map>
</div>

</div>
</div>
<a id="a09dacab33f0a207388ab373c77fd45b3" name="a09dacab33f0a207388ab373c77fd45b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09dacab33f0a207388ab373c77fd45b3">&#9670;&#160;</a></span>ustream_should_move()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool ustream_should_move </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#da/dd1/structustream__buf__list">ustream_buf_list</a> *</td>          <td class="paramname"><span class="paramname"><em>l</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00147">147</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  148</span>{</div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordtype">int</span> maxlen;</div>
<div class="line"><span class="lineno">  150</span>    <span class="keywordtype">int</span> offset;</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>    <span class="comment">/* nothing to squeeze */</span></div>
<div class="line"><span class="lineno">  153</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;data == <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;head)</div>
<div class="line"><span class="lineno">  154</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>    maxlen = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;end - <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;head;</div>
<div class="line"><span class="lineno">  157</span>    offset = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;data - <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;head;</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>    <span class="comment">/* less than half is available */</span></div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordflow">if</span> (offset &gt; maxlen / 2)</div>
<div class="line"><span class="lineno">  161</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    <span class="comment">/* less than 32 bytes data but takes more than 1/4 space */</span></div>
<div class="line"><span class="lineno">  164</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;tail - <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;data &lt; 32 &amp;&amp; offset &gt; maxlen / 4)</div>
<div class="line"><span class="lineno">  165</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>    <span class="comment">/* more buf is already in list or can be allocated */</span></div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> != l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a870d35c982e3e30d2eb7ad18c76ac686">tail</a> || <a class="code hl_function" href="#aa67ddac4c773e0d21f6626bf2371f8d2">ustream_can_alloc</a>(l))</div>
<div class="line"><span class="lineno">  169</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>    <span class="comment">/* no need to move if len is available at the tail */</span></div>
<div class="line"><span class="lineno">  172</span>    <span class="keywordflow">return</span> (<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;end - <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;tail &lt; len);</div>
<div class="line"><span class="lineno">  173</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00036">ustream_buf_list::tail</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00054">ustream_can_alloc()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d26/ustream_8c_source.html#l00251">ustream_prepare_buf()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d26/ustream_8c_a09dacab33f0a207388ab373c77fd45b3_cgraph.png" border="0" usemap="#ad6/d26/ustream_8c_a09dacab33f0a207388ab373c77fd45b3_cgraph" alt=""/></div>
<map name="ad6/d26/ustream_8c_a09dacab33f0a207388ab373c77fd45b3_cgraph" id="ad6/d26/ustream_8c_a09dacab33f0a207388ab373c77fd45b3_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,234,39"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#aa67ddac4c773e0d21f6626bf2371f8d2" title=" " alt="" coords="282,5,472,39"/>
<area shape="poly" title=" " alt="" coords="234,20,266,20,266,25,234,25"/>
</map>
</div>

</div>
</div>
<a id="aae83a7acd40d935b0e000c15f017c2fc" name="aae83a7acd40d935b0e000c15f017c2fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae83a7acd40d935b0e000c15f017c2fc">&#9670;&#160;</a></span>ustream_state_change_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ustream_state_change_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a> *</td>          <td class="paramname"><span class="paramname"><em>t</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00104">104</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  105</span>{</div>
<div class="line"><span class="lineno">  106</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *s = <a class="code hl_define" href="../../da/d23/list_8h.html#af8c317a42292b61c93aae91e59118a46">container_of</a>(t, <span class="keyword">struct</span> <a class="code hl_struct" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a>, <a class="code hl_variable" href="../../da/d79/ustream_8h.html#a6edf9e3eba069a76347d6d9975cc41c5">state_change</a>);</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordflow">if</span> (s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab5a83f668de8533f03f594fd4851a8fc">write_error</a>)</div>
<div class="line"><span class="lineno">  109</span>        <a class="code hl_function" href="#a133847346c9a2d708d19c8a056f728bc">ustream_free_buffers</a>(&amp;s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a03853611acd8f4e90eec49c1e183ee87">w</a>);</div>
<div class="line"><span class="lineno">  110</span>    <span class="keywordflow">if</span> (s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a6070c3efdc219cf92c423b8e775b74cb">notify_state</a>)</div>
<div class="line"><span class="lineno">  111</span>        s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a6070c3efdc219cf92c423b8e775b74cb">notify_state</a>(s);</div>
<div class="line"><span class="lineno">  112</span>}</div>
<div class="ttc" id="alist_8h_html_af8c317a42292b61c93aae91e59118a46"><div class="ttname"><a href="../../da/d23/list_8h.html#af8c317a42292b61c93aae91e59118a46">container_of</a></div><div class="ttdeci">#define container_of(ptr, type, member)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d23/list_8h_source.html#l00038">list.h:38</a></div></div>
<div class="ttc" id="austream_8h_html_a6070c3efdc219cf92c423b8e775b74cb"><div class="ttname"><a href="../../da/d79/ustream_8h.html#a6070c3efdc219cf92c423b8e775b74cb">ustream::notify_state</a></div><div class="ttdeci">void(* notify_state)(struct ustream *s)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00078">ustream.h:78</a></div></div>
<div class="ttc" id="austream_8h_html_d8/d8e/structustream"><div class="ttname"><a href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00049">ustream.h:49</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d23/list_8h_source.html#l00038">container_of</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00078">ustream::notify_state</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00051">ustream::state_change</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00079">ustream_free_buffers()</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00050">ustream::w</a>, and <a class="el" href="../../da/d79/ustream_8h_source.html#l00116">ustream::write_error</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d26/ustream_8c_source.html#l00114">ustream_init_defaults()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d26/ustream_8c_aae83a7acd40d935b0e000c15f017c2fc_cgraph.png" border="0" usemap="#ad6/d26/ustream_8c_aae83a7acd40d935b0e000c15f017c2fc_cgraph" alt=""/></div>
<map name="ad6/d26/ustream_8c_aae83a7acd40d935b0e000c15f017c2fc_cgraph" id="ad6/d26/ustream_8c_aae83a7acd40d935b0e000c15f017c2fc_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,266,39"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a133847346c9a2d708d19c8a056f728bc" title=" " alt="" coords="314,5,531,39"/>
<area shape="poly" title=" " alt="" coords="266,20,298,20,298,25,266,25"/>
</map>
</div>

</div>
</div>
<a id="a61be783dcc8b068e3462484564835363" name="a61be783dcc8b068e3462484564835363"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61be783dcc8b068e3462484564835363">&#9670;&#160;</a></span>ustream_vprintf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ustream_vprintf </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>format</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">va_list</td>          <td class="paramname"><span class="paramname"><em>arg</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00473">473</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  474</span>{</div>
<div class="line"><span class="lineno">  475</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../da/d79/ustream_8h.html#da/dd1/structustream__buf__list">ustream_buf_list</a> *l = &amp;s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a03853611acd8f4e90eec49c1e183ee87">w</a>;</div>
<div class="line"><span class="lineno">  476</span>    <span class="keywordtype">char</span> *<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>;</div>
<div class="line"><span class="lineno">  477</span>    va_list arg2;</div>
<div class="line"><span class="lineno">  478</span>    <span class="keywordtype">int</span> wr, maxlen, buflen;</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>    <span class="keywordflow">if</span> (s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab5a83f668de8533f03f594fd4851a8fc">write_error</a>)</div>
<div class="line"><span class="lineno">  481</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>    <span class="keywordflow">if</span> (!l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a2cb8be7b642a24ce03d0d8910b98500d">data_bytes</a>) {</div>
<div class="line"><span class="lineno">  484</span>        <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> = alloca(<a class="code hl_define" href="#a6b85908d36fdecd13603f95c58db00c4">MAX_STACK_BUFLEN</a>);</div>
<div class="line"><span class="lineno">  485</span>        va_copy(arg2, arg);</div>
<div class="line"><span class="lineno">  486</span>        maxlen = vsnprintf(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, <a class="code hl_define" href="#a6b85908d36fdecd13603f95c58db00c4">MAX_STACK_BUFLEN</a>, format, arg2);</div>
<div class="line"><span class="lineno">  487</span>        va_end(arg2);</div>
<div class="line"><span class="lineno">  488</span>        <span class="keywordflow">if</span> (maxlen &lt; <a class="code hl_define" href="#a6b85908d36fdecd13603f95c58db00c4">MAX_STACK_BUFLEN</a>) {</div>
<div class="line"><span class="lineno">  489</span>            wr = s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a36cba8d68c57c1a20ab3c077d21fadb7">write</a>(s, <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, maxlen, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  490</span>            <span class="keywordflow">if</span> (wr &lt; 0) {</div>
<div class="line"><span class="lineno">  491</span>                <a class="code hl_function" href="#a90259dc27343d0ee765236e3e42302da">ustream_write_error</a>(s);</div>
<div class="line"><span class="lineno">  492</span>                <span class="keywordflow">return</span> wr;</div>
<div class="line"><span class="lineno">  493</span>            }</div>
<div class="line"><span class="lineno">  494</span>            <span class="keywordflow">if</span> (wr == maxlen)</div>
<div class="line"><span class="lineno">  495</span>                <span class="keywordflow">return</span> wr;</div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span>            <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> += wr;</div>
<div class="line"><span class="lineno">  498</span>            maxlen -= wr;</div>
<div class="line"><span class="lineno">  499</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="#aff14ca1c3b81e376b6033f2cf55bf75b">ustream_write_buffered</a>(s, <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, maxlen, wr);</div>
<div class="line"><span class="lineno">  500</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  501</span>            <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> = malloc(maxlen + 1);</div>
<div class="line"><span class="lineno">  502</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>)</div>
<div class="line"><span class="lineno">  503</span>                <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  504</span>            wr = vsnprintf(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, maxlen + 1, format, arg);</div>
<div class="line"><span class="lineno">  505</span>            wr = <a class="code hl_function" href="#a0fd4724c3a2419db5c46a929ca2d7c9c">ustream_write</a>(s, <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, wr, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  506</span>            free(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>);</div>
<div class="line"><span class="lineno">  507</span>            <span class="keywordflow">return</span> wr;</div>
<div class="line"><span class="lineno">  508</span>        }</div>
<div class="line"><span class="lineno">  509</span>    }</div>
<div class="line"><span class="lineno">  510</span> </div>
<div class="line"><span class="lineno">  511</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="#a0ed3a1f1af94d311249c4b34b9e937d3">ustream_prepare_buf</a>(s, l, 1))</div>
<div class="line"><span class="lineno">  512</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>    <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> = l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab50800cb2a37029cb21c964b2980d666">data_tail</a>-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ac485edc30dbc1daa9bdc1cca27ed7995">tail</a>;</div>
<div class="line"><span class="lineno">  515</span>    buflen = l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab50800cb2a37029cb21c964b2980d666">data_tail</a>-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ac837d6addf424ba56de98baec5e6235d">end</a> - <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>;</div>
<div class="line"><span class="lineno">  516</span> </div>
<div class="line"><span class="lineno">  517</span>    va_copy(arg2, arg);</div>
<div class="line"><span class="lineno">  518</span>    maxlen = vsnprintf(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, buflen, format, arg2);</div>
<div class="line"><span class="lineno">  519</span>    va_end(arg2);</div>
<div class="line"><span class="lineno">  520</span> </div>
<div class="line"><span class="lineno">  521</span>    wr = maxlen;</div>
<div class="line"><span class="lineno">  522</span>    <span class="keywordflow">if</span> (wr &gt;= buflen)</div>
<div class="line"><span class="lineno">  523</span>        wr = buflen - 1;</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>    l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab50800cb2a37029cb21c964b2980d666">data_tail</a>-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ac485edc30dbc1daa9bdc1cca27ed7995">tail</a> += wr;</div>
<div class="line"><span class="lineno">  526</span>    l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a2cb8be7b642a24ce03d0d8910b98500d">data_bytes</a> += wr;</div>
<div class="line"><span class="lineno">  527</span>    <span class="keywordflow">if</span> (maxlen &lt; buflen)</div>
<div class="line"><span class="lineno">  528</span>        <span class="keywordflow">return</span> wr;</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>    <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> = malloc(maxlen + 1);</div>
<div class="line"><span class="lineno">  531</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>)</div>
<div class="line"><span class="lineno">  532</span>        <span class="keywordflow">return</span> wr;</div>
<div class="line"><span class="lineno">  533</span>    maxlen = vsnprintf(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, maxlen + 1, format, arg);</div>
<div class="line"><span class="lineno">  534</span>    wr = <a class="code hl_function" href="#aff14ca1c3b81e376b6033f2cf55bf75b">ustream_write_buffered</a>(s, <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> + wr, maxlen - wr, wr);</div>
<div class="line"><span class="lineno">  535</span>    free(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>);</div>
<div class="line"><span class="lineno">  536</span> </div>
<div class="line"><span class="lineno">  537</span>    <span class="keywordflow">return</span> wr;</div>
<div class="line"><span class="lineno">  538</span>}</div>
<div class="ttc" id="austream_8c_html_a0fd4724c3a2419db5c46a929ca2d7c9c"><div class="ttname"><a href="#a0fd4724c3a2419db5c46a929ca2d7c9c">ustream_write</a></div><div class="ttdeci">int ustream_write(struct ustream *s, const char *data, int len, bool more)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d26/ustream_8c_source.html#l00446">ustream.c:446</a></div></div>
<div class="ttc" id="austream_8c_html_a6b85908d36fdecd13603f95c58db00c4"><div class="ttname"><a href="#a6b85908d36fdecd13603f95c58db00c4">MAX_STACK_BUFLEN</a></div><div class="ttdeci">#define MAX_STACK_BUFLEN</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d26/ustream_8c_source.html#l00471">ustream.c:471</a></div></div>
<div class="ttc" id="austream_8c_html_a90259dc27343d0ee765236e3e42302da"><div class="ttname"><a href="#a90259dc27343d0ee765236e3e42302da">ustream_write_error</a></div><div class="ttdeci">static void ustream_write_error(struct ustream *s)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d26/ustream_8c_source.html#l00371">ustream.c:371</a></div></div>
<div class="ttc" id="austream_8c_html_aff14ca1c3b81e376b6033f2cf55bf75b"><div class="ttname"><a href="#aff14ca1c3b81e376b6033f2cf55bf75b">ustream_write_buffered</a></div><div class="ttdeci">static int ustream_write_buffered(struct ustream *s, const char *data, int len, int wr)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d26/ustream_8c_source.html#l00419">ustream.c:419</a></div></div>
<div class="ttc" id="austream_8h_html_a36cba8d68c57c1a20ab3c077d21fadb7"><div class="ttname"><a href="../../da/d79/ustream_8h.html#a36cba8d68c57c1a20ab3c077d21fadb7">ustream::write</a></div><div class="ttdeci">int(* write)(struct ustream *s, const char *buf, int len, bool more)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00088">ustream.h:88</a></div></div>
<div class="ttc" id="austream_8h_html_ac485edc30dbc1daa9bdc1cca27ed7995"><div class="ttname"><a href="../../da/d79/ustream_8h.html#ac485edc30dbc1daa9bdc1cca27ed7995">ustream_buf::tail</a></div><div class="ttdeci">char * tail</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00132">ustream.h:132</a></div></div>
<div class="ttc" id="austream_8h_html_ac837d6addf424ba56de98baec5e6235d"><div class="ttname"><a href="../../da/d79/ustream_8h.html#ac837d6addf424ba56de98baec5e6235d">ustream_buf::end</a></div><div class="ttdeci">char * end</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00133">ustream.h:133</a></div></div>
<div class="ttc" id="austream_8h_html_da/dd1/structustream__buf__list"><div class="ttname"><a href="../../da/d79/ustream_8h.html#da/dd1/structustream__buf__list">ustream_buf_list</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00033">ustream.h:33</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00040">ustream_buf_list::data_bytes</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00035">ustream_buf_list::data_tail</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00133">ustream_buf::end</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00471">MAX_STACK_BUFLEN</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00132">ustream_buf::tail</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00251">ustream_prepare_buf()</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00446">ustream_write()</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00419">ustream_write_buffered()</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00371">ustream_write_error()</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00050">ustream::w</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00088">ustream::write</a>, and <a class="el" href="../../da/d79/ustream_8h_source.html#l00116">ustream::write_error</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d26/ustream_8c_source.html#l00540">ustream_printf()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d26/ustream_8c_a61be783dcc8b068e3462484564835363_cgraph.png" border="0" usemap="#ad6/d26/ustream_8c_a61be783dcc8b068e3462484564835363_cgraph" alt=""/></div>
<map name="ad6/d26/ustream_8c_a61be783dcc8b068e3462484564835363_cgraph" id="ad6/d26/ustream_8c_a61be783dcc8b068e3462484564835363_cgraph">
<area shape="rect" title=" " alt="" coords="5,91,174,124"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a0ed3a1f1af94d311249c4b34b9e937d3" title=" " alt="" coords="715,23,933,56"/>
<area shape="poly" title=" " alt="" coords="162,87,221,75,348,58,476,46,700,37,700,42,476,52,349,63,222,81,163,92"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a0fd4724c3a2419db5c46a929ca2d7c9c" title=" " alt="" coords="222,117,374,151"/>
<area shape="poly" title=" " alt="" coords="174,115,206,120,206,125,174,121"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#aff14ca1c3b81e376b6033f2cf55bf75b" title=" " alt="" coords="422,67,661,100"/>
<area shape="poly" title=" " alt="" coords="174,100,406,88,407,93,174,106"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a90259dc27343d0ee765236e3e42302da" title=" " alt="" coords="439,160,644,194"/>
<area shape="poly" title=" " alt="" coords="124,122,169,144,222,161,325,176,424,179,423,184,324,181,221,166,168,148,121,127"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#aa67ddac4c773e0d21f6626bf2371f8d2" title=" " alt="" coords="1278,7,1468,40"/>
<area shape="poly" title=" " alt="" coords="905,19,986,7,1058,3,1130,3,1263,10,1262,15,1130,8,1058,9,987,13,906,24"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a4f850d5efa8e096ca116a2b98a68bd16" title=" " alt="" coords="993,23,1209,56"/>
<area shape="poly" title=" " alt="" coords="933,37,977,37,977,42,933,42"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a09dacab33f0a207388ab373c77fd45b3" title=" " alt="" coords="987,80,1215,114"/>
<area shape="poly" title=" " alt="" coords="909,54,1002,74,1001,79,908,59"/>
<area shape="poly" title=" " alt="" coords="1173,77,1214,66,1298,42,1300,48,1216,71,1175,82"/>
<area shape="poly" title=" " alt="" coords="374,116,442,101,443,106,375,121"/>
<area shape="poly" title=" " alt="" coords="375,145,427,154,426,159,374,150"/>
<area shape="poly" title=" " alt="" coords="654,63,700,56,701,61,654,69"/>
<area shape="rect" href="../../da/d79/ustream_8h.html#add76dce88c832892b8971ab19c766aab" title=" " alt="" coords="709,160,939,194"/>
<area shape="poly" title=" " alt="" coords="645,174,694,174,694,179,645,179"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="1006,160,1196,194"/>
<area shape="poly" title=" " alt="" coords="939,174,990,174,990,179,939,179"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a941864296983cb342a79afe55055f8d3" title=" " alt="" coords="1297,103,1449,136"/>
<area shape="poly" title=" " alt="" coords="1184,157,1281,136,1283,141,1185,162"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07" title=" " alt="" coords="1275,160,1471,194"/>
<area shape="poly" title=" " alt="" coords="1196,174,1259,174,1259,179,1196,179"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="1263,217,1483,251"/>
<area shape="poly" title=" " alt="" coords="1185,191,1275,211,1274,216,1184,197"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="1531,103,1661,136"/>
<area shape="poly" title=" " alt="" coords="1442,157,1483,146,1516,137,1517,143,1484,151,1443,162"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a76f33118cba0a358482528fad8c0f4cd" title=" " alt="" coords="1557,160,1635,194"/>
<area shape="poly" title=" " alt="" coords="1472,174,1541,174,1541,179,1472,179"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="1709,103,1810,136"/>
<area shape="poly" title=" " alt="" coords="1661,117,1693,117,1693,122,1661,122"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="1553,217,1639,251"/>
<area shape="poly" title=" " alt="" coords="1484,231,1538,231,1538,237,1484,237"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="1712,217,1807,251"/>
<area shape="poly" title=" " alt="" coords="1639,231,1697,231,1697,237,1639,237"/>
</map>
</div>

</div>
</div>
<a id="a0fd4724c3a2419db5c46a929ca2d7c9c" name="a0fd4724c3a2419db5c46a929ca2d7c9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fd4724c3a2419db5c46a929ca2d7c9c">&#9670;&#160;</a></span>ustream_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ustream_write </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>more</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00446">446</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  447</span>{</div>
<div class="line"><span class="lineno">  448</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../da/d79/ustream_8h.html#da/dd1/structustream__buf__list">ustream_buf_list</a> *l = &amp;s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a03853611acd8f4e90eec49c1e183ee87">w</a>;</div>
<div class="line"><span class="lineno">  449</span>    <span class="keywordtype">int</span> wr = 0;</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>    <span class="keywordflow">if</span> (s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab5a83f668de8533f03f594fd4851a8fc">write_error</a>)</div>
<div class="line"><span class="lineno">  452</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>    <span class="keywordflow">if</span> (!l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a2cb8be7b642a24ce03d0d8910b98500d">data_bytes</a>) {</div>
<div class="line"><span class="lineno">  455</span>        wr = s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a36cba8d68c57c1a20ab3c077d21fadb7">write</a>(s, data, len, more);</div>
<div class="line"><span class="lineno">  456</span>        <span class="keywordflow">if</span> (wr == len)</div>
<div class="line"><span class="lineno">  457</span>            <span class="keywordflow">return</span> wr;</div>
<div class="line"><span class="lineno">  458</span> </div>
<div class="line"><span class="lineno">  459</span>        <span class="keywordflow">if</span> (wr &lt; 0) {</div>
<div class="line"><span class="lineno">  460</span>            <a class="code hl_function" href="#a90259dc27343d0ee765236e3e42302da">ustream_write_error</a>(s);</div>
<div class="line"><span class="lineno">  461</span>            <span class="keywordflow">return</span> wr;</div>
<div class="line"><span class="lineno">  462</span>        }</div>
<div class="line"><span class="lineno">  463</span> </div>
<div class="line"><span class="lineno">  464</span>        data += wr;</div>
<div class="line"><span class="lineno">  465</span>        len -= wr;</div>
<div class="line"><span class="lineno">  466</span>    }</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="#aff14ca1c3b81e376b6033f2cf55bf75b">ustream_write_buffered</a>(s, data, len, wr);</div>
<div class="line"><span class="lineno">  469</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d79/ustream_8h_source.html#l00040">ustream_buf_list::data_bytes</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00419">ustream_write_buffered()</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00371">ustream_write_error()</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00050">ustream::w</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00088">ustream::write</a>, and <a class="el" href="../../da/d79/ustream_8h_source.html#l00116">ustream::write_error</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/dc0/uxc_8c_source.html#l00485">client_cb()</a>, <a class="el" href="../../d2/d28/instance_8c_source.html#l00732">instance_console()</a>, <a class="el" href="../../d2/d28/instance_8c_source.html#l00754">instance_console_client()</a>, <a class="el" href="../../da/dc0/uxc_8c_source.html#l00505">local_cb()</a>, <a class="el" href="../../d4/daa/plugin_8c_source.html#l00134">rpc_plugin_call_stdin_cb()</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00473">ustream_vprintf()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d26/ustream_8c_a0fd4724c3a2419db5c46a929ca2d7c9c_cgraph.png" border="0" usemap="#ad6/d26/ustream_8c_a0fd4724c3a2419db5c46a929ca2d7c9c_cgraph" alt=""/></div>
<map name="ad6/d26/ustream_8c_a0fd4724c3a2419db5c46a929ca2d7c9c_cgraph" id="ad6/d26/ustream_8c_a0fd4724c3a2419db5c46a929ca2d7c9c_cgraph">
<area shape="rect" title=" " alt="" coords="5,92,158,126"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#aff14ca1c3b81e376b6033f2cf55bf75b" title=" " alt="" coords="206,63,445,96"/>
<area shape="poly" title=" " alt="" coords="157,97,190,93,190,98,158,102"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a90259dc27343d0ee765236e3e42302da" title=" " alt="" coords="223,120,428,154"/>
<area shape="poly" title=" " alt="" coords="158,115,207,121,206,126,158,120"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a0ed3a1f1af94d311249c4b34b9e937d3" title=" " alt="" coords="499,63,716,96"/>
<area shape="poly" title=" " alt="" coords="445,77,483,77,483,82,445,82"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#aa67ddac4c773e0d21f6626bf2371f8d2" title=" " alt="" coords="1062,5,1252,39"/>
<area shape="poly" title=" " alt="" coords="644,60,702,37,770,18,841,9,914,6,1046,9,1046,14,914,11,842,14,771,23,704,42,646,65"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a4f850d5efa8e096ca116a2b98a68bd16" title=" " alt="" coords="776,33,993,67"/>
<area shape="poly" title=" " alt="" coords="717,65,760,61,761,66,717,71"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a09dacab33f0a207388ab373c77fd45b3" title=" " alt="" coords="770,91,999,124"/>
<area shape="poly" title=" " alt="" coords="717,88,755,92,755,97,717,93"/>
<area shape="poly" title=" " alt="" coords="960,88,998,77,1097,43,1098,48,999,82,962,93"/>
<area shape="rect" href="../../da/d79/ustream_8h.html#add76dce88c832892b8971ab19c766aab" title=" " alt="" coords="493,120,722,154"/>
<area shape="poly" title=" " alt="" coords="428,134,477,134,477,140,428,140"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="790,148,979,182"/>
<area shape="poly" title=" " alt="" coords="723,146,774,151,774,156,723,151"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a941864296983cb342a79afe55055f8d3" title=" " alt="" coords="1081,91,1233,124"/>
<area shape="poly" title=" " alt="" coords="967,145,1065,124,1066,129,968,150"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07" title=" " alt="" coords="1059,148,1255,182"/>
<area shape="poly" title=" " alt="" coords="980,162,1043,162,1043,168,980,168"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="1047,205,1267,239"/>
<area shape="poly" title=" " alt="" coords="968,180,1059,199,1058,204,967,185"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="1315,91,1444,124"/>
<area shape="poly" title=" " alt="" coords="1225,145,1266,134,1300,126,1301,131,1268,139,1227,150"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a76f33118cba0a358482528fad8c0f4cd" title=" " alt="" coords="1341,148,1419,182"/>
<area shape="poly" title=" " alt="" coords="1255,162,1325,162,1325,168,1255,168"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="1492,91,1594,124"/>
<area shape="poly" title=" " alt="" coords="1445,105,1477,105,1477,110,1445,110"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="1337,205,1422,239"/>
<area shape="poly" title=" " alt="" coords="1268,220,1321,220,1321,225,1268,225"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="1496,205,1590,239"/>
<area shape="poly" title=" " alt="" coords="1423,220,1481,220,1481,225,1423,225"/>
</map>
</div>

</div>
</div>
<a id="aff14ca1c3b81e376b6033f2cf55bf75b" name="aff14ca1c3b81e376b6033f2cf55bf75b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff14ca1c3b81e376b6033f2cf55bf75b">&#9670;&#160;</a></span>ustream_write_buffered()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ustream_write_buffered </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>wr</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00419">419</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  420</span>{</div>
<div class="line"><span class="lineno">  421</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../da/d79/ustream_8h.html#da/dd1/structustream__buf__list">ustream_buf_list</a> *l = &amp;s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a03853611acd8f4e90eec49c1e183ee87">w</a>;</div>
<div class="line"><span class="lineno">  422</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>;</div>
<div class="line"><span class="lineno">  423</span>    <span class="keywordtype">int</span> maxlen;</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>    <span class="keywordflow">while</span> (len) {</div>
<div class="line"><span class="lineno">  426</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="#a0ed3a1f1af94d311249c4b34b9e937d3">ustream_prepare_buf</a>(s, &amp;s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a03853611acd8f4e90eec49c1e183ee87">w</a>, len))</div>
<div class="line"><span class="lineno">  427</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>        <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> = l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab50800cb2a37029cb21c964b2980d666">data_tail</a>;</div>
<div class="line"><span class="lineno">  430</span> </div>
<div class="line"><span class="lineno">  431</span>        maxlen = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;end - <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;tail;</div>
<div class="line"><span class="lineno">  432</span>        <span class="keywordflow">if</span> (maxlen &gt; len)</div>
<div class="line"><span class="lineno">  433</span>            maxlen = len;</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>        memcpy(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;tail, <a class="code hl_variable" href="../../da/d79/ustream_8h.html#abdb0a0d252a71d877f92bb4159f027a7">data</a>, maxlen);</div>
<div class="line"><span class="lineno">  436</span>        <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;tail += maxlen;</div>
<div class="line"><span class="lineno">  437</span>        <a class="code hl_variable" href="../../da/d79/ustream_8h.html#abdb0a0d252a71d877f92bb4159f027a7">data</a> += maxlen;</div>
<div class="line"><span class="lineno">  438</span>        len -= maxlen;</div>
<div class="line"><span class="lineno">  439</span>        wr += maxlen;</div>
<div class="line"><span class="lineno">  440</span>        l-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a2cb8be7b642a24ce03d0d8910b98500d">data_bytes</a> += maxlen;</div>
<div class="line"><span class="lineno">  441</span>    }</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>    <span class="keywordflow">return</span> wr;</div>
<div class="line"><span class="lineno">  444</span>}</div>
<div class="ttc" id="austream_8h_html_abdb0a0d252a71d877f92bb4159f027a7"><div class="ttname"><a href="../../da/d79/ustream_8h.html#abdb0a0d252a71d877f92bb4159f027a7">ustream_buf::data</a></div><div class="ttdeci">char * data</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00131">ustream.h:131</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00131">ustream_buf::data</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00040">ustream_buf_list::data_bytes</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00035">ustream_buf_list::data_tail</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00251">ustream_prepare_buf()</a>, and <a class="el" href="../../da/d79/ustream_8h_source.html#l00050">ustream::w</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d26/ustream_8c_source.html#l00473">ustream_vprintf()</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00446">ustream_write()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d26/ustream_8c_aff14ca1c3b81e376b6033f2cf55bf75b_cgraph.png" border="0" usemap="#ad6/d26/ustream_8c_aff14ca1c3b81e376b6033f2cf55bf75b_cgraph" alt=""/></div>
<map name="ad6/d26/ustream_8c_aff14ca1c3b81e376b6033f2cf55bf75b_cgraph" id="ad6/d26/ustream_8c_aff14ca1c3b81e376b6033f2cf55bf75b_cgraph">
<area shape="rect" title=" " alt="" coords="5,26,245,59"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a0ed3a1f1af94d311249c4b34b9e937d3" title=" " alt="" coords="293,26,510,59"/>
<area shape="poly" title=" " alt="" coords="245,40,277,40,277,45,245,45"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#aa67ddac4c773e0d21f6626bf2371f8d2" title=" " alt="" coords="834,27,1025,61"/>
<area shape="poly" title=" " alt="" coords="479,22,558,10,672,3,787,10,847,20,846,26,786,16,672,8,558,16,480,28"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a4f850d5efa8e096ca116a2b98a68bd16" title=" " alt="" coords="564,26,780,59"/>
<area shape="poly" title=" " alt="" coords="511,40,548,40,548,45,511,45"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a09dacab33f0a207388ab373c77fd45b3" title=" " alt="" coords="558,83,786,117"/>
<area shape="poly" title=" " alt="" coords="485,57,575,77,574,82,484,62"/>
<area shape="poly" title=" " alt="" coords="752,80,833,62,834,67,754,85"/>
</map>
</div>

</div>
</div>
<a id="a90259dc27343d0ee765236e3e42302da" name="a90259dc27343d0ee765236e3e42302da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90259dc27343d0ee765236e3e42302da">&#9670;&#160;</a></span>ustream_write_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ustream_write_error </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00371">371</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  372</span>{</div>
<div class="line"><span class="lineno">  373</span>    <span class="keywordflow">if</span> (!s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab5a83f668de8533f03f594fd4851a8fc">write_error</a>)</div>
<div class="line"><span class="lineno">  374</span>        <a class="code hl_function" href="../../da/d79/ustream_8h.html#add76dce88c832892b8971ab19c766aab">ustream_state_change</a>(s);</div>
<div class="line"><span class="lineno">  375</span>    s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab5a83f668de8533f03f594fd4851a8fc">write_error</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  376</span>}</div>
<div class="ttc" id="austream_8h_html_add76dce88c832892b8971ab19c766aab"><div class="ttname"><a href="../../da/d79/ustream_8h.html#add76dce88c832892b8971ab19c766aab">ustream_state_change</a></div><div class="ttdeci">static void ustream_state_change(struct ustream *s)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00209">ustream.h:209</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d79/ustream_8h_source.html#l00209">ustream_state_change()</a>, and <a class="el" href="../../da/d79/ustream_8h_source.html#l00116">ustream::write_error</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d26/ustream_8c_source.html#l00473">ustream_vprintf()</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00446">ustream_write()</a>, and <a class="el" href="../../d6/d26/ustream_8c_source.html#l00378">ustream_write_pending()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d26/ustream_8c_a90259dc27343d0ee765236e3e42302da_cgraph.png" border="0" usemap="#ad6/d26/ustream_8c_a90259dc27343d0ee765236e3e42302da_cgraph" alt=""/></div>
<map name="ad6/d26/ustream_8c_a90259dc27343d0ee765236e3e42302da_cgraph" id="ad6/d26/ustream_8c_a90259dc27343d0ee765236e3e42302da_cgraph">
<area shape="rect" title=" " alt="" coords="5,63,211,96"/>
<area shape="rect" href="../../da/d79/ustream_8h.html#add76dce88c832892b8971ab19c766aab" title=" " alt="" coords="259,63,488,96"/>
<area shape="poly" title=" " alt="" coords="211,77,243,77,243,82,211,82"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="536,63,725,96"/>
<area shape="poly" title=" " alt="" coords="489,77,520,77,520,82,489,82"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a941864296983cb342a79afe55055f8d3" title=" " alt="" coords="807,5,960,39"/>
<area shape="poly" title=" " alt="" coords="707,59,792,40,793,45,709,65"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07" title=" " alt="" coords="785,63,982,96"/>
<area shape="poly" title=" " alt="" coords="726,77,770,77,770,82,726,82"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="773,120,994,154"/>
<area shape="poly" title=" " alt="" coords="709,94,792,113,791,119,707,100"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="1042,5,1171,39"/>
<area shape="poly" title=" " alt="" coords="952,60,993,49,1026,40,1028,45,994,54,953,65"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a76f33118cba0a358482528fad8c0f4cd" title=" " alt="" coords="1067,63,1146,96"/>
<area shape="poly" title=" " alt="" coords="982,77,1052,77,1052,82,982,82"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="1219,5,1320,39"/>
<area shape="poly" title=" " alt="" coords="1172,20,1203,20,1203,25,1172,25"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="1064,120,1149,154"/>
<area shape="poly" title=" " alt="" coords="994,134,1048,134,1048,140,994,140"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="1223,120,1317,154"/>
<area shape="poly" title=" " alt="" coords="1149,134,1207,134,1207,140,1149,140"/>
</map>
</div>

</div>
</div>
<a id="a7460ade35d8721c6dbac14e9cfab4b8c" name="a7460ade35d8721c6dbac14e9cfab4b8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7460ade35d8721c6dbac14e9cfab4b8c">&#9670;&#160;</a></span>ustream_write_pending()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ustream_write_pending </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../da/d79/ustream_8h.html#d8/d8e/structustream">ustream</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d26/ustream_8c_source.html#l00378">378</a> of file <a class="el" href="../../d6/d26/ustream_8c_source.html">ustream.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  379</span>{</div>
<div class="line"><span class="lineno">  380</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> = s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a03853611acd8f4e90eec49c1e183ee87">w</a>.<a class="code hl_variable" href="../../da/d79/ustream_8h.html#aa70350247646ae77f4551d297fb62fef">head</a>;</div>
<div class="line"><span class="lineno">  381</span>    <span class="keywordtype">int</span> wr = 0, len;</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>    <span class="keywordflow">if</span> (s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab5a83f668de8533f03f594fd4851a8fc">write_error</a>)</div>
<div class="line"><span class="lineno">  384</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  385</span> </div>
<div class="line"><span class="lineno">  386</span>    <span class="keywordflow">while</span> (<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> &amp;&amp; s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a03853611acd8f4e90eec49c1e183ee87">w</a>.<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a2cb8be7b642a24ce03d0d8910b98500d">data_bytes</a>) {</div>
<div class="line"><span class="lineno">  387</span>        <span class="keyword">struct </span><a class="code hl_struct" href="../../da/d79/ustream_8h.html#d9/dc0/structustream__buf">ustream_buf</a> *<a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab664a1d47378eec9f4feee70e9fdec4f">next</a> = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;next;</div>
<div class="line"><span class="lineno">  388</span>        <span class="keywordtype">int</span> maxlen = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;tail - <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;data;</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>        len = s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a36cba8d68c57c1a20ab3c077d21fadb7">write</a>(s, <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;data, maxlen, !!<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;next);</div>
<div class="line"><span class="lineno">  391</span>        <span class="keywordflow">if</span> (len &lt; 0) {</div>
<div class="line"><span class="lineno">  392</span>            <a class="code hl_function" href="#a90259dc27343d0ee765236e3e42302da">ustream_write_error</a>(s);</div>
<div class="line"><span class="lineno">  393</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  394</span>        }</div>
<div class="line"><span class="lineno">  395</span> </div>
<div class="line"><span class="lineno">  396</span>        <span class="keywordflow">if</span> (len == 0)</div>
<div class="line"><span class="lineno">  397</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>        wr += len;</div>
<div class="line"><span class="lineno">  400</span>        s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a03853611acd8f4e90eec49c1e183ee87">w</a>.<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a2cb8be7b642a24ce03d0d8910b98500d">data_bytes</a> -= len;</div>
<div class="line"><span class="lineno">  401</span>        <span class="keywordflow">if</span> (len &lt; maxlen) {</div>
<div class="line"><span class="lineno">  402</span>            <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>-&gt;data += len;</div>
<div class="line"><span class="lineno">  403</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  404</span>        }</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>        <a class="code hl_function" href="#a63bfcff990b542772fd9fbc5b6e1f870">ustream_free_buf</a>(&amp;s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a03853611acd8f4e90eec49c1e183ee87">w</a>, <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>);</div>
<div class="line"><span class="lineno">  407</span>        <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a> = <a class="code hl_variable" href="../../da/d79/ustream_8h.html#ab664a1d47378eec9f4feee70e9fdec4f">next</a>;</div>
<div class="line"><span class="lineno">  408</span>    }</div>
<div class="line"><span class="lineno">  409</span> </div>
<div class="line"><span class="lineno">  410</span>    <span class="keywordflow">if</span> (s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a0aff7c2094b736f9462d04842f774aca">notify_write</a>)</div>
<div class="line"><span class="lineno">  411</span>        s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a0aff7c2094b736f9462d04842f774aca">notify_write</a>(s, wr);</div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span>    <span class="keywordflow">if</span> (s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a0a033ab27c8b83cc83765b571e7e3a03">eof</a> &amp;&amp; wr &amp;&amp; !s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a03853611acd8f4e90eec49c1e183ee87">w</a>.<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a2cb8be7b642a24ce03d0d8910b98500d">data_bytes</a>)</div>
<div class="line"><span class="lineno">  414</span>        <a class="code hl_function" href="../../da/d79/ustream_8h.html#add76dce88c832892b8971ab19c766aab">ustream_state_change</a>(s);</div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span>    <span class="keywordflow">return</span> !s-&gt;<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a03853611acd8f4e90eec49c1e183ee87">w</a>.<a class="code hl_variable" href="../../da/d79/ustream_8h.html#a2cb8be7b642a24ce03d0d8910b98500d">data_bytes</a>;</div>
<div class="line"><span class="lineno">  417</span>}</div>
<div class="ttc" id="austream_8h_html_a0aff7c2094b736f9462d04842f774aca"><div class="ttname"><a href="../../da/d79/ustream_8h.html#a0aff7c2094b736f9462d04842f774aca">ustream::notify_write</a></div><div class="ttdeci">void(* notify_write)(struct ustream *s, int bytes)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d79/ustream_8h_source.html#l00068">ustream.h:68</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00040">ustream_buf_list::data_bytes</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00117">ustream::eof</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00034">ustream_buf_list::head</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00129">ustream_buf::next</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00068">ustream::notify_write</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00175">ustream_free_buf()</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00209">ustream_state_change()</a>, <a class="el" href="../../d6/d26/ustream_8c_source.html#l00371">ustream_write_error()</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00050">ustream::w</a>, <a class="el" href="../../da/d79/ustream_8h_source.html#l00088">ustream::write</a>, and <a class="el" href="../../da/d79/ustream_8h_source.html#l00116">ustream::write_error</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d70/ustream-fd_8c_source.html#l00116">__ustream_fd_poll()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d26/ustream_8c_a7460ade35d8721c6dbac14e9cfab4b8c_cgraph.png" border="0" usemap="#ad6/d26/ustream_8c_a7460ade35d8721c6dbac14e9cfab4b8c_cgraph" alt=""/></div>
<map name="ad6/d26/ustream_8c_a7460ade35d8721c6dbac14e9cfab4b8c_cgraph" id="ad6/d26/ustream_8c_a7460ade35d8721c6dbac14e9cfab4b8c_cgraph">
<area shape="rect" title=" " alt="" coords="5,104,243,138"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a63bfcff990b542772fd9fbc5b6e1f870" title=" " alt="" coords="302,49,485,83"/>
<area shape="poly" title=" " alt="" coords="210,101,292,84,293,89,211,106"/>
<area shape="rect" href="../../da/d79/ustream_8h.html#add76dce88c832892b8971ab19c766aab" title=" " alt="" coords="544,133,773,167"/>
<area shape="poly" title=" " alt="" coords="243,125,529,140,528,146,243,130"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a90259dc27343d0ee765236e3e42302da" title=" " alt="" coords="291,159,496,192"/>
<area shape="poly" title=" " alt="" coords="211,136,293,152,292,158,210,141"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a64710c908502c6d43dc365d365e28370" title=" " alt="" coords="568,5,749,39"/>
<area shape="poly" title=" " alt="" coords="485,48,553,37,554,42,486,54"/>
<area shape="rect" href="../../d6/d26/ustream_8c.html#a3a72c25243ae144e230cc375fa016aac" title=" " alt="" coords="571,63,746,96"/>
<area shape="poly" title=" " alt="" coords="485,68,556,72,556,77,485,73"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="821,133,1011,167"/>
<area shape="poly" title=" " alt="" coords="774,148,806,148,806,153,774,153"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a941864296983cb342a79afe55055f8d3" title=" " alt="" coords="1093,76,1245,110"/>
<area shape="poly" title=" " alt="" coords="993,130,1077,111,1078,116,994,135"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07" title=" " alt="" coords="1071,133,1267,167"/>
<area shape="poly" title=" " alt="" coords="1011,148,1055,148,1055,153,1011,153"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="1059,191,1279,224"/>
<area shape="poly" title=" " alt="" coords="994,165,1077,184,1076,189,993,170"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="1327,76,1456,110"/>
<area shape="poly" title=" " alt="" coords="1237,130,1278,120,1312,111,1313,116,1280,125,1239,135"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a76f33118cba0a358482528fad8c0f4cd" title=" " alt="" coords="1353,133,1431,167"/>
<area shape="poly" title=" " alt="" coords="1267,148,1337,148,1337,153,1267,153"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="1504,76,1606,110"/>
<area shape="poly" title=" " alt="" coords="1457,90,1489,90,1489,96,1457,96"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="1349,191,1434,224"/>
<area shape="poly" title=" " alt="" coords="1280,205,1333,205,1333,210,1280,210"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="1508,191,1602,224"/>
<area shape="poly" title=" " alt="" coords="1435,205,1493,205,1493,210,1435,210"/>
<area shape="poly" title=" " alt="" coords="496,163,528,160,529,165,497,168"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
