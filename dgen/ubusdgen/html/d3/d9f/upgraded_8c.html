<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>zbus: /home/g41797/CLionProjects/github.com/g41797/zbus/src/libs/procd/upgraded/upgraded.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">zbus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_87a455bccb09a92130c26a11a880c98a.html">libs</a></li><li class="navelem"><a class="el" href="../../dir_63350b749fcf74007a53c7c917c10773.html">procd</a></li><li class="navelem"><a class="el" href="../../dir_91ee9a9a00138ab5b862c6f834e9fc96.html">upgraded</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">upgraded.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;sys/reboot.h&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;<a class="el" href="../../dc/d56/uloop_8h_source.html">libubox/uloop.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d9/da3/watchdog_8h_source.html">../watchdog.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for upgraded.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d86/upgraded_8c__incl.png" border="0" usemap="#a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2procd_2upgraded_2upgraded_8c" alt=""/></div>
<map name="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2procd_2upgraded_2upgraded_8c" id="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2procd_2upgraded_2upgraded_8c">
<area shape="rect" title=" " alt="" coords="397,5,683,108"/>
<area shape="rect" title=" " alt="" coords="5,156,141,190"/>
<area shape="poly" title=" " alt="" coords="396,96,154,154,153,149,395,90"/>
<area shape="rect" title=" " alt="" coords="165,156,245,190"/>
<area shape="poly" title=" " alt="" coords="397,109,261,155,259,150,395,104"/>
<area shape="rect" title=" " alt="" coords="270,156,354,190"/>
<area shape="poly" title=" " alt="" coords="440,111,359,151,357,146,437,106"/>
<area shape="rect" title=" " alt="" coords="379,156,469,190"/>
<area shape="poly" title=" " alt="" coords="490,110,452,147,449,143,486,107"/>
<area shape="rect" title=" " alt="" coords="493,156,586,190"/>
<area shape="poly" title=" " alt="" coords="542,108,542,140,537,140,537,108"/>
<area shape="rect" title=" " alt="" coords="611,156,708,190"/>
<area shape="poly" title=" " alt="" coords="595,107,634,143,630,147,591,110"/>
<area shape="rect" title=" " alt="" coords="732,156,819,190"/>
<area shape="poly" title=" " alt="" coords="646,106,730,146,727,151,644,111"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html" title=" " alt="" coords="1008,156,1173,190"/>
<area shape="poly" title=" " alt="" coords="684,85,998,150,997,155,683,90"/>
<area shape="rect" href="../../d9/da3/watchdog_8h.html" title=" " alt="" coords="670,238,817,271"/>
<area shape="poly" title=" " alt="" coords="684,68,726,80,767,98,804,122,834,154,839,165,840,177,831,197,813,216,791,232,788,228,810,212,827,194,835,176,834,167,829,158,800,126,764,103,724,85,682,73"/>
<area shape="rect" title=" " alt="" coords="1278,238,1396,271"/>
<area shape="poly" title=" " alt="" coords="1141,188,1273,230,1272,235,1139,193"/>
<area shape="rect" title=" " alt="" coords="841,238,969,271"/>
<area shape="poly" title=" " alt="" coords="1054,193,957,234,955,229,1052,188"/>
<area shape="rect" title=" " alt="" coords="953,319,1060,353"/>
<area shape="poly" title=" " alt="" coords="1073,192,1052,213,1034,239,1021,272,1013,304,1008,303,1016,270,1029,236,1048,210,1069,188"/>
<area shape="rect" title=" " alt="" coords="1044,238,1137,271"/>
<area shape="poly" title=" " alt="" coords="1093,190,1093,222,1088,222,1088,190"/>
<area shape="rect" title=" " alt="" coords="1161,238,1255,271"/>
<area shape="poly" title=" " alt="" coords="1116,188,1173,227,1170,231,1113,192"/>
<area shape="rect" href="../../da/d23/list_8h.html" title=" " alt="" coords="1420,238,1486,271"/>
<area shape="poly" title=" " alt="" coords="1173,185,1280,205,1406,235,1405,240,1279,210,1172,190"/>
<area shape="poly" title=" " alt="" coords="1420,271,1408,274,1319,293,1229,309,1075,330,1075,325,1228,304,1318,288,1407,269,1419,265"/>
<area shape="rect" title=" " alt="" coords="1405,319,1501,353"/>
<area shape="poly" title=" " alt="" coords="1456,272,1456,304,1450,304,1450,272"/>
<area shape="poly" title=" " alt="" coords="798,269,939,312,938,317,796,274"/>
</map>
</div>
</div>
<p><a href="../../d3/d9f/upgraded_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a369266c24eacffb87046522897a570d5" id="r_a369266c24eacffb87046522897a570d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a369266c24eacffb87046522897a570d5">_GNU_SOURCE</a></td></tr>
<tr class="separator:a369266c24eacffb87046522897a570d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b82111c13e7367ba2ac5fd6bf4650ab" id="r_a6b82111c13e7367ba2ac5fd6bf4650ab"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6b82111c13e7367ba2ac5fd6bf4650ab">O_PATH</a>&#160;&#160;&#160;010000000</td></tr>
<tr class="separator:a6b82111c13e7367ba2ac5fd6bf4650ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a88f7de89e03f71739fd0fbd87dbfc50e" id="r_a88f7de89e03f71739fd0fbd87dbfc50e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a88f7de89e03f71739fd0fbd87dbfc50e">upgrade_proc_cb</a> (struct <a class="el" href="../../dc/d56/uloop_8h.html#da/d43/structuloop__process">uloop_process</a> *proc, int ret)</td></tr>
<tr class="separator:a88f7de89e03f71739fd0fbd87dbfc50e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add9ff192190277f127d3049632c8a0aa" id="r_add9ff192190277f127d3049632c8a0aa"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#add9ff192190277f127d3049632c8a0aa">sysupgrade</a> (char *<a class="el" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, char *command)</td></tr>
<tr class="separator:add9ff192190277f127d3049632c8a0aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627" id="r_a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af46424df334b6e5110945d8ae8012e17" id="r_af46424df334b6e5110945d8ae8012e17"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dc/d56/uloop_8h.html#da/d43/structuloop__process">uloop_process</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af46424df334b6e5110945d8ae8012e17">upgrade_proc</a></td></tr>
<tr class="separator:af46424df334b6e5110945d8ae8012e17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3770535f39c67ca0811e27731893370" id="r_aa3770535f39c67ca0811e27731893370"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa3770535f39c67ca0811e27731893370">debug</a> = 2</td></tr>
<tr class="separator:aa3770535f39c67ca0811e27731893370"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a369266c24eacffb87046522897a570d5" name="a369266c24eacffb87046522897a570d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a369266c24eacffb87046522897a570d5">&#9670;&#160;</a></span>_GNU_SOURCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _GNU_SOURCE</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d9f/upgraded_8c_source.html#l00015">15</a> of file <a class="el" href="../../d3/d9f/upgraded_8c_source.html">upgraded.c</a>.</p>

</div>
</div>
<a id="a6b82111c13e7367ba2ac5fd6bf4650ab" name="a6b82111c13e7367ba2ac5fd6bf4650ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b82111c13e7367ba2ac5fd6bf4650ab">&#9670;&#160;</a></span>O_PATH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define O_PATH&#160;&#160;&#160;010000000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d9f/upgraded_8c_source.html#l00031">31</a> of file <a class="el" href="../../d3/d9f/upgraded_8c_source.html">upgraded.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d9f/upgraded_8c_source.html#l00066">main()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a3c04138a5bfe5d72780bb7e82a18e627" name="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c04138a5bfe5d72780bb7e82a18e627">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>argc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d9f/upgraded_8c_source.html#l00066">66</a> of file <a class="el" href="../../d3/d9f/upgraded_8c_source.html">upgraded.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   67</span>{</div>
<div class="line"><span class="lineno">   68</span>    pid_t p = getpid();</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>    <span class="keywordflow">if</span> (p != 1) {</div>
<div class="line"><span class="lineno">   71</span>        fprintf(stderr, <span class="stringliteral">&quot;this tool needs to run as pid 1\n&quot;</span>);</div>
<div class="line"><span class="lineno">   72</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">   73</span>    }</div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>    <span class="keywordtype">int</span> fd = open(<span class="stringliteral">&quot;/&quot;</span>, O_DIRECTORY|<a class="code hl_define" href="#a6b82111c13e7367ba2ac5fd6bf4650ab">O_PATH</a>);</div>
<div class="line"><span class="lineno">   76</span>    <span class="keywordflow">if</span> (fd &lt; 0) {</div>
<div class="line"><span class="lineno">   77</span>        fprintf(stderr, <span class="stringliteral">&quot;unable to open prefix directory: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno">   78</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">   79</span>    }</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>    <span class="keywordflow">if</span> (chroot(<span class="stringliteral">&quot;.&quot;</span>) &lt; 0) {</div>
<div class="line"><span class="lineno">   82</span>        fprintf(stderr, <span class="stringliteral">&quot;failed to chroot: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno">   83</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">   84</span>    }</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>    <span class="keywordflow">if</span> (fchdir(fd) == -1) {</div>
<div class="line"><span class="lineno">   87</span>        fprintf(stderr, <span class="stringliteral">&quot;failed to chdir to prefix directory: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno">   88</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">   89</span>    }</div>
<div class="line"><span class="lineno">   90</span>    close(fd);</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>    <span class="keywordflow">if</span> (argc != 3) {</div>
<div class="line"><span class="lineno">   93</span>        fprintf(stderr, <span class="stringliteral">&quot;sysupgrade stage 2 failed, invalid command line\n&quot;</span>);</div>
<div class="line"><span class="lineno">   94</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">   95</span>    }</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>    <a class="code hl_function" href="../../d1/d08/uloop_8c.html#ae960d01033fb72572bc1aa539a501fe7">uloop_init</a>();</div>
<div class="line"><span class="lineno">   98</span>    <a class="code hl_function" href="../../d6/d88/watchdog_8c.html#a874a52d6ac45041d9e76bd1925d88c24">watchdog_init</a>(0);</div>
<div class="line"><span class="lineno">   99</span>    <a class="code hl_function" href="#add9ff192190277f127d3049632c8a0aa">sysupgrade</a>(argv[1], argv[2]);</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>    reboot(RB_AUTOBOOT);</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  104</span>}</div>
<div class="ttc" id="auloop_8c_html_ae960d01033fb72572bc1aa539a501fe7"><div class="ttname"><a href="../../d1/d08/uloop_8c.html#ae960d01033fb72572bc1aa539a501fe7">uloop_init</a></div><div class="ttdeci">int uloop_init(void)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d08/uloop_8c_source.html#l00150">uloop.c:150</a></div></div>
<div class="ttc" id="aupgraded_8c_html_a6b82111c13e7367ba2ac5fd6bf4650ab"><div class="ttname"><a href="#a6b82111c13e7367ba2ac5fd6bf4650ab">O_PATH</a></div><div class="ttdeci">#define O_PATH</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d9f/upgraded_8c_source.html#l00031">upgraded.c:31</a></div></div>
<div class="ttc" id="aupgraded_8c_html_add9ff192190277f127d3049632c8a0aa"><div class="ttname"><a href="#add9ff192190277f127d3049632c8a0aa">sysupgrade</a></div><div class="ttdeci">static void sysupgrade(char *path, char *command)</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d9f/upgraded_8c_source.html#l00044">upgraded.c:44</a></div></div>
<div class="ttc" id="awatchdog_8c_html_a874a52d6ac45041d9e76bd1925d88c24"><div class="ttname"><a href="../../d6/d88/watchdog_8c.html#a874a52d6ac45041d9e76bd1925d88c24">watchdog_init</a></div><div class="ttdeci">void watchdog_init(int preinit)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d88/watchdog_8c_source.html#l00191">watchdog.c:191</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d3/d9f/upgraded_8c_source.html#l00031">O_PATH</a>, <a class="el" href="../../d3/d9f/upgraded_8c_source.html#l00044">sysupgrade()</a>, <a class="el" href="../../d1/d08/uloop_8c_source.html#l00150">uloop_init()</a>, and <a class="el" href="../../d6/d88/watchdog_8c_source.html#l00191">watchdog_init()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/upgraded_8c_a3c04138a5bfe5d72780bb7e82a18e627_cgraph.png" border="0" usemap="#ad3/d9f/upgraded_8c_a3c04138a5bfe5d72780bb7e82a18e627_cgraph" alt=""/></div>
<map name="ad3/d9f/upgraded_8c_a3c04138a5bfe5d72780bb7e82a18e627_cgraph" id="ad3/d9f/upgraded_8c_a3c04138a5bfe5d72780bb7e82a18e627_cgraph">
<area shape="rect" title=" " alt="" coords="5,452,73,486"/>
<area shape="rect" href="../../d3/d9f/upgraded_8c.html#add9ff192190277f127d3049632c8a0aa" title=" " alt="" coords="130,452,261,486"/>
<area shape="poly" title=" " alt="" coords="73,466,115,466,115,472,73,472"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae960d01033fb72572bc1aa539a501fe7" title=" " alt="" coords="140,653,251,687"/>
<area shape="poly" title=" " alt="" coords="56,484,174,639,170,643,51,488"/>
<area shape="rect" href="../../d6/d88/watchdog_8c.html#a874a52d6ac45041d9e76bd1925d88c24" title=" " alt="" coords="121,235,270,268"/>
<area shape="poly" title=" " alt="" coords="50,450,171,279,176,282,55,453"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb" title=" " alt="" coords="632,261,829,295"/>
<area shape="poly" title=" " alt="" coords="214,450,259,414,317,380,392,349,471,325,616,292,618,298,472,330,394,354,319,385,262,419,217,454"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077" title=" " alt="" coords="377,509,490,543"/>
<area shape="poly" title=" " alt="" coords="262,482,362,506,361,512,260,487"/>
<area shape="rect" href="../../d3/d9f/upgraded_8c.html#a88f7de89e03f71739fd0fbd87dbfc50e" title=" " alt="" coords="344,452,523,486"/>
<area shape="poly" title=" " alt="" coords="261,466,328,466,328,472,261,472"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="969,261,1098,295"/>
<area shape="poly" title=" " alt="" coords="829,276,953,276,953,281,829,281"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="1248,261,1349,295"/>
<area shape="poly" title=" " alt="" coords="1098,276,1232,276,1232,281,1098,281"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a14d4e1fa83f245cd59f0c68f48c90d75" title=" " alt="" coords="634,509,827,543"/>
<area shape="poly" title=" " alt="" coords="490,524,618,524,618,529,490,529"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a18ed130af55f89035ca041f340a091f9" title=" " alt="" coords="913,509,1154,543"/>
<area shape="poly" title=" " alt="" coords="828,524,897,524,897,529,828,529"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#a5881608c3589830842d1db287f1f896e" title=" " alt="" coords="672,452,789,486"/>
<area shape="poly" title=" " alt="" coords="523,466,657,466,657,472,523,472"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ac0bcdd57d004a600844745bd38e83a2d" title=" " alt="" coords="370,796,497,830"/>
<area shape="poly" title=" " alt="" coords="227,685,392,786,389,790,224,690"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a28e87c6264a681dc2a422d32794416c5" title=" " alt="" coords="627,905,834,939"/>
<area shape="poly" title=" " alt="" coords="206,686,221,719,246,762,279,805,320,840,353,859,389,875,465,899,541,913,612,920,611,925,541,918,464,904,388,880,351,864,316,844,275,808,241,765,217,722,201,688"/>
<area shape="rect" href="../../d3/d91/uloop-epoll_8c.html#a5b8f7c4e758eaf7384d7dafa9cd59502" title=" " alt="" coords="348,596,519,630"/>
<area shape="poly" title=" " alt="" coords="250,654,345,631,346,636,251,660"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae9d27835a99bfac45ed3f07a26287d7a" title=" " alt="" coords="376,653,490,687"/>
<area shape="poly" title=" " alt="" coords="251,668,360,668,360,673,251,673"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a13ca20f7af9aa4aa3057b1114e23e7f1" title=" " alt="" coords="617,739,844,772"/>
<area shape="poly" title=" " alt="" coords="497,798,624,773,625,778,498,803"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#afe30e87975d460220899f69103f90d0d" title=" " alt="" coords="622,796,839,830"/>
<area shape="poly" title=" " alt="" coords="497,810,607,810,607,816,497,816"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="950,652,1117,686"/>
<area shape="poly" title=" " alt="" coords="485,828,561,848,657,864,710,867,762,864,814,856,864,840,912,811,953,773,987,733,1012,697,1016,700,992,736,957,777,915,815,866,845,815,861,763,870,710,872,657,869,560,853,483,833"/>
<area shape="poly" title=" " alt="" coords="470,828,529,856,597,884,643,898,641,903,595,889,527,861,467,833"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aabc9ad24aad72332a1e4d9221ee472e4" title=" " alt="" coords="931,991,1136,1024"/>
<area shape="poly" title=" " alt="" coords="784,937,913,977,940,984,939,989,912,982,783,942"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a1651f5bc65e4fff991f6df6f997c6821" title=" " alt="" coords="1202,905,1394,939"/>
<area shape="poly" title=" " alt="" coords="804,902,864,884,887,871,912,861,979,848,1033,844,1087,849,1155,861,1206,876,1253,896,1251,901,1204,881,1153,866,1086,854,1033,850,980,853,913,866,889,876,866,889,806,907"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#accc698d934ee8aef79f735562f95c5fa" title=" " alt="" coords="932,876,1135,910"/>
<area shape="poly" title=" " alt="" coords="834,909,916,902,916,907,835,915"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a57cfc499a638333604b2ab14b3a11a9b" title=" " alt="" coords="925,933,1142,967"/>
<area shape="poly" title=" " alt="" coords="835,929,910,936,909,941,834,934"/>
<area shape="poly" title=" " alt="" coords="1115,988,1153,977,1243,943,1245,948,1155,982,1117,993"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a994ffe62801650ad1dca601989bc8145" title=" " alt="" coords="646,624,815,658"/>
<area shape="poly" title=" " alt="" coords="491,662,630,648,631,653,491,667"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a570d5b4ff73cb373a6ca0ac54a9726a0" title=" " alt="" coords="658,567,803,600"/>
<area shape="poly" title=" " alt="" coords="490,658,547,640,571,624,595,609,642,594,644,600,597,614,574,629,549,645,491,663"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aad7e22a1f44c1981287cfd22c413742b" title=" " alt="" coords="659,681,802,715"/>
<area shape="poly" title=" " alt="" coords="491,673,644,687,644,693,491,678"/>
<area shape="poly" title=" " alt="" coords="804,594,865,609,972,644,971,649,864,614,803,599"/>
<area shape="rect" href="../../dd/de5/preinit_8c.html#a90282b93d8528c3fc4e5b188bc5fbc1c" title=" " alt="" coords="393,120,473,154"/>
<area shape="poly" title=" " alt="" coords="214,232,259,197,317,162,377,143,379,148,319,167,262,201,217,236"/>
<area shape="rect" href="../../d6/d88/watchdog_8c.html#a31664dcba8ff01b57b09be53bc297d58" title=" " alt="" coords="350,177,516,211"/>
<area shape="poly" title=" " alt="" coords="267,232,345,213,346,218,268,237"/>
<area shape="rect" href="../../d6/d88/watchdog_8c.html#a05316067521d0e4efd9b8d3a3a322591" title=" " alt="" coords="318,235,548,268"/>
<area shape="poly" title=" " alt="" coords="270,249,302,249,302,254,270,254"/>
<area shape="rect" href="../../d6/d88/watchdog_8c.html#a35f4cbd80d58c214a0f47b8022fa4ca1" title=" " alt="" coords="596,344,865,378"/>
<area shape="poly" title=" " alt="" coords="267,266,319,278,618,338,617,343,317,283,266,272"/>
<area shape="rect" href="../../d6/d88/watchdog_8c.html#a9cb0f6cbef0cbe8203eb22795acc9446" title=" " alt="" coords="338,395,529,428"/>
<area shape="poly" title=" " alt="" coords="224,267,395,383,392,388,221,271"/>
<area shape="rect" href="../../d6/d88/watchdog_8c.html#a5a3159d3f3390614400f8f403c5aac73" title=" " alt="" coords="322,63,544,96"/>
<area shape="poly" title=" " alt="" coords="204,233,247,170,279,135,317,105,324,101,327,105,319,110,283,139,251,173,208,236"/>
<area shape="poly" title=" " alt="" coords="474,138,512,146,550,163,566,177,575,192,584,207,598,221,626,239,657,253,655,258,624,244,595,226,579,210,571,195,562,180,547,167,511,151,473,143"/>
<area shape="rect" href="../../dd/de5/preinit_8c.html#a3c2b1b2951eae690991001026ac7c4d4" title=" " alt="" coords="653,177,808,211"/>
<area shape="poly" title=" " alt="" coords="474,142,639,174,638,179,473,147"/>
<area shape="rect" href="../../dd/de5/preinit_8c.html#a9539d3f84ee0e5d5db04710740c805f2" title=" " alt="" coords="659,120,802,154"/>
<area shape="poly" title=" " alt="" coords="474,134,644,134,644,140,474,140"/>
<area shape="poly" title=" " alt="" coords="529,393,613,378,614,383,530,398"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="636,63,825,96"/>
<area shape="poly" title=" " alt="" coords="545,77,620,77,620,82,545,82"/>
<area shape="rect" href="../../d6/d88/watchdog_8c.html#a40e298539d4f4fb3c5ab3317d4c449ff" title=" " alt="" coords="650,5,811,39"/>
<area shape="poly" title=" " alt="" coords="524,59,634,38,635,43,525,65"/>
</map>
</div>

</div>
</div>
<a id="add9ff192190277f127d3049632c8a0aa" name="add9ff192190277f127d3049632c8a0aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add9ff192190277f127d3049632c8a0aa">&#9670;&#160;</a></span>sysupgrade()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sysupgrade </td>
          <td>(</td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>command</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d9f/upgraded_8c_source.html#l00044">44</a> of file <a class="el" href="../../d3/d9f/upgraded_8c_source.html">upgraded.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   45</span>{</div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordtype">char</span> *args[] = { <span class="stringliteral">&quot;/lib/upgrade/stage2&quot;</span>, <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, command, NULL };</div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span>    <a class="code hl_variable" href="#af46424df334b6e5110945d8ae8012e17">upgrade_proc</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a46406fa271016311e9876c440d30897f">cb</a> = <a class="code hl_function" href="#a88f7de89e03f71739fd0fbd87dbfc50e">upgrade_proc_cb</a>;</div>
<div class="line"><span class="lineno">   49</span>    <a class="code hl_variable" href="#af46424df334b6e5110945d8ae8012e17">upgrade_proc</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a> = fork();</div>
<div class="line"><span class="lineno">   50</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af46424df334b6e5110945d8ae8012e17">upgrade_proc</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a> &lt; 0) {</div>
<div class="line"><span class="lineno">   51</span>        fprintf(stderr, <span class="stringliteral">&quot;Failed to fork sysupgrade\n&quot;</span>);</div>
<div class="line"><span class="lineno">   52</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   53</span>    }</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#af46424df334b6e5110945d8ae8012e17">upgrade_proc</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>) {</div>
<div class="line"><span class="lineno">   56</span>        <span class="comment">/* Child */</span></div>
<div class="line"><span class="lineno">   57</span>        execvp(args[0], args);</div>
<div class="line"><span class="lineno">   58</span>        fprintf(stderr, <span class="stringliteral">&quot;Failed to exec sysupgrade\n&quot;</span>);</div>
<div class="line"><span class="lineno">   59</span>        _exit(EXIT_FAILURE);</div>
<div class="line"><span class="lineno">   60</span>    }</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>    <a class="code hl_function" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb">uloop_process_add</a>(&amp;<a class="code hl_variable" href="#af46424df334b6e5110945d8ae8012e17">upgrade_proc</a>);</div>
<div class="line"><span class="lineno">   63</span>    <a class="code hl_function" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077">uloop_run</a>();</div>
<div class="line"><span class="lineno">   64</span>}</div>
<div class="ttc" id="aubusd__obj_8c_html_a9ece2e576492090c46d5e3b435cef7d4"><div class="ttname"><a href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a></div><div class="ttdeci">struct avl_tree path</div><div class="ttdef"><b>Definition</b> <a href="../../df/d0e/ubusd__obj_8c_source.html#l00019">ubusd_obj.c:19</a></div></div>
<div class="ttc" id="auloop_8c_html_af511d1bcbdfcfaba211d4ae1b0930dbb"><div class="ttname"><a href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb">uloop_process_add</a></div><div class="ttdeci">int uloop_process_add(struct uloop_process *p)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d08/uloop_8c_source.html#l00391">uloop.c:391</a></div></div>
<div class="ttc" id="auloop_8h_html_a41e26562918b24966ac2e0d7906fb1b8"><div class="ttname"><a href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">uloop_process::pid</a></div><div class="ttdeci">pid_t pid</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d56/uloop_8h_source.html#l00087">uloop.h:87</a></div></div>
<div class="ttc" id="auloop_8h_html_a46406fa271016311e9876c440d30897f"><div class="ttname"><a href="../../dc/d56/uloop_8h.html#a46406fa271016311e9876c440d30897f">uloop_process::cb</a></div><div class="ttdeci">uloop_process_handler cb</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d56/uloop_8h_source.html#l00086">uloop.h:86</a></div></div>
<div class="ttc" id="auloop_8h_html_aba97081464ac3304fef640bcfc7d3077"><div class="ttname"><a href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077">uloop_run</a></div><div class="ttdeci">static int uloop_run(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d56/uloop_8h_source.html#l00147">uloop.h:147</a></div></div>
<div class="ttc" id="aupgraded_8c_html_a88f7de89e03f71739fd0fbd87dbfc50e"><div class="ttname"><a href="#a88f7de89e03f71739fd0fbd87dbfc50e">upgrade_proc_cb</a></div><div class="ttdeci">static void upgrade_proc_cb(struct uloop_process *proc, int ret)</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d9f/upgraded_8c_source.html#l00037">upgraded.c:37</a></div></div>
<div class="ttc" id="aupgraded_8c_html_af46424df334b6e5110945d8ae8012e17"><div class="ttname"><a href="#af46424df334b6e5110945d8ae8012e17">upgrade_proc</a></div><div class="ttdeci">static struct uloop_process upgrade_proc</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d9f/upgraded_8c_source.html#l00034">upgraded.c:34</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d56/uloop_8h_source.html#l00086">uloop_process::cb</a>, <a class="el" href="../../df/d0e/ubusd__obj_8c_source.html#l00019">path</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00087">uloop_process::pid</a>, <a class="el" href="../../d1/d08/uloop_8c_source.html#l00391">uloop_process_add()</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00147">uloop_run()</a>, <a class="el" href="../../d3/d9f/upgraded_8c_source.html#l00034">upgrade_proc</a>, and <a class="el" href="../../d3/d9f/upgraded_8c_source.html#l00037">upgrade_proc_cb()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d9f/upgraded_8c_source.html#l00066">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/upgraded_8c_add9ff192190277f127d3049632c8a0aa_cgraph.png" border="0" usemap="#ad3/d9f/upgraded_8c_add9ff192190277f127d3049632c8a0aa_cgraph" alt=""/></div>
<map name="ad3/d9f/upgraded_8c_add9ff192190277f127d3049632c8a0aa_cgraph" id="ad3/d9f/upgraded_8c_add9ff192190277f127d3049632c8a0aa_cgraph">
<area shape="rect" title=" " alt="" coords="5,120,136,154"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb" title=" " alt="" coords="184,48,380,82"/>
<area shape="poly" title=" " alt="" coords="121,117,215,85,217,90,123,122"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077" title=" " alt="" coords="225,120,339,154"/>
<area shape="poly" title=" " alt="" coords="136,134,209,134,209,140,136,140"/>
<area shape="rect" href="../../d3/d9f/upgraded_8c.html#a88f7de89e03f71739fd0fbd87dbfc50e" title=" " alt="" coords="192,177,372,211"/>
<area shape="poly" title=" " alt="" coords="136,152,203,170,202,175,134,157"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="460,20,589,54"/>
<area shape="poly" title=" " alt="" coords="380,51,444,43,445,49,381,56"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="741,5,843,39"/>
<area shape="poly" title=" " alt="" coords="590,31,725,23,726,28,590,36"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a14d4e1fa83f245cd59f0c68f48c90d75" title=" " alt="" coords="428,120,621,154"/>
<area shape="poly" title=" " alt="" coords="339,134,412,134,412,140,339,140"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a18ed130af55f89035ca041f340a091f9" title=" " alt="" coords="671,289,913,323"/>
<area shape="poly" title=" " alt="" coords="607,152,623,163,636,177,643,192,648,222,652,250,659,263,671,276,674,278,670,282,668,280,655,266,647,252,642,222,638,194,631,180,620,167,604,156"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a5d07b4993342a59a1b6327d23a771d47" title=" " alt="" coords="669,120,915,154"/>
<area shape="poly" title=" " alt="" coords="622,134,654,134,654,140,622,140"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ab4fcc424426de9a075b7b4b6f390fd2e" title=" " alt="" coords="671,232,913,266"/>
<area shape="poly" title=" " alt="" coords="592,152,622,162,689,192,747,222,745,226,686,196,620,167,590,157"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a1d8cdbdb1ea8dad23288f6ec0b2ff005" title=" " alt="" coords="700,63,884,96"/>
<area shape="poly" title=" " alt="" coords="606,117,695,98,696,103,607,122"/>
<area shape="rect" href="../../da/d23/list_8h.html#a6ff0e5eee443d7b27def83827340634d" title=" " alt="" coords="1015,347,1131,380"/>
<area shape="poly" title=" " alt="" coords="878,321,1000,346,999,351,877,326"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a76f33118cba0a358482528fad8c0f4cd" title=" " alt="" coords="1034,232,1112,266"/>
<area shape="poly" title=" " alt="" coords="877,286,1018,257,1019,262,878,291"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a941864296983cb342a79afe55055f8d3" title=" " alt="" coords="997,289,1149,323"/>
<area shape="poly" title=" " alt="" coords="913,304,981,304,981,309,913,309"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a49ba044023de765e2d9d14db25d1845b" title=" " alt="" coords="964,117,1182,151"/>
<area shape="poly" title=" " alt="" coords="915,133,948,133,948,138,915,138"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="1272,147,1357,180"/>
<area shape="poly" title=" " alt="" coords="1183,145,1257,154,1256,159,1182,150"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="1508,147,1602,180"/>
<area shape="poly" title=" " alt="" coords="1357,161,1492,161,1492,166,1357,166"/>
<area shape="poly" title=" " alt="" coords="895,264,916,275,932,289,941,305,949,320,964,333,1001,350,999,354,961,338,945,323,936,307,928,293,913,279,892,269"/>
<area shape="poly" title=" " alt="" coords="914,246,1018,246,1018,252,914,252"/>
<area shape="poly" title=" " alt="" coords="878,264,982,285,981,290,877,269"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="963,175,1183,208"/>
<area shape="poly" title=" " alt="" coords="877,229,971,209,973,215,878,234"/>
<area shape="poly" title=" " alt="" coords="1183,176,1256,168,1256,173,1184,181"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#abe443fe3f794c14f0aaa0c5f18a27ddd" title=" " alt="" coords="1445,63,1665,96"/>
<area shape="poly" title=" " alt="" coords="885,77,1430,77,1430,82,885,82"/>
<area shape="rect" href="../../d3/d91/uloop-epoll_8c.html#a596fcfcf68883d7c7977ee295adf9625" title=" " alt="" coords="973,8,1173,42"/>
<area shape="poly" title=" " alt="" coords="882,59,967,43,968,48,883,65"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="1231,8,1397,42"/>
<area shape="poly" title=" " alt="" coords="1173,22,1215,22,1215,28,1173,28"/>
<area shape="poly" title=" " alt="" coords="1392,40,1463,56,1462,61,1391,45"/>
<area shape="rect" href="../../d3/d91/uloop-epoll_8c.html#ae98d2f54596aacb1f0f176d0e565e2e2" title=" " alt="" coords="1463,5,1647,39"/>
<area shape="poly" title=" " alt="" coords="1398,21,1447,21,1447,26,1398,27"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#a5881608c3589830842d1db287f1f896e" title=" " alt="" coords="467,177,583,211"/>
<area shape="poly" title=" " alt="" coords="372,192,451,192,451,197,372,197"/>
</map>
</div>

</div>
</div>
<a id="a88f7de89e03f71739fd0fbd87dbfc50e" name="a88f7de89e03f71739fd0fbd87dbfc50e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88f7de89e03f71739fd0fbd87dbfc50e">&#9670;&#160;</a></span>upgrade_proc_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void upgrade_proc_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dc/d56/uloop_8h.html#da/d43/structuloop__process">uloop_process</a> *</td>          <td class="paramname"><span class="paramname"><em>proc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ret</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d9f/upgraded_8c_source.html#l00037">37</a> of file <a class="el" href="../../d3/d9f/upgraded_8c_source.html">upgraded.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   38</span>{</div>
<div class="line"><span class="lineno">   39</span>    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><span class="lineno">   40</span>        fprintf(stderr, <span class="stringliteral">&quot;sysupgrade aborted with return code: %d\n&quot;</span>, ret);</div>
<div class="line"><span class="lineno">   41</span>    <a class="code hl_function" href="../../dc/d56/uloop_8h.html#a5881608c3589830842d1db287f1f896e">uloop_end</a>();</div>
<div class="line"><span class="lineno">   42</span>}</div>
<div class="ttc" id="auloop_8h_html_a5881608c3589830842d1db287f1f896e"><div class="ttname"><a href="../../dc/d56/uloop_8h.html#a5881608c3589830842d1db287f1f896e">uloop_end</a></div><div class="ttdeci">static void uloop_end(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d56/uloop_8h_source.html#l00140">uloop.h:140</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d56/uloop_8h_source.html#l00140">uloop_end()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d9f/upgraded_8c_source.html#l00044">sysupgrade()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/upgraded_8c_a88f7de89e03f71739fd0fbd87dbfc50e_cgraph.png" border="0" usemap="#ad3/d9f/upgraded_8c_a88f7de89e03f71739fd0fbd87dbfc50e_cgraph" alt=""/></div>
<map name="ad3/d9f/upgraded_8c_a88f7de89e03f71739fd0fbd87dbfc50e_cgraph" id="ad3/d9f/upgraded_8c_a88f7de89e03f71739fd0fbd87dbfc50e_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,185,39"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#a5881608c3589830842d1db287f1f896e" title=" " alt="" coords="233,5,349,39"/>
<area shape="poly" title=" " alt="" coords="185,20,217,20,217,25,185,25"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aa3770535f39c67ca0811e27731893370" name="aa3770535f39c67ca0811e27731893370"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3770535f39c67ca0811e27731893370">&#9670;&#160;</a></span>debug</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int debug = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d9f/upgraded_8c_source.html#l00035">35</a> of file <a class="el" href="../../d3/d9f/upgraded_8c_source.html">upgraded.c</a>.</p>

</div>
</div>
<a id="af46424df334b6e5110945d8ae8012e17" name="af46424df334b6e5110945d8ae8012e17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af46424df334b6e5110945d8ae8012e17">&#9670;&#160;</a></span>upgrade_proc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dc/d56/uloop_8h.html#da/d43/structuloop__process">uloop_process</a> upgrade_proc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d9f/upgraded_8c_source.html#l00034">34</a> of file <a class="el" href="../../d3/d9f/upgraded_8c_source.html">upgraded.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d9f/upgraded_8c_source.html#l00044">sysupgrade()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
