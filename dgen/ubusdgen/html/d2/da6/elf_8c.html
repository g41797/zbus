<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>zbus: /home/g41797/CLionProjects/github.com/g41797/zbus/src/libs/procd/jail/elf.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">zbus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_87a455bccb09a92130c26a11a880c98a.html">libs</a></li><li class="navelem"><a class="el" href="../../dir_63350b749fcf74007a53c7c917c10773.html">procd</a></li><li class="navelem"><a class="el" href="../../dir_332eccd3a674db599d080e188d7046bc.html">jail</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">elf.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;glob.h&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d1/d9e/elf_8h_source.html">elf.h</a>&gt;</code><br />
<code>#include &lt;linux/limits.h&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d5/d1d/libubox_2utils_8h_source.html">libubox/utils.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="../../df/d26/fs_8h_source.html">fs.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html">log.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for elf.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d00/elf_8c__incl.png" border="0" usemap="#a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2procd_2jail_2elf_8c" alt=""/></div>
<map name="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2procd_2jail_2elf_8c" id="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2procd_2jail_2elf_8c">
<area shape="rect" title=" " alt="" coords="412,5,698,85"/>
<area shape="rect" title=" " alt="" coords="512,378,606,412"/>
<area shape="poly" title=" " alt="" coords="558,86,561,362,556,362,553,86"/>
<area shape="rect" title=" " alt="" coords="257,460,368,493"/>
<area shape="poly" title=" " alt="" coords="412,77,352,100,300,133,279,153,262,175,252,201,248,230,248,314,253,351,264,386,295,445,290,448,259,388,247,352,243,315,243,230,247,200,258,173,275,149,296,128,350,96,410,72"/>
<area shape="rect" title=" " alt="" coords="333,133,414,167"/>
<area shape="poly" title=" " alt="" coords="487,88,416,128,414,123,484,83"/>
<area shape="rect" title=" " alt="" coords="438,133,517,167"/>
<area shape="poly" title=" " alt="" coords="527,87,501,122,497,119,523,84"/>
<area shape="rect" href="../../d1/d9e/elf_8h.html" title=" " alt="" coords="283,215,344,248"/>
<area shape="poly" title=" " alt="" coords="412,74,363,98,342,115,324,135,316,149,311,166,311,199,305,199,306,165,311,147,319,131,338,111,360,94,410,69"/>
<area shape="rect" title=" " alt="" coords="593,133,733,167"/>
<area shape="poly" title=" " alt="" coords="598,84,637,120,633,124,594,88"/>
<area shape="rect" href="../../d5/d1d/libubox_2utils_8h.html" title=" " alt="" coords="695,378,847,412"/>
<area shape="poly" title=" " alt="" coords="691,83,722,104,748,131,764,159,775,190,786,254,785,314,780,363,774,362,780,314,780,254,770,191,759,162,743,135,718,108,688,88"/>
<area shape="rect" href="../../df/d26/fs_8h.html" title=" " alt="" coords="848,133,904,167"/>
<area shape="poly" title=" " alt="" coords="679,83,834,132,832,137,677,88"/>
<area shape="rect" href="../../d8/d30/procd_2jail_2log_8h.html" title=" " alt="" coords="1167,133,1234,167"/>
<area shape="poly" title=" " alt="" coords="699,67,1151,138,1151,143,698,72"/>
<area shape="rect" href="../../d3/d51/avl_8h.html" title=" " alt="" coords="61,296,201,330"/>
<area shape="poly" title=" " alt="" coords="284,249,183,292,181,287,282,244"/>
<area shape="rect" href="../../d8/d47/avl-cmp_8h.html" title=" " alt="" coords="283,296,470,330"/>
<area shape="poly" title=" " alt="" coords="328,247,356,282,352,286,324,250"/>
<area shape="rect" title=" " alt="" coords="5,460,102,493"/>
<area shape="poly" title=" " alt="" coords="117,332,98,354,81,379,68,412,61,445,55,444,63,411,76,377,94,350,113,329"/>
<area shape="rect" title=" " alt="" coords="125,460,233,493"/>
<area shape="poly" title=" " alt="" coords="145,329,160,351,172,377,180,411,182,444,177,444,174,412,167,379,155,353,141,332"/>
<area shape="rect" href="../../da/d23/list_8h.html" title=" " alt="" coords="91,378,157,412"/>
<area shape="poly" title=" " alt="" coords="132,331,129,363,124,362,127,330"/>
<area shape="poly" title=" " alt="" coords="112,414,80,450,76,446,108,410"/>
<area shape="poly" title=" " alt="" coords="137,411,161,445,157,448,133,414"/>
<area shape="poly" title=" " alt="" coords="695,411,383,462,382,457,694,405"/>
<area shape="poly" title=" " alt="" coords="695,411,667,414,551,427,458,435,366,444,248,462,247,457,365,439,458,430,550,422,667,409,694,405"/>
<area shape="rect" title=" " alt="" coords="707,460,835,493"/>
<area shape="poly" title=" " alt="" coords="774,412,774,444,768,444,768,412"/>
<area shape="rect" title=" " alt="" coords="859,460,976,493"/>
<area shape="poly" title=" " alt="" coords="802,410,876,450,873,454,799,415"/>
<area shape="rect" title=" " alt="" coords="1122,460,1214,493"/>
<area shape="poly" title=" " alt="" coords="848,406,966,427,1108,456,1107,462,965,433,847,411"/>
<area shape="rect" title=" " alt="" coords="1001,460,1098,493"/>
<area shape="poly" title=" " alt="" coords="828,410,987,455,985,460,827,415"/>
<area shape="rect" title=" " alt="" coords="392,460,472,493"/>
<area shape="poly" title=" " alt="" coords="695,414,488,462,487,456,694,409"/>
<area shape="rect" title=" " alt="" coords="496,460,683,493"/>
<area shape="poly" title=" " alt="" coords="735,415,641,456,639,451,733,410"/>
<area shape="rect" title=" " alt="" coords="808,215,944,248"/>
<area shape="poly" title=" " alt="" coords="879,167,879,199,874,199,874,167"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html" title=" " alt="" coords="969,215,1162,248"/>
<area shape="poly" title=" " alt="" coords="906,161,1014,206,1012,211,904,166"/>
<area shape="rect" title=" " alt="" coords="876,296,975,330"/>
<area shape="poly" title=" " alt="" coords="1038,251,968,291,966,286,1036,246"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html" title=" " alt="" coords="999,296,1079,330"/>
<area shape="poly" title=" " alt="" coords="1063,250,1052,283,1046,281,1058,248"/>
<area shape="poly" title=" " alt="" coords="999,330,987,333,887,350,809,359,730,366,630,381,621,382,620,377,629,375,730,361,808,354,887,345,986,327,998,325"/>
<area shape="poly" title=" " alt="" coords="999,330,987,333,902,347,834,352,767,359,684,381,665,389,652,397,638,406,618,414,564,429,518,438,436,446,353,450,248,462,247,457,353,444,436,440,517,433,563,424,617,409,635,401,649,393,663,384,682,375,766,354,833,347,901,342,986,327,998,324"/>
<area shape="poly" title=" " alt="" coords="999,329,988,333,841,376,840,371,986,327,998,324"/>
<area shape="poly" title=" " alt="" coords="1055,329,1097,376,1150,445,1145,448,1093,380,1051,332"/>
<area shape="rect" title=" " alt="" coords="880,378,971,412"/>
<area shape="poly" title=" " alt="" coords="1017,333,962,371,959,367,1014,328"/>
<area shape="rect" title=" " alt="" coords="1158,378,1242,412"/>
<area shape="poly" title=" " alt="" coords="1073,328,1155,369,1153,373,1070,333"/>
<area shape="rect" title=" " alt="" coords="995,378,1083,412"/>
<area shape="poly" title=" " alt="" coords="1042,330,1042,363,1036,363,1036,330"/>
<area shape="poly" title=" " alt="" coords="1203,167,1203,363,1198,363,1198,167"/>
<area shape="rect" title=" " alt="" coords="1238,215,1336,248"/>
<area shape="poly" title=" " alt="" coords="1220,165,1260,202,1256,206,1216,169"/>
</map>
</div>
</div>
<p><a href="../../d2/da6/elf_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a369266c24eacffb87046522897a570d5" id="r_a369266c24eacffb87046522897a570d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a369266c24eacffb87046522897a570d5">_GNU_SOURCE</a></td></tr>
<tr class="separator:a369266c24eacffb87046522897a570d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7dff13cf5aa3876c471a5f2c7d7d5cec" id="r_a7dff13cf5aa3876c471a5f2c7d7d5cec"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7dff13cf5aa3876c471a5f2c7d7d5cec">LIST_HEAD</a> (library_paths)</td></tr>
<tr class="separator:a7dff13cf5aa3876c471a5f2c7d7d5cec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3640146373568deef10feba467965bb9" id="r_a3640146373568deef10feba467965bb9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3640146373568deef10feba467965bb9">alloc_library_path</a> (const char *<a class="el" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>)</td></tr>
<tr class="separator:a3640146373568deef10feba467965bb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5601edf43bf58289cb22c5b20d17a1e9" id="r_a5601edf43bf58289cb22c5b20d17a1e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5601edf43bf58289cb22c5b20d17a1e9">alloc_library</a> (const char *<a class="el" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, const char *name)</td></tr>
<tr class="separator:a5601edf43bf58289cb22c5b20d17a1e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ae7cc745a41248c9f0d9bbb83a86a43" id="r_a9ae7cc745a41248c9f0d9bbb83a86a43"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9ae7cc745a41248c9f0d9bbb83a86a43">lib_open</a> (char **fullpath, const char *file)</td></tr>
<tr class="separator:a9ae7cc745a41248c9f0d9bbb83a86a43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefdad32a1f287a539e1d6f6d31301e4e" id="r_aefdad32a1f287a539e1d6f6d31301e4e"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aefdad32a1f287a539e1d6f6d31301e4e">find_lib</a> (const char *file)</td></tr>
<tr class="separator:aefdad32a1f287a539e1d6f6d31301e4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3212416f7b63427063c564bdedd8b645" id="r_a3212416f7b63427063c564bdedd8b645"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3212416f7b63427063c564bdedd8b645">elf64_find_section</a> (const char *map, unsigned int <a class="el" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, unsigned long *offset, unsigned long *size, unsigned long *vaddr)</td></tr>
<tr class="separator:a3212416f7b63427063c564bdedd8b645"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecc20c7d8b2e298820356d8e32eb4f4a" id="r_aecc20c7d8b2e298820356d8e32eb4f4a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aecc20c7d8b2e298820356d8e32eb4f4a">elf32_find_section</a> (const char *map, unsigned int <a class="el" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, unsigned long *offset, unsigned long *size, unsigned long *vaddr)</td></tr>
<tr class="separator:aecc20c7d8b2e298820356d8e32eb4f4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fada8bd25495e270df90e58db6890f1" id="r_a1fada8bd25495e270df90e58db6890f1"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1fada8bd25495e270df90e58db6890f1">elf_find_section</a> (const char *map, unsigned int <a class="el" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, unsigned long *offset, unsigned long *size, unsigned long *vaddr)</td></tr>
<tr class="separator:a1fada8bd25495e270df90e58db6890f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12c644fb0c26d71dff162e574593230e" id="r_a12c644fb0c26d71dff162e574593230e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a12c644fb0c26d71dff162e574593230e">elf32_scan_dynamic</a> (const char *map, unsigned long dyn_offset, unsigned long dyn_size, long load_offset)</td></tr>
<tr class="separator:a12c644fb0c26d71dff162e574593230e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ac3dca93dd7aead60876faae920be80" id="r_a0ac3dca93dd7aead60876faae920be80"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ac3dca93dd7aead60876faae920be80">elf64_scan_dynamic</a> (const char *map, unsigned long dyn_offset, unsigned long dyn_size, long load_offset)</td></tr>
<tr class="separator:a0ac3dca93dd7aead60876faae920be80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48837326349fc40e7a38f613d853f8f2" id="r_a48837326349fc40e7a38f613d853f8f2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a48837326349fc40e7a38f613d853f8f2">elf_load_deps</a> (const char *<a class="el" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, const char *map)</td></tr>
<tr class="separator:a48837326349fc40e7a38f613d853f8f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a804281d8e0faf31dd192190cea41c371" id="r_a804281d8e0faf31dd192190cea41c371"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a804281d8e0faf31dd192190cea41c371">load_ldso_conf</a> (const char *<a class="el" href="../../da/dc0/uxc_8c.html#ae5511ac79f463b84683d8cbfb4e01430">conf</a>)</td></tr>
<tr class="separator:a804281d8e0faf31dd192190cea41c371"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5c6746a1010af2033a89a248fc0c2d3" id="r_ab5c6746a1010af2033a89a248fc0c2d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab5c6746a1010af2033a89a248fc0c2d3">init_library_search</a> (void)</td></tr>
<tr class="separator:ab5c6746a1010af2033a89a248fc0c2d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb68ed1aa9f416ea5f299d7672a3b5c1" id="r_abb68ed1aa9f416ea5f299d7672a3b5c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abb68ed1aa9f416ea5f299d7672a3b5c1">free_library_search</a> (void)</td></tr>
<tr class="separator:abb68ed1aa9f416ea5f299d7672a3b5c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad5cd1529b1d09e1fefb94edad826fe2b" id="r_ad5cd1529b1d09e1fefb94edad826fe2b"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d3/d51/avl_8h.html#dd/d4a/structavl__tree">avl_tree</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad5cd1529b1d09e1fefb94edad826fe2b">libraries</a></td></tr>
<tr class="separator:ad5cd1529b1d09e1fefb94edad826fe2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a369266c24eacffb87046522897a570d5" name="a369266c24eacffb87046522897a570d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a369266c24eacffb87046522897a570d5">&#9670;&#160;</a></span>_GNU_SOURCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _GNU_SOURCE</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/elf_8c_source.html#l00014">14</a> of file <a class="el" href="../../d2/da6/elf_8c_source.html">elf.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a5601edf43bf58289cb22c5b20d17a1e9" name="a5601edf43bf58289cb22c5b20d17a1e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5601edf43bf58289cb22c5b20d17a1e9">&#9670;&#160;</a></span>alloc_library()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void alloc_library </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/elf_8c_source.html#l00056">56</a> of file <a class="el" href="../../d2/da6/elf_8c_source.html">elf.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   57</span>{</div>
<div class="line"><span class="lineno">   58</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d1/d9e/elf_8h.html#d3/d23/structlibrary">library</a> *l;</div>
<div class="line"><span class="lineno">   59</span>    <span class="keywordtype">char</span> *_name, *_path;</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>    l = <a class="code hl_define" href="../../d5/d1d/libubox_2utils_8h.html#aff691579da2cdefdfca9824884526804">calloc_a</a>(<span class="keyword">sizeof</span>(*l),</div>
<div class="line"><span class="lineno">   62</span>        &amp;_path, strlen(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>) + 1,</div>
<div class="line"><span class="lineno">   63</span>        &amp;_name, strlen(<a class="code hl_variable" href="../../d1/d9e/elf_8h.html#aa29e258f00217d97a0c1b1850f218f6d">name</a>) + 1);</div>
<div class="line"><span class="lineno">   64</span>    <span class="keywordflow">if</span> (!l)</div>
<div class="line"><span class="lineno">   65</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>    l-&gt;<a class="code hl_variable" href="../../d1/d9e/elf_8h.html#a0b3d6c6db266ef4533eee4c840a713be">avl</a>.<a class="code hl_variable" href="../../d3/d51/avl_8h.html#aa097934e0f5e3c398890a99605291b01">key</a> = l-&gt;<a class="code hl_variable" href="../../d1/d9e/elf_8h.html#aa29e258f00217d97a0c1b1850f218f6d">name</a> = strcpy(_name, <a class="code hl_variable" href="../../d1/d9e/elf_8h.html#aa29e258f00217d97a0c1b1850f218f6d">name</a>);</div>
<div class="line"><span class="lineno">   68</span>    l-&gt;<a class="code hl_variable" href="../../d1/d9e/elf_8h.html#ac8db6c3d0fa3f4c42e13f8281aab15da">path</a> = strcpy(_path, <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>);</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>    <a class="code hl_function" href="../../df/dc2/avl_8c.html#ab9041e08938920d5ae722e2d57dc20e2">avl_insert</a>(&amp;<a class="code hl_variable" href="#ad5cd1529b1d09e1fefb94edad826fe2b">libraries</a>, &amp;l-&gt;<a class="code hl_variable" href="../../d1/d9e/elf_8h.html#a0b3d6c6db266ef4533eee4c840a713be">avl</a>);</div>
<div class="line"><span class="lineno">   71</span>    <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;adding library %s (%s)\n&quot;</span>, <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, <a class="code hl_variable" href="../../d1/d9e/elf_8h.html#aa29e258f00217d97a0c1b1850f218f6d">name</a>);</div>
<div class="line"><span class="lineno">   72</span>}</div>
<div class="ttc" id="aavl_8c_html_ab9041e08938920d5ae722e2d57dc20e2"><div class="ttname"><a href="../../df/dc2/avl_8c.html#ab9041e08938920d5ae722e2d57dc20e2">avl_insert</a></div><div class="ttdeci">int avl_insert(struct avl_tree *tree, struct avl_node *new)</div><div class="ttdef"><b>Definition</b> <a href="../../df/dc2/avl_8c_source.html#l00220">avl.c:220</a></div></div>
<div class="ttc" id="aavl_8h_html_aa097934e0f5e3c398890a99605291b01"><div class="ttname"><a href="../../d3/d51/avl_8h.html#aa097934e0f5e3c398890a99605291b01">avl_node::key</a></div><div class="ttdeci">const void * key</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d51/avl_8h_source.html#l00084">avl.h:84</a></div></div>
<div class="ttc" id="aelf_8c_html_ad5cd1529b1d09e1fefb94edad826fe2b"><div class="ttname"><a href="#ad5cd1529b1d09e1fefb94edad826fe2b">libraries</a></div><div class="ttdeci">struct avl_tree libraries</div><div class="ttdef"><b>Definition</b> <a href="../../d2/da6/elf_8c_source.html#l00029">elf.c:29</a></div></div>
<div class="ttc" id="aelf_8h_html_a0b3d6c6db266ef4533eee4c840a713be"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a0b3d6c6db266ef4533eee4c840a713be">library::avl</a></div><div class="ttdeci">struct avl_node avl</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d9e/elf_8h_source.html#l00020">elf.h:20</a></div></div>
<div class="ttc" id="aelf_8h_html_aa29e258f00217d97a0c1b1850f218f6d"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#aa29e258f00217d97a0c1b1850f218f6d">library::name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d9e/elf_8h_source.html#l00021">elf.h:21</a></div></div>
<div class="ttc" id="aelf_8h_html_ac8db6c3d0fa3f4c42e13f8281aab15da"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#ac8db6c3d0fa3f4c42e13f8281aab15da">library::path</a></div><div class="ttdeci">char * path</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d9e/elf_8h_source.html#l00022">elf.h:22</a></div></div>
<div class="ttc" id="aelf_8h_html_d3/d23/structlibrary"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#d3/d23/structlibrary">library</a></div><div class="ttdef"><b>Definition</b> <a href="../../d1/d9e/elf_8h_source.html#l00019">elf.h:19</a></div></div>
<div class="ttc" id="alibubox_2utils_8h_html_aff691579da2cdefdfca9824884526804"><div class="ttname"><a href="../../d5/d1d/libubox_2utils_8h.html#aff691579da2cdefdfca9824884526804">calloc_a</a></div><div class="ttdeci">#define calloc_a(len,...)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d1d/libubox_2utils_8h_source.html#l00039">utils.h:39</a></div></div>
<div class="ttc" id="asystem-dummy_8c_html_ad72dbcf6d0153db1b8d8a58001feed83"><div class="ttname"><a href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a></div><div class="ttdeci">#define DEBUG</div><div class="ttdef"><b>Definition</b> <a href="../../da/d12/system-dummy_8c_source.html#l00021">system-dummy.c:21</a></div></div>
<div class="ttc" id="aubusd__obj_8c_html_a9ece2e576492090c46d5e3b435cef7d4"><div class="ttname"><a href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a></div><div class="ttdeci">struct avl_tree path</div><div class="ttdef"><b>Definition</b> <a href="../../df/d0e/ubusd__obj_8c_source.html#l00019">ubusd_obj.c:19</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d9e/elf_8h_source.html#l00020">library::avl</a>, <a class="el" href="../../df/dc2/avl_8c_source.html#l00220">avl_insert()</a>, <a class="el" href="../../d5/d1d/libubox_2utils_8h_source.html#l00039">calloc_a</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../d3/d51/avl_8h_source.html#l00084">avl_node::key</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00029">libraries</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00021">library::name</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00022">library::path</a>, and <a class="el" href="../../df/d0e/ubusd__obj_8c_source.html#l00019">path</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d5a/fs_8c_source.html#l00486">add_2paths_and_deps()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/da6/elf_8c_a5601edf43bf58289cb22c5b20d17a1e9_cgraph.png" border="0" usemap="#ad2/da6/elf_8c_a5601edf43bf58289cb22c5b20d17a1e9_cgraph" alt=""/></div>
<map name="ad2/da6/elf_8c_a5601edf43bf58289cb22c5b20d17a1e9_cgraph" id="ad2/da6/elf_8c_a5601edf43bf58289cb22c5b20d17a1e9_cgraph">
<area shape="rect" title=" " alt="" coords="5,196,138,230"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab9041e08938920d5ae722e2d57dc20e2" title=" " alt="" coords="186,196,296,230"/>
<area shape="poly" title=" " alt="" coords="138,210,170,210,170,216,138,216"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a55d3dbabb73970f597eff3d04809f4ef" title=" " alt="" coords="368,29,498,63"/>
<area shape="poly" title=" " alt="" coords="248,194,283,135,310,101,342,72,352,66,355,70,346,76,314,105,288,138,253,197"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#abd4899daa8ad959e6c9694dd5e4132a8" title=" " alt="" coords="352,87,514,120"/>
<area shape="poly" title=" " alt="" coords="261,193,298,166,343,137,369,124,371,129,345,142,301,170,265,198"/>
<area shape="rect" href="../../da/d23/list_8h.html#a875b53c95596d9e8df15ac54f6d24ae6" title=" " alt="" coords="606,139,699,172"/>
<area shape="poly" title=" " alt="" coords="295,193,344,181,476,163,591,155,591,160,476,168,344,186,296,198"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab6f5b72e706a1955a5a5d6af278c677e" title=" " alt="" coords="344,196,522,230"/>
<area shape="poly" title=" " alt="" coords="297,210,328,210,328,216,297,216"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a6de877c20c7b55fa52c80e7be87715fa" title=" " alt="" coords="384,253,482,287"/>
<area shape="poly" title=" " alt="" coords="297,227,370,249,369,254,296,232"/>
<area shape="rect" href="../../da/d23/list_8h.html#abb4dd1eb7346eb35ea621351220e80ce" title=" " alt="" coords="376,311,490,344"/>
<area shape="poly" title=" " alt="" coords="260,228,297,263,345,297,363,305,360,310,343,302,294,267,256,232"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a212673459e8e8ff2e11a8d093602d35e" title=" " alt="" coords="372,392,495,426"/>
<area shape="poly" title=" " alt="" coords="253,229,290,288,316,323,346,355,383,382,380,386,342,359,312,326,286,291,249,232"/>
<area shape="poly" title=" " alt="" coords="398,30,394,20,400,11,413,5,433,3,455,5,468,12,465,16,454,10,433,8,414,10,403,15,400,20,403,28"/>
<area shape="poly" title=" " alt="" coords="508,118,592,139,591,144,507,124"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="783,168,884,202"/>
<area shape="poly" title=" " alt="" coords="700,160,768,172,767,177,699,166"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="588,196,717,230"/>
<area shape="poly" title=" " alt="" coords="523,210,573,210,573,216,523,216"/>
<area shape="poly" title=" " alt="" coords="717,200,767,192,767,198,718,205"/>
<area shape="poly" title=" " alt="" coords="398,393,394,383,400,373,413,367,433,365,455,368,468,374,465,379,454,373,433,371,414,373,403,377,400,383,403,391"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a67b3db37af2f8ebc4f6895202c358604" title=" " alt="" coords="578,363,727,396"/>
<area shape="poly" title=" " alt="" coords="495,398,562,389,563,394,496,403"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab84f86be5fe7f7abcf8ffb6fa0a38700" title=" " alt="" coords="570,420,735,454"/>
<area shape="poly" title=" " alt="" coords="496,414,555,422,554,427,495,419"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#aaf08ec177405c5e004b1ca33808f19da" title=" " alt="" coords="785,420,882,454"/>
<area shape="poly" title=" " alt="" coords="709,394,771,414,769,419,707,399"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e2d83bace7533ed4cc93bdf2a94ad95" title=" " alt="" coords="787,363,880,396"/>
<area shape="poly" title=" " alt="" coords="727,377,772,377,772,382,727,382"/>
<area shape="poly" title=" " alt="" coords="735,434,769,434,769,440,735,440"/>
<area shape="poly" title=" " alt="" coords="707,417,772,396,773,401,709,422"/>
</map>
</div>

</div>
</div>
<a id="a3640146373568deef10feba467965bb9" name="a3640146373568deef10feba467965bb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3640146373568deef10feba467965bb9">&#9670;&#160;</a></span>alloc_library_path()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void alloc_library_path </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/elf_8c_source.html#l00032">32</a> of file <a class="el" href="../../d2/da6/elf_8c_source.html">elf.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   33</span>{</div>
<div class="line"><span class="lineno">   34</span>    <span class="keyword">struct </span>stat s;</div>
<div class="line"><span class="lineno">   35</span>    <span class="keywordflow">if</span> (stat(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, &amp;s))</div>
<div class="line"><span class="lineno">   36</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   37</span> </div>
<div class="line"><span class="lineno">   38</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d1/d9e/elf_8h.html#df/dad/structlibrary__path">library_path</a> *p;</div>
<div class="line"><span class="lineno">   39</span>    <span class="keywordtype">char</span> *_path;</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>    p = <a class="code hl_define" href="../../d5/d1d/libubox_2utils_8h.html#aff691579da2cdefdfca9824884526804">calloc_a</a>(<span class="keyword">sizeof</span>(*p),</div>
<div class="line"><span class="lineno">   42</span>        &amp;_path, strlen(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>) + 1);</div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordflow">if</span> (!p)</div>
<div class="line"><span class="lineno">   44</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span>    p-&gt;<a class="code hl_variable" href="../../d1/d9e/elf_8h.html#a0b00cf25b7f124d14fcebe0840ae2725">path</a> = strcpy(_path, <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>);</div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span>    <a class="code hl_function" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1">list_add_tail</a>(&amp;p-&gt;<a class="code hl_variable" href="../../d1/d9e/elf_8h.html#a4df2c3eefaa9988d446262e68f08795b">list</a>, &amp;library_paths);</div>
<div class="line"><span class="lineno">   49</span>    <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;adding ld.so path %s\n&quot;</span>, <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>);</div>
<div class="line"><span class="lineno">   50</span>}</div>
<div class="ttc" id="aelf_8h_html_a0b00cf25b7f124d14fcebe0840ae2725"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a0b00cf25b7f124d14fcebe0840ae2725">library_path::path</a></div><div class="ttdeci">char * path</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d9e/elf_8h_source.html#l00027">elf.h:27</a></div></div>
<div class="ttc" id="aelf_8h_html_a4df2c3eefaa9988d446262e68f08795b"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a4df2c3eefaa9988d446262e68f08795b">library_path::list</a></div><div class="ttdeci">struct list_head list</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d9e/elf_8h_source.html#l00026">elf.h:26</a></div></div>
<div class="ttc" id="aelf_8h_html_df/dad/structlibrary__path"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#df/dad/structlibrary__path">library_path</a></div><div class="ttdef"><b>Definition</b> <a href="../../d1/d9e/elf_8h_source.html#l00025">elf.h:25</a></div></div>
<div class="ttc" id="alist_8h_html_a5f3c4582c49b990c9fb4f5c83f8400d1"><div class="ttname"><a href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1">list_add_tail</a></div><div class="ttdeci">static void list_add_tail(struct list_head *_new, struct list_head *head)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d23/list_8h_source.html#l00165">list.h:165</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d1d/libubox_2utils_8h_source.html#l00039">calloc_a</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00026">library_path::list</a>, <a class="el" href="../../da/d23/list_8h_source.html#l00165">list_add_tail()</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00027">library_path::path</a>, and <a class="el" href="../../df/d0e/ubusd__obj_8c_source.html#l00019">path</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/da6/elf_8c_source.html#l00310">init_library_search()</a>, and <a class="el" href="../../d2/da6/elf_8c_source.html#l00264">load_ldso_conf()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/da6/elf_8c_a3640146373568deef10feba467965bb9_cgraph.png" border="0" usemap="#ad2/da6/elf_8c_a3640146373568deef10feba467965bb9_cgraph" alt=""/></div>
<map name="ad2/da6/elf_8c_a3640146373568deef10feba467965bb9_cgraph" id="ad2/da6/elf_8c_a3640146373568deef10feba467965bb9_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,189,39"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="237,5,366,39"/>
<area shape="poly" title=" " alt="" coords="189,20,221,20,221,25,189,25"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="414,5,515,39"/>
<area shape="poly" title=" " alt="" coords="367,20,398,20,398,25,367,25"/>
</map>
</div>

</div>
</div>
<a id="aecc20c7d8b2e298820356d8e32eb4f4a" name="aecc20c7d8b2e298820356d8e32eb4f4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecc20c7d8b2e298820356d8e32eb4f4a">&#9670;&#160;</a></span>elf32_find_section()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int elf32_find_section </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>map</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *</td>          <td class="paramname"><span class="paramname"><em>offset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *</td>          <td class="paramname"><span class="paramname"><em>size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *</td>          <td class="paramname"><span class="paramname"><em>vaddr</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/elf_8c_source.html#l00128">128</a> of file <a class="el" href="../../d2/da6/elf_8c_source.html">elf.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  129</span>{</div>
<div class="line"><span class="lineno">  130</span>    Elf32_Ehdr *e;</div>
<div class="line"><span class="lineno">  131</span>    Elf32_Phdr *ph;</div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>    e = (Elf32_Ehdr *) map;</div>
<div class="line"><span class="lineno">  135</span>    ph = (Elf32_Phdr *) (map + e-&gt;e_phoff);</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>    <span class="keywordflow">for</span> (i = 0; i &lt; e-&gt;e_phnum; i++) {</div>
<div class="line"><span class="lineno">  138</span>        <span class="keywordflow">if</span> (ph[i].p_type == <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>) {</div>
<div class="line"><span class="lineno">  139</span>            *offset = ph[i].p_offset;</div>
<div class="line"><span class="lineno">  140</span>            <span class="keywordflow">if</span> (size)</div>
<div class="line"><span class="lineno">  141</span>                *size = ph[i].p_filesz;</div>
<div class="line"><span class="lineno">  142</span>            <span class="keywordflow">if</span> (vaddr)</div>
<div class="line"><span class="lineno">  143</span>                *vaddr = ph[i].p_vaddr;</div>
<div class="line"><span class="lineno">  144</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  145</span>        }</div>
<div class="line"><span class="lineno">  146</span>    }</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  149</span>}</div>
<div class="ttc" id="audebug-proto_8h_html_a1d127017fb298b889f4ba24752d08b8e"><div class="ttname"><a href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a></div><div class="ttdeci">uint8_t type</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d8f/udebug-proto_8h_source.html#l00000">udebug-proto.h:0</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d8f/udebug-proto_8h_source.html#l00000">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/da6/elf_8c_source.html#l00151">elf_find_section()</a>.</p>

</div>
</div>
<a id="a12c644fb0c26d71dff162e574593230e" name="a12c644fb0c26d71dff162e574593230e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12c644fb0c26d71dff162e574593230e">&#9670;&#160;</a></span>elf32_scan_dynamic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int elf32_scan_dynamic </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>map</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long</td>          <td class="paramname"><span class="paramname"><em>dyn_offset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long</td>          <td class="paramname"><span class="paramname"><em>dyn_size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>load_offset</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/elf_8c_source.html#l00165">165</a> of file <a class="el" href="../../d2/da6/elf_8c_source.html">elf.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  166</span>{</div>
<div class="line"><span class="lineno">  167</span>    Elf32_Dyn *dynamic = (Elf32_Dyn *) (map + dyn_offset);</div>
<div class="line"><span class="lineno">  168</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *strtab = NULL;</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>    <span class="keywordflow">while</span> ((<span class="keywordtype">void</span> *) dynamic &lt; (<span class="keywordtype">void</span> *) (map + dyn_offset + dyn_size)) {</div>
<div class="line"><span class="lineno">  171</span>        Elf32_Dyn *curr = dynamic;</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>        dynamic++;</div>
<div class="line"><span class="lineno">  174</span>        <span class="keywordflow">if</span> (curr-&gt;d_tag != DT_STRTAB)</div>
<div class="line"><span class="lineno">  175</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>        strtab = map + (curr-&gt;d_un.d_ptr - load_offset);</div>
<div class="line"><span class="lineno">  178</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  179</span>    }</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>    <span class="keywordflow">if</span> (!strtab)</div>
<div class="line"><span class="lineno">  182</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>    dynamic = (Elf32_Dyn *) (map + dyn_offset);</div>
<div class="line"><span class="lineno">  185</span>    <span class="keywordflow">while</span> ((<span class="keywordtype">void</span> *) dynamic &lt; (<span class="keywordtype">void</span> *) (map + dyn_offset + dyn_size)) {</div>
<div class="line"><span class="lineno">  186</span>        Elf32_Dyn *curr = dynamic;</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>        dynamic++;</div>
<div class="line"><span class="lineno">  189</span>        <span class="keywordflow">if</span> (curr-&gt;d_tag != DT_NEEDED)</div>
<div class="line"><span class="lineno">  190</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../df/d26/fs_8h.html#a3c2c8ec14a25736480de113e1b71f52d">add_path_and_deps</a>(&amp;strtab[curr-&gt;d_un.d_val], 1, -1, 1))</div>
<div class="line"><span class="lineno">  193</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  194</span>    }</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  197</span>}</div>
<div class="ttc" id="afs_8h_html_a3c2c8ec14a25736480de113e1b71f52d"><div class="ttname"><a href="../../df/d26/fs_8h.html#a3c2c8ec14a25736480de113e1b71f52d">add_path_and_deps</a></div><div class="ttdeci">static int add_path_and_deps(const char *path, int readonly, int error, int lib)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d26/fs_8h_source.html#l00027">fs.h:27</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../df/d26/fs_8h_source.html#l00027">add_path_and_deps()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/da6/elf_8c_source.html#l00233">elf_load_deps()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/da6/elf_8c_a12c644fb0c26d71dff162e574593230e_cgraph.png" border="0" usemap="#ad2/da6/elf_8c_a12c644fb0c26d71dff162e574593230e_cgraph" alt=""/></div>
<map name="ad2/da6/elf_8c_a12c644fb0c26d71dff162e574593230e_cgraph" id="ad2/da6/elf_8c_a12c644fb0c26d71dff162e574593230e_cgraph">
<area shape="rect" title=" " alt="" coords="5,479,214,512"/>
<area shape="rect" href="../../df/d26/fs_8h.html#a3c2c8ec14a25736480de113e1b71f52d" title=" " alt="" coords="262,428,467,462"/>
<area shape="poly" title=" " alt="" coords="197,475,261,463,262,468,198,481"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#ac4992c3c85512f44840f4eda86df97b5" title=" " alt="" coords="515,323,742,356"/>
<area shape="poly" title=" " alt="" coords="408,425,569,360,571,365,410,430"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4824ede62a9ceedb153f039c5dc212f9" title=" " alt="" coords="790,323,975,356"/>
<area shape="poly" title=" " alt="" coords="743,337,775,337,775,342,743,342"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e08d7ee7d67ff58eeea30dd8a9356d1" title=" " alt="" coords="1524,377,1617,411"/>
<area shape="poly" title=" " alt="" coords="712,354,791,366,997,383,1200,391,1508,393,1508,398,1200,396,996,388,790,371,712,360"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a2b2c9415458859df2a4ed2558f53db56" title=" " alt="" coords="792,156,973,190"/>
<area shape="poly" title=" " alt="" coords="650,320,789,207,815,194,817,198,792,211,653,324"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a5601edf43bf58289cb22c5b20d17a1e9" title=" " alt="" coords="1061,211,1193,244"/>
<area shape="poly" title=" " alt="" coords="653,320,713,283,750,265,790,250,856,235,923,226,1045,222,1045,227,924,232,857,240,791,255,752,270,715,288,656,324"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a48837326349fc40e7a38f613d853f8f2" title=" " alt="" coords="809,483,956,516"/>
<area shape="poly" title=" " alt="" coords="659,355,842,472,840,476,656,359"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a9ae7cc745a41248c9f0d9bbb83a86a43" title=" " alt="" coords="833,265,932,299"/>
<area shape="poly" title=" " alt="" coords="706,319,817,294,818,299,707,325"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2" title=" " alt="" coords="1064,323,1190,356"/>
<area shape="poly" title=" " alt="" coords="975,337,1048,337,1048,342,975,342"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a6a335418ee05d0ecbda2094c55408404" title=" " alt="" coords="1306,323,1440,356"/>
<area shape="poly" title=" " alt="" coords="1190,337,1290,337,1290,342,1190,342"/>
<area shape="poly" title=" " alt="" coords="1437,354,1510,375,1508,380,1436,360"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab9041e08938920d5ae722e2d57dc20e2" title=" " alt="" coords="1515,211,1626,244"/>
<area shape="poly" title=" " alt="" coords="1404,320,1524,250,1527,255,1406,324"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a55d3dbabb73970f597eff3d04809f4ef" title=" " alt="" coords="1698,392,1828,426"/>
<area shape="poly" title=" " alt="" coords="1618,395,1682,400,1682,405,1618,400"/>
<area shape="poly" title=" " alt="" coords="1728,393,1724,383,1729,373,1742,367,1763,365,1785,368,1797,374,1795,379,1783,373,1763,371,1744,373,1733,377,1729,383,1733,391"/>
<area shape="poly" title=" " alt="" coords="1585,243,1622,296,1647,327,1675,355,1713,382,1710,386,1672,359,1643,330,1617,299,1580,246"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#abd4899daa8ad959e6c9694dd5e4132a8" title=" " alt="" coords="1682,196,1844,230"/>
<area shape="poly" title=" " alt="" coords="1626,221,1666,218,1667,223,1626,226"/>
<area shape="rect" href="../../da/d23/list_8h.html#a875b53c95596d9e8df15ac54f6d24ae6" title=" " alt="" coords="1936,196,2028,230"/>
<area shape="poly" title=" " alt="" coords="1602,208,1635,193,1673,181,1723,173,1762,171,1852,181,1921,194,1920,199,1852,186,1762,177,1723,178,1674,186,1637,198,1604,213"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab6f5b72e706a1955a5a5d6af278c677e" title=" " alt="" coords="1674,253,1852,287"/>
<area shape="poly" title=" " alt="" coords="1627,237,1670,247,1669,252,1626,242"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a6de877c20c7b55fa52c80e7be87715fa" title=" " alt="" coords="1714,311,1812,344"/>
<area shape="poly" title=" " alt="" coords="1594,243,1631,270,1675,297,1700,308,1698,313,1672,302,1628,275,1591,247"/>
<area shape="rect" href="../../da/d23/list_8h.html#abb4dd1eb7346eb35ea621351220e80ce" title=" " alt="" coords="1706,5,1820,39"/>
<area shape="poly" title=" " alt="" coords="1575,209,1587,175,1607,132,1635,87,1672,48,1690,37,1693,41,1675,52,1639,90,1612,134,1592,177,1580,211"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a212673459e8e8ff2e11a8d093602d35e" title=" " alt="" coords="1701,87,1825,120"/>
<area shape="poly" title=" " alt="" coords="1587,208,1624,173,1672,137,1696,125,1698,129,1675,142,1628,177,1590,212"/>
<area shape="poly" title=" " alt="" coords="1844,210,1920,210,1920,216,1844,216"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="2112,211,2214,244"/>
<area shape="poly" title=" " alt="" coords="2029,214,2097,220,2097,225,2029,219"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="1918,253,2047,287"/>
<area shape="poly" title=" " alt="" coords="1852,268,1902,268,1902,273,1852,273"/>
<area shape="poly" title=" " alt="" coords="2047,252,2097,240,2098,246,2048,257"/>
<area shape="poly" title=" " alt="" coords="1728,87,1724,77,1729,68,1742,62,1763,60,1785,63,1797,69,1795,74,1783,68,1763,65,1744,67,1733,72,1729,78,1733,85"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a67b3db37af2f8ebc4f6895202c358604" title=" " alt="" coords="1908,125,2057,159"/>
<area shape="poly" title=" " alt="" coords="1826,112,1893,124,1892,129,1825,117"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab84f86be5fe7f7abcf8ffb6fa0a38700" title=" " alt="" coords="1900,68,2064,102"/>
<area shape="poly" title=" " alt="" coords="1825,96,1884,91,1884,96,1825,101"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#aaf08ec177405c5e004b1ca33808f19da" title=" " alt="" coords="2114,68,2212,102"/>
<area shape="poly" title=" " alt="" coords="2037,122,2099,102,2100,107,2038,127"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e2d83bace7533ed4cc93bdf2a94ad95" title=" " alt="" coords="2117,125,2209,159"/>
<area shape="poly" title=" " alt="" coords="2057,140,2101,140,2101,145,2057,145"/>
<area shape="poly" title=" " alt="" coords="2065,82,2099,82,2099,88,2065,88"/>
<area shape="poly" title=" " alt="" coords="2038,100,2103,121,2101,126,2037,105"/>
<area shape="poly" title=" " alt="" coords="813,193,748,212,672,239,592,272,516,312,481,337,447,365,393,418,389,414,443,361,477,333,514,308,590,267,670,234,746,207,811,188"/>
<area shape="poly" title=" " alt="" coords="1193,225,1500,225,1500,230,1193,230"/>
<area shape="poly" title=" " alt="" coords="809,502,230,499,230,493,809,496"/>
<area shape="poly" title=" " alt="" coords="809,496,515,466,482,462,483,457,515,461,809,490"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a0ac3dca93dd7aead60876faae920be80" title=" " alt="" coords="1023,432,1231,466"/>
<area shape="poly" title=" " alt="" coords="955,482,1027,467,1028,472,956,487"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a1fada8bd25495e270df90e58db6890f1" title=" " alt="" coords="1045,489,1209,523"/>
<area shape="poly" title=" " alt="" coords="956,499,1029,501,1029,506,956,504"/>
<area shape="poly" title=" " alt="" coords="1023,451,483,448,483,443,1023,446"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#aecc20c7d8b2e298820356d8e32eb4f4a" title=" " alt="" coords="1279,517,1467,551"/>
<area shape="poly" title=" " alt="" coords="1210,513,1264,519,1263,524,1209,518"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a3212416f7b63427063c564bdedd8b645" title=" " alt="" coords="1279,460,1467,494"/>
<area shape="poly" title=" " alt="" coords="1209,494,1263,487,1264,493,1210,499"/>
</map>
</div>

</div>
</div>
<a id="a3212416f7b63427063c564bdedd8b645" name="a3212416f7b63427063c564bdedd8b645"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3212416f7b63427063c564bdedd8b645">&#9670;&#160;</a></span>elf64_find_section()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int elf64_find_section </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>map</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *</td>          <td class="paramname"><span class="paramname"><em>offset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *</td>          <td class="paramname"><span class="paramname"><em>size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *</td>          <td class="paramname"><span class="paramname"><em>vaddr</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/elf_8c_source.html#l00105">105</a> of file <a class="el" href="../../d2/da6/elf_8c_source.html">elf.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  106</span>{</div>
<div class="line"><span class="lineno">  107</span>    Elf64_Ehdr *e;</div>
<div class="line"><span class="lineno">  108</span>    Elf64_Phdr *ph;</div>
<div class="line"><span class="lineno">  109</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>    e = (Elf64_Ehdr *) map;</div>
<div class="line"><span class="lineno">  112</span>    ph = (Elf64_Phdr *) (map + e-&gt;e_phoff);</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>    <span class="keywordflow">for</span> (i = 0; i &lt; e-&gt;e_phnum; i++) {</div>
<div class="line"><span class="lineno">  115</span>        <span class="keywordflow">if</span> (ph[i].p_type == <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>) {</div>
<div class="line"><span class="lineno">  116</span>            *offset = ph[i].p_offset;</div>
<div class="line"><span class="lineno">  117</span>            <span class="keywordflow">if</span> (size)</div>
<div class="line"><span class="lineno">  118</span>                *size = ph[i].p_filesz;</div>
<div class="line"><span class="lineno">  119</span>            <span class="keywordflow">if</span> (vaddr)</div>
<div class="line"><span class="lineno">  120</span>                *vaddr = ph[i].p_vaddr;</div>
<div class="line"><span class="lineno">  121</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  122</span>        }</div>
<div class="line"><span class="lineno">  123</span>    }</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  126</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d8f/udebug-proto_8h_source.html#l00000">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/da6/elf_8c_source.html#l00151">elf_find_section()</a>.</p>

</div>
</div>
<a id="a0ac3dca93dd7aead60876faae920be80" name="a0ac3dca93dd7aead60876faae920be80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ac3dca93dd7aead60876faae920be80">&#9670;&#160;</a></span>elf64_scan_dynamic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int elf64_scan_dynamic </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>map</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long</td>          <td class="paramname"><span class="paramname"><em>dyn_offset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long</td>          <td class="paramname"><span class="paramname"><em>dyn_size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>load_offset</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/elf_8c_source.html#l00199">199</a> of file <a class="el" href="../../d2/da6/elf_8c_source.html">elf.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  200</span>{</div>
<div class="line"><span class="lineno">  201</span>    Elf64_Dyn *dynamic = (Elf64_Dyn *) (map + dyn_offset);</div>
<div class="line"><span class="lineno">  202</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *strtab = NULL;</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>    <span class="keywordflow">while</span> ((<span class="keywordtype">void</span> *) dynamic &lt; (<span class="keywordtype">void</span> *) (map + dyn_offset + dyn_size)) {</div>
<div class="line"><span class="lineno">  205</span>        Elf64_Dyn *curr = dynamic;</div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>        dynamic++;</div>
<div class="line"><span class="lineno">  208</span>        <span class="keywordflow">if</span> (curr-&gt;d_tag != DT_STRTAB)</div>
<div class="line"><span class="lineno">  209</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>        strtab = map + (curr-&gt;d_un.d_ptr - load_offset);</div>
<div class="line"><span class="lineno">  212</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  213</span>    }</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>    <span class="keywordflow">if</span> (!strtab)</div>
<div class="line"><span class="lineno">  216</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>    dynamic = (Elf64_Dyn *) (map + dyn_offset);</div>
<div class="line"><span class="lineno">  219</span>    <span class="keywordflow">while</span> ((<span class="keywordtype">void</span> *) dynamic &lt; (<span class="keywordtype">void</span> *) (map + dyn_offset + dyn_size)) {</div>
<div class="line"><span class="lineno">  220</span>        Elf64_Dyn *curr = dynamic;</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>        dynamic++;</div>
<div class="line"><span class="lineno">  223</span>        <span class="keywordflow">if</span> (curr-&gt;d_tag != DT_NEEDED)</div>
<div class="line"><span class="lineno">  224</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../df/d26/fs_8h.html#a3c2c8ec14a25736480de113e1b71f52d">add_path_and_deps</a>(&amp;strtab[curr-&gt;d_un.d_val], 1, -1, 1))</div>
<div class="line"><span class="lineno">  227</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  228</span>    }</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  231</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../df/d26/fs_8h_source.html#l00027">add_path_and_deps()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/da6/elf_8c_source.html#l00233">elf_load_deps()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/da6/elf_8c_a0ac3dca93dd7aead60876faae920be80_cgraph.png" border="0" usemap="#ad2/da6/elf_8c_a0ac3dca93dd7aead60876faae920be80_cgraph" alt=""/></div>
<map name="ad2/da6/elf_8c_a0ac3dca93dd7aead60876faae920be80_cgraph" id="ad2/da6/elf_8c_a0ac3dca93dd7aead60876faae920be80_cgraph">
<area shape="rect" title=" " alt="" coords="5,479,214,512"/>
<area shape="rect" href="../../df/d26/fs_8h.html#a3c2c8ec14a25736480de113e1b71f52d" title=" " alt="" coords="262,428,467,462"/>
<area shape="poly" title=" " alt="" coords="197,475,261,463,262,468,198,481"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#ac4992c3c85512f44840f4eda86df97b5" title=" " alt="" coords="515,323,742,356"/>
<area shape="poly" title=" " alt="" coords="408,425,569,360,571,365,410,430"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4824ede62a9ceedb153f039c5dc212f9" title=" " alt="" coords="790,323,975,356"/>
<area shape="poly" title=" " alt="" coords="743,337,775,337,775,342,743,342"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e08d7ee7d67ff58eeea30dd8a9356d1" title=" " alt="" coords="1524,377,1617,411"/>
<area shape="poly" title=" " alt="" coords="712,354,791,366,997,383,1200,391,1508,393,1508,398,1200,396,996,388,790,371,712,360"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a2b2c9415458859df2a4ed2558f53db56" title=" " alt="" coords="792,156,973,190"/>
<area shape="poly" title=" " alt="" coords="650,320,789,207,815,194,817,198,792,211,653,324"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a5601edf43bf58289cb22c5b20d17a1e9" title=" " alt="" coords="1061,211,1193,244"/>
<area shape="poly" title=" " alt="" coords="653,320,713,283,750,265,790,250,856,235,923,226,1045,222,1045,227,924,232,857,240,791,255,752,270,715,288,656,324"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a48837326349fc40e7a38f613d853f8f2" title=" " alt="" coords="809,483,956,516"/>
<area shape="poly" title=" " alt="" coords="659,355,842,472,840,476,656,359"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a9ae7cc745a41248c9f0d9bbb83a86a43" title=" " alt="" coords="833,265,932,299"/>
<area shape="poly" title=" " alt="" coords="706,319,817,294,818,299,707,325"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2" title=" " alt="" coords="1064,323,1190,356"/>
<area shape="poly" title=" " alt="" coords="975,337,1048,337,1048,342,975,342"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a6a335418ee05d0ecbda2094c55408404" title=" " alt="" coords="1306,323,1440,356"/>
<area shape="poly" title=" " alt="" coords="1190,337,1290,337,1290,342,1190,342"/>
<area shape="poly" title=" " alt="" coords="1437,354,1510,375,1508,380,1436,360"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab9041e08938920d5ae722e2d57dc20e2" title=" " alt="" coords="1515,211,1626,244"/>
<area shape="poly" title=" " alt="" coords="1404,320,1524,250,1527,255,1406,324"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a55d3dbabb73970f597eff3d04809f4ef" title=" " alt="" coords="1698,392,1828,426"/>
<area shape="poly" title=" " alt="" coords="1618,395,1682,400,1682,405,1618,400"/>
<area shape="poly" title=" " alt="" coords="1728,393,1724,383,1729,373,1742,367,1763,365,1785,368,1797,374,1795,379,1783,373,1763,371,1744,373,1733,377,1729,383,1733,391"/>
<area shape="poly" title=" " alt="" coords="1585,243,1622,296,1647,327,1675,355,1713,382,1710,386,1672,359,1643,330,1617,299,1580,246"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#abd4899daa8ad959e6c9694dd5e4132a8" title=" " alt="" coords="1682,196,1844,230"/>
<area shape="poly" title=" " alt="" coords="1626,221,1666,218,1667,223,1626,226"/>
<area shape="rect" href="../../da/d23/list_8h.html#a875b53c95596d9e8df15ac54f6d24ae6" title=" " alt="" coords="1936,196,2028,230"/>
<area shape="poly" title=" " alt="" coords="1602,208,1635,193,1673,181,1723,173,1762,171,1852,181,1921,194,1920,199,1852,186,1762,177,1723,178,1674,186,1637,198,1604,213"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab6f5b72e706a1955a5a5d6af278c677e" title=" " alt="" coords="1674,253,1852,287"/>
<area shape="poly" title=" " alt="" coords="1627,237,1670,247,1669,252,1626,242"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a6de877c20c7b55fa52c80e7be87715fa" title=" " alt="" coords="1714,311,1812,344"/>
<area shape="poly" title=" " alt="" coords="1594,243,1631,270,1675,297,1700,308,1698,313,1672,302,1628,275,1591,247"/>
<area shape="rect" href="../../da/d23/list_8h.html#abb4dd1eb7346eb35ea621351220e80ce" title=" " alt="" coords="1706,5,1820,39"/>
<area shape="poly" title=" " alt="" coords="1575,209,1587,175,1607,132,1635,87,1672,48,1690,37,1693,41,1675,52,1639,90,1612,134,1592,177,1580,211"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a212673459e8e8ff2e11a8d093602d35e" title=" " alt="" coords="1701,87,1825,120"/>
<area shape="poly" title=" " alt="" coords="1587,208,1624,173,1672,137,1696,125,1698,129,1675,142,1628,177,1590,212"/>
<area shape="poly" title=" " alt="" coords="1844,210,1920,210,1920,216,1844,216"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="2112,211,2214,244"/>
<area shape="poly" title=" " alt="" coords="2029,214,2097,220,2097,225,2029,219"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="1918,253,2047,287"/>
<area shape="poly" title=" " alt="" coords="1852,268,1902,268,1902,273,1852,273"/>
<area shape="poly" title=" " alt="" coords="2047,252,2097,240,2098,246,2048,257"/>
<area shape="poly" title=" " alt="" coords="1728,87,1724,77,1729,68,1742,62,1763,60,1785,63,1797,69,1795,74,1783,68,1763,65,1744,67,1733,72,1729,78,1733,85"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a67b3db37af2f8ebc4f6895202c358604" title=" " alt="" coords="1908,125,2057,159"/>
<area shape="poly" title=" " alt="" coords="1826,112,1893,124,1892,129,1825,117"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab84f86be5fe7f7abcf8ffb6fa0a38700" title=" " alt="" coords="1900,68,2064,102"/>
<area shape="poly" title=" " alt="" coords="1825,96,1884,91,1884,96,1825,101"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#aaf08ec177405c5e004b1ca33808f19da" title=" " alt="" coords="2114,68,2212,102"/>
<area shape="poly" title=" " alt="" coords="2037,122,2099,102,2100,107,2038,127"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e2d83bace7533ed4cc93bdf2a94ad95" title=" " alt="" coords="2117,125,2209,159"/>
<area shape="poly" title=" " alt="" coords="2057,140,2101,140,2101,145,2057,145"/>
<area shape="poly" title=" " alt="" coords="2065,82,2099,82,2099,88,2065,88"/>
<area shape="poly" title=" " alt="" coords="2038,100,2103,121,2101,126,2037,105"/>
<area shape="poly" title=" " alt="" coords="813,193,748,212,672,239,592,272,516,312,481,337,447,365,393,418,389,414,443,361,477,333,514,308,590,267,670,234,746,207,811,188"/>
<area shape="poly" title=" " alt="" coords="1193,225,1500,225,1500,230,1193,230"/>
<area shape="poly" title=" " alt="" coords="809,502,230,499,230,493,809,496"/>
<area shape="poly" title=" " alt="" coords="809,496,515,466,482,462,483,457,515,461,809,490"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a12c644fb0c26d71dff162e574593230e" title=" " alt="" coords="1023,432,1231,466"/>
<area shape="poly" title=" " alt="" coords="955,482,1027,467,1028,472,956,487"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a1fada8bd25495e270df90e58db6890f1" title=" " alt="" coords="1045,489,1209,523"/>
<area shape="poly" title=" " alt="" coords="956,499,1029,501,1029,506,956,504"/>
<area shape="poly" title=" " alt="" coords="1023,451,483,448,483,443,1023,446"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#aecc20c7d8b2e298820356d8e32eb4f4a" title=" " alt="" coords="1279,517,1467,551"/>
<area shape="poly" title=" " alt="" coords="1210,513,1264,519,1263,524,1209,518"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a3212416f7b63427063c564bdedd8b645" title=" " alt="" coords="1279,460,1467,494"/>
<area shape="poly" title=" " alt="" coords="1209,494,1263,487,1264,493,1210,499"/>
</map>
</div>

</div>
</div>
<a id="a1fada8bd25495e270df90e58db6890f1" name="a1fada8bd25495e270df90e58db6890f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fada8bd25495e270df90e58db6890f1">&#9670;&#160;</a></span>elf_find_section()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int elf_find_section </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>map</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *</td>          <td class="paramname"><span class="paramname"><em>offset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *</td>          <td class="paramname"><span class="paramname"><em>size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *</td>          <td class="paramname"><span class="paramname"><em>vaddr</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/elf_8c_source.html#l00151">151</a> of file <a class="el" href="../../d2/da6/elf_8c_source.html">elf.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  152</span>{</div>
<div class="line"><span class="lineno">  153</span>    <span class="keywordtype">int</span> clazz = map[EI_CLASS];</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordflow">if</span> (clazz == ELFCLASS32)</div>
<div class="line"><span class="lineno">  156</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#aecc20c7d8b2e298820356d8e32eb4f4a">elf32_find_section</a>(map, <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, offset, size, vaddr);</div>
<div class="line"><span class="lineno">  157</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (clazz == ELFCLASS64)</div>
<div class="line"><span class="lineno">  158</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a3212416f7b63427063c564bdedd8b645">elf64_find_section</a>(map, <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, offset, size, vaddr);</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>    <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;unknown elf format %d\n&quot;</span>, clazz);</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  163</span>}</div>
<div class="ttc" id="aelf_8c_html_a3212416f7b63427063c564bdedd8b645"><div class="ttname"><a href="#a3212416f7b63427063c564bdedd8b645">elf64_find_section</a></div><div class="ttdeci">static int elf64_find_section(const char *map, unsigned int type, unsigned long *offset, unsigned long *size, unsigned long *vaddr)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/da6/elf_8c_source.html#l00105">elf.c:105</a></div></div>
<div class="ttc" id="aelf_8c_html_aecc20c7d8b2e298820356d8e32eb4f4a"><div class="ttname"><a href="#aecc20c7d8b2e298820356d8e32eb4f4a">elf32_find_section</a></div><div class="ttdeci">static int elf32_find_section(const char *map, unsigned int type, unsigned long *offset, unsigned long *size, unsigned long *vaddr)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/da6/elf_8c_source.html#l00128">elf.c:128</a></div></div>
<div class="ttc" id="aprocd_2jail_2log_8h_html_a15378cd15bafb3a79061424b452497aa"><div class="ttname"><a href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a></div><div class="ttdeci">#define ERROR(fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">log.h:27</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/da6/elf_8c_source.html#l00128">elf32_find_section()</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00105">elf64_find_section()</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, and <a class="el" href="../../dd/d8f/udebug-proto_8h_source.html#l00000">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/da6/elf_8c_source.html#l00233">elf_load_deps()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/da6/elf_8c_a1fada8bd25495e270df90e58db6890f1_cgraph.png" border="0" usemap="#ad2/da6/elf_8c_a1fada8bd25495e270df90e58db6890f1_cgraph" alt=""/></div>
<map name="ad2/da6/elf_8c_a1fada8bd25495e270df90e58db6890f1_cgraph" id="ad2/da6/elf_8c_a1fada8bd25495e270df90e58db6890f1_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,170,68"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#aecc20c7d8b2e298820356d8e32eb4f4a" title=" " alt="" coords="218,5,406,39"/>
<area shape="poly" title=" " alt="" coords="170,38,202,34,202,39,170,43"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a3212416f7b63427063c564bdedd8b645" title=" " alt="" coords="218,63,406,96"/>
<area shape="poly" title=" " alt="" coords="170,59,202,63,202,68,170,64"/>
</map>
</div>

</div>
</div>
<a id="a48837326349fc40e7a38f613d853f8f2" name="a48837326349fc40e7a38f613d853f8f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48837326349fc40e7a38f613d853f8f2">&#9670;&#160;</a></span>elf_load_deps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int elf_load_deps </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>map</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/elf_8c_source.html#l00233">233</a> of file <a class="el" href="../../d2/da6/elf_8c_source.html">elf.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  234</span>{</div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> dyn_offset, dyn_size;</div>
<div class="line"><span class="lineno">  236</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> load_offset, load_vaddr;</div>
<div class="line"><span class="lineno">  237</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> interp_offset;</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="#a1fada8bd25495e270df90e58db6890f1">elf_find_section</a>(map, PT_INTERP, &amp;interp_offset, NULL, NULL) == 0) {</div>
<div class="line"><span class="lineno">  240</span>        <a class="code hl_function" href="../../df/d26/fs_8h.html#a3c2c8ec14a25736480de113e1b71f52d">add_path_and_deps</a>(map+interp_offset, 1, -1, 0);</div>
<div class="line"><span class="lineno">  241</span>    }</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="#a1fada8bd25495e270df90e58db6890f1">elf_find_section</a>(map, PT_LOAD, &amp;load_offset, NULL, &amp;load_vaddr)) {</div>
<div class="line"><span class="lineno">  244</span>        <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;failed to load the .load section from %s\n&quot;</span>, <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>);</div>
<div class="line"><span class="lineno">  245</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  246</span>    }</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="#a1fada8bd25495e270df90e58db6890f1">elf_find_section</a>(map, PT_DYNAMIC, &amp;dyn_offset, &amp;dyn_size, NULL)) {</div>
<div class="line"><span class="lineno">  249</span>        <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;failed to load the .dynamic section from %s\n&quot;</span>, <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>);</div>
<div class="line"><span class="lineno">  250</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  251</span>    }</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>    <span class="keywordtype">int</span> clazz = map[EI_CLASS];</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span>    <span class="keywordflow">if</span> (clazz == ELFCLASS32)</div>
<div class="line"><span class="lineno">  256</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a12c644fb0c26d71dff162e574593230e">elf32_scan_dynamic</a>(map, dyn_offset, dyn_size, load_vaddr - load_offset);</div>
<div class="line"><span class="lineno">  257</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (clazz == ELFCLASS64)</div>
<div class="line"><span class="lineno">  258</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a0ac3dca93dd7aead60876faae920be80">elf64_scan_dynamic</a>(map, dyn_offset, dyn_size, load_vaddr - load_offset);</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>    <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;unknown elf format %d\n&quot;</span>, clazz);</div>
<div class="line"><span class="lineno">  261</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  262</span>}</div>
<div class="ttc" id="aelf_8c_html_a0ac3dca93dd7aead60876faae920be80"><div class="ttname"><a href="#a0ac3dca93dd7aead60876faae920be80">elf64_scan_dynamic</a></div><div class="ttdeci">static int elf64_scan_dynamic(const char *map, unsigned long dyn_offset, unsigned long dyn_size, long load_offset)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/da6/elf_8c_source.html#l00199">elf.c:199</a></div></div>
<div class="ttc" id="aelf_8c_html_a12c644fb0c26d71dff162e574593230e"><div class="ttname"><a href="#a12c644fb0c26d71dff162e574593230e">elf32_scan_dynamic</a></div><div class="ttdeci">static int elf32_scan_dynamic(const char *map, unsigned long dyn_offset, unsigned long dyn_size, long load_offset)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/da6/elf_8c_source.html#l00165">elf.c:165</a></div></div>
<div class="ttc" id="aelf_8c_html_a1fada8bd25495e270df90e58db6890f1"><div class="ttname"><a href="#a1fada8bd25495e270df90e58db6890f1">elf_find_section</a></div><div class="ttdeci">static int elf_find_section(const char *map, unsigned int type, unsigned long *offset, unsigned long *size, unsigned long *vaddr)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/da6/elf_8c_source.html#l00151">elf.c:151</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../df/d26/fs_8h_source.html#l00027">add_path_and_deps()</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00165">elf32_scan_dynamic()</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00199">elf64_scan_dynamic()</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00151">elf_find_section()</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, and <a class="el" href="../../df/d0e/ubusd__obj_8c_source.html#l00019">path</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d5a/fs_8c_source.html#l00486">add_2paths_and_deps()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/da6/elf_8c_a48837326349fc40e7a38f613d853f8f2_cgraph.png" border="0" usemap="#ad2/da6/elf_8c_a48837326349fc40e7a38f613d853f8f2_cgraph" alt=""/></div>
<map name="ad2/da6/elf_8c_a48837326349fc40e7a38f613d853f8f2_cgraph" id="ad2/da6/elf_8c_a48837326349fc40e7a38f613d853f8f2_cgraph">
<area shape="rect" title=" " alt="" coords="5,215,152,248"/>
<area shape="rect" href="../../df/d26/fs_8h.html#a3c2c8ec14a25736480de113e1b71f52d" title=" " alt="" coords="456,159,661,192"/>
<area shape="poly" title=" " alt="" coords="95,212,139,174,168,156,199,142,236,133,275,128,354,128,427,137,490,152,489,157,426,143,353,133,276,133,237,138,201,147,170,161,142,179,98,216"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a12c644fb0c26d71dff162e574593230e" title=" " alt="" coords="200,157,408,191"/>
<area shape="poly" title=" " alt="" coords="147,212,219,193,221,198,148,217"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a0ac3dca93dd7aead60876faae920be80" title=" " alt="" coords="200,215,408,248"/>
<area shape="poly" title=" " alt="" coords="152,229,184,229,184,234,152,234"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a1fada8bd25495e270df90e58db6890f1" title=" " alt="" coords="222,324,386,358"/>
<area shape="poly" title=" " alt="" coords="106,247,150,274,201,302,233,316,231,321,199,307,147,279,103,251"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#ac4992c3c85512f44840f4eda86df97b5" title=" " alt="" coords="709,268,937,302"/>
<area shape="poly" title=" " alt="" coords="602,190,767,259,765,264,600,195"/>
<area shape="poly" title=" " alt="" coords="709,290,473,286,336,278,199,263,155,255,156,250,200,258,336,273,474,281,709,285"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4824ede62a9ceedb153f039c5dc212f9" title=" " alt="" coords="985,325,1169,359"/>
<area shape="poly" title=" " alt="" coords="901,300,985,319,984,324,900,305"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e08d7ee7d67ff58eeea30dd8a9356d1" title=" " alt="" coords="1588,380,1682,414"/>
<area shape="poly" title=" " alt="" coords="849,300,909,337,946,355,985,369,1066,387,1149,400,1232,407,1313,410,1461,408,1572,401,1573,406,1461,414,1313,416,1232,412,1148,405,1065,392,984,374,944,360,907,342,846,304"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a2b2c9415458859df2a4ed2558f53db56" title=" " alt="" coords="986,159,1168,192"/>
<area shape="poly" title=" " alt="" coords="860,265,984,209,1015,196,1017,201,986,214,862,270"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a5601edf43bf58289cb22c5b20d17a1e9" title=" " alt="" coords="1217,213,1349,247"/>
<area shape="poly" title=" " alt="" coords="911,265,984,253,1098,240,1201,232,1202,238,1098,246,985,258,911,270"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a9ae7cc745a41248c9f0d9bbb83a86a43" title=" " alt="" coords="1028,268,1126,302"/>
<area shape="poly" title=" " alt="" coords="937,282,1012,282,1012,288,937,288"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2" title=" " alt="" coords="1221,325,1346,359"/>
<area shape="poly" title=" " alt="" coords="1169,340,1205,340,1205,345,1169,345"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a6a335418ee05d0ecbda2094c55408404" title=" " alt="" coords="1397,325,1532,359"/>
<area shape="poly" title=" " alt="" coords="1346,340,1382,340,1382,345,1346,345"/>
<area shape="poly" title=" " alt="" coords="1520,357,1574,375,1573,380,1519,362"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab9041e08938920d5ae722e2d57dc20e2" title=" " alt="" coords="1580,213,1690,247"/>
<area shape="poly" title=" " alt="" coords="1491,322,1593,254,1596,258,1494,327"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a55d3dbabb73970f597eff3d04809f4ef" title=" " alt="" coords="1762,392,1892,426"/>
<area shape="poly" title=" " alt="" coords="1682,397,1747,401,1746,406,1682,402"/>
<area shape="poly" title=" " alt="" coords="1792,393,1788,383,1794,373,1807,367,1827,365,1849,368,1862,374,1859,379,1848,373,1827,371,1808,373,1797,377,1794,383,1797,391"/>
<area shape="poly" title=" " alt="" coords="1649,246,1686,298,1712,327,1740,355,1779,382,1776,386,1736,359,1708,331,1682,301,1645,249"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#abd4899daa8ad959e6c9694dd5e4132a8" title=" " alt="" coords="1746,201,1908,235"/>
<area shape="poly" title=" " alt="" coords="1690,224,1731,222,1731,227,1691,229"/>
<area shape="rect" href="../../da/d23/list_8h.html#a875b53c95596d9e8df15ac54f6d24ae6" title=" " alt="" coords="2000,253,2093,287"/>
<area shape="poly" title=" " alt="" coords="1691,238,1738,245,1870,257,1985,265,1985,270,1870,263,1738,250,1690,243"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab6f5b72e706a1955a5a5d6af278c677e" title=" " alt="" coords="1738,311,1916,344"/>
<area shape="poly" title=" " alt="" coords="1664,245,1739,289,1767,302,1765,307,1737,294,1661,250"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a6de877c20c7b55fa52c80e7be87715fa" title=" " alt="" coords="1778,5,1876,39"/>
<area shape="poly" title=" " alt="" coords="1639,212,1651,178,1671,134,1699,88,1736,48,1762,33,1765,38,1740,52,1703,91,1676,136,1656,180,1644,214"/>
<area shape="rect" href="../../da/d23/list_8h.html#abb4dd1eb7346eb35ea621351220e80ce" title=" " alt="" coords="1770,63,1884,96"/>
<area shape="poly" title=" " alt="" coords="1644,211,1680,159,1706,130,1737,105,1755,95,1757,100,1739,110,1710,134,1684,163,1648,214"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a212673459e8e8ff2e11a8d093602d35e" title=" " alt="" coords="1766,144,1889,178"/>
<area shape="poly" title=" " alt="" coords="1676,210,1737,186,1754,180,1756,185,1739,191,1678,215"/>
<area shape="poly" title=" " alt="" coords="1902,233,1986,253,1985,258,1901,238"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="2177,281,2278,315"/>
<area shape="poly" title=" " alt="" coords="2094,275,2162,285,2161,291,2093,280"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="1982,311,2111,344"/>
<area shape="poly" title=" " alt="" coords="1917,325,1967,325,1967,330,1917,330"/>
<area shape="poly" title=" " alt="" coords="2111,314,2161,306,2161,311,2112,320"/>
<area shape="poly" title=" " alt="" coords="1792,145,1788,135,1794,125,1807,119,1827,117,1849,120,1862,126,1859,131,1848,125,1827,123,1808,125,1797,129,1794,135,1797,143"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a67b3db37af2f8ebc4f6895202c358604" title=" " alt="" coords="1972,113,2121,147"/>
<area shape="poly" title=" " alt="" coords="1889,150,1956,140,1957,145,1890,155"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab84f86be5fe7f7abcf8ffb6fa0a38700" title=" " alt="" coords="1964,171,2129,204"/>
<area shape="poly" title=" " alt="" coords="1890,166,1949,173,1948,178,1889,171"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#aaf08ec177405c5e004b1ca33808f19da" title=" " alt="" coords="2179,171,2276,204"/>
<area shape="poly" title=" " alt="" coords="2103,145,2165,165,2163,170,2101,150"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e2d83bace7533ed4cc93bdf2a94ad95" title=" " alt="" coords="2181,113,2274,147"/>
<area shape="poly" title=" " alt="" coords="2121,128,2166,128,2166,133,2121,133"/>
<area shape="poly" title=" " alt="" coords="2129,185,2163,185,2163,190,2129,190"/>
<area shape="poly" title=" " alt="" coords="2101,168,2166,147,2167,152,2103,173"/>
<area shape="poly" title=" " alt="" coords="986,178,677,178,677,173,986,173"/>
<area shape="poly" title=" " alt="" coords="1350,228,1564,228,1564,233,1350,233"/>
<area shape="poly" title=" " alt="" coords="408,172,440,172,440,178,408,177"/>
<area shape="poly" title=" " alt="" coords="383,211,463,194,465,199,384,217"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#aecc20c7d8b2e298820356d8e32eb4f4a" title=" " alt="" coords="465,324,653,358"/>
<area shape="poly" title=" " alt="" coords="386,338,449,338,449,344,386,344"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a3212416f7b63427063c564bdedd8b645" title=" " alt="" coords="465,381,653,415"/>
<area shape="poly" title=" " alt="" coords="382,356,467,375,465,380,381,361"/>
</map>
</div>

</div>
</div>
<a id="aefdad32a1f287a539e1d6f6d31301e4e" name="aefdad32a1f287a539e1d6f6d31301e4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefdad32a1f287a539e1d6f6d31301e4e">&#9670;&#160;</a></span>find_lib()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * find_lib </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>file</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/elf_8c_source.html#l00094">94</a> of file <a class="el" href="../../d2/da6/elf_8c_source.html">elf.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   95</span>{</div>
<div class="line"><span class="lineno">   96</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d1/d9e/elf_8h.html#d3/d23/structlibrary">library</a> *l;</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>    l = <a class="code hl_define" href="../../d3/d51/avl_8h.html#a65bfca92c030dd0ea5548f23de5fc07e">avl_find_element</a>(&amp;<a class="code hl_variable" href="#ad5cd1529b1d09e1fefb94edad826fe2b">libraries</a>, file, l, <a class="code hl_variable" href="../../d1/d9e/elf_8h.html#a0b3d6c6db266ef4533eee4c840a713be">avl</a>);</div>
<div class="line"><span class="lineno">   99</span>    <span class="keywordflow">if</span> (!l)</div>
<div class="line"><span class="lineno">  100</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>    <span class="keywordflow">return</span> l-&gt;<a class="code hl_variable" href="../../d1/d9e/elf_8h.html#ac8db6c3d0fa3f4c42e13f8281aab15da">path</a>;</div>
<div class="line"><span class="lineno">  103</span>}</div>
<div class="ttc" id="aavl_8h_html_a65bfca92c030dd0ea5548f23de5fc07e"><div class="ttname"><a href="../../d3/d51/avl_8h.html#a65bfca92c030dd0ea5548f23de5fc07e">avl_find_element</a></div><div class="ttdeci">#define avl_find_element(tree, key, element, node_element)</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d51/avl_8h_source.html#l00240">avl.h:240</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d9e/elf_8h_source.html#l00020">library::avl</a>, <a class="el" href="../../d3/d51/avl_8h_source.html#l00240">avl_find_element</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00029">libraries</a>, and <a class="el" href="../../d1/d9e/elf_8h_source.html#l00022">library::path</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00959">build_envp()</a>.</p>

</div>
</div>
<a id="abb68ed1aa9f416ea5f299d7672a3b5c1" name="abb68ed1aa9f416ea5f299d7672a3b5c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb68ed1aa9f416ea5f299d7672a3b5c1">&#9670;&#160;</a></span>free_library_search()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_library_search </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/elf_8c_source.html#l00319">319</a> of file <a class="el" href="../../d2/da6/elf_8c_source.html">elf.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  320</span>{</div>
<div class="line"><span class="lineno">  321</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d1/d9e/elf_8h.html#df/dad/structlibrary__path">library_path</a> *p, *ptmp;</div>
<div class="line"><span class="lineno">  322</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d1/d9e/elf_8h.html#d3/d23/structlibrary">library</a> *l, *tmp;</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>    <a class="code hl_define" href="../../da/d23/list_8h.html#a698670b36c7c0ca13822698ee825ddc8">list_for_each_entry_safe</a>(p, ptmp, &amp;library_paths, list)</div>
<div class="line"><span class="lineno">  325</span>        free(p);</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>    <a class="code hl_define" href="../../d3/d51/avl_8h.html#af8b3ca3843e7a4bb3bc80858f53c2ad5">avl_remove_all_elements</a>(&amp;<a class="code hl_variable" href="#ad5cd1529b1d09e1fefb94edad826fe2b">libraries</a>, l, <a class="code hl_variable" href="../../d1/d9e/elf_8h.html#a0b3d6c6db266ef4533eee4c840a713be">avl</a>, tmp)</div>
<div class="line"><span class="lineno">  328</span>        free(l);</div>
<div class="line"><span class="lineno">  329</span>}</div>
<div class="ttc" id="aavl_8h_html_af8b3ca3843e7a4bb3bc80858f53c2ad5"><div class="ttname"><a href="../../d3/d51/avl_8h.html#af8b3ca3843e7a4bb3bc80858f53c2ad5">avl_remove_all_elements</a></div><div class="ttdeci">#define avl_remove_all_elements(tree, element, node_member, ptr)</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d51/avl_8h_source.html#l00545">avl.h:545</a></div></div>
<div class="ttc" id="alist_8h_html_a698670b36c7c0ca13822698ee825ddc8"><div class="ttname"><a href="../../da/d23/list_8h.html#a698670b36c7c0ca13822698ee825ddc8">list_for_each_entry_safe</a></div><div class="ttdeci">#define list_for_each_entry_safe(p, n, h, field)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d23/list_8h_source.html#l00146">list.h:146</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d9e/elf_8h_source.html#l00020">library::avl</a>, <a class="el" href="../../d3/d51/avl_8h_source.html#l00545">avl_remove_all_elements</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00029">libraries</a>, and <a class="el" href="../../da/d23/list_8h_source.html#l00146">list_for_each_entry_safe</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00254">free_opts()</a>.</p>

</div>
</div>
<a id="ab5c6746a1010af2033a89a248fc0c2d3" name="ab5c6746a1010af2033a89a248fc0c2d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5c6746a1010af2033a89a248fc0c2d3">&#9670;&#160;</a></span>init_library_search()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_library_search </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/elf_8c_source.html#l00310">310</a> of file <a class="el" href="../../d2/da6/elf_8c_source.html">elf.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  311</span>{</div>
<div class="line"><span class="lineno">  312</span>    <a class="code hl_function" href="../../df/dc2/avl_8c.html#af44d4960ede7f23f071bf00e360bc23d">avl_init</a>(&amp;<a class="code hl_variable" href="#ad5cd1529b1d09e1fefb94edad826fe2b">libraries</a>, <a class="code hl_function" href="../../d2/d66/avl-cmp_8c.html#ae22a4fecfc8234279efe5ce4f38838f0">avl_strcmp</a>, <span class="keyword">false</span>, NULL);</div>
<div class="line"><span class="lineno">  313</span>    <a class="code hl_function" href="#a3640146373568deef10feba467965bb9">alloc_library_path</a>(<span class="stringliteral">&quot;/lib&quot;</span>);</div>
<div class="line"><span class="lineno">  314</span>    <a class="code hl_function" href="#a3640146373568deef10feba467965bb9">alloc_library_path</a>(<span class="stringliteral">&quot;/lib64&quot;</span>);</div>
<div class="line"><span class="lineno">  315</span>    <a class="code hl_function" href="#a3640146373568deef10feba467965bb9">alloc_library_path</a>(<span class="stringliteral">&quot;/usr/lib&quot;</span>);</div>
<div class="line"><span class="lineno">  316</span>    <a class="code hl_function" href="#a804281d8e0faf31dd192190cea41c371">load_ldso_conf</a>(<span class="stringliteral">&quot;/etc/ld.so.conf&quot;</span>);</div>
<div class="line"><span class="lineno">  317</span>}</div>
<div class="ttc" id="aavl-cmp_8c_html_ae22a4fecfc8234279efe5ce4f38838f0"><div class="ttname"><a href="../../d2/d66/avl-cmp_8c.html#ae22a4fecfc8234279efe5ce4f38838f0">avl_strcmp</a></div><div class="ttdeci">int avl_strcmp(const void *k1, const void *k2, void *ptr)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d66/avl-cmp_8c_source.html#l00026">avl-cmp.c:26</a></div></div>
<div class="ttc" id="aavl_8c_html_af44d4960ede7f23f071bf00e360bc23d"><div class="ttname"><a href="../../df/dc2/avl_8c.html#af44d4960ede7f23f071bf00e360bc23d">avl_init</a></div><div class="ttdeci">void avl_init(struct avl_tree *tree, avl_tree_comp comp, bool allow_dups, void *ptr)</div><div class="ttdef"><b>Definition</b> <a href="../../df/dc2/avl_8c_source.html#l00092">avl.c:92</a></div></div>
<div class="ttc" id="aelf_8c_html_a3640146373568deef10feba467965bb9"><div class="ttname"><a href="#a3640146373568deef10feba467965bb9">alloc_library_path</a></div><div class="ttdeci">static void alloc_library_path(const char *path)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/da6/elf_8c_source.html#l00032">elf.c:32</a></div></div>
<div class="ttc" id="aelf_8c_html_a804281d8e0faf31dd192190cea41c371"><div class="ttname"><a href="#a804281d8e0faf31dd192190cea41c371">load_ldso_conf</a></div><div class="ttdeci">static void load_ldso_conf(const char *conf)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/da6/elf_8c_source.html#l00264">elf.c:264</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/da6/elf_8c_source.html#l00032">alloc_library_path()</a>, <a class="el" href="../../df/dc2/avl_8c_source.html#l00092">avl_init()</a>, <a class="el" href="../../d2/d66/avl-cmp_8c_source.html#l00026">avl_strcmp()</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00029">libraries</a>, and <a class="el" href="../../d2/da6/elf_8c_source.html#l00264">load_ldso_conf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02583">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/da6/elf_8c_ab5c6746a1010af2033a89a248fc0c2d3_cgraph.png" border="0" usemap="#ad2/da6/elf_8c_ab5c6746a1010af2033a89a248fc0c2d3_cgraph" alt=""/></div>
<map name="ad2/da6/elf_8c_ab5c6746a1010af2033a89a248fc0c2d3_cgraph" id="ad2/da6/elf_8c_ab5c6746a1010af2033a89a248fc0c2d3_cgraph">
<area shape="rect" title=" " alt="" coords="5,88,195,122"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a3640146373568deef10feba467965bb9" title=" " alt="" coords="447,129,630,163"/>
<area shape="poly" title=" " alt="" coords="195,94,294,91,399,100,441,109,481,121,479,126,440,114,399,105,294,97,195,99"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#af44d4960ede7f23f071bf00e360bc23d" title=" " alt="" coords="278,5,364,39"/>
<area shape="poly" title=" " alt="" coords="146,85,262,41,264,46,148,90"/>
<area shape="rect" href="../../d2/d66/avl-cmp_8c.html#ae22a4fecfc8234279efe5ce4f38838f0" title=" " alt="" coords="260,115,382,148"/>
<area shape="poly" title=" " alt="" coords="195,114,245,120,245,125,195,119"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a804281d8e0faf31dd192190cea41c371" title=" " alt="" coords="243,196,399,230"/>
<area shape="poly" title=" " alt="" coords="138,120,272,186,269,191,135,125"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="678,129,808,163"/>
<area shape="poly" title=" " alt="" coords="631,144,663,144,663,149,631,149"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="856,129,957,163"/>
<area shape="poly" title=" " alt="" coords="808,144,840,144,840,149,808,149"/>
<area shape="rect" href="../../da/d23/list_8h.html#aea85dd50b9129ddaa3e3c67ed55804e4" title=" " alt="" coords="455,5,623,39"/>
<area shape="poly" title=" " alt="" coords="364,20,439,20,439,25,364,25"/>
<area shape="poly" title=" " alt="" coords="377,193,466,166,467,171,379,198"/>
<area shape="poly" title=" " alt="" coords="282,197,277,187,283,177,298,171,321,169,346,172,360,178,357,183,344,177,321,175,299,177,287,181,283,187,286,195"/>
</map>
</div>

</div>
</div>
<a id="a9ae7cc745a41248c9f0d9bbb83a86a43" name="a9ae7cc745a41248c9f0d9bbb83a86a43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ae7cc745a41248c9f0d9bbb83a86a43">&#9670;&#160;</a></span>lib_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int lib_open </td>
          <td>(</td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>fullpath</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>file</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/elf_8c_source.html#l00074">74</a> of file <a class="el" href="../../d2/da6/elf_8c_source.html">elf.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   75</span>{</div>
<div class="line"><span class="lineno">   76</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d1/d9e/elf_8h.html#df/dad/structlibrary__path">library_path</a> *p;</div>
<div class="line"><span class="lineno">   77</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>[PATH_MAX];</div>
<div class="line"><span class="lineno">   78</span>    <span class="keywordtype">int</span> fd = -1;</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>    *fullpath = NULL;</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>    <a class="code hl_define" href="../../da/d23/list_8h.html#a6b4019bb70de70adc3caddbe3a024c27">list_for_each_entry</a>(p, &amp;library_paths, <a class="code hl_variable" href="../../d1/d9e/elf_8h.html#a4df2c3eefaa9988d446262e68f08795b">list</a>) {</div>
<div class="line"><span class="lineno">   83</span>        snprintf(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>), <span class="stringliteral">&quot;%s/%s&quot;</span>, p-&gt;<a class="code hl_variable" href="../../d1/d9e/elf_8h.html#a0b00cf25b7f124d14fcebe0840ae2725">path</a>, file);</div>
<div class="line"><span class="lineno">   84</span>        fd = open(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, O_RDONLY|O_CLOEXEC);</div>
<div class="line"><span class="lineno">   85</span>        <span class="keywordflow">if</span> (fd &gt;= 0) {</div>
<div class="line"><span class="lineno">   86</span>            *fullpath = strdup(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>);</div>
<div class="line"><span class="lineno">   87</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   88</span>        }</div>
<div class="line"><span class="lineno">   89</span>    }</div>
<div class="line"><span class="lineno">   90</span> </div>
<div class="line"><span class="lineno">   91</span>    <span class="keywordflow">return</span> fd;</div>
<div class="line"><span class="lineno">   92</span>}</div>
<div class="ttc" id="alist_8h_html_a6b4019bb70de70adc3caddbe3a024c27"><div class="ttname"><a href="../../da/d23/list_8h.html#a6b4019bb70de70adc3caddbe3a024c27">list_for_each_entry</a></div><div class="ttdeci">#define list_for_each_entry(p, h, field)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d23/list_8h_source.html#l00132">list.h:132</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d9e/elf_8h_source.html#l00026">library_path::list</a>, <a class="el" href="../../da/d23/list_8h_source.html#l00132">list_for_each_entry</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00027">library_path::path</a>, and <a class="el" href="../../df/d0e/ubusd__obj_8c_source.html#l00019">path</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d5a/fs_8c_source.html#l00486">add_2paths_and_deps()</a>.</p>

</div>
</div>
<a id="a7dff13cf5aa3876c471a5f2c7d7d5cec" name="a7dff13cf5aa3876c471a5f2c7d7d5cec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dff13cf5aa3876c471a5f2c7d7d5cec">&#9670;&#160;</a></span>LIST_HEAD()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static LIST_HEAD </td>
          <td>(</td>
          <td class="paramtype">library_paths</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a804281d8e0faf31dd192190cea41c371" name="a804281d8e0faf31dd192190cea41c371"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a804281d8e0faf31dd192190cea41c371">&#9670;&#160;</a></span>load_ldso_conf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void load_ldso_conf </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>conf</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/elf_8c_source.html#l00264">264</a> of file <a class="el" href="../../d2/da6/elf_8c_source.html">elf.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  265</span>{</div>
<div class="line"><span class="lineno">  266</span>    FILE* fp = fopen(<a class="code hl_variable" href="../../da/dc0/uxc_8c.html#ae5511ac79f463b84683d8cbfb4e01430">conf</a>, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno">  267</span>    <span class="keywordtype">char</span> line[PATH_MAX];</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>    <span class="keywordflow">if</span> (!fp) {</div>
<div class="line"><span class="lineno">  270</span>        <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;failed to open %s\n&quot;</span>, <a class="code hl_variable" href="../../da/dc0/uxc_8c.html#ae5511ac79f463b84683d8cbfb4e01430">conf</a>);</div>
<div class="line"><span class="lineno">  271</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  272</span>    }</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>    <span class="keywordflow">while</span> (!feof(fp)) {</div>
<div class="line"><span class="lineno">  275</span>        <span class="keywordtype">int</span> len;</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>        <span class="keywordflow">if</span> (!fgets(line, <span class="keyword">sizeof</span>(line), fp))</div>
<div class="line"><span class="lineno">  278</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  279</span>        len = strlen(line);</div>
<div class="line"><span class="lineno">  280</span>        <span class="keywordflow">if</span> (len &lt; 2)</div>
<div class="line"><span class="lineno">  281</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  282</span>        <span class="keywordflow">if</span> (*line == <span class="charliteral">&#39;#&#39;</span>)</div>
<div class="line"><span class="lineno">  283</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  284</span>        <span class="keywordflow">if</span> (line[len - 1] == <span class="charliteral">&#39;\n&#39;</span>)</div>
<div class="line"><span class="lineno">  285</span>            line[len - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  286</span>        <span class="keywordflow">if</span> (!strncmp(line, <span class="stringliteral">&quot;include &quot;</span>, 8)) {</div>
<div class="line"><span class="lineno">  287</span>            <span class="keywordtype">char</span> *sep = strstr(line, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><span class="lineno">  288</span>            glob_t gl;</div>
<div class="line"><span class="lineno">  289</span>            <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span>            <span class="keywordflow">if</span> (!sep)</div>
<div class="line"><span class="lineno">  292</span>                <span class="keywordflow">continue</span>;;</div>
<div class="line"><span class="lineno">  293</span>            <span class="keywordflow">while</span> (*sep == <span class="charliteral">&#39; &#39;</span>)</div>
<div class="line"><span class="lineno">  294</span>                sep++;</div>
<div class="line"><span class="lineno">  295</span>            <span class="keywordflow">if</span> (glob(sep, GLOB_NOESCAPE | GLOB_MARK, NULL, &amp;gl)) {</div>
<div class="line"><span class="lineno">  296</span>                <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;glob failed on %s\n&quot;</span>, sep);</div>
<div class="line"><span class="lineno">  297</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  298</span>            }</div>
<div class="line"><span class="lineno">  299</span>            <span class="keywordflow">for</span> (i = 0; i &lt; gl.gl_pathc; i++)</div>
<div class="line"><span class="lineno">  300</span>                <a class="code hl_function" href="#a804281d8e0faf31dd192190cea41c371">load_ldso_conf</a>(gl.gl_pathv[i]);</div>
<div class="line"><span class="lineno">  301</span>            globfree(&amp;gl);</div>
<div class="line"><span class="lineno">  302</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  303</span>            <a class="code hl_function" href="#a3640146373568deef10feba467965bb9">alloc_library_path</a>(line);</div>
<div class="line"><span class="lineno">  304</span>        }</div>
<div class="line"><span class="lineno">  305</span>    }</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>    fclose(fp);</div>
<div class="line"><span class="lineno">  308</span>}</div>
<div class="ttc" id="auxc_8c_html_ae5511ac79f463b84683d8cbfb4e01430"><div class="ttname"><a href="../../da/dc0/uxc_8c.html#ae5511ac79f463b84683d8cbfb4e01430">conf</a></div><div class="ttdeci">static struct blob_buf conf</div><div class="ttdef"><b>Definition</b> <a href="../../da/dc0/uxc_8c_source.html#l00104">uxc.c:104</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/da6/elf_8c_source.html#l00032">alloc_library_path()</a>, <a class="el" href="../../da/dc0/uxc_8c_source.html#l00104">conf</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, and <a class="el" href="../../d2/da6/elf_8c_source.html#l00264">load_ldso_conf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/da6/elf_8c_source.html#l00310">init_library_search()</a>, and <a class="el" href="../../d2/da6/elf_8c_source.html#l00264">load_ldso_conf()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/da6/elf_8c_a804281d8e0faf31dd192190cea41c371_cgraph.png" border="0" usemap="#ad2/da6/elf_8c_a804281d8e0faf31dd192190cea41c371_cgraph" alt=""/></div>
<map name="ad2/da6/elf_8c_a804281d8e0faf31dd192190cea41c371_cgraph" id="ad2/da6/elf_8c_a804281d8e0faf31dd192190cea41c371_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,162,63"/>
<area shape="poly" title=" " alt="" coords="44,30,40,20,46,11,60,5,84,3,108,5,122,12,120,16,107,10,83,8,62,10,49,15,45,20,49,28"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a3640146373568deef10feba467965bb9" title=" " alt="" coords="210,29,393,63"/>
<area shape="poly" title=" " alt="" coords="162,44,194,44,194,49,162,49"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="441,29,570,63"/>
<area shape="poly" title=" " alt="" coords="393,44,425,44,425,49,393,49"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="618,29,720,63"/>
<area shape="poly" title=" " alt="" coords="571,44,603,44,603,49,571,49"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad5cd1529b1d09e1fefb94edad826fe2b" name="ad5cd1529b1d09e1fefb94edad826fe2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5cd1529b1d09e1fefb94edad826fe2b">&#9670;&#160;</a></span>libraries</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d3/d51/avl_8h.html#dd/d4a/structavl__tree">avl_tree</a> libraries</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/da6/elf_8c_source.html#l00029">29</a> of file <a class="el" href="../../d2/da6/elf_8c_source.html">elf.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d5a/fs_8c_source.html#l00486">add_2paths_and_deps()</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00056">alloc_library()</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00094">find_lib()</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00319">free_library_search()</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00310">init_library_search()</a>, and <a class="el" href="../../d2/d5a/fs_8c_source.html#l00429">mount_all()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
