<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>zbus: /home/g41797/CLionProjects/github.com/g41797/zbus/src/libs/procd/jail/fs.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">zbus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_87a455bccb09a92130c26a11a880c98a.html">libs</a></li><li class="navelem"><a class="el" href="../../dir_63350b749fcf74007a53c7c917c10773.html">procd</a></li><li class="navelem"><a class="el" href="../../dir_332eccd3a674db599d080e188d7046bc.html">jail</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">fs.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d1/d9e/elf_8h_source.html">elf.h</a>&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;linux/limits.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;sys/mman.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;libgen.h&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d3/d51/avl_8h_source.html">libubox/avl.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d8/d47/avl-cmp_8h_source.html">libubox/avl-cmp.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../dd/dad/blobmsg_8h_source.html">libubox/blobmsg.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../da/d23/list_8h_source.html">libubox/list.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d5/d1d/libubox_2utils_8h_source.html">libubox/utils.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="../../df/d26/fs_8h_source.html">fs.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/d88/jail_8h_source.html">jail.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html">log.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for fs.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d4/d4f/fs_8c__incl.png" border="0" usemap="#a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2procd_2jail_2fs_8c" alt=""/></div>
<map name="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2procd_2jail_2fs_8c" id="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2procd_2jail_2fs_8c">
<area shape="rect" title=" " alt="" coords="928,5,1214,85"/>
<area shape="rect" title=" " alt="" coords="5,133,102,167"/>
<area shape="poly" title=" " alt="" coords="927,56,560,83,340,105,121,136,117,136,116,131,120,130,340,100,560,77,927,51"/>
<area shape="rect" href="../../d1/d9e/elf_8h.html" title=" " alt="" coords="405,133,465,167"/>
<area shape="poly" title=" " alt="" coords="928,66,721,94,491,136,481,138,480,133,490,130,720,89,927,60"/>
<area shape="rect" href="../../d3/d51/avl_8h.html" title=" " alt="" coords="177,215,317,248"/>
<area shape="poly" title=" " alt="" coords="927,60,632,89,493,111,436,123,393,135,361,150,330,169,278,207,275,202,327,164,358,146,391,131,435,118,492,105,631,84,927,54"/>
<area shape="rect" href="../../da/d23/list_8h.html" title=" " alt="" coords="136,296,203,330"/>
<area shape="poly" title=" " alt="" coords="927,51,797,57,644,72,482,97,402,114,324,136,232,160,197,179,182,194,167,216,160,231,158,248,162,281,157,281,153,248,155,230,162,213,178,191,194,174,230,155,322,130,400,109,481,92,644,66,797,52,927,45"/>
<area shape="rect" href="../../d8/d47/avl-cmp_8h.html" title=" " alt="" coords="341,215,529,248"/>
<area shape="poly" title=" " alt="" coords="928,52,839,60,742,75,643,100,548,135,522,150,499,168,460,205,456,201,495,164,520,146,546,131,641,94,741,70,838,55,927,47"/>
<area shape="rect" title=" " alt="" coords="530,378,617,412"/>
<area shape="poly" title=" " alt="" coords="928,55,866,65,802,80,739,103,682,135,656,158,634,185,617,215,604,247,586,311,578,363,573,362,581,309,599,245,612,213,630,182,652,154,679,131,737,98,801,75,865,59,927,50"/>
<area shape="rect" title=" " alt="" coords="1459,133,1539,167"/>
<area shape="poly" title=" " alt="" coords="1215,77,1441,130,1445,131,1443,137,1440,136,1214,82"/>
<area shape="rect" title=" " alt="" coords="1563,133,1704,167"/>
<area shape="poly" title=" " alt="" coords="1215,69,1548,130,1547,135,1214,75"/>
<area shape="rect" title=" " alt="" coords="882,378,972,412"/>
<area shape="poly" title=" " alt="" coords="1070,86,1053,219,1039,285,1021,331,1001,354,978,372,974,368,998,350,1017,329,1034,284,1048,218,1065,85"/>
<area shape="rect" title=" " alt="" coords="1114,378,1198,412"/>
<area shape="poly" title=" " alt="" coords="1084,85,1096,132,1152,362,1146,364,1091,134,1079,86"/>
<area shape="rect" title=" " alt="" coords="996,378,1090,412"/>
<area shape="poly" title=" " alt="" coords="1076,85,1078,196,1075,263,1067,331,1057,364,1052,363,1062,329,1070,263,1073,196,1071,85"/>
<area shape="rect" title=" " alt="" coords="1170,460,1281,493"/>
<area shape="poly" title=" " alt="" coords="1215,75,1272,99,1323,131,1344,152,1360,175,1370,201,1373,230,1373,315,1371,338,1363,359,1338,398,1304,429,1270,454,1267,449,1301,425,1334,394,1359,357,1366,336,1368,314,1368,230,1365,202,1355,177,1340,155,1320,135,1270,103,1213,80"/>
<area shape="rect" title=" " alt="" coords="1727,133,1863,167"/>
<area shape="poly" title=" " alt="" coords="1214,61,1444,90,1712,130,1711,135,1443,95,1214,66"/>
<area shape="rect" title=" " alt="" coords="1350,460,1448,493"/>
<area shape="poly" title=" " alt="" coords="1215,62,1289,83,1324,98,1356,116,1383,138,1405,164,1419,195,1424,230,1424,315,1419,385,1408,445,1403,444,1413,384,1419,314,1419,230,1414,196,1401,167,1380,142,1353,121,1321,103,1287,88,1214,67"/>
<area shape="rect" title=" " alt="" coords="1887,133,1983,167"/>
<area shape="poly" title=" " alt="" coords="1215,53,1514,80,1692,102,1872,130,1871,135,1691,107,1513,85,1214,58"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html" title=" " alt="" coords="814,215,1008,248"/>
<area shape="poly" title=" " alt="" coords="1039,87,936,205,932,201,1035,84"/>
<area shape="rect" href="../../d5/d1d/libubox_2utils_8h.html" title=" " alt="" coords="716,378,794,412"/>
<area shape="poly" title=" " alt="" coords="928,64,851,83,772,112,735,132,701,156,670,184,644,216,635,236,634,256,640,277,652,297,684,335,721,366,717,370,681,339,647,300,635,279,629,257,630,235,639,213,666,180,698,152,733,128,770,108,849,77,927,59"/>
<area shape="rect" href="../../df/d26/fs_8h.html" title=" " alt="" coords="883,133,939,167"/>
<area shape="poly" title=" " alt="" coords="1011,88,950,127,947,122,1008,83"/>
<area shape="rect" href="../../d2/d88/jail_8h.html" title=" " alt="" coords="2008,133,2073,167"/>
<area shape="poly" title=" " alt="" coords="1215,47,1373,54,1566,69,1778,93,1993,130,1992,136,1778,99,1565,74,1372,59,1214,52"/>
<area shape="rect" href="../../d8/d30/procd_2jail_2log_8h.html" title=" " alt="" coords="1200,133,1267,167"/>
<area shape="poly" title=" " alt="" coords="1135,83,1197,122,1194,127,1132,88"/>
<area shape="poly" title=" " alt="" coords="405,166,300,211,298,206,403,162"/>
<area shape="poly" title=" " alt="" coords="438,167,438,199,432,199,432,167"/>
<area shape="rect" title=" " alt="" coords="200,378,296,412"/>
<area shape="poly" title=" " alt="" coords="250,249,251,363,245,363,244,249"/>
<area shape="rect" title=" " alt="" coords="284,460,391,493"/>
<area shape="poly" title=" " alt="" coords="257,248,311,377,332,444,327,445,306,379,252,250"/>
<area shape="poly" title=" " alt="" coords="233,251,198,287,194,283,229,247"/>
<area shape="poly" title=" " alt="" coords="187,329,223,365,220,369,184,332"/>
<area shape="poly" title=" " alt="" coords="171,330,173,370,179,391,190,410,207,427,227,440,270,459,268,464,224,445,204,431,186,413,175,393,168,371,166,331"/>
<area shape="rect" title=" " alt="" coords="908,296,1007,330"/>
<area shape="poly" title=" " alt="" coords="923,247,943,281,938,284,918,250"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html" title=" " alt="" coords="805,296,884,330"/>
<area shape="poly" title=" " alt="" coords="899,251,869,286,865,283,895,247"/>
<area shape="poly" title=" " alt="" coords="810,333,630,414,407,463,406,458,629,409,808,328"/>
<area shape="poly" title=" " alt="" coords="805,329,633,379,632,374,803,324"/>
<area shape="poly" title=" " alt="" coords="863,329,901,365,897,369,859,332"/>
<area shape="poly" title=" " alt="" coords="885,324,897,327,1100,375,1099,380,896,333,884,329"/>
<area shape="poly" title=" " alt="" coords="885,328,989,369,987,374,883,333"/>
<area shape="rect" title=" " alt="" coords="1030,460,1122,493"/>
<area shape="poly" title=" " alt="" coords="846,330,851,370,859,391,871,410,923,428,1016,455,1014,460,921,433,868,414,854,394,846,371,841,331"/>
<area shape="poly" title=" " alt="" coords="828,332,786,369,783,365,824,328"/>
<area shape="poly" title=" " alt="" coords="716,407,682,414,410,462,407,463,406,458,409,457,681,409,715,402"/>
<area shape="poly" title=" " alt="" coords="795,400,1135,457,1155,460,1154,466,1134,462,794,405"/>
<area shape="poly" title=" " alt="" coords="795,399,870,409,1082,433,1294,457,1335,463,1334,468,1293,462,1081,438,869,414,794,404"/>
<area shape="poly" title=" " alt="" coords="795,403,1016,457,1014,462,794,408"/>
<area shape="rect" title=" " alt="" coords="422,460,549,493"/>
<area shape="poly" title=" " alt="" coords="716,410,556,457,554,452,714,405"/>
<area shape="rect" title=" " alt="" coords="574,460,691,493"/>
<area shape="poly" title=" " alt="" coords="731,414,671,453,668,449,729,410"/>
<area shape="rect" title=" " alt="" coords="715,460,795,493"/>
<area shape="poly" title=" " alt="" coords="758,412,758,444,752,444,752,412"/>
<area shape="rect" title=" " alt="" coords="819,460,1006,493"/>
<area shape="poly" title=" " alt="" coords="788,410,868,450,866,455,785,415"/>
<area shape="poly" title=" " alt="" coords="914,167,914,199,908,199,908,167"/>
<area shape="rect" title=" " alt="" coords="653,215,790,248"/>
<area shape="poly" title=" " alt="" coords="883,166,775,211,773,206,881,161"/>
<area shape="poly" title=" " alt="" coords="1258,165,1280,186,1297,214,1302,231,1297,249,1277,287,1250,320,1194,371,1190,367,1246,316,1273,284,1292,247,1296,231,1292,216,1276,190,1254,169"/>
<area shape="rect" title=" " alt="" coords="1184,215,1283,248"/>
<area shape="poly" title=" " alt="" coords="1236,167,1236,199,1231,199,1231,167"/>
</map>
</div>
</div>
<p><a href="../../d2/d5a/fs_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:d3/df8/structmount" id="r_d3/df8/structmount"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#d3/df8/structmount">mount</a></td></tr>
<tr class="separator:d3/df8/structmount"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d4/d9d/structmount__opt" id="r_d4/d9d/structmount__opt"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#d4/d9d/structmount__opt">mount_opt</a></td></tr>
<tr class="separator:d4/d9d/structmount__opt"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a369266c24eacffb87046522897a570d5" id="r_a369266c24eacffb87046522897a570d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a369266c24eacffb87046522897a570d5">_GNU_SOURCE</a></td></tr>
<tr class="separator:a369266c24eacffb87046522897a570d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acba7d2341524f732462beeee4febf9aa" id="r_acba7d2341524f732462beeee4febf9aa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acba7d2341524f732462beeee4febf9aa">UJAIL_NOAFILE</a>&#160;&#160;&#160;&quot;/tmp/.ujailnoafile&quot;</td></tr>
<tr class="separator:acba7d2341524f732462beeee4febf9aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ae6dceca96ec2c7a1b4aa211264a87ef6" id="r_ae6dceca96ec2c7a1b4aa211264a87ef6"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="#ae6dceca96ec2c7a1b4aa211264a87ef6a5f0311ba1acd526e02715d4b2adc2b27">OCI_MOUNT_SOURCE</a>
, <a class="el" href="#ae6dceca96ec2c7a1b4aa211264a87ef6aad5881700d0b39d0d3f1f3547b74f42c">OCI_MOUNT_DESTINATION</a>
, <a class="el" href="#ae6dceca96ec2c7a1b4aa211264a87ef6a69970528af4b2b0a369aac82a7c817d3">OCI_MOUNT_TYPE</a>
, <a class="el" href="#ae6dceca96ec2c7a1b4aa211264a87ef6a3f174c99d2381e1742a714e6f4643e7b">OCI_MOUNT_OPTIONS</a>
, <br />
&#160;&#160;<a class="el" href="#ae6dceca96ec2c7a1b4aa211264a87ef6adf4ecd718eb3092e22f1c4257cd460df">__OCI_MOUNT_MAX</a>
<br />
 }</td></tr>
<tr class="separator:ae6dceca96ec2c7a1b4aa211264a87ef6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9a6c15b3db1b76232ac5ccf46cca0aef" id="r_a9a6c15b3db1b76232ac5ccf46cca0aef"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9a6c15b3db1b76232ac5ccf46cca0aef">do_mount</a> (const char *root, const char *orig_source, const char *target, const char *filesystemtype, unsigned long orig_mountflags, unsigned long propflags, const char *optstr, int error, bool inner)</td></tr>
<tr class="separator:a9a6c15b3db1b76232ac5ccf46cca0aef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a335418ee05d0ecbda2094c55408404" id="r_a6a335418ee05d0ecbda2094c55408404"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6a335418ee05d0ecbda2094c55408404">_add_mount</a> (const char *source, const char *target, const char *filesystemtype, unsigned long mountflags, unsigned long propflags, const char *optstr, int error, bool inner)</td></tr>
<tr class="separator:a6a335418ee05d0ecbda2094c55408404"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16e2b60a1b30b2a7791960d7c8ce15b2" id="r_a16e2b60a1b30b2a7791960d7c8ce15b2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a16e2b60a1b30b2a7791960d7c8ce15b2">add_mount</a> (const char *source, const char *target, const char *filesystemtype, unsigned long mountflags, unsigned long propflags, const char *optstr, int error)</td></tr>
<tr class="separator:a16e2b60a1b30b2a7791960d7c8ce15b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28c0345ea0c2bb5b2e5815235849fd30" id="r_a28c0345ea0c2bb5b2e5815235849fd30"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a28c0345ea0c2bb5b2e5815235849fd30">add_mount_inner</a> (const char *source, const char *target, const char *filesystemtype, unsigned long mountflags, unsigned long propflags, const char *optstr, int error)</td></tr>
<tr class="separator:a28c0345ea0c2bb5b2e5815235849fd30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4824ede62a9ceedb153f039c5dc212f9" id="r_a4824ede62a9ceedb153f039c5dc212f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4824ede62a9ceedb153f039c5dc212f9">_add_mount_bind</a> (const char *<a class="el" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, const char *path2, int readonly, int error)</td></tr>
<tr class="separator:a4824ede62a9ceedb153f039c5dc212f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31752c6608fbf56bb359ba109bdc6f6f" id="r_a31752c6608fbf56bb359ba109bdc6f6f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a31752c6608fbf56bb359ba109bdc6f6f">add_mount_bind</a> (const char *<a class="el" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, int readonly, int error)</td></tr>
<tr class="separator:a31752c6608fbf56bb359ba109bdc6f6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26cdf624337a8578902d903d2ed76b6c" id="r_a26cdf624337a8578902d903d2ed76b6c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a26cdf624337a8578902d903d2ed76b6c">parseOCImountopts</a> (struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *msg, unsigned long *mount_flags, unsigned long *propagation_flags, char **mount_data, int *error)</td></tr>
<tr class="separator:a26cdf624337a8578902d903d2ed76b6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af24351611b930a9663cd1778f19c3ce4" id="r_af24351611b930a9663cd1778f19c3ce4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af24351611b930a9663cd1778f19c3ce4">parseOCImount</a> (struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *msg)</td></tr>
<tr class="separator:af24351611b930a9663cd1778f19c3ce4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3f280d4a5a86fc2a2c0632a4a271ef8" id="r_ab3f280d4a5a86fc2a2c0632a4a271ef8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab3f280d4a5a86fc2a2c0632a4a271ef8">build_noafile</a> (void)</td></tr>
<tr class="separator:ab3f280d4a5a86fc2a2c0632a4a271ef8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47cfef0db3b7b8feb6675dd2ee7e4d4e" id="r_a47cfef0db3b7b8feb6675dd2ee7e4d4e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a47cfef0db3b7b8feb6675dd2ee7e4d4e">mount_all</a> (const char *jailroot)</td></tr>
<tr class="separator:a47cfef0db3b7b8feb6675dd2ee7e4d4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b6f537dfef57c06536c73d6c7c2ff48" id="r_a4b6f537dfef57c06536c73d6c7c2ff48"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4b6f537dfef57c06536c73d6c7c2ff48">mount_free</a> (void)</td></tr>
<tr class="separator:a4b6f537dfef57c06536c73d6c7c2ff48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0629849a79384a49397f97b899640cce" id="r_a0629849a79384a49397f97b899640cce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0629849a79384a49397f97b899640cce">mount_list_init</a> (void)</td></tr>
<tr class="separator:a0629849a79384a49397f97b899640cce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b2c9415458859df2a4ed2558f53db56" id="r_a2b2c9415458859df2a4ed2558f53db56"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2b2c9415458859df2a4ed2558f53db56">add_script_interp</a> (const char *<a class="el" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, const char *map, int size)</td></tr>
<tr class="separator:a2b2c9415458859df2a4ed2558f53db56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4992c3c85512f44840f4eda86df97b5" id="r_ac4992c3c85512f44840f4eda86df97b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac4992c3c85512f44840f4eda86df97b5">add_2paths_and_deps</a> (const char *<a class="el" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, const char *path2, int readonly, int error, int lib)</td></tr>
<tr class="separator:ac4992c3c85512f44840f4eda86df97b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab73004ccbdbc7a5bcf2d7534135070c5" id="r_ab73004ccbdbc7a5bcf2d7534135070c5"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d3/d51/avl_8h.html#dd/d4a/structavl__tree">avl_tree</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab73004ccbdbc7a5bcf2d7534135070c5">mounts</a></td></tr>
<tr class="separator:ab73004ccbdbc7a5bcf2d7534135070c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d2e0c6d0d920485aff6684dd9f7bf0a" id="r_a8d2e0c6d0d920485aff6684dd9f7bf0a"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8d2e0c6d0d920485aff6684dd9f7bf0a">oci_mount_policy</a> []</td></tr>
<tr class="separator:a8d2e0c6d0d920485aff6684dd9f7bf0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<hr/><h2 class="groupheader">Class Documentation</h2>
<a name="d3/df8/structmount" id="d3/df8/structmount"></a>
<h2 class="memtitle"><span class="permalink"><a href="#d3/df8/structmount">&#9670;&#160;</a></span>mount</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct mount</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00044">44</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>
</div><div class="dynheader">
Collaboration diagram for mount:</div>
<div class="dyncontent">
<div class="center"><img src="../../d9/d1c/structmount__coll__graph.png" border="0" usemap="#amount_coll__map" alt="Collaboration graph"/></div>
<map name="amount_coll__map" id="amount_coll__map">
<area shape="rect" title=" " alt="" coords="435,308,516,342"/>
<area shape="rect" href="../../d3/d51/avl_8h.html#d6/d44/structavl__node" title=" " alt="" coords="240,152,343,185"/>
<area shape="poly" title=" " alt="" coords="322,194,425,282,455,306,452,310,422,286,318,198"/>
<area shape="poly" title=" " alt="" coords="360,154,367,160,369,169,362,181,344,186,342,181,358,177,364,168,362,163,356,159"/>
<area shape="rect" href="../../da/d23/list_8h.html#d9/d93/structlist__head" title=" " alt="" coords="92,12,195,45"/>
<area shape="poly" title=" " alt="" coords="183,52,210,73,250,113,281,149,277,153,246,117,207,77,180,56"/>
<area shape="poly" title=" " alt="" coords="211,18,218,22,221,29,213,38,196,42,195,37,211,34,216,28,215,25,209,22"/>
<area shape="rect" title=" " alt="" coords="290,12,421,45"/>
<area shape="poly" title=" " alt="" coords="336,59,326,77,309,117,298,152,293,150,304,115,321,74,332,56"/>
<area shape="rect" title=" " alt="" coords="5,12,68,45"/>
<area shape="poly" title=" " alt="" coords="38,60,41,96,48,136,63,177,87,213,126,245,170,270,217,289,266,303,360,318,434,322,434,327,359,324,265,308,216,294,168,275,123,249,83,216,58,180,43,138,35,96,33,61"/>
<area shape="poly" title=" " alt="" coords="66,53,94,76,126,96,164,109,203,120,263,148,261,153,201,125,162,114,124,101,91,80,62,57"/>
<area shape="rect" title=" " alt="" coords="445,12,505,45"/>
<area shape="poly" title=" " alt="" coords="478,61,478,308,473,308,473,61"/>
<area shape="poly" title=" " alt="" coords="433,55,394,78,346,117,309,153,305,149,343,113,391,73,430,50"/>
<area shape="rect" title=" " alt="" coords="553,152,707,185"/>
<area shape="poly" title=" " alt="" coords="605,198,493,310,489,306,601,195"/>
<area shape="rect" title=" " alt="" coords="739,152,785,185"/>
<area shape="poly" title=" " alt="" coords="749,200,719,246,698,268,674,287,635,305,593,317,517,326,516,321,592,312,633,300,671,282,694,264,715,242,745,197"/>
</map>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Class Members</th></tr>
<tr><td class="fieldtype">
<a id="a83d6ac10330d409124ca276a28d4101f" name="a83d6ac10330d409124ca276a28d4101f"></a>struct <a class="el" href="../../d3/d51/avl_8h.html#d6/d44/structavl__node">avl_node</a></td>
<td class="fieldname">
avl</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a2253030ebbd8465ad30762a7500644ae" name="a2253030ebbd8465ad30762a7500644ae"></a>int</td>
<td class="fieldname">
error</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a72319afac35d51a3ad918397ab9e1c4d" name="a72319afac35d51a3ad918397ab9e1c4d"></a>const char *</td>
<td class="fieldname">
filesystemtype</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a1bd6bb339b9438359be62d3259a30b08" name="a1bd6bb339b9438359be62d3259a30b08"></a>bool</td>
<td class="fieldname">
inner</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a687f3d081beb41b92e8bb52adec21826" name="a687f3d081beb41b92e8bb52adec21826"></a>unsigned long</td>
<td class="fieldname">
mountflags</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af46af2468729be934aed123bb2914123" name="af46af2468729be934aed123bb2914123"></a>const char *</td>
<td class="fieldname">
optstr</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac1bc1981b26e095cda174d1f26c66313" name="ac1bc1981b26e095cda174d1f26c66313"></a>unsigned long</td>
<td class="fieldname">
propflags</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a793de928240866f861cfb8a83cf05598" name="a793de928240866f861cfb8a83cf05598"></a>const char *</td>
<td class="fieldname">
source</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a276688d0f59467daf07eac8496873d02" name="a276688d0f59467daf07eac8496873d02"></a>const char *</td>
<td class="fieldname">
target</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="d4/d9d/structmount__opt" id="d4/d9d/structmount__opt"></a>
<h2 class="memtitle"><span class="permalink"><a href="#d4/d9d/structmount__opt">&#9670;&#160;</a></span>mount_opt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct mount_opt</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00239">239</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>
</div><div class="dynheader">
Collaboration diagram for mount_opt:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d64/structmount__opt__coll__graph.png" border="0" usemap="#amount__opt_coll__map" alt="Collaboration graph"/></div>
<map name="amount__opt_coll__map" id="amount__opt_coll__map">
<area shape="rect" title=" " alt="" coords="86,122,207,156"/>
<area shape="rect" href="../../da/d23/list_8h.html#d9/d93/structlist__head" title=" " alt="" coords="5,12,109,45"/>
<area shape="poly" title=" " alt="" coords="82,56,135,120,131,124,78,59"/>
<area shape="poly" title=" " alt="" coords="125,18,132,22,135,29,127,38,109,42,108,37,125,34,130,28,128,25,123,22"/>
<area shape="rect" title=" " alt="" coords="203,12,266,45"/>
<area shape="poly" title=" " alt="" coords="214,59,161,123,157,120,210,56"/>
</map>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Class Members</th></tr>
<tr><td class="fieldtype">
<a id="a7c6e7dc9bda2140c2920a7c881f411c2" name="a7c6e7dc9bda2140c2920a7c881f411c2"></a>struct <a class="el" href="../../da/d23/list_8h.html#d9/d93/structlist__head">list_head</a></td>
<td class="fieldname">
list</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad449ad31833bc131110de43958c1d796" name="ad449ad31833bc131110de43958c1d796"></a>char *</td>
<td class="fieldname">
optstr</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a369266c24eacffb87046522897a570d5" name="a369266c24eacffb87046522897a570d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a369266c24eacffb87046522897a570d5">&#9670;&#160;</a></span>_GNU_SOURCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _GNU_SOURCE</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00016">16</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>

</div>
</div>
<a id="acba7d2341524f732462beeee4febf9aa" name="acba7d2341524f732462beeee4febf9aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acba7d2341524f732462beeee4febf9aa">&#9670;&#160;</a></span>UJAIL_NOAFILE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UJAIL_NOAFILE&#160;&#160;&#160;&quot;/tmp/.ujailnoafile&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00042">42</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d5a/fs_8c_source.html#l00418">build_noafile()</a>, and <a class="el" href="../../d2/d5a/fs_8c_source.html#l00058">do_mount()</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ae6dceca96ec2c7a1b4aa211264a87ef6" name="ae6dceca96ec2c7a1b4aa211264a87ef6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6dceca96ec2c7a1b4aa211264a87ef6">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ae6dceca96ec2c7a1b4aa211264a87ef6a5f0311ba1acd526e02715d4b2adc2b27" name="ae6dceca96ec2c7a1b4aa211264a87ef6a5f0311ba1acd526e02715d4b2adc2b27"></a>OCI_MOUNT_SOURCE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ae6dceca96ec2c7a1b4aa211264a87ef6aad5881700d0b39d0d3f1f3547b74f42c" name="ae6dceca96ec2c7a1b4aa211264a87ef6aad5881700d0b39d0d3f1f3547b74f42c"></a>OCI_MOUNT_DESTINATION&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ae6dceca96ec2c7a1b4aa211264a87ef6a69970528af4b2b0a369aac82a7c817d3" name="ae6dceca96ec2c7a1b4aa211264a87ef6a69970528af4b2b0a369aac82a7c817d3"></a>OCI_MOUNT_TYPE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ae6dceca96ec2c7a1b4aa211264a87ef6a3f174c99d2381e1742a714e6f4643e7b" name="ae6dceca96ec2c7a1b4aa211264a87ef6a3f174c99d2381e1742a714e6f4643e7b"></a>OCI_MOUNT_OPTIONS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ae6dceca96ec2c7a1b4aa211264a87ef6adf4ecd718eb3092e22f1c4257cd460df" name="ae6dceca96ec2c7a1b4aa211264a87ef6adf4ecd718eb3092e22f1c4257cd460df"></a>__OCI_MOUNT_MAX&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00224">224</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  224</span>     {</div>
<div class="line"><span class="lineno">  225</span>    <a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6a5f0311ba1acd526e02715d4b2adc2b27">OCI_MOUNT_SOURCE</a>,</div>
<div class="line"><span class="lineno">  226</span>    <a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6aad5881700d0b39d0d3f1f3547b74f42c">OCI_MOUNT_DESTINATION</a>,</div>
<div class="line"><span class="lineno">  227</span>    <a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6a69970528af4b2b0a369aac82a7c817d3">OCI_MOUNT_TYPE</a>,</div>
<div class="line"><span class="lineno">  228</span>    <a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6a3f174c99d2381e1742a714e6f4643e7b">OCI_MOUNT_OPTIONS</a>,</div>
<div class="line"><span class="lineno">  229</span>    <a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6adf4ecd718eb3092e22f1c4257cd460df">__OCI_MOUNT_MAX</a>,</div>
<div class="line"><span class="lineno">  230</span>};</div>
<div class="ttc" id="afs_8c_html_ae6dceca96ec2c7a1b4aa211264a87ef6a3f174c99d2381e1742a714e6f4643e7b"><div class="ttname"><a href="#ae6dceca96ec2c7a1b4aa211264a87ef6a3f174c99d2381e1742a714e6f4643e7b">OCI_MOUNT_OPTIONS</a></div><div class="ttdeci">@ OCI_MOUNT_OPTIONS</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00228">fs.c:228</a></div></div>
<div class="ttc" id="afs_8c_html_ae6dceca96ec2c7a1b4aa211264a87ef6a5f0311ba1acd526e02715d4b2adc2b27"><div class="ttname"><a href="#ae6dceca96ec2c7a1b4aa211264a87ef6a5f0311ba1acd526e02715d4b2adc2b27">OCI_MOUNT_SOURCE</a></div><div class="ttdeci">@ OCI_MOUNT_SOURCE</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00225">fs.c:225</a></div></div>
<div class="ttc" id="afs_8c_html_ae6dceca96ec2c7a1b4aa211264a87ef6a69970528af4b2b0a369aac82a7c817d3"><div class="ttname"><a href="#ae6dceca96ec2c7a1b4aa211264a87ef6a69970528af4b2b0a369aac82a7c817d3">OCI_MOUNT_TYPE</a></div><div class="ttdeci">@ OCI_MOUNT_TYPE</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00227">fs.c:227</a></div></div>
<div class="ttc" id="afs_8c_html_ae6dceca96ec2c7a1b4aa211264a87ef6aad5881700d0b39d0d3f1f3547b74f42c"><div class="ttname"><a href="#ae6dceca96ec2c7a1b4aa211264a87ef6aad5881700d0b39d0d3f1f3547b74f42c">OCI_MOUNT_DESTINATION</a></div><div class="ttdeci">@ OCI_MOUNT_DESTINATION</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00226">fs.c:226</a></div></div>
<div class="ttc" id="afs_8c_html_ae6dceca96ec2c7a1b4aa211264a87ef6adf4ecd718eb3092e22f1c4257cd460df"><div class="ttname"><a href="#ae6dceca96ec2c7a1b4aa211264a87ef6adf4ecd718eb3092e22f1c4257cd460df">__OCI_MOUNT_MAX</a></div><div class="ttdeci">@ __OCI_MOUNT_MAX</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00229">fs.c:229</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6a335418ee05d0ecbda2094c55408404" name="a6a335418ee05d0ecbda2094c55408404"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a335418ee05d0ecbda2094c55408404">&#9670;&#160;</a></span>_add_mount()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _add_mount </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>target</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>filesystemtype</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long</td>          <td class="paramname"><span class="paramname"><em>mountflags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long</td>          <td class="paramname"><span class="paramname"><em>propflags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>optstr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>error</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>inner</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00158">158</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  161</span>{</div>
<div class="line"><span class="lineno">  162</span>    assert(target != NULL);</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../df/dc2/avl_8c.html#a0e08d7ee7d67ff58eeea30dd8a9356d1">avl_find</a>(&amp;<a class="code hl_variable" href="#ab73004ccbdbc7a5bcf2d7534135070c5">mounts</a>, target))</div>
<div class="line"><span class="lineno">  165</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>    <span class="keyword">struct </span><a class="code hl_struct" href="#d3/df8/structmount">mount</a> *m;</div>
<div class="line"><span class="lineno">  168</span>    m = calloc(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="#d3/df8/structmount">mount</a>));</div>
<div class="line"><span class="lineno">  169</span>    <span class="keywordflow">if</span> (!m)</div>
<div class="line"><span class="lineno">  170</span>        <span class="keywordflow">return</span> ENOMEM;</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>    m-&gt;<a class="code hl_variable" href="#a83d6ac10330d409124ca276a28d4101f">avl</a>.<a class="code hl_variable" href="../../d3/d51/avl_8h.html#aa097934e0f5e3c398890a99605291b01">key</a> = m-&gt;<a class="code hl_variable" href="#a276688d0f59467daf07eac8496873d02">target</a> = strdup(<a class="code hl_variable" href="#a276688d0f59467daf07eac8496873d02">target</a>);</div>
<div class="line"><span class="lineno">  173</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a793de928240866f861cfb8a83cf05598">source</a>) {</div>
<div class="line"><span class="lineno">  174</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a793de928240866f861cfb8a83cf05598">source</a> != (<span class="keywordtype">void</span>*)(-1))</div>
<div class="line"><span class="lineno">  175</span>            m-&gt;<a class="code hl_variable" href="#a793de928240866f861cfb8a83cf05598">source</a> = strdup(<a class="code hl_variable" href="#a793de928240866f861cfb8a83cf05598">source</a>);</div>
<div class="line"><span class="lineno">  176</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  177</span>            m-&gt;<a class="code hl_variable" href="#a793de928240866f861cfb8a83cf05598">source</a> = (<span class="keywordtype">void</span>*)(-1);</div>
<div class="line"><span class="lineno">  178</span>    }</div>
<div class="line"><span class="lineno">  179</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a72319afac35d51a3ad918397ab9e1c4d">filesystemtype</a>)</div>
<div class="line"><span class="lineno">  180</span>        m-&gt;<a class="code hl_variable" href="#a72319afac35d51a3ad918397ab9e1c4d">filesystemtype</a> = strdup(<a class="code hl_variable" href="#a72319afac35d51a3ad918397ab9e1c4d">filesystemtype</a>);</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af46af2468729be934aed123bb2914123">optstr</a>)</div>
<div class="line"><span class="lineno">  183</span>        m-&gt;<a class="code hl_variable" href="#af46af2468729be934aed123bb2914123">optstr</a> = strdup(<a class="code hl_variable" href="#af46af2468729be934aed123bb2914123">optstr</a>);</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>    m-&gt;<a class="code hl_variable" href="#a687f3d081beb41b92e8bb52adec21826">mountflags</a> = <a class="code hl_variable" href="#a687f3d081beb41b92e8bb52adec21826">mountflags</a>;</div>
<div class="line"><span class="lineno">  186</span>    m-&gt;<a class="code hl_variable" href="#ac1bc1981b26e095cda174d1f26c66313">propflags</a> = <a class="code hl_variable" href="#ac1bc1981b26e095cda174d1f26c66313">propflags</a>;</div>
<div class="line"><span class="lineno">  187</span>    m-&gt;<a class="code hl_variable" href="#a2253030ebbd8465ad30762a7500644ae">error</a> = <a class="code hl_variable" href="#a2253030ebbd8465ad30762a7500644ae">error</a>;</div>
<div class="line"><span class="lineno">  188</span>    m-&gt;<a class="code hl_variable" href="#a1bd6bb339b9438359be62d3259a30b08">inner</a> = <a class="code hl_variable" href="#a1bd6bb339b9438359be62d3259a30b08">inner</a>;</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>    <a class="code hl_function" href="../../df/dc2/avl_8c.html#ab9041e08938920d5ae722e2d57dc20e2">avl_insert</a>(&amp;<a class="code hl_variable" href="#ab73004ccbdbc7a5bcf2d7534135070c5">mounts</a>, &amp;m-&gt;<a class="code hl_variable" href="#a83d6ac10330d409124ca276a28d4101f">avl</a>);</div>
<div class="line"><span class="lineno">  191</span>    <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;adding mount %s %s bind(%d) ro(%d) err(%d)\n&quot;</span>, (m-&gt;<a class="code hl_variable" href="#a793de928240866f861cfb8a83cf05598">source</a> == (<span class="keywordtype">void</span>*)(-1))?<span class="stringliteral">&quot;mask&quot;</span>:m-&gt;<a class="code hl_variable" href="#a793de928240866f861cfb8a83cf05598">source</a>, m-&gt;<a class="code hl_variable" href="#a276688d0f59467daf07eac8496873d02">target</a>,</div>
<div class="line"><span class="lineno">  192</span>        !!(m-&gt;<a class="code hl_variable" href="#a687f3d081beb41b92e8bb52adec21826">mountflags</a> &amp; MS_BIND), !!(m-&gt;<a class="code hl_variable" href="#a687f3d081beb41b92e8bb52adec21826">mountflags</a> &amp; MS_RDONLY), m-&gt;<a class="code hl_variable" href="#a2253030ebbd8465ad30762a7500644ae">error</a> != 0);</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  195</span>}</div>
<div class="ttc" id="aavl_8c_html_a0e08d7ee7d67ff58eeea30dd8a9356d1"><div class="ttname"><a href="../../df/dc2/avl_8c.html#a0e08d7ee7d67ff58eeea30dd8a9356d1">avl_find</a></div><div class="ttdeci">struct avl_node * avl_find(const struct avl_tree *tree, const void *key)</div><div class="ttdef"><b>Definition</b> <a href="../../df/dc2/avl_8c_source.html#l00115">avl.c:115</a></div></div>
<div class="ttc" id="aavl_8c_html_ab9041e08938920d5ae722e2d57dc20e2"><div class="ttname"><a href="../../df/dc2/avl_8c.html#ab9041e08938920d5ae722e2d57dc20e2">avl_insert</a></div><div class="ttdeci">int avl_insert(struct avl_tree *tree, struct avl_node *new)</div><div class="ttdef"><b>Definition</b> <a href="../../df/dc2/avl_8c_source.html#l00220">avl.c:220</a></div></div>
<div class="ttc" id="aavl_8h_html_aa097934e0f5e3c398890a99605291b01"><div class="ttname"><a href="../../d3/d51/avl_8h.html#aa097934e0f5e3c398890a99605291b01">avl_node::key</a></div><div class="ttdeci">const void * key</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d51/avl_8h_source.html#l00084">avl.h:84</a></div></div>
<div class="ttc" id="afs_8c_html_a1bd6bb339b9438359be62d3259a30b08"><div class="ttname"><a href="#a1bd6bb339b9438359be62d3259a30b08">mount::inner</a></div><div class="ttdeci">bool inner</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00053">fs.c:53</a></div></div>
<div class="ttc" id="afs_8c_html_a2253030ebbd8465ad30762a7500644ae"><div class="ttname"><a href="#a2253030ebbd8465ad30762a7500644ae">mount::error</a></div><div class="ttdeci">int error</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00052">fs.c:52</a></div></div>
<div class="ttc" id="afs_8c_html_a276688d0f59467daf07eac8496873d02"><div class="ttname"><a href="#a276688d0f59467daf07eac8496873d02">mount::target</a></div><div class="ttdeci">const char * target</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00047">fs.c:47</a></div></div>
<div class="ttc" id="afs_8c_html_a687f3d081beb41b92e8bb52adec21826"><div class="ttname"><a href="#a687f3d081beb41b92e8bb52adec21826">mount::mountflags</a></div><div class="ttdeci">unsigned long mountflags</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00049">fs.c:49</a></div></div>
<div class="ttc" id="afs_8c_html_a72319afac35d51a3ad918397ab9e1c4d"><div class="ttname"><a href="#a72319afac35d51a3ad918397ab9e1c4d">mount::filesystemtype</a></div><div class="ttdeci">const char * filesystemtype</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00048">fs.c:48</a></div></div>
<div class="ttc" id="afs_8c_html_a793de928240866f861cfb8a83cf05598"><div class="ttname"><a href="#a793de928240866f861cfb8a83cf05598">mount::source</a></div><div class="ttdeci">const char * source</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00046">fs.c:46</a></div></div>
<div class="ttc" id="afs_8c_html_a83d6ac10330d409124ca276a28d4101f"><div class="ttname"><a href="#a83d6ac10330d409124ca276a28d4101f">mount::avl</a></div><div class="ttdeci">struct avl_node avl</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00045">fs.c:45</a></div></div>
<div class="ttc" id="afs_8c_html_ab73004ccbdbc7a5bcf2d7534135070c5"><div class="ttname"><a href="#ab73004ccbdbc7a5bcf2d7534135070c5">mounts</a></div><div class="ttdeci">struct avl_tree mounts</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00056">fs.c:56</a></div></div>
<div class="ttc" id="afs_8c_html_ac1bc1981b26e095cda174d1f26c66313"><div class="ttname"><a href="#ac1bc1981b26e095cda174d1f26c66313">mount::propflags</a></div><div class="ttdeci">unsigned long propflags</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00050">fs.c:50</a></div></div>
<div class="ttc" id="afs_8c_html_af46af2468729be934aed123bb2914123"><div class="ttname"><a href="#af46af2468729be934aed123bb2914123">mount::optstr</a></div><div class="ttdeci">const char * optstr</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00051">fs.c:51</a></div></div>
<div class="ttc" id="afs_8c_html_d3/df8/structmount"><div class="ttname"><a href="#d3/df8/structmount">mount</a></div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00044">fs.c:44</a></div></div>
<div class="ttc" id="asystem-dummy_8c_html_ad72dbcf6d0153db1b8d8a58001feed83"><div class="ttname"><a href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a></div><div class="ttdeci">#define DEBUG</div><div class="ttdef"><b>Definition</b> <a href="../../da/d12/system-dummy_8c_source.html#l00021">system-dummy.c:21</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d5a/fs_8c_source.html#l00045">mount::avl</a>, <a class="el" href="../../df/dc2/avl_8c_source.html#l00115">avl_find()</a>, <a class="el" href="../../df/dc2/avl_8c_source.html#l00220">avl_insert()</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00052">mount::error</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00048">mount::filesystemtype</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00053">mount::inner</a>, <a class="el" href="../../d3/d51/avl_8h_source.html#l00084">avl_node::key</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00049">mount::mountflags</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00056">mounts</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00051">mount::optstr</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00050">mount::propflags</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00046">mount::source</a>, and <a class="el" href="../../d2/d5a/fs_8c_source.html#l00047">mount::target</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d5a/fs_8c_source.html#l00197">add_mount()</a>, and <a class="el" href="../../d2/d5a/fs_8c_source.html#l00203">add_mount_inner()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d5a/fs_8c_a6a335418ee05d0ecbda2094c55408404_cgraph.png" border="0" usemap="#ad2/d5a/fs_8c_a6a335418ee05d0ecbda2094c55408404_cgraph" alt=""/></div>
<map name="ad2/d5a/fs_8c_a6a335418ee05d0ecbda2094c55408404_cgraph" id="ad2/d5a/fs_8c_a6a335418ee05d0ecbda2094c55408404_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,140,191"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e08d7ee7d67ff58eeea30dd8a9356d1" title=" " alt="" coords="196,79,290,112"/>
<area shape="poly" title=" " alt="" coords="110,154,190,117,192,122,112,159"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab9041e08938920d5ae722e2d57dc20e2" title=" " alt="" coords="188,185,298,219"/>
<area shape="poly" title=" " alt="" coords="141,183,172,188,171,193,140,188"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a55d3dbabb73970f597eff3d04809f4ef" title=" " alt="" coords="370,29,500,63"/>
<area shape="poly" title=" " alt="" coords="289,81,354,64,356,69,291,86"/>
<area shape="poly" title=" " alt="" coords="400,30,396,20,402,11,415,5,435,3,457,5,470,12,467,16,456,10,435,8,416,10,405,15,402,20,405,28"/>
<area shape="poly" title=" " alt="" coords="254,183,299,122,324,92,344,72,354,66,357,70,348,76,327,95,303,125,258,187"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#abd4899daa8ad959e6c9694dd5e4132a8" title=" " alt="" coords="354,283,516,316"/>
<area shape="poly" title=" " alt="" coords="267,217,304,244,347,269,358,274,356,279,345,274,301,248,264,222"/>
<area shape="rect" href="../../da/d23/list_8h.html#a875b53c95596d9e8df15ac54f6d24ae6" title=" " alt="" coords="608,335,701,368"/>
<area shape="poly" title=" " alt="" coords="254,218,289,274,315,303,347,327,377,340,409,349,474,360,538,362,593,358,593,363,538,367,474,365,408,355,375,345,345,331,312,307,285,277,250,221"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab6f5b72e706a1955a5a5d6af278c677e" title=" " alt="" coords="346,392,524,426"/>
<area shape="poly" title=" " alt="" coords="253,219,286,291,314,334,348,371,364,382,361,387,344,375,309,337,282,294,248,221"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a6de877c20c7b55fa52c80e7be87715fa" title=" " alt="" coords="386,87,484,120"/>
<area shape="poly" title=" " alt="" coords="264,183,300,156,345,129,370,119,372,123,347,134,303,160,267,187"/>
<area shape="rect" href="../../da/d23/list_8h.html#abb4dd1eb7346eb35ea621351220e80ce" title=" " alt="" coords="378,144,492,178"/>
<area shape="poly" title=" " alt="" coords="298,188,362,174,364,179,299,193"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a212673459e8e8ff2e11a8d093602d35e" title=" " alt="" coords="374,225,497,259"/>
<area shape="poly" title=" " alt="" coords="299,211,359,224,358,229,298,216"/>
<area shape="poly" title=" " alt="" coords="510,314,594,335,593,340,509,320"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="785,349,886,383"/>
<area shape="poly" title=" " alt="" coords="701,353,769,358,769,363,701,358"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="590,392,719,426"/>
<area shape="poly" title=" " alt="" coords="525,406,575,406,575,412,525,412"/>
<area shape="poly" title=" " alt="" coords="719,391,769,379,770,384,720,396"/>
<area shape="poly" title=" " alt="" coords="400,226,396,216,402,207,415,201,435,199,457,201,470,208,467,212,456,206,435,204,416,206,405,211,402,216,405,224"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a67b3db37af2f8ebc4f6895202c358604" title=" " alt="" coords="580,207,729,240"/>
<area shape="poly" title=" " alt="" coords="497,234,564,229,564,234,498,240"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab84f86be5fe7f7abcf8ffb6fa0a38700" title=" " alt="" coords="572,264,737,298"/>
<area shape="poly" title=" " alt="" coords="498,250,558,261,557,266,497,256"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#aaf08ec177405c5e004b1ca33808f19da" title=" " alt="" coords="787,264,884,298"/>
<area shape="poly" title=" " alt="" coords="711,238,773,258,771,263,709,243"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e2d83bace7533ed4cc93bdf2a94ad95" title=" " alt="" coords="789,207,882,240"/>
<area shape="poly" title=" " alt="" coords="729,221,774,221,774,226,729,226"/>
<area shape="poly" title=" " alt="" coords="737,278,771,278,771,284,737,284"/>
<area shape="poly" title=" " alt="" coords="709,261,774,240,775,245,711,266"/>
</map>
</div>

</div>
</div>
<a id="a4824ede62a9ceedb153f039c5dc212f9" name="a4824ede62a9ceedb153f039c5dc212f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4824ede62a9ceedb153f039c5dc212f9">&#9670;&#160;</a></span>_add_mount_bind()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int _add_mount_bind </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>readonly</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>error</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00209">209</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  210</span>{</div>
<div class="line"><span class="lineno">  211</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> mountflags = MS_BIND;</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>    <span class="keywordflow">if</span> (readonly)</div>
<div class="line"><span class="lineno">  214</span>        mountflags |= MS_RDONLY;</div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="#a16e2b60a1b30b2a7791960d7c8ce15b2">add_mount</a>(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, path2, NULL, mountflags, 0, NULL, error);</div>
<div class="line"><span class="lineno">  217</span>}</div>
<div class="ttc" id="afs_8c_html_a16e2b60a1b30b2a7791960d7c8ce15b2"><div class="ttname"><a href="#a16e2b60a1b30b2a7791960d7c8ce15b2">add_mount</a></div><div class="ttdeci">int add_mount(const char *source, const char *target, const char *filesystemtype, unsigned long mountflags, unsigned long propflags, const char *optstr, int error)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00197">fs.c:197</a></div></div>
<div class="ttc" id="aubusd__obj_8c_html_a9ece2e576492090c46d5e3b435cef7d4"><div class="ttname"><a href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a></div><div class="ttdeci">struct avl_tree path</div><div class="ttdef"><b>Definition</b> <a href="../../df/d0e/ubusd__obj_8c_source.html#l00019">ubusd_obj.c:19</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d5a/fs_8c_source.html#l00197">add_mount()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00052">mount::error</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00049">mount::mountflags</a>, and <a class="el" href="../../df/d0e/ubusd__obj_8c_source.html#l00019">path</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d5a/fs_8c_source.html#l00486">add_2paths_and_deps()</a>, and <a class="el" href="../../d2/d5a/fs_8c_source.html#l00219">add_mount_bind()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d5a/fs_8c_a4824ede62a9ceedb153f039c5dc212f9_cgraph.png" border="0" usemap="#ad2/d5a/fs_8c_a4824ede62a9ceedb153f039c5dc212f9_cgraph" alt=""/></div>
<map name="ad2/d5a/fs_8c_a4824ede62a9ceedb153f039c5dc212f9_cgraph" id="ad2/d5a/fs_8c_a4824ede62a9ceedb153f039c5dc212f9_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,190,191"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2" title=" " alt="" coords="238,157,363,191"/>
<area shape="poly" title=" " alt="" coords="190,172,222,172,222,177,190,177"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a6a335418ee05d0ecbda2094c55408404" title=" " alt="" coords="411,157,545,191"/>
<area shape="poly" title=" " alt="" coords="363,172,396,172,396,177,363,177"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e08d7ee7d67ff58eeea30dd8a9356d1" title=" " alt="" coords="602,79,695,112"/>
<area shape="poly" title=" " alt="" coords="516,154,595,117,598,122,518,159"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab9041e08938920d5ae722e2d57dc20e2" title=" " alt="" coords="593,185,704,219"/>
<area shape="poly" title=" " alt="" coords="546,183,578,188,577,193,545,188"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a55d3dbabb73970f597eff3d04809f4ef" title=" " alt="" coords="776,29,906,63"/>
<area shape="poly" title=" " alt="" coords="695,81,760,64,761,69,696,86"/>
<area shape="poly" title=" " alt="" coords="806,30,802,20,807,11,820,5,841,3,863,5,875,12,873,16,861,10,841,8,822,10,811,15,807,20,811,28"/>
<area shape="poly" title=" " alt="" coords="659,183,704,122,729,92,750,72,760,66,763,70,753,76,733,95,708,125,664,187"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#abd4899daa8ad959e6c9694dd5e4132a8" title=" " alt="" coords="760,283,922,316"/>
<area shape="poly" title=" " alt="" coords="673,217,709,244,753,269,764,274,762,279,750,274,706,248,670,222"/>
<area shape="rect" href="../../da/d23/list_8h.html#a875b53c95596d9e8df15ac54f6d24ae6" title=" " alt="" coords="1014,335,1106,368"/>
<area shape="poly" title=" " alt="" coords="660,218,695,274,721,303,753,327,783,340,814,349,880,360,943,362,998,358,999,363,943,367,880,365,813,355,781,345,750,331,718,307,690,277,656,221"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab6f5b72e706a1955a5a5d6af278c677e" title=" " alt="" coords="752,392,930,426"/>
<area shape="poly" title=" " alt="" coords="658,219,692,291,719,334,753,371,770,382,767,387,750,375,715,337,687,294,654,221"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a6de877c20c7b55fa52c80e7be87715fa" title=" " alt="" coords="792,87,890,120"/>
<area shape="poly" title=" " alt="" coords="669,183,706,156,750,129,776,119,778,123,753,134,709,160,672,187"/>
<area shape="rect" href="../../da/d23/list_8h.html#abb4dd1eb7346eb35ea621351220e80ce" title=" " alt="" coords="784,144,898,178"/>
<area shape="poly" title=" " alt="" coords="704,188,768,174,769,179,705,193"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a212673459e8e8ff2e11a8d093602d35e" title=" " alt="" coords="779,225,903,259"/>
<area shape="poly" title=" " alt="" coords="705,211,764,224,763,229,704,216"/>
<area shape="poly" title=" " alt="" coords="916,314,1000,335,998,340,914,320"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="1190,349,1292,383"/>
<area shape="poly" title=" " alt="" coords="1107,353,1175,358,1175,363,1107,358"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="996,392,1125,426"/>
<area shape="poly" title=" " alt="" coords="930,406,980,406,980,412,930,412"/>
<area shape="poly" title=" " alt="" coords="1125,391,1175,379,1176,384,1126,396"/>
<area shape="poly" title=" " alt="" coords="806,226,802,216,807,207,820,201,841,199,863,201,875,208,873,212,861,206,841,204,822,206,811,211,807,216,811,224"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a67b3db37af2f8ebc4f6895202c358604" title=" " alt="" coords="986,207,1135,240"/>
<area shape="poly" title=" " alt="" coords="903,234,969,229,970,234,903,240"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab84f86be5fe7f7abcf8ffb6fa0a38700" title=" " alt="" coords="978,264,1142,298"/>
<area shape="poly" title=" " alt="" coords="904,250,963,261,962,266,903,256"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#aaf08ec177405c5e004b1ca33808f19da" title=" " alt="" coords="1192,264,1290,298"/>
<area shape="poly" title=" " alt="" coords="1116,238,1178,258,1177,263,1115,243"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e2d83bace7533ed4cc93bdf2a94ad95" title=" " alt="" coords="1195,207,1287,240"/>
<area shape="poly" title=" " alt="" coords="1135,221,1179,221,1179,226,1135,226"/>
<area shape="poly" title=" " alt="" coords="1143,278,1177,278,1177,284,1143,284"/>
<area shape="poly" title=" " alt="" coords="1115,261,1179,240,1181,245,1116,266"/>
</map>
</div>

</div>
</div>
<a id="ac4992c3c85512f44840f4eda86df97b5" name="ac4992c3c85512f44840f4eda86df97b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4992c3c85512f44840f4eda86df97b5">&#9670;&#160;</a></span>add_2paths_and_deps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int add_2paths_and_deps </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>readonly</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>error</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>lib</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00486">486</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  487</span>{</div>
<div class="line"><span class="lineno">  488</span>    assert(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a> != NULL);</div>
<div class="line"><span class="lineno">  489</span>    assert(path2 != NULL);</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>    <span class="keywordflow">if</span> (lib == 0 &amp;&amp; <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>[0] != <span class="charliteral">&#39;/&#39;</span>) {</div>
<div class="line"><span class="lineno">  492</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;%s is not an absolute path\n&quot;</span>, <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>);</div>
<div class="line"><span class="lineno">  493</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">  494</span>    }</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>    <span class="keywordtype">char</span> *map = NULL;</div>
<div class="line"><span class="lineno">  497</span>    <span class="keywordtype">int</span> fd, ret = -1;</div>
<div class="line"><span class="lineno">  498</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>[0] == <span class="charliteral">&#39;/&#39;</span>) {</div>
<div class="line"><span class="lineno">  499</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../df/dc2/avl_8c.html#a0e08d7ee7d67ff58eeea30dd8a9356d1">avl_find</a>(&amp;<a class="code hl_variable" href="#ab73004ccbdbc7a5bcf2d7534135070c5">mounts</a>, path2))</div>
<div class="line"><span class="lineno">  500</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  501</span>        fd = open(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, O_RDONLY|O_CLOEXEC);</div>
<div class="line"><span class="lineno">  502</span>        <span class="keywordflow">if</span> (fd &lt; 0)</div>
<div class="line"><span class="lineno">  503</span>            <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">  504</span>        <a class="code hl_function" href="#a4824ede62a9ceedb153f039c5dc212f9">_add_mount_bind</a>(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, path2, readonly, error);</div>
<div class="line"><span class="lineno">  505</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  506</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../df/dc2/avl_8c.html#a0e08d7ee7d67ff58eeea30dd8a9356d1">avl_find</a>(&amp;<a class="code hl_variable" href="../../d2/da6/elf_8c.html#ad5cd1529b1d09e1fefb94edad826fe2b">libraries</a>, <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>))</div>
<div class="line"><span class="lineno">  507</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  508</span>        <span class="keywordtype">char</span> *fullpath;</div>
<div class="line"><span class="lineno">  509</span>        fd = <a class="code hl_function" href="../../d2/da6/elf_8c.html#a9ae7cc745a41248c9f0d9bbb83a86a43">lib_open</a>(&amp;fullpath, <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>);</div>
<div class="line"><span class="lineno">  510</span>        <span class="keywordflow">if</span> (fd &lt; 0)</div>
<div class="line"><span class="lineno">  511</span>            <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">  512</span>        <span class="keywordflow">if</span> (fullpath) {</div>
<div class="line"><span class="lineno">  513</span>            <a class="code hl_function" href="../../d2/da6/elf_8c.html#a5601edf43bf58289cb22c5b20d17a1e9">alloc_library</a>(fullpath, <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>);</div>
<div class="line"><span class="lineno">  514</span>            free(fullpath);</div>
<div class="line"><span class="lineno">  515</span>        }</div>
<div class="line"><span class="lineno">  516</span>    }</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>    <span class="keyword">struct </span>stat s;</div>
<div class="line"><span class="lineno">  519</span>    <span class="keywordflow">if</span> (fstat(fd, &amp;s) == -1) {</div>
<div class="line"><span class="lineno">  520</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;fstat(%s) failed: %m\n&quot;</span>, <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>);</div>
<div class="line"><span class="lineno">  521</span>        ret = error;</div>
<div class="line"><span class="lineno">  522</span>        <span class="keywordflow">goto</span> out;</div>
<div class="line"><span class="lineno">  523</span>    }</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>    <span class="keywordflow">if</span> (!S_ISREG(s.st_mode)) {</div>
<div class="line"><span class="lineno">  526</span>        ret = 0;</div>
<div class="line"><span class="lineno">  527</span>        <span class="keywordflow">goto</span> out;</div>
<div class="line"><span class="lineno">  528</span>    }</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>    <span class="comment">/* too small to be an ELF or a script -&gt; &quot;normal&quot; file */</span></div>
<div class="line"><span class="lineno">  531</span>    <span class="keywordflow">if</span> (s.st_size &lt; 4) {</div>
<div class="line"><span class="lineno">  532</span>        ret = 0;</div>
<div class="line"><span class="lineno">  533</span>        <span class="keywordflow">goto</span> out;</div>
<div class="line"><span class="lineno">  534</span>    }</div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>    map = mmap(NULL, s.st_size, PROT_READ, MAP_PRIVATE, fd, 0);</div>
<div class="line"><span class="lineno">  537</span>    <span class="keywordflow">if</span> (map == MAP_FAILED) {</div>
<div class="line"><span class="lineno">  538</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to mmap %s: %m\n&quot;</span>, <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>);</div>
<div class="line"><span class="lineno">  539</span>        ret = -1;</div>
<div class="line"><span class="lineno">  540</span>        <span class="keywordflow">goto</span> out;</div>
<div class="line"><span class="lineno">  541</span>    }</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>    <span class="keywordflow">if</span> (map[0] == <span class="charliteral">&#39;#&#39;</span> &amp;&amp; map[1] == <span class="charliteral">&#39;!&#39;</span>) {</div>
<div class="line"><span class="lineno">  544</span>        ret = <a class="code hl_function" href="#a2b2c9415458859df2a4ed2558f53db56">add_script_interp</a>(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, map, s.st_size);</div>
<div class="line"><span class="lineno">  545</span>        <span class="keywordflow">goto</span> out;</div>
<div class="line"><span class="lineno">  546</span>    }</div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span>    <span class="keywordflow">if</span> (map[0] == ELFMAG0 &amp;&amp; map[1] == ELFMAG1 &amp;&amp; map[2] == ELFMAG2 &amp;&amp; map[3] == ELFMAG3) {</div>
<div class="line"><span class="lineno">  549</span>        ret = <a class="code hl_function" href="../../d2/da6/elf_8c.html#a48837326349fc40e7a38f613d853f8f2">elf_load_deps</a>(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, map);</div>
<div class="line"><span class="lineno">  550</span>        <span class="keywordflow">goto</span> out;</div>
<div class="line"><span class="lineno">  551</span>    }</div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span>    ret = 0;</div>
<div class="line"><span class="lineno">  554</span> </div>
<div class="line"><span class="lineno">  555</span>out:</div>
<div class="line"><span class="lineno">  556</span>    <span class="keywordflow">if</span> (fd &gt;= 0)</div>
<div class="line"><span class="lineno">  557</span>        close(fd);</div>
<div class="line"><span class="lineno">  558</span>    <span class="keywordflow">if</span> (map)</div>
<div class="line"><span class="lineno">  559</span>        munmap(map, s.st_size);</div>
<div class="line"><span class="lineno">  560</span> </div>
<div class="line"><span class="lineno">  561</span>    <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno">  562</span>}</div>
<div class="ttc" id="aelf_8c_html_a48837326349fc40e7a38f613d853f8f2"><div class="ttname"><a href="../../d2/da6/elf_8c.html#a48837326349fc40e7a38f613d853f8f2">elf_load_deps</a></div><div class="ttdeci">int elf_load_deps(const char *path, const char *map)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/da6/elf_8c_source.html#l00233">elf.c:233</a></div></div>
<div class="ttc" id="aelf_8c_html_a5601edf43bf58289cb22c5b20d17a1e9"><div class="ttname"><a href="../../d2/da6/elf_8c.html#a5601edf43bf58289cb22c5b20d17a1e9">alloc_library</a></div><div class="ttdeci">void alloc_library(const char *path, const char *name)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/da6/elf_8c_source.html#l00056">elf.c:56</a></div></div>
<div class="ttc" id="aelf_8c_html_a9ae7cc745a41248c9f0d9bbb83a86a43"><div class="ttname"><a href="../../d2/da6/elf_8c.html#a9ae7cc745a41248c9f0d9bbb83a86a43">lib_open</a></div><div class="ttdeci">int lib_open(char **fullpath, const char *file)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/da6/elf_8c_source.html#l00074">elf.c:74</a></div></div>
<div class="ttc" id="aelf_8c_html_ad5cd1529b1d09e1fefb94edad826fe2b"><div class="ttname"><a href="../../d2/da6/elf_8c.html#ad5cd1529b1d09e1fefb94edad826fe2b">libraries</a></div><div class="ttdeci">struct avl_tree libraries</div><div class="ttdef"><b>Definition</b> <a href="../../d2/da6/elf_8c_source.html#l00029">elf.c:29</a></div></div>
<div class="ttc" id="afs_8c_html_a2b2c9415458859df2a4ed2558f53db56"><div class="ttname"><a href="#a2b2c9415458859df2a4ed2558f53db56">add_script_interp</a></div><div class="ttdeci">static int add_script_interp(const char *path, const char *map, int size)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00463">fs.c:463</a></div></div>
<div class="ttc" id="afs_8c_html_a4824ede62a9ceedb153f039c5dc212f9"><div class="ttname"><a href="#a4824ede62a9ceedb153f039c5dc212f9">_add_mount_bind</a></div><div class="ttdeci">static int _add_mount_bind(const char *path, const char *path2, int readonly, int error)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00209">fs.c:209</a></div></div>
<div class="ttc" id="aprocd_2jail_2log_8h_html_a15378cd15bafb3a79061424b452497aa"><div class="ttname"><a href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a></div><div class="ttdeci">#define ERROR(fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">log.h:27</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d5a/fs_8c_source.html#l00209">_add_mount_bind()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00463">add_script_interp()</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00056">alloc_library()</a>, <a class="el" href="../../df/dc2/avl_8c_source.html#l00115">avl_find()</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00233">elf_load_deps()</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00052">mount::error</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00074">lib_open()</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00029">libraries</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00056">mounts</a>, and <a class="el" href="../../df/d0e/ubusd__obj_8c_source.html#l00019">path</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/d26/fs_8h_source.html#l00027">add_path_and_deps()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l02583">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d5a/fs_8c_ac4992c3c85512f44840f4eda86df97b5_cgraph.png" border="0" usemap="#ad2/d5a/fs_8c_ac4992c3c85512f44840f4eda86df97b5_cgraph" alt=""/></div>
<map name="ad2/d5a/fs_8c_ac4992c3c85512f44840f4eda86df97b5_cgraph" id="ad2/d5a/fs_8c_ac4992c3c85512f44840f4eda86df97b5_cgraph">
<area shape="rect" title=" " alt="" coords="5,339,233,372"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4824ede62a9ceedb153f039c5dc212f9" title=" " alt="" coords="281,168,465,202"/>
<area shape="poly" title=" " alt="" coords="144,336,332,208,335,213,147,340"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e08d7ee7d67ff58eeea30dd8a9356d1" title=" " alt="" coords="1031,84,1125,118"/>
<area shape="poly" title=" " alt="" coords="126,337,147,298,180,247,225,195,251,172,279,153,326,130,375,110,478,81,583,65,687,59,786,60,877,67,1017,86,1016,91,876,72,786,65,687,64,584,71,479,87,377,115,329,134,282,158,254,176,228,199,184,250,152,301,131,340"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a2b2c9415458859df2a4ed2558f53db56" title=" " alt="" coords="282,447,464,480"/>
<area shape="poly" title=" " alt="" coords="162,370,318,438,316,442,160,375"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a5601edf43bf58289cb22c5b20d17a1e9" title=" " alt="" coords="551,196,683,230"/>
<area shape="poly" title=" " alt="" coords="178,336,512,238,536,232,537,237,514,243,180,341"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a48837326349fc40e7a38f613d853f8f2" title=" " alt="" coords="300,339,446,372"/>
<area shape="poly" title=" " alt="" coords="233,353,284,353,284,358,233,358"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a9ae7cc745a41248c9f0d9bbb83a86a43" title=" " alt="" coords="324,580,422,614"/>
<area shape="poly" title=" " alt="" coords="132,372,154,410,188,460,231,512,282,559,310,575,308,580,279,563,228,516,184,463,150,412,127,374"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2" title=" " alt="" coords="555,139,680,172"/>
<area shape="poly" title=" " alt="" coords="465,171,539,162,539,167,466,176"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a6a335418ee05d0ecbda2094c55408404" title=" " alt="" coords="805,139,939,172"/>
<area shape="poly" title=" " alt="" coords="680,153,789,153,789,158,680,158"/>
<area shape="poly" title=" " alt="" coords="937,135,1015,114,1017,120,939,141"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab9041e08938920d5ae722e2d57dc20e2" title=" " alt="" coords="1023,196,1133,230"/>
<area shape="poly" title=" " alt="" coords="936,170,1008,191,1007,196,934,175"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a55d3dbabb73970f597eff3d04809f4ef" title=" " alt="" coords="1205,29,1335,63"/>
<area shape="poly" title=" " alt="" coords="1124,85,1193,65,1195,70,1126,90"/>
<area shape="poly" title=" " alt="" coords="1235,30,1231,20,1237,11,1250,5,1270,3,1292,5,1305,12,1302,16,1291,10,1270,8,1251,10,1240,15,1237,20,1240,28"/>
<area shape="poly" title=" " alt="" coords="1088,194,1132,127,1158,94,1179,72,1189,66,1192,70,1183,76,1162,97,1137,130,1092,197"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#abd4899daa8ad959e6c9694dd5e4132a8" title=" " alt="" coords="1189,277,1351,311"/>
<area shape="poly" title=" " alt="" coords="1119,228,1182,256,1213,269,1211,273,1180,261,1117,233"/>
<area shape="rect" href="../../da/d23/list_8h.html#a875b53c95596d9e8df15ac54f6d24ae6" title=" " alt="" coords="1443,277,1536,311"/>
<area shape="poly" title=" " alt="" coords="1134,220,1360,262,1429,277,1428,283,1359,267,1133,225"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab6f5b72e706a1955a5a5d6af278c677e" title=" " alt="" coords="1181,335,1359,368"/>
<area shape="poly" title=" " alt="" coords="1093,228,1129,275,1154,300,1182,321,1189,325,1186,330,1180,326,1151,304,1125,278,1088,232"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a6de877c20c7b55fa52c80e7be87715fa" title=" " alt="" coords="1221,392,1319,426"/>
<area shape="poly" title=" " alt="" coords="1087,229,1100,261,1120,301,1148,343,1183,379,1208,393,1205,397,1179,383,1144,346,1116,304,1095,263,1082,231"/>
<area shape="rect" href="../../da/d23/list_8h.html#abb4dd1eb7346eb35ea621351220e80ce" title=" " alt="" coords="1213,87,1327,120"/>
<area shape="poly" title=" " alt="" coords="1095,194,1132,161,1180,129,1197,121,1200,126,1182,134,1135,165,1098,198"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a212673459e8e8ff2e11a8d093602d35e" title=" " alt="" coords="1209,168,1332,202"/>
<area shape="poly" title=" " alt="" coords="1133,202,1193,193,1194,199,1134,207"/>
<area shape="poly" title=" " alt="" coords="1352,292,1428,292,1428,297,1352,297"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="1620,292,1721,326"/>
<area shape="poly" title=" " alt="" coords="1536,295,1604,301,1604,306,1536,301"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="1425,335,1554,368"/>
<area shape="poly" title=" " alt="" coords="1360,349,1410,349,1410,354,1360,354"/>
<area shape="poly" title=" " alt="" coords="1554,334,1604,322,1605,327,1555,339"/>
<area shape="poly" title=" " alt="" coords="1235,169,1231,159,1237,149,1250,143,1270,141,1292,144,1305,150,1302,155,1291,149,1270,147,1251,149,1240,153,1237,159,1240,167"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a67b3db37af2f8ebc4f6895202c358604" title=" " alt="" coords="1415,207,1564,240"/>
<area shape="poly" title=" " alt="" coords="1333,193,1400,205,1399,210,1332,198"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab84f86be5fe7f7abcf8ffb6fa0a38700" title=" " alt="" coords="1407,149,1572,183"/>
<area shape="poly" title=" " alt="" coords="1332,177,1391,172,1392,177,1333,182"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#aaf08ec177405c5e004b1ca33808f19da" title=" " alt="" coords="1622,207,1719,240"/>
<area shape="poly" title=" " alt="" coords="1564,221,1606,221,1606,226,1564,226"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e2d83bace7533ed4cc93bdf2a94ad95" title=" " alt="" coords="1624,149,1717,183"/>
<area shape="poly" title=" " alt="" coords="1544,204,1609,183,1610,188,1546,209"/>
<area shape="poly" title=" " alt="" coords="1546,181,1608,201,1606,206,1544,186"/>
<area shape="poly" title=" " alt="" coords="1572,164,1609,164,1609,169,1572,169"/>
<area shape="rect" href="../../df/d26/fs_8h.html#a3c2c8ec14a25736480de113e1b71f52d" title=" " alt="" coords="769,420,975,454"/>
<area shape="poly" title=" " alt="" coords="464,463,513,464,617,467,663,467,721,464,781,455,782,460,722,469,663,473,617,473,513,469,464,468"/>
<area shape="poly" title=" " alt="" coords="826,457,725,488,660,504,588,516,511,524,433,525,355,516,280,495,237,474,199,445,166,415,141,386,145,383,170,411,202,441,240,469,282,490,356,510,433,519,511,519,587,511,659,498,724,483,824,452"/>
<area shape="poly" title=" " alt="" coords="684,210,1007,210,1007,216,684,216"/>
<area shape="poly" title=" " alt="" coords="447,363,722,405,771,414,770,419,721,410,446,368"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a12c644fb0c26d71dff162e574593230e" title=" " alt="" coords="513,420,721,454"/>
<area shape="poly" title=" " alt="" coords="427,370,551,412,549,417,425,375"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a0ac3dca93dd7aead60876faae920be80" title=" " alt="" coords="513,311,721,344"/>
<area shape="poly" title=" " alt="" coords="446,345,497,339,498,344,446,350"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a1fada8bd25495e270df90e58db6890f1" title=" " alt="" coords="535,253,699,287"/>
<area shape="poly" title=" " alt="" coords="412,336,512,296,532,289,533,294,514,301,414,341"/>
<area shape="poly" title=" " alt="" coords="722,434,754,434,754,440,722,440"/>
<area shape="poly" title=" " alt="" coords="673,342,722,361,826,410,823,415,720,366,671,347"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#aecc20c7d8b2e298820356d8e32eb4f4a" title=" " alt="" coords="778,252,966,286"/>
<area shape="poly" title=" " alt="" coords="700,267,762,267,762,272,700,272"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a3212416f7b63427063c564bdedd8b645" title=" " alt="" coords="778,309,966,343"/>
<area shape="poly" title=" " alt="" coords="698,285,778,303,777,308,697,290"/>
</map>
</div>

</div>
</div>
<a id="a16e2b60a1b30b2a7791960d7c8ce15b2" name="a16e2b60a1b30b2a7791960d7c8ce15b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16e2b60a1b30b2a7791960d7c8ce15b2">&#9670;&#160;</a></span>add_mount()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int add_mount </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>target</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>filesystemtype</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long</td>          <td class="paramname"><span class="paramname"><em>mountflags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long</td>          <td class="paramname"><span class="paramname"><em>propflags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>optstr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>error</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00197">197</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  199</span>{</div>
<div class="line"><span class="lineno">  200</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="#a6a335418ee05d0ecbda2094c55408404">_add_mount</a>(source, target, filesystemtype, mountflags, propflags, optstr, error, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  201</span>}</div>
<div class="ttc" id="afs_8c_html_a6a335418ee05d0ecbda2094c55408404"><div class="ttname"><a href="#a6a335418ee05d0ecbda2094c55408404">_add_mount</a></div><div class="ttdeci">static int _add_mount(const char *source, const char *target, const char *filesystemtype, unsigned long mountflags, unsigned long propflags, const char *optstr, int error, bool inner)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00158">fs.c:158</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d5a/fs_8c_source.html#l00158">_add_mount()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00052">mount::error</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00048">mount::filesystemtype</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00049">mount::mountflags</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00051">mount::optstr</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00050">mount::propflags</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00046">mount::source</a>, and <a class="el" href="../../d2/d5a/fs_8c_source.html#l00047">mount::target</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d5a/fs_8c_source.html#l00209">_add_mount_bind()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02198">parseOCIlinux()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00388">parseOCImount()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d5a/fs_8c_a16e2b60a1b30b2a7791960d7c8ce15b2_cgraph.png" border="0" usemap="#ad2/d5a/fs_8c_a16e2b60a1b30b2a7791960d7c8ce15b2_cgraph" alt=""/></div>
<map name="ad2/d5a/fs_8c_a16e2b60a1b30b2a7791960d7c8ce15b2_cgraph" id="ad2/d5a/fs_8c_a16e2b60a1b30b2a7791960d7c8ce15b2_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,131,191"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a6a335418ee05d0ecbda2094c55408404" title=" " alt="" coords="179,157,313,191"/>
<area shape="poly" title=" " alt="" coords="131,172,163,172,163,177,131,177"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e08d7ee7d67ff58eeea30dd8a9356d1" title=" " alt="" coords="370,79,463,112"/>
<area shape="poly" title=" " alt="" coords="283,154,363,117,365,122,286,159"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab9041e08938920d5ae722e2d57dc20e2" title=" " alt="" coords="361,185,471,219"/>
<area shape="poly" title=" " alt="" coords="314,183,346,188,345,193,313,188"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a55d3dbabb73970f597eff3d04809f4ef" title=" " alt="" coords="543,29,674,63"/>
<area shape="poly" title=" " alt="" coords="463,81,528,64,529,69,464,86"/>
<area shape="poly" title=" " alt="" coords="573,30,570,20,575,11,588,5,609,3,631,5,643,12,640,16,629,10,608,8,589,10,578,15,575,20,578,28"/>
<area shape="poly" title=" " alt="" coords="427,183,472,122,497,92,518,72,528,66,531,70,521,76,501,95,476,125,431,187"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#abd4899daa8ad959e6c9694dd5e4132a8" title=" " alt="" coords="527,283,690,316"/>
<area shape="poly" title=" " alt="" coords="441,217,477,244,521,269,532,274,530,279,518,274,474,248,437,222"/>
<area shape="rect" href="../../da/d23/list_8h.html#a875b53c95596d9e8df15ac54f6d24ae6" title=" " alt="" coords="782,335,874,368"/>
<area shape="poly" title=" " alt="" coords="428,218,462,274,489,303,521,327,550,340,582,349,648,360,711,362,766,358,766,363,711,367,647,365,581,355,549,345,518,331,485,307,458,277,423,221"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab6f5b72e706a1955a5a5d6af278c677e" title=" " alt="" coords="519,392,698,426"/>
<area shape="poly" title=" " alt="" coords="426,219,460,291,487,334,521,371,538,382,534,387,518,375,483,337,455,294,421,221"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a6de877c20c7b55fa52c80e7be87715fa" title=" " alt="" coords="559,87,658,120"/>
<area shape="poly" title=" " alt="" coords="437,183,474,156,518,129,543,119,545,123,521,134,477,160,440,187"/>
<area shape="rect" href="../../da/d23/list_8h.html#abb4dd1eb7346eb35ea621351220e80ce" title=" " alt="" coords="551,144,666,178"/>
<area shape="poly" title=" " alt="" coords="471,188,536,174,537,179,472,193"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a212673459e8e8ff2e11a8d093602d35e" title=" " alt="" coords="547,225,670,259"/>
<area shape="poly" title=" " alt="" coords="472,211,532,224,531,229,471,216"/>
<area shape="poly" title=" " alt="" coords="683,314,767,335,766,340,682,320"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="958,349,1059,383"/>
<area shape="poly" title=" " alt="" coords="875,353,943,358,942,363,874,358"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="763,392,893,426"/>
<area shape="poly" title=" " alt="" coords="698,406,748,406,748,412,698,412"/>
<area shape="poly" title=" " alt="" coords="892,391,942,379,943,384,894,396"/>
<area shape="poly" title=" " alt="" coords="573,226,570,216,575,207,588,201,609,199,631,201,643,208,640,212,629,206,608,204,589,206,578,211,575,216,578,224"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a67b3db37af2f8ebc4f6895202c358604" title=" " alt="" coords="753,207,903,240"/>
<area shape="poly" title=" " alt="" coords="671,234,737,229,738,234,671,240"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab84f86be5fe7f7abcf8ffb6fa0a38700" title=" " alt="" coords="746,264,910,298"/>
<area shape="poly" title=" " alt="" coords="671,250,731,261,730,266,670,256"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#aaf08ec177405c5e004b1ca33808f19da" title=" " alt="" coords="960,264,1057,298"/>
<area shape="poly" title=" " alt="" coords="884,238,946,258,944,263,882,243"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e2d83bace7533ed4cc93bdf2a94ad95" title=" " alt="" coords="963,207,1055,240"/>
<area shape="poly" title=" " alt="" coords="903,221,947,221,947,226,903,226"/>
<area shape="poly" title=" " alt="" coords="910,278,945,278,945,284,910,284"/>
<area shape="poly" title=" " alt="" coords="882,261,947,240,949,245,884,266"/>
</map>
</div>

</div>
</div>
<a id="a31752c6608fbf56bb359ba109bdc6f6f" name="a31752c6608fbf56bb359ba109bdc6f6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31752c6608fbf56bb359ba109bdc6f6f">&#9670;&#160;</a></span>add_mount_bind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int add_mount_bind </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>readonly</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>error</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00219">219</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  220</span>{</div>
<div class="line"><span class="lineno">  221</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="#a4824ede62a9ceedb153f039c5dc212f9">_add_mount_bind</a>(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, readonly, error);</div>
<div class="line"><span class="lineno">  222</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d5a/fs_8c_source.html#l00209">_add_mount_bind()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00052">mount::error</a>, and <a class="el" href="../../df/d0e/ubusd__obj_8c_source.html#l00019">path</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02583">main()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00429">mount_all()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d5a/fs_8c_a31752c6608fbf56bb359ba109bdc6f6f_cgraph.png" border="0" usemap="#ad2/d5a/fs_8c_a31752c6608fbf56bb359ba109bdc6f6f_cgraph" alt=""/></div>
<map name="ad2/d5a/fs_8c_a31752c6608fbf56bb359ba109bdc6f6f_cgraph" id="ad2/d5a/fs_8c_a31752c6608fbf56bb359ba109bdc6f6f_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,181,191"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4824ede62a9ceedb153f039c5dc212f9" title=" " alt="" coords="229,157,413,191"/>
<area shape="poly" title=" " alt="" coords="181,172,213,172,213,177,181,177"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2" title=" " alt="" coords="461,157,586,191"/>
<area shape="poly" title=" " alt="" coords="413,172,445,172,445,177,413,177"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a6a335418ee05d0ecbda2094c55408404" title=" " alt="" coords="634,157,769,191"/>
<area shape="poly" title=" " alt="" coords="587,172,619,172,619,177,587,177"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e08d7ee7d67ff58eeea30dd8a9356d1" title=" " alt="" coords="825,79,919,112"/>
<area shape="poly" title=" " alt="" coords="739,154,819,117,821,122,741,159"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab9041e08938920d5ae722e2d57dc20e2" title=" " alt="" coords="817,185,927,219"/>
<area shape="poly" title=" " alt="" coords="770,183,801,188,800,193,769,188"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a55d3dbabb73970f597eff3d04809f4ef" title=" " alt="" coords="999,29,1129,63"/>
<area shape="poly" title=" " alt="" coords="918,81,983,64,985,69,920,86"/>
<area shape="poly" title=" " alt="" coords="1029,30,1025,20,1031,11,1044,5,1064,3,1086,5,1099,12,1096,16,1085,10,1064,8,1045,10,1034,15,1031,20,1034,28"/>
<area shape="poly" title=" " alt="" coords="883,183,928,122,953,92,973,72,983,66,986,70,977,76,956,95,932,125,887,187"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#abd4899daa8ad959e6c9694dd5e4132a8" title=" " alt="" coords="983,283,1145,316"/>
<area shape="poly" title=" " alt="" coords="896,217,933,244,976,269,987,274,985,279,974,274,930,248,893,222"/>
<area shape="rect" href="../../da/d23/list_8h.html#a875b53c95596d9e8df15ac54f6d24ae6" title=" " alt="" coords="1237,335,1330,368"/>
<area shape="poly" title=" " alt="" coords="883,218,918,274,944,303,976,327,1006,340,1038,349,1103,360,1167,362,1222,358,1222,363,1167,367,1103,365,1037,355,1004,345,974,331,941,307,914,277,879,221"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab6f5b72e706a1955a5a5d6af278c677e" title=" " alt="" coords="975,392,1153,426"/>
<area shape="poly" title=" " alt="" coords="882,219,915,291,943,334,977,371,993,382,990,387,973,375,938,337,911,294,877,221"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a6de877c20c7b55fa52c80e7be87715fa" title=" " alt="" coords="1015,87,1113,120"/>
<area shape="poly" title=" " alt="" coords="893,183,929,156,974,129,999,119,1001,123,976,134,932,160,896,187"/>
<area shape="rect" href="../../da/d23/list_8h.html#abb4dd1eb7346eb35ea621351220e80ce" title=" " alt="" coords="1007,144,1121,178"/>
<area shape="poly" title=" " alt="" coords="927,188,991,174,993,179,928,193"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a212673459e8e8ff2e11a8d093602d35e" title=" " alt="" coords="1003,225,1126,259"/>
<area shape="poly" title=" " alt="" coords="928,211,988,224,987,229,927,216"/>
<area shape="poly" title=" " alt="" coords="1139,314,1223,335,1222,340,1138,320"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="1414,349,1515,383"/>
<area shape="poly" title=" " alt="" coords="1330,353,1398,358,1398,363,1330,358"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="1219,392,1348,426"/>
<area shape="poly" title=" " alt="" coords="1154,406,1204,406,1204,412,1154,412"/>
<area shape="poly" title=" " alt="" coords="1348,391,1398,379,1399,384,1349,396"/>
<area shape="poly" title=" " alt="" coords="1029,226,1025,216,1031,207,1044,201,1064,199,1086,201,1099,208,1096,212,1085,206,1064,204,1045,206,1034,211,1031,216,1034,224"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a67b3db37af2f8ebc4f6895202c358604" title=" " alt="" coords="1209,207,1358,240"/>
<area shape="poly" title=" " alt="" coords="1126,234,1193,229,1193,234,1127,240"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab84f86be5fe7f7abcf8ffb6fa0a38700" title=" " alt="" coords="1201,264,1366,298"/>
<area shape="poly" title=" " alt="" coords="1127,250,1187,261,1186,266,1126,256"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#aaf08ec177405c5e004b1ca33808f19da" title=" " alt="" coords="1416,264,1513,298"/>
<area shape="poly" title=" " alt="" coords="1340,238,1402,258,1400,263,1338,243"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e2d83bace7533ed4cc93bdf2a94ad95" title=" " alt="" coords="1418,207,1511,240"/>
<area shape="poly" title=" " alt="" coords="1358,221,1403,221,1403,226,1358,226"/>
<area shape="poly" title=" " alt="" coords="1366,278,1400,278,1400,284,1366,284"/>
<area shape="poly" title=" " alt="" coords="1338,261,1403,240,1404,245,1340,266"/>
</map>
</div>

</div>
</div>
<a id="a28c0345ea0c2bb5b2e5815235849fd30" name="a28c0345ea0c2bb5b2e5815235849fd30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28c0345ea0c2bb5b2e5815235849fd30">&#9670;&#160;</a></span>add_mount_inner()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int add_mount_inner </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>target</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>filesystemtype</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long</td>          <td class="paramname"><span class="paramname"><em>mountflags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long</td>          <td class="paramname"><span class="paramname"><em>propflags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>optstr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>error</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00203">203</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  205</span>{</div>
<div class="line"><span class="lineno">  206</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="#a6a335418ee05d0ecbda2094c55408404">_add_mount</a>(source, target, filesystemtype, mountflags, propflags, optstr, error, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  207</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d5a/fs_8c_source.html#l00158">_add_mount()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00052">mount::error</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00048">mount::filesystemtype</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00049">mount::mountflags</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00051">mount::optstr</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00050">mount::propflags</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00046">mount::source</a>, and <a class="el" href="../../d2/d5a/fs_8c_source.html#l00047">mount::target</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d5a/fs_8c_a28c0345ea0c2bb5b2e5815235849fd30_cgraph.png" border="0" usemap="#ad2/d5a/fs_8c_a28c0345ea0c2bb5b2e5815235849fd30_cgraph" alt=""/></div>
<map name="ad2/d5a/fs_8c_a28c0345ea0c2bb5b2e5815235849fd30_cgraph" id="ad2/d5a/fs_8c_a28c0345ea0c2bb5b2e5815235849fd30_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,188,191"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a6a335418ee05d0ecbda2094c55408404" title=" " alt="" coords="236,157,370,191"/>
<area shape="poly" title=" " alt="" coords="188,172,220,172,220,177,188,177"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e08d7ee7d67ff58eeea30dd8a9356d1" title=" " alt="" coords="427,79,520,112"/>
<area shape="poly" title=" " alt="" coords="340,154,420,117,422,122,343,159"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab9041e08938920d5ae722e2d57dc20e2" title=" " alt="" coords="418,185,528,219"/>
<area shape="poly" title=" " alt="" coords="371,183,403,188,402,193,370,188"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a55d3dbabb73970f597eff3d04809f4ef" title=" " alt="" coords="600,29,731,63"/>
<area shape="poly" title=" " alt="" coords="520,81,585,64,586,69,521,86"/>
<area shape="poly" title=" " alt="" coords="630,30,627,20,632,11,645,5,666,3,688,5,700,12,697,16,686,10,665,8,646,10,635,15,632,20,635,28"/>
<area shape="poly" title=" " alt="" coords="484,183,529,122,554,92,575,72,585,66,588,70,578,76,558,95,533,125,488,187"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#abd4899daa8ad959e6c9694dd5e4132a8" title=" " alt="" coords="584,283,747,316"/>
<area shape="poly" title=" " alt="" coords="498,217,534,244,578,269,589,274,587,279,575,274,531,248,494,222"/>
<area shape="rect" href="../../da/d23/list_8h.html#a875b53c95596d9e8df15ac54f6d24ae6" title=" " alt="" coords="839,335,931,368"/>
<area shape="poly" title=" " alt="" coords="485,218,519,274,546,303,578,327,607,340,639,349,705,360,768,362,823,358,823,363,768,367,704,365,638,355,606,345,575,331,542,307,515,277,480,221"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab6f5b72e706a1955a5a5d6af278c677e" title=" " alt="" coords="576,392,755,426"/>
<area shape="poly" title=" " alt="" coords="483,219,517,291,544,334,578,371,595,382,591,387,575,375,540,337,512,294,478,221"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a6de877c20c7b55fa52c80e7be87715fa" title=" " alt="" coords="616,87,715,120"/>
<area shape="poly" title=" " alt="" coords="494,183,531,156,575,129,600,119,602,123,578,134,534,160,497,187"/>
<area shape="rect" href="../../da/d23/list_8h.html#abb4dd1eb7346eb35ea621351220e80ce" title=" " alt="" coords="608,144,723,178"/>
<area shape="poly" title=" " alt="" coords="528,188,593,174,594,179,529,193"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a212673459e8e8ff2e11a8d093602d35e" title=" " alt="" coords="604,225,727,259"/>
<area shape="poly" title=" " alt="" coords="529,211,589,224,588,229,528,216"/>
<area shape="poly" title=" " alt="" coords="740,314,824,335,823,340,739,320"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="1015,349,1116,383"/>
<area shape="poly" title=" " alt="" coords="932,353,1000,358,999,363,931,358"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="820,392,950,426"/>
<area shape="poly" title=" " alt="" coords="755,406,805,406,805,412,755,412"/>
<area shape="poly" title=" " alt="" coords="949,391,999,379,1000,384,951,396"/>
<area shape="poly" title=" " alt="" coords="630,226,627,216,632,207,645,201,666,199,688,201,700,208,697,212,686,206,665,204,646,206,635,211,632,216,635,224"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a67b3db37af2f8ebc4f6895202c358604" title=" " alt="" coords="810,207,960,240"/>
<area shape="poly" title=" " alt="" coords="728,234,794,229,795,234,728,240"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab84f86be5fe7f7abcf8ffb6fa0a38700" title=" " alt="" coords="803,264,967,298"/>
<area shape="poly" title=" " alt="" coords="728,250,788,261,787,266,727,256"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#aaf08ec177405c5e004b1ca33808f19da" title=" " alt="" coords="1017,264,1114,298"/>
<area shape="poly" title=" " alt="" coords="941,238,1003,258,1001,263,939,243"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e2d83bace7533ed4cc93bdf2a94ad95" title=" " alt="" coords="1020,207,1112,240"/>
<area shape="poly" title=" " alt="" coords="960,221,1004,221,1004,226,960,226"/>
<area shape="poly" title=" " alt="" coords="967,278,1002,278,1002,284,967,284"/>
<area shape="poly" title=" " alt="" coords="939,261,1004,240,1006,245,941,266"/>
</map>
</div>

</div>
</div>
<a id="a2b2c9415458859df2a4ed2558f53db56" name="a2b2c9415458859df2a4ed2558f53db56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b2c9415458859df2a4ed2558f53db56">&#9670;&#160;</a></span>add_script_interp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int add_script_interp </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>map</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>size</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00463">463</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  464</span>{</div>
<div class="line"><span class="lineno">  465</span>    <span class="keywordtype">int</span> start = 2;</div>
<div class="line"><span class="lineno">  466</span>    <span class="keywordflow">while</span> (start &lt; size &amp;&amp; map[start] != <span class="charliteral">&#39;/&#39;</span>) {</div>
<div class="line"><span class="lineno">  467</span>        start++;</div>
<div class="line"><span class="lineno">  468</span>    }</div>
<div class="line"><span class="lineno">  469</span>    <span class="keywordflow">if</span> (start &gt;= size) {</div>
<div class="line"><span class="lineno">  470</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;bad script interp (%s)\n&quot;</span>, <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>);</div>
<div class="line"><span class="lineno">  471</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  472</span>    }</div>
<div class="line"><span class="lineno">  473</span>    <span class="keywordtype">int</span> stop = start + 1;</div>
<div class="line"><span class="lineno">  474</span>    <span class="keywordflow">while</span> (stop &lt; size &amp;&amp; map[stop] &gt; 0x20 &amp;&amp; map[stop] &lt;= 0x7e) {</div>
<div class="line"><span class="lineno">  475</span>        stop++;</div>
<div class="line"><span class="lineno">  476</span>    }</div>
<div class="line"><span class="lineno">  477</span>    <span class="keywordflow">if</span> (stop &gt;= size || (stop-start) &gt; PATH_MAX) {</div>
<div class="line"><span class="lineno">  478</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;bad script interp (%s)\n&quot;</span>, <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>);</div>
<div class="line"><span class="lineno">  479</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  480</span>    }</div>
<div class="line"><span class="lineno">  481</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>[PATH_MAX];</div>
<div class="line"><span class="lineno">  482</span>    strncpy(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, map+start, stop-start);</div>
<div class="line"><span class="lineno">  483</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../df/d26/fs_8h.html#a3c2c8ec14a25736480de113e1b71f52d">add_path_and_deps</a>(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, 1, -1, 0);</div>
<div class="line"><span class="lineno">  484</span>}</div>
<div class="ttc" id="afs_8h_html_a3c2c8ec14a25736480de113e1b71f52d"><div class="ttname"><a href="../../df/d26/fs_8h.html#a3c2c8ec14a25736480de113e1b71f52d">add_path_and_deps</a></div><div class="ttdeci">static int add_path_and_deps(const char *path, int readonly, int error, int lib)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d26/fs_8h_source.html#l00027">fs.h:27</a></div></div>
<div class="ttc" id="amkdev_8c_html_a024e65f7d9664cdc767f51c283fd8353"><div class="ttname"><a href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a></div><div class="ttdeci">static char buf[PATH_MAX]</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d9a/mkdev_8c_source.html#l00034">mkdev.c:34</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../df/d26/fs_8h_source.html#l00027">add_path_and_deps()</a>, <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, and <a class="el" href="../../df/d0e/ubusd__obj_8c_source.html#l00019">path</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d5a/fs_8c_source.html#l00486">add_2paths_and_deps()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d5a/fs_8c_a2b2c9415458859df2a4ed2558f53db56_cgraph.png" border="0" usemap="#ad2/d5a/fs_8c_a2b2c9415458859df2a4ed2558f53db56_cgraph" alt=""/></div>
<map name="ad2/d5a/fs_8c_a2b2c9415458859df2a4ed2558f53db56_cgraph" id="ad2/d5a/fs_8c_a2b2c9415458859df2a4ed2558f53db56_cgraph">
<area shape="rect" title=" " alt="" coords="5,367,187,400"/>
<area shape="rect" href="../../df/d26/fs_8h.html#a3c2c8ec14a25736480de113e1b71f52d" title=" " alt="" coords="235,393,440,427"/>
<area shape="poly" title=" " alt="" coords="188,391,219,394,219,400,187,396"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#ac4992c3c85512f44840f4eda86df97b5" title=" " alt="" coords="488,339,715,372"/>
<area shape="poly" title=" " alt="" coords="422,390,501,373,502,379,423,395"/>
<area shape="poly" title=" " alt="" coords="488,364,203,380,202,375,487,359"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4824ede62a9ceedb153f039c5dc212f9" title=" " alt="" coords="763,284,948,318"/>
<area shape="poly" title=" " alt="" coords="683,335,758,319,760,324,684,341"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e08d7ee7d67ff58eeea30dd8a9356d1" title=" " alt="" coords="1497,339,1590,372"/>
<area shape="poly" title=" " alt="" coords="716,353,1482,353,1482,358,716,358"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a5601edf43bf58289cb22c5b20d17a1e9" title=" " alt="" coords="1280,227,1412,260"/>
<area shape="poly" title=" " alt="" coords="626,336,686,300,724,283,763,269,830,254,899,242,1036,231,1163,230,1265,234,1265,239,1163,235,1037,236,899,248,831,259,764,274,726,287,689,305,629,340"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a48837326349fc40e7a38f613d853f8f2" title=" " alt="" coords="782,448,929,482"/>
<area shape="poly" title=" " alt="" coords="644,370,801,439,799,444,642,375"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a9ae7cc745a41248c9f0d9bbb83a86a43" title=" " alt="" coords="806,175,905,208"/>
<area shape="poly" title=" " alt="" coords="619,336,680,283,720,253,762,225,790,211,793,216,765,230,723,257,683,287,623,340"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2" title=" " alt="" coords="1037,284,1163,318"/>
<area shape="poly" title=" " alt="" coords="948,298,1021,298,1021,304,948,304"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a6a335418ee05d0ecbda2094c55408404" title=" " alt="" coords="1279,284,1413,318"/>
<area shape="poly" title=" " alt="" coords="1163,298,1263,298,1263,304,1163,304"/>
<area shape="poly" title=" " alt="" coords="1410,316,1483,336,1481,341,1409,321"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab9041e08938920d5ae722e2d57dc20e2" title=" " alt="" coords="1488,227,1599,260"/>
<area shape="poly" title=" " alt="" coords="1406,281,1473,261,1475,266,1407,286"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a55d3dbabb73970f597eff3d04809f4ef" title=" " alt="" coords="1671,392,1801,426"/>
<area shape="poly" title=" " alt="" coords="1591,366,1659,385,1657,390,1590,371"/>
<area shape="poly" title=" " alt="" coords="1701,393,1697,383,1702,373,1715,367,1736,365,1758,368,1770,374,1768,379,1756,373,1736,371,1717,373,1706,377,1702,383,1706,391"/>
<area shape="poly" title=" " alt="" coords="1560,259,1597,305,1648,355,1688,382,1685,386,1645,359,1593,308,1556,262"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#abd4899daa8ad959e6c9694dd5e4132a8" title=" " alt="" coords="1655,144,1817,178"/>
<area shape="poly" title=" " alt="" coords="1581,224,1646,194,1676,182,1678,186,1648,199,1583,228"/>
<area shape="rect" href="../../da/d23/list_8h.html#a875b53c95596d9e8df15ac54f6d24ae6" title=" " alt="" coords="1909,196,2001,230"/>
<area shape="poly" title=" " alt="" coords="1599,237,1893,215,1894,220,1599,242"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab6f5b72e706a1955a5a5d6af278c677e" title=" " alt="" coords="1647,253,1825,287"/>
<area shape="poly" title=" " alt="" coords="1600,249,1631,253,1631,258,1599,254"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a6de877c20c7b55fa52c80e7be87715fa" title=" " alt="" coords="1687,311,1785,344"/>
<area shape="poly" title=" " alt="" coords="1574,259,1648,297,1673,307,1671,312,1646,302,1572,263"/>
<area shape="rect" href="../../da/d23/list_8h.html#abb4dd1eb7346eb35ea621351220e80ce" title=" " alt="" coords="1679,5,1793,39"/>
<area shape="poly" title=" " alt="" coords="1547,225,1558,189,1578,141,1606,91,1624,68,1645,48,1663,37,1666,41,1648,52,1628,72,1611,94,1582,143,1563,191,1552,227"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a212673459e8e8ff2e11a8d093602d35e" title=" " alt="" coords="1674,87,1798,120"/>
<area shape="poly" title=" " alt="" coords="1554,224,1591,177,1616,152,1645,129,1658,122,1661,127,1648,134,1620,156,1595,181,1558,228"/>
<area shape="poly" title=" " alt="" coords="1811,176,1895,196,1893,201,1809,181"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="2085,224,2187,258"/>
<area shape="poly" title=" " alt="" coords="2002,217,2070,228,2069,233,2002,223"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="1891,253,2020,287"/>
<area shape="poly" title=" " alt="" coords="1825,268,1875,268,1875,273,1825,273"/>
<area shape="poly" title=" " alt="" coords="2020,257,2069,249,2070,254,2021,262"/>
<area shape="poly" title=" " alt="" coords="1701,87,1697,77,1702,68,1715,62,1736,60,1758,63,1770,69,1768,74,1756,68,1736,65,1717,67,1706,72,1702,78,1706,85"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a67b3db37af2f8ebc4f6895202c358604" title=" " alt="" coords="1881,56,2030,90"/>
<area shape="poly" title=" " alt="" coords="1798,92,1865,83,1866,88,1798,98"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab84f86be5fe7f7abcf8ffb6fa0a38700" title=" " alt="" coords="1873,113,2037,147"/>
<area shape="poly" title=" " alt="" coords="1798,108,1857,116,1857,121,1798,114"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#aaf08ec177405c5e004b1ca33808f19da" title=" " alt="" coords="2087,113,2185,147"/>
<area shape="poly" title=" " alt="" coords="2011,88,2073,108,2072,113,2010,93"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e2d83bace7533ed4cc93bdf2a94ad95" title=" " alt="" coords="2090,56,2182,90"/>
<area shape="poly" title=" " alt="" coords="2030,70,2074,70,2074,76,2030,76"/>
<area shape="poly" title=" " alt="" coords="2038,128,2072,128,2072,133,2038,133"/>
<area shape="poly" title=" " alt="" coords="2010,110,2074,89,2076,94,2011,115"/>
<area shape="poly" title=" " alt="" coords="1413,241,1473,241,1473,246,1413,246"/>
<area shape="poly" title=" " alt="" coords="782,461,488,431,455,428,456,422,488,426,782,456"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a12c644fb0c26d71dff162e574593230e" title=" " alt="" coords="996,508,1204,542"/>
<area shape="poly" title=" " alt="" coords="927,480,1014,501,1013,506,926,485"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a0ac3dca93dd7aead60876faae920be80" title=" " alt="" coords="996,393,1204,427"/>
<area shape="poly" title=" " alt="" coords="928,446,1006,428,1007,434,929,451"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a1fada8bd25495e270df90e58db6890f1" title=" " alt="" coords="1018,451,1182,484"/>
<area shape="poly" title=" " alt="" coords="929,463,1002,464,1002,469,929,468"/>
<area shape="poly" title=" " alt="" coords="995,523,761,503,624,485,487,459,401,435,402,430,489,454,625,480,762,498,996,517"/>
<area shape="poly" title=" " alt="" coords="996,413,456,413,456,408,996,408"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#aecc20c7d8b2e298820356d8e32eb4f4a" title=" " alt="" coords="1252,479,1440,512"/>
<area shape="poly" title=" " alt="" coords="1183,474,1237,480,1236,486,1182,480"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a3212416f7b63427063c564bdedd8b645" title=" " alt="" coords="1252,421,1440,455"/>
<area shape="poly" title=" " alt="" coords="1182,455,1236,449,1237,454,1183,460"/>
</map>
</div>

</div>
</div>
<a id="ab3f280d4a5a86fc2a2c0632a4a271ef8" name="ab3f280d4a5a86fc2a2c0632a4a271ef8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3f280d4a5a86fc2a2c0632a4a271ef8">&#9670;&#160;</a></span>build_noafile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void build_noafile </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00418">418</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  418</span>                                {</div>
<div class="line"><span class="lineno">  419</span>    <span class="keywordtype">int</span> fd;</div>
<div class="line"><span class="lineno">  420</span> </div>
<div class="line"><span class="lineno">  421</span>    fd = creat(<a class="code hl_define" href="#acba7d2341524f732462beeee4febf9aa">UJAIL_NOAFILE</a>, 0000);</div>
<div class="line"><span class="lineno">  422</span>    <span class="keywordflow">if</span> (fd &lt; 0)</div>
<div class="line"><span class="lineno">  423</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>    close(fd);</div>
<div class="line"><span class="lineno">  426</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  427</span>}</div>
<div class="ttc" id="afs_8c_html_acba7d2341524f732462beeee4febf9aa"><div class="ttname"><a href="#acba7d2341524f732462beeee4febf9aa">UJAIL_NOAFILE</a></div><div class="ttdeci">#define UJAIL_NOAFILE</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00042">fs.c:42</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d5a/fs_8c_source.html#l00042">UJAIL_NOAFILE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d5a/fs_8c_source.html#l00429">mount_all()</a>.</p>

</div>
</div>
<a id="a9a6c15b3db1b76232ac5ccf46cca0aef" name="a9a6c15b3db1b76232ac5ccf46cca0aef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a6c15b3db1b76232ac5ccf46cca0aef">&#9670;&#160;</a></span>do_mount()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int do_mount </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>root</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>orig_source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>target</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>filesystemtype</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long</td>          <td class="paramname"><span class="paramname"><em>orig_mountflags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long</td>          <td class="paramname"><span class="paramname"><em>propflags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>optstr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>error</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>inner</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00058">58</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   60</span>{</div>
<div class="line"><span class="lineno">   61</span>    <span class="keyword">struct </span>stat s;</div>
<div class="line"><span class="lineno">   62</span>    <span class="keywordtype">char</span> <span class="keyword">new</span>[PATH_MAX];</div>
<div class="line"><span class="lineno">   63</span>    <span class="keywordtype">char</span> *source = (<span class="keywordtype">char</span> *)orig_source;</div>
<div class="line"><span class="lineno">   64</span>    <span class="keywordtype">int</span> fd, ret = 0;</div>
<div class="line"><span class="lineno">   65</span>    <span class="keywordtype">bool</span> is_bind = (orig_mountflags &amp; MS_BIND);</div>
<div class="line"><span class="lineno">   66</span>    <span class="keywordtype">bool</span> is_mask = (source == (<span class="keywordtype">void</span> *)(-1));</div>
<div class="line"><span class="lineno">   67</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> mountflags = orig_mountflags;</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>    assert(!(inner &amp;&amp; is_mask));</div>
<div class="line"><span class="lineno">   70</span>    assert(!(inner &amp;&amp; !orig_source));</div>
<div class="line"><span class="lineno">   71</span> </div>
<div class="line"><span class="lineno">   72</span>    <span class="keywordflow">if</span> (source &amp;&amp; is_bind &amp;&amp; stat(source, &amp;s)) {</div>
<div class="line"><span class="lineno">   73</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;stat(%s) failed: %m\n&quot;</span>, source);</div>
<div class="line"><span class="lineno">   74</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">   75</span>    }</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>    <span class="keywordflow">if</span> (inner)</div>
<div class="line"><span class="lineno">   78</span>        <span class="keywordflow">if</span> (asprintf(&amp;source, <span class="stringliteral">&quot;%s%s&quot;</span>, root, orig_source) &lt; 0)</div>
<div class="line"><span class="lineno">   79</span>            <span class="keywordflow">return</span> ENOMEM;</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>    snprintf(<span class="keyword">new</span>, <span class="keyword">sizeof</span>(<span class="keyword">new</span>), <span class="stringliteral">&quot;%s%s&quot;</span>, root, target?target:source);</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>    <span class="keywordflow">if</span> (is_mask) {</div>
<div class="line"><span class="lineno">   84</span>        <span class="keywordflow">if</span> (stat(<span class="keyword">new</span>, &amp;s))</div>
<div class="line"><span class="lineno">   85</span>            <span class="keywordflow">return</span> 0; <span class="comment">/* doesn&#39;t exists, nothing to mask */</span></div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>        <span class="keywordflow">if</span> (S_ISDIR(s.st_mode)) {<span class="comment">/* use empty 0-sized tmpfs for directories */</span></div>
<div class="line"><span class="lineno">   88</span>            <span class="keywordflow">if</span> (<a class="code hl_struct" href="#d3/df8/structmount">mount</a>(<span class="stringliteral">&quot;none&quot;</span>, <span class="keyword">new</span>, <span class="stringliteral">&quot;tmpfs&quot;</span>, MS_RDONLY | MS_NOSUID | MS_NOEXEC | MS_NODEV | MS_NOATIME, <span class="stringliteral">&quot;size=0,mode=000&quot;</span>))</div>
<div class="line"><span class="lineno">   89</span>                <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">   90</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   91</span>            <span class="comment">/* mount-bind 0-sized file having mode 000 */</span></div>
<div class="line"><span class="lineno">   92</span>            <span class="keywordflow">if</span> (<a class="code hl_struct" href="#d3/df8/structmount">mount</a>(<a class="code hl_define" href="#acba7d2341524f732462beeee4febf9aa">UJAIL_NOAFILE</a>, <span class="keyword">new</span>, <span class="stringliteral">&quot;bind&quot;</span>, MS_BIND, NULL))</div>
<div class="line"><span class="lineno">   93</span>                <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>            <span class="keywordflow">if</span> (<a class="code hl_struct" href="#d3/df8/structmount">mount</a>(<a class="code hl_define" href="#acba7d2341524f732462beeee4febf9aa">UJAIL_NOAFILE</a>, <span class="keyword">new</span>, <span class="stringliteral">&quot;bind&quot;</span>, MS_REMOUNT | MS_BIND | MS_RDONLY | MS_NOSUID | MS_NOEXEC | MS_NODEV | MS_NOATIME, NULL))</div>
<div class="line"><span class="lineno">   96</span>                <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">   97</span>        }</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>        <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;masked path %s\n&quot;</span>, <span class="keyword">new</span>);</div>
<div class="line"><span class="lineno">  100</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  101</span>    }</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>    <span class="keywordflow">if</span> (!is_bind || (source &amp;&amp; S_ISDIR(s.st_mode))) {</div>
<div class="line"><span class="lineno">  105</span>        <a class="code hl_function" href="../../d0/d2b/libubox_2utils_8c.html#a9fb089901b41392a5ac197f3e18cc3f7">mkdir_p</a>(<span class="keyword">new</span>, 0755);</div>
<div class="line"><span class="lineno">  106</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_bind &amp;&amp; source) {</div>
<div class="line"><span class="lineno">  107</span>        <a class="code hl_function" href="../../d0/d2b/libubox_2utils_8c.html#a9fb089901b41392a5ac197f3e18cc3f7">mkdir_p</a>(dirname(<span class="keyword">new</span>), 0755);</div>
<div class="line"><span class="lineno">  108</span>        snprintf(<span class="keyword">new</span>, <span class="keyword">sizeof</span>(<span class="keyword">new</span>), <span class="stringliteral">&quot;%s%s&quot;</span>, root, target?target:source);</div>
<div class="line"><span class="lineno">  109</span>        fd = open(<span class="keyword">new</span>, O_CREAT|O_WRONLY|O_TRUNC|O_EXCL, 0644);</div>
<div class="line"><span class="lineno">  110</span>        <span class="keywordflow">if</span> (fd &gt;= 0)</div>
<div class="line"><span class="lineno">  111</span>            close(fd);</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>        <span class="keywordflow">if</span> (error &amp;&amp; fd &lt; 0 &amp;&amp; errno != EEXIST) {</div>
<div class="line"><span class="lineno">  114</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to create mount target %s: %m\n&quot;</span>, <span class="keyword">new</span>);</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>            ret = errno;</div>
<div class="line"><span class="lineno">  117</span>            <span class="keywordflow">goto</span> free_source_out;</div>
<div class="line"><span class="lineno">  118</span>        }</div>
<div class="line"><span class="lineno">  119</span>    }</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    <span class="keywordflow">if</span> (is_bind) {</div>
<div class="line"><span class="lineno">  122</span>        <span class="keywordflow">if</span> (<a class="code hl_struct" href="#d3/df8/structmount">mount</a>(source?:<span class="keyword">new</span>, <span class="keyword">new</span>, filesystemtype?:<span class="stringliteral">&quot;bind&quot;</span>, MS_BIND | (mountflags &amp; MS_REC), optstr)) {</div>
<div class="line"><span class="lineno">  123</span>            <span class="keywordflow">if</span> (error)</div>
<div class="line"><span class="lineno">  124</span>                <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to mount -B %s %s: %m\n&quot;</span>, source, <span class="keyword">new</span>);</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>            ret = error;</div>
<div class="line"><span class="lineno">  127</span>            <span class="keywordflow">goto</span> free_source_out;</div>
<div class="line"><span class="lineno">  128</span>        }</div>
<div class="line"><span class="lineno">  129</span>        mountflags |= MS_REMOUNT;</div>
<div class="line"><span class="lineno">  130</span>    }</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *hack_fstype = ((!filesystemtype || strcmp(filesystemtype, <span class="stringliteral">&quot;cgroup&quot;</span>))?filesystemtype:<span class="stringliteral">&quot;cgroup2&quot;</span>);</div>
<div class="line"><span class="lineno">  133</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="#d3/df8/structmount">mount</a>(source?:(is_bind?<span class="keyword">new</span>:NULL), <span class="keyword">new</span>, hack_fstype?:<span class="stringliteral">&quot;none&quot;</span>, mountflags, optstr)) {</div>
<div class="line"><span class="lineno">  134</span>        <span class="keywordflow">if</span> (error)</div>
<div class="line"><span class="lineno">  135</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to mount %s %s: %m\n&quot;</span>, source, <span class="keyword">new</span>);</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>        ret = error;</div>
<div class="line"><span class="lineno">  138</span>        <span class="keywordflow">goto</span> free_source_out;</div>
<div class="line"><span class="lineno">  139</span>    }</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>    <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;mount %s%s %s (%s)\n&quot;</span>, (mountflags &amp; MS_BIND)?<span class="stringliteral">&quot;-B &quot;</span>:<span class="stringliteral">&quot;&quot;</span>, source, <span class="keyword">new</span>,</div>
<div class="line"><span class="lineno">  142</span>          (mountflags &amp; MS_RDONLY)?<span class="stringliteral">&quot;ro&quot;</span>:<span class="stringliteral">&quot;rw&quot;</span>);</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>    <span class="keywordflow">if</span> (propflags &amp;&amp; <a class="code hl_struct" href="#d3/df8/structmount">mount</a>(<span class="stringliteral">&quot;none&quot;</span>, <span class="keyword">new</span>, <span class="stringliteral">&quot;none&quot;</span>, propflags, NULL)) {</div>
<div class="line"><span class="lineno">  145</span>        <span class="keywordflow">if</span> (error)</div>
<div class="line"><span class="lineno">  146</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to mount --make-... %s \n&quot;</span>, <span class="keyword">new</span>);</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>        ret = error;</div>
<div class="line"><span class="lineno">  149</span>    }</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>free_source_out:</div>
<div class="line"><span class="lineno">  152</span>    <span class="keywordflow">if</span> (inner)</div>
<div class="line"><span class="lineno">  153</span>        free(source);</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno">  156</span>}</div>
<div class="ttc" id="alibubox_2utils_8c_html_a9fb089901b41392a5ac197f3e18cc3f7"><div class="ttname"><a href="../../d0/d2b/libubox_2utils_8c.html#a9fb089901b41392a5ac197f3e18cc3f7">mkdir_p</a></div><div class="ttdeci">int mkdir_p(char *dir, mode_t mask)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d2b/libubox_2utils_8c_source.html#l00161">utils.c:161</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../d0/d2b/libubox_2utils_8c_source.html#l00161">mkdir_p()</a>, and <a class="el" href="../../d2/d5a/fs_8c_source.html#l00042">UJAIL_NOAFILE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d5a/fs_8c_source.html#l00429">mount_all()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d5a/fs_8c_a9a6c15b3db1b76232ac5ccf46cca0aef_cgraph.png" border="0" usemap="#ad2/d5a/fs_8c_a9a6c15b3db1b76232ac5ccf46cca0aef_cgraph" alt=""/></div>
<map name="ad2/d5a/fs_8c_a9a6c15b3db1b76232ac5ccf46cca0aef_cgraph" id="ad2/d5a/fs_8c_a9a6c15b3db1b76232ac5ccf46cca0aef_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,119,63"/>
<area shape="rect" href="../../d0/d2b/libubox_2utils_8c.html#a9fb089901b41392a5ac197f3e18cc3f7" title=" " alt="" coords="167,29,263,63"/>
<area shape="poly" title=" " alt="" coords="119,44,151,44,151,49,119,49"/>
<area shape="poly" title=" " alt="" coords="186,30,184,20,188,11,198,5,215,3,233,5,243,12,240,16,231,10,215,8,200,10,192,14,189,20,192,28"/>
</map>
</div>

</div>
</div>
<a id="a47cfef0db3b7b8feb6675dd2ee7e4d4e" name="a47cfef0db3b7b8feb6675dd2ee7e4d4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47cfef0db3b7b8feb6675dd2ee7e4d4e">&#9670;&#160;</a></span>mount_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mount_all </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>jailroot</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00429">429</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  429</span>                                    {</div>
<div class="line"><span class="lineno">  430</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d1/d9e/elf_8h.html#d3/d23/structlibrary">library</a> *l;</div>
<div class="line"><span class="lineno">  431</span>    <span class="keyword">struct </span><a class="code hl_struct" href="#d3/df8/structmount">mount</a> *m;</div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>    <a class="code hl_function" href="#ab3f280d4a5a86fc2a2c0632a4a271ef8">build_noafile</a>();</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>    <a class="code hl_define" href="../../d3/d51/avl_8h.html#a78fce1e55fe672174caa3053a460ae56">avl_for_each_element</a>(&amp;<a class="code hl_variable" href="../../d2/da6/elf_8c.html#ad5cd1529b1d09e1fefb94edad826fe2b">libraries</a>, l, <a class="code hl_variable" href="#a83d6ac10330d409124ca276a28d4101f">avl</a>)</div>
<div class="line"><span class="lineno">  436</span>        <a class="code hl_function" href="#a31752c6608fbf56bb359ba109bdc6f6f">add_mount_bind</a>(l-&gt;<a class="code hl_variable" href="../../d1/d9e/elf_8h.html#ac8db6c3d0fa3f4c42e13f8281aab15da">path</a>, 1, -1);</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>    <a class="code hl_define" href="../../d3/d51/avl_8h.html#a78fce1e55fe672174caa3053a460ae56">avl_for_each_element</a>(&amp;<a class="code hl_variable" href="#ab73004ccbdbc7a5bcf2d7534135070c5">mounts</a>, m, <a class="code hl_variable" href="#a83d6ac10330d409124ca276a28d4101f">avl</a>)</div>
<div class="line"><span class="lineno">  439</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="#a9a6c15b3db1b76232ac5ccf46cca0aef">do_mount</a>(jailroot, m-&gt;<a class="code hl_variable" href="#a793de928240866f861cfb8a83cf05598">source</a>, m-&gt;<a class="code hl_variable" href="#a276688d0f59467daf07eac8496873d02">target</a>, m-&gt;<a class="code hl_variable" href="#a72319afac35d51a3ad918397ab9e1c4d">filesystemtype</a>, m-&gt;<a class="code hl_variable" href="#a687f3d081beb41b92e8bb52adec21826">mountflags</a>,</div>
<div class="line"><span class="lineno">  440</span>                 m-&gt;<a class="code hl_variable" href="#ac1bc1981b26e095cda174d1f26c66313">propflags</a>, m-&gt;<a class="code hl_variable" href="#af46af2468729be934aed123bb2914123">optstr</a>, m-&gt;<a class="code hl_variable" href="#a2253030ebbd8465ad30762a7500644ae">error</a>, m-&gt;<a class="code hl_variable" href="#a1bd6bb339b9438359be62d3259a30b08">inner</a>))</div>
<div class="line"><span class="lineno">  441</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  444</span>}</div>
<div class="ttc" id="aavl_8h_html_a78fce1e55fe672174caa3053a460ae56"><div class="ttname"><a href="../../d3/d51/avl_8h.html#a78fce1e55fe672174caa3053a460ae56">avl_for_each_element</a></div><div class="ttdeci">#define avl_for_each_element(tree, element, node_member)</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d51/avl_8h_source.html#l00366">avl.h:366</a></div></div>
<div class="ttc" id="aelf_8h_html_ac8db6c3d0fa3f4c42e13f8281aab15da"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#ac8db6c3d0fa3f4c42e13f8281aab15da">library::path</a></div><div class="ttdeci">char * path</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d9e/elf_8h_source.html#l00022">elf.h:22</a></div></div>
<div class="ttc" id="aelf_8h_html_d3/d23/structlibrary"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#d3/d23/structlibrary">library</a></div><div class="ttdef"><b>Definition</b> <a href="../../d1/d9e/elf_8h_source.html#l00019">elf.h:19</a></div></div>
<div class="ttc" id="afs_8c_html_a31752c6608fbf56bb359ba109bdc6f6f"><div class="ttname"><a href="#a31752c6608fbf56bb359ba109bdc6f6f">add_mount_bind</a></div><div class="ttdeci">int add_mount_bind(const char *path, int readonly, int error)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00219">fs.c:219</a></div></div>
<div class="ttc" id="afs_8c_html_a9a6c15b3db1b76232ac5ccf46cca0aef"><div class="ttname"><a href="#a9a6c15b3db1b76232ac5ccf46cca0aef">do_mount</a></div><div class="ttdeci">static int do_mount(const char *root, const char *orig_source, const char *target, const char *filesystemtype, unsigned long orig_mountflags, unsigned long propflags, const char *optstr, int error, bool inner)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00058">fs.c:58</a></div></div>
<div class="ttc" id="afs_8c_html_ab3f280d4a5a86fc2a2c0632a4a271ef8"><div class="ttname"><a href="#ab3f280d4a5a86fc2a2c0632a4a271ef8">build_noafile</a></div><div class="ttdeci">static void build_noafile(void)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00418">fs.c:418</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d5a/fs_8c_source.html#l00219">add_mount_bind()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00045">mount::avl</a>, <a class="el" href="../../d3/d51/avl_8h_source.html#l00366">avl_for_each_element</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00418">build_noafile()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00058">do_mount()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00052">mount::error</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00048">mount::filesystemtype</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00053">mount::inner</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00029">libraries</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00049">mount::mountflags</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00056">mounts</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00051">mount::optstr</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00022">library::path</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00050">mount::propflags</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00046">mount::source</a>, and <a class="el" href="../../d2/d5a/fs_8c_source.html#l00047">mount::target</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00679">build_jail_fs()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d5a/fs_8c_a47cfef0db3b7b8feb6675dd2ee7e4d4e_cgraph.png" border="0" usemap="#ad2/d5a/fs_8c_a47cfef0db3b7b8feb6675dd2ee7e4d4e_cgraph" alt=""/></div>
<map name="ad2/d5a/fs_8c_a47cfef0db3b7b8feb6675dd2ee7e4d4e_cgraph" id="ad2/d5a/fs_8c_a47cfef0db3b7b8feb6675dd2ee7e4d4e_cgraph">
<area shape="rect" title=" " alt="" coords="5,215,117,248"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a31752c6608fbf56bb359ba109bdc6f6f" title=" " alt="" coords="165,157,340,191"/>
<area shape="poly" title=" " alt="" coords="116,212,179,193,181,198,118,217"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#ab3f280d4a5a86fc2a2c0632a4a271ef8" title=" " alt="" coords="183,215,322,248"/>
<area shape="poly" title=" " alt="" coords="117,229,168,229,168,234,117,234"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a9a6c15b3db1b76232ac5ccf46cca0aef" title=" " alt="" coords="196,272,309,306"/>
<area shape="poly" title=" " alt="" coords="118,246,182,265,180,270,116,251"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4824ede62a9ceedb153f039c5dc212f9" title=" " alt="" coords="388,157,572,191"/>
<area shape="poly" title=" " alt="" coords="340,172,372,172,372,177,340,177"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2" title=" " alt="" coords="620,157,746,191"/>
<area shape="poly" title=" " alt="" coords="573,172,605,172,605,177,573,177"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a6a335418ee05d0ecbda2094c55408404" title=" " alt="" coords="794,157,928,191"/>
<area shape="poly" title=" " alt="" coords="746,172,778,172,778,177,746,177"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e08d7ee7d67ff58eeea30dd8a9356d1" title=" " alt="" coords="985,79,1078,112"/>
<area shape="poly" title=" " alt="" coords="898,154,978,117,980,122,901,159"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab9041e08938920d5ae722e2d57dc20e2" title=" " alt="" coords="976,185,1086,219"/>
<area shape="poly" title=" " alt="" coords="929,183,961,188,960,193,928,188"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a55d3dbabb73970f597eff3d04809f4ef" title=" " alt="" coords="1158,29,1289,63"/>
<area shape="poly" title=" " alt="" coords="1078,81,1143,64,1144,69,1079,86"/>
<area shape="poly" title=" " alt="" coords="1188,30,1185,20,1190,11,1203,5,1224,3,1246,5,1258,12,1255,16,1244,10,1223,8,1204,10,1193,15,1190,20,1193,28"/>
<area shape="poly" title=" " alt="" coords="1042,183,1087,122,1112,92,1133,72,1143,66,1146,70,1136,76,1116,95,1091,125,1046,187"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#abd4899daa8ad959e6c9694dd5e4132a8" title=" " alt="" coords="1142,283,1305,316"/>
<area shape="poly" title=" " alt="" coords="1056,217,1092,244,1136,269,1147,274,1145,279,1133,274,1089,248,1052,222"/>
<area shape="rect" href="../../da/d23/list_8h.html#a875b53c95596d9e8df15ac54f6d24ae6" title=" " alt="" coords="1397,335,1489,368"/>
<area shape="poly" title=" " alt="" coords="1043,218,1077,274,1104,303,1136,327,1165,340,1197,349,1263,360,1326,362,1381,358,1381,363,1326,367,1262,365,1196,355,1164,345,1133,331,1100,307,1073,277,1038,221"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab6f5b72e706a1955a5a5d6af278c677e" title=" " alt="" coords="1134,392,1313,426"/>
<area shape="poly" title=" " alt="" coords="1041,219,1075,291,1102,334,1136,371,1153,382,1149,387,1133,375,1098,337,1070,294,1036,221"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a6de877c20c7b55fa52c80e7be87715fa" title=" " alt="" coords="1174,87,1273,120"/>
<area shape="poly" title=" " alt="" coords="1052,183,1089,156,1133,129,1158,119,1160,123,1136,134,1092,160,1055,187"/>
<area shape="rect" href="../../da/d23/list_8h.html#abb4dd1eb7346eb35ea621351220e80ce" title=" " alt="" coords="1166,144,1281,178"/>
<area shape="poly" title=" " alt="" coords="1086,188,1151,174,1152,179,1087,193"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a212673459e8e8ff2e11a8d093602d35e" title=" " alt="" coords="1162,225,1285,259"/>
<area shape="poly" title=" " alt="" coords="1087,211,1147,224,1146,229,1086,216"/>
<area shape="poly" title=" " alt="" coords="1298,314,1382,335,1381,340,1297,320"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="1573,363,1674,396"/>
<area shape="poly" title=" " alt="" coords="1490,356,1558,367,1557,372,1489,361"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="1378,392,1508,426"/>
<area shape="poly" title=" " alt="" coords="1313,406,1363,406,1363,412,1313,412"/>
<area shape="poly" title=" " alt="" coords="1508,396,1557,388,1558,393,1508,401"/>
<area shape="poly" title=" " alt="" coords="1188,226,1185,216,1190,207,1203,201,1224,199,1246,201,1258,208,1255,212,1244,206,1223,204,1204,206,1193,211,1190,216,1193,224"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a67b3db37af2f8ebc4f6895202c358604" title=" " alt="" coords="1368,195,1518,228"/>
<area shape="poly" title=" " alt="" coords="1285,231,1353,221,1353,227,1286,236"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab84f86be5fe7f7abcf8ffb6fa0a38700" title=" " alt="" coords="1361,252,1525,286"/>
<area shape="poly" title=" " alt="" coords="1286,247,1345,254,1344,260,1285,252"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#aaf08ec177405c5e004b1ca33808f19da" title=" " alt="" coords="1575,252,1672,286"/>
<area shape="poly" title=" " alt="" coords="1499,226,1561,246,1559,251,1497,231"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e2d83bace7533ed4cc93bdf2a94ad95" title=" " alt="" coords="1578,195,1670,228"/>
<area shape="poly" title=" " alt="" coords="1518,209,1562,209,1562,214,1518,214"/>
<area shape="poly" title=" " alt="" coords="1525,266,1560,266,1560,272,1525,272"/>
<area shape="poly" title=" " alt="" coords="1497,249,1562,228,1564,233,1499,254"/>
<area shape="rect" href="../../d0/d2b/libubox_2utils_8c.html#a9fb089901b41392a5ac197f3e18cc3f7" title=" " alt="" coords="432,272,528,306"/>
<area shape="poly" title=" " alt="" coords="309,286,416,286,416,292,309,292"/>
<area shape="poly" title=" " alt="" coords="443,273,439,263,445,253,459,247,480,245,503,248,516,254,514,259,502,253,480,251,460,253,448,257,445,263,448,271"/>
</map>
</div>

</div>
</div>
<a id="a4b6f537dfef57c06536c73d6c7c2ff48" name="a4b6f537dfef57c06536c73d6c7c2ff48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b6f537dfef57c06536c73d6c7c2ff48">&#9670;&#160;</a></span>mount_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mount_free </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00446">446</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  446</span>                      {</div>
<div class="line"><span class="lineno">  447</span>    <span class="keyword">struct </span><a class="code hl_struct" href="#d3/df8/structmount">mount</a> *m, *tmp;</div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>    <a class="code hl_define" href="../../d3/d51/avl_8h.html#af8b3ca3843e7a4bb3bc80858f53c2ad5">avl_remove_all_elements</a>(&amp;<a class="code hl_variable" href="#ab73004ccbdbc7a5bcf2d7534135070c5">mounts</a>, m, <a class="code hl_variable" href="#a83d6ac10330d409124ca276a28d4101f">avl</a>, tmp) {</div>
<div class="line"><span class="lineno">  450</span>        <span class="keywordflow">if</span> (m-&gt;<a class="code hl_variable" href="#a793de928240866f861cfb8a83cf05598">source</a> != (<span class="keywordtype">void</span>*)(-1))</div>
<div class="line"><span class="lineno">  451</span>            free((<span class="keywordtype">void</span>*)m-&gt;<a class="code hl_variable" href="#a793de928240866f861cfb8a83cf05598">source</a>);</div>
<div class="line"><span class="lineno">  452</span>        free((<span class="keywordtype">void</span>*)m-&gt;<a class="code hl_variable" href="#a276688d0f59467daf07eac8496873d02">target</a>);</div>
<div class="line"><span class="lineno">  453</span>        free((<span class="keywordtype">void</span>*)m-&gt;<a class="code hl_variable" href="#a72319afac35d51a3ad918397ab9e1c4d">filesystemtype</a>);</div>
<div class="line"><span class="lineno">  454</span>        free((<span class="keywordtype">void</span>*)m-&gt;<a class="code hl_variable" href="#af46af2468729be934aed123bb2914123">optstr</a>);</div>
<div class="line"><span class="lineno">  455</span>        free(m);</div>
<div class="line"><span class="lineno">  456</span>    }</div>
<div class="line"><span class="lineno">  457</span>}</div>
<div class="ttc" id="aavl_8h_html_af8b3ca3843e7a4bb3bc80858f53c2ad5"><div class="ttname"><a href="../../d3/d51/avl_8h.html#af8b3ca3843e7a4bb3bc80858f53c2ad5">avl_remove_all_elements</a></div><div class="ttdeci">#define avl_remove_all_elements(tree, element, node_member, ptr)</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d51/avl_8h_source.html#l00545">avl.h:545</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d5a/fs_8c_source.html#l00045">mount::avl</a>, <a class="el" href="../../d3/d51/avl_8h_source.html#l00545">avl_remove_all_elements</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00048">mount::filesystemtype</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00056">mounts</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00051">mount::optstr</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00046">mount::source</a>, and <a class="el" href="../../d2/d5a/fs_8c_source.html#l00047">mount::target</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00254">free_opts()</a>.</p>

</div>
</div>
<a id="a0629849a79384a49397f97b899640cce" name="a0629849a79384a49397f97b899640cce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0629849a79384a49397f97b899640cce">&#9670;&#160;</a></span>mount_list_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mount_list_init </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00459">459</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  459</span>                           {</div>
<div class="line"><span class="lineno">  460</span>    <a class="code hl_function" href="../../df/dc2/avl_8c.html#af44d4960ede7f23f071bf00e360bc23d">avl_init</a>(&amp;<a class="code hl_variable" href="#ab73004ccbdbc7a5bcf2d7534135070c5">mounts</a>, <a class="code hl_function" href="../../d2/d66/avl-cmp_8c.html#ae22a4fecfc8234279efe5ce4f38838f0">avl_strcmp</a>, <span class="keyword">false</span>, NULL);</div>
<div class="line"><span class="lineno">  461</span>}</div>
<div class="ttc" id="aavl-cmp_8c_html_ae22a4fecfc8234279efe5ce4f38838f0"><div class="ttname"><a href="../../d2/d66/avl-cmp_8c.html#ae22a4fecfc8234279efe5ce4f38838f0">avl_strcmp</a></div><div class="ttdeci">int avl_strcmp(const void *k1, const void *k2, void *ptr)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d66/avl-cmp_8c_source.html#l00026">avl-cmp.c:26</a></div></div>
<div class="ttc" id="aavl_8c_html_af44d4960ede7f23f071bf00e360bc23d"><div class="ttname"><a href="../../df/dc2/avl_8c.html#af44d4960ede7f23f071bf00e360bc23d">avl_init</a></div><div class="ttdeci">void avl_init(struct avl_tree *tree, avl_tree_comp comp, bool allow_dups, void *ptr)</div><div class="ttdef"><b>Definition</b> <a href="../../df/dc2/avl_8c_source.html#l00092">avl.c:92</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../df/dc2/avl_8c_source.html#l00092">avl_init()</a>, <a class="el" href="../../d2/d66/avl-cmp_8c_source.html#l00026">avl_strcmp()</a>, and <a class="el" href="../../d2/d5a/fs_8c_source.html#l00056">mounts</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02583">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d5a/fs_8c_a0629849a79384a49397f97b899640cce_cgraph.png" border="0" usemap="#ad2/d5a/fs_8c_a0629849a79384a49397f97b899640cce_cgraph" alt=""/></div>
<map name="ad2/d5a/fs_8c_a0629849a79384a49397f97b899640cce_cgraph" id="ad2/d5a/fs_8c_a0629849a79384a49397f97b899640cce_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,161,68"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#af44d4960ede7f23f071bf00e360bc23d" title=" " alt="" coords="226,5,313,39"/>
<area shape="poly" title=" " alt="" coords="161,37,210,29,211,34,162,42"/>
<area shape="rect" href="../../d2/d66/avl-cmp_8c.html#ae22a4fecfc8234279efe5ce4f38838f0" title=" " alt="" coords="209,63,330,96"/>
<area shape="poly" title=" " alt="" coords="162,61,194,65,193,71,161,66"/>
<area shape="rect" href="../../da/d23/list_8h.html#aea85dd50b9129ddaa3e3c67ed55804e4" title=" " alt="" coords="378,5,546,39"/>
<area shape="poly" title=" " alt="" coords="313,20,362,20,362,25,313,25"/>
</map>
</div>

</div>
</div>
<a id="af24351611b930a9663cd1778f19c3ce4" name="af24351611b930a9663cd1778f19c3ce4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af24351611b930a9663cd1778f19c3ce4">&#9670;&#160;</a></span>parseOCImount()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int parseOCImount </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00388">388</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  389</span>{</div>
<div class="line"><span class="lineno">  390</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *tb[<a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6adf4ecd718eb3092e22f1c4257cd460df">__OCI_MOUNT_MAX</a>];</div>
<div class="line"><span class="lineno">  391</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> mount_flags = 0;</div>
<div class="line"><span class="lineno">  392</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> propagation_flags = 0;</div>
<div class="line"><span class="lineno">  393</span>    <span class="keywordtype">char</span> *mount_data = NULL;</div>
<div class="line"><span class="lineno">  394</span>    <span class="keywordtype">int</span> ret, <a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a> = -1;</div>
<div class="line"><span class="lineno">  395</span> </div>
<div class="line"><span class="lineno">  396</span>    <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#a8d2e0c6d0d920485aff6684dd9f7bf0a">oci_mount_policy</a>, <a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6adf4ecd718eb3092e22f1c4257cd460df">__OCI_MOUNT_MAX</a>, tb, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(msg), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a>(msg));</div>
<div class="line"><span class="lineno">  397</span> </div>
<div class="line"><span class="lineno">  398</span>    <span class="keywordflow">if</span> (!tb[<a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6aad5881700d0b39d0d3f1f3547b74f42c">OCI_MOUNT_DESTINATION</a>])</div>
<div class="line"><span class="lineno">  399</span>        <span class="keywordflow">return</span> EINVAL;</div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6a3f174c99d2381e1742a714e6f4643e7b">OCI_MOUNT_OPTIONS</a>]) {</div>
<div class="line"><span class="lineno">  402</span>        ret = <a class="code hl_function" href="#a26cdf624337a8578902d903d2ed76b6c">parseOCImountopts</a>(tb[<a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6a3f174c99d2381e1742a714e6f4643e7b">OCI_MOUNT_OPTIONS</a>], &amp;mount_flags, &amp;propagation_flags, &amp;mount_data, &amp;<a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a>);</div>
<div class="line"><span class="lineno">  403</span>        <span class="keywordflow">if</span> (ret)</div>
<div class="line"><span class="lineno">  404</span>            <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno">  405</span>    }</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>    ret = <a class="code hl_function" href="#a16e2b60a1b30b2a7791960d7c8ce15b2">add_mount</a>(tb[<a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6a5f0311ba1acd526e02715d4b2adc2b27">OCI_MOUNT_SOURCE</a>] ? <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6a5f0311ba1acd526e02715d4b2adc2b27">OCI_MOUNT_SOURCE</a>]) : NULL,</div>
<div class="line"><span class="lineno">  408</span>          <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6aad5881700d0b39d0d3f1f3547b74f42c">OCI_MOUNT_DESTINATION</a>]),</div>
<div class="line"><span class="lineno">  409</span>          tb[<a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6a69970528af4b2b0a369aac82a7c817d3">OCI_MOUNT_TYPE</a>] ? <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6a69970528af4b2b0a369aac82a7c817d3">OCI_MOUNT_TYPE</a>]) : NULL,</div>
<div class="line"><span class="lineno">  410</span>          mount_flags, propagation_flags, mount_data, <a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a>);</div>
<div class="line"><span class="lineno">  411</span> </div>
<div class="line"><span class="lineno">  412</span>    <span class="keywordflow">if</span> (mount_data)</div>
<div class="line"><span class="lineno">  413</span>        free(mount_data);</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>    <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno">  416</span>}</div>
<div class="ttc" id="ablob_8h_html_dc/dd9/structblob__attr"><div class="ttname"><a href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a></div><div class="ttdef"><b>Definition</b> <a href="../../d8/d3c/blob_8h_source.html#l00052">blob.h:52</a></div></div>
<div class="ttc" id="ablobmsg_8c_html_afb56b36905412b6618a529c171e833ed"><div class="ttname"><a href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a></div><div class="ttdeci">int blobmsg_parse(const struct blobmsg_policy *policy, int policy_len, struct blob_attr **tb, void *data, unsigned int len)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d30/blobmsg_8c_source.html#l00166">blobmsg.c:166</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a2646be9952a62787018f5760ce95fdd5"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a></div><div class="ttdeci">static size_t blobmsg_len(const struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00108">blobmsg.h:108</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a6c1cc8e52e96bf9698f6b0f65ad48603"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a></div><div class="ttdeci">static char * blobmsg_get_string(struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00348">blobmsg.h:348</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_ab788ffb2ae75d047fa39be6e79571d20"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a></div><div class="ttdeci">static void * blobmsg_data(const struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00078">blobmsg.h:78</a></div></div>
<div class="ttc" id="afs_8c_html_a26cdf624337a8578902d903d2ed76b6c"><div class="ttname"><a href="#a26cdf624337a8578902d903d2ed76b6c">parseOCImountopts</a></div><div class="ttdeci">static int parseOCImountopts(struct blob_attr *msg, unsigned long *mount_flags, unsigned long *propagation_flags, char **mount_data, int *error)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00248">fs.c:248</a></div></div>
<div class="ttc" id="afs_8c_html_a8d2e0c6d0d920485aff6684dd9f7bf0a"><div class="ttname"><a href="#a8d2e0c6d0d920485aff6684dd9f7bf0a">oci_mount_policy</a></div><div class="ttdeci">static const struct blobmsg_policy oci_mount_policy[]</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00232">fs.c:232</a></div></div>
<div class="ttc" id="audevtrigger_8c_html_abdc0ddb6c825c951cdc8e45b53459445"><div class="ttname"><a href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a></div><div class="ttdeci">#define err(format, arg...)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d62/udevtrigger_8c_source.html#l00058">udevtrigger.c:58</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d5a/fs_8c_source.html#l00229">__OCI_MOUNT_MAX</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00197">add_mount()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00078">blobmsg_data()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00348">blobmsg_get_string()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00108">blobmsg_len()</a>, <a class="el" href="../../d1/d30/blobmsg_8c_source.html#l00166">blobmsg_parse()</a>, <a class="el" href="../../d2/d62/udevtrigger_8c_source.html#l00058">err</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00226">OCI_MOUNT_DESTINATION</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00228">OCI_MOUNT_OPTIONS</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00232">oci_mount_policy</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00225">OCI_MOUNT_SOURCE</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00227">OCI_MOUNT_TYPE</a>, and <a class="el" href="../../d2/d5a/fs_8c_source.html#l00248">parseOCImountopts()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02323">parseOCI()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d5a/fs_8c_af24351611b930a9663cd1778f19c3ce4_cgraph.png" border="0" usemap="#ad2/d5a/fs_8c_af24351611b930a9663cd1778f19c3ce4_cgraph" alt=""/></div>
<map name="ad2/d5a/fs_8c_af24351611b930a9663cd1778f19c3ce4_cgraph" id="ad2/d5a/fs_8c_af24351611b930a9663cd1778f19c3ce4_cgraph">
<area shape="rect" title=" " alt="" coords="5,588,173,622"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2" title=" " alt="" coords="262,335,387,368"/>
<area shape="poly" title=" " alt="" coords="104,586,295,378,299,381,108,589"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="1041,820,1192,854"/>
<area shape="poly" title=" " alt="" coords="173,609,322,624,519,652,738,695,849,722,957,754,1020,780,1075,810,1072,814,1018,785,955,759,848,727,737,700,518,657,322,630,173,614"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603" title=" " alt="" coords="496,559,699,592"/>
<area shape="poly" title=" " alt="" coords="173,597,480,580,480,585,173,603"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5" title=" " alt="" coords="255,928,394,962"/>
<area shape="poly" title=" " alt="" coords="104,621,305,914,300,917,100,624"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed" title=" " alt="" coords="243,740,406,774"/>
<area shape="poly" title=" " alt="" coords="118,620,285,729,282,733,116,625"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a26cdf624337a8578902d903d2ed76b6c" title=" " alt="" coords="221,504,428,538"/>
<area shape="poly" title=" " alt="" coords="138,585,260,541,262,546,139,590"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a6a335418ee05d0ecbda2094c55408404" title=" " alt="" coords="531,223,665,256"/>
<area shape="poly" title=" " alt="" coords="367,332,540,260,542,265,369,336"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e08d7ee7d67ff58eeea30dd8a9356d1" title=" " alt="" coords="815,97,908,131"/>
<area shape="poly" title=" " alt="" coords="634,220,809,136,811,141,636,224"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab9041e08938920d5ae722e2d57dc20e2" title=" " alt="" coords="806,223,917,256"/>
<area shape="poly" title=" " alt="" coords="665,237,791,237,791,242,665,242"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a55d3dbabb73970f597eff3d04809f4ef" title=" " alt="" coords="1051,29,1182,63"/>
<area shape="poly" title=" " alt="" coords="908,98,1003,72,1035,63,1037,68,1004,77,909,103"/>
<area shape="poly" title=" " alt="" coords="1071,30,1066,20,1073,11,1090,5,1116,3,1145,5,1161,11,1159,16,1144,10,1116,8,1091,10,1076,15,1071,20,1076,28"/>
<area shape="poly" title=" " alt="" coords="879,220,954,142,967,122,975,105,984,88,1002,72,1035,56,1037,61,1005,76,989,92,979,107,971,125,958,145,883,224"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#abd4899daa8ad959e6c9694dd5e4132a8" title=" " alt="" coords="1035,168,1198,202"/>
<area shape="poly" title=" " alt="" coords="916,225,1019,203,1021,208,917,230"/>
<area shape="rect" href="../../da/d23/list_8h.html#a875b53c95596d9e8df15ac54f6d24ae6" title=" " alt="" coords="1326,223,1418,256"/>
<area shape="poly" title=" " alt="" coords="917,237,1310,237,1310,242,917,242"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab6f5b72e706a1955a5a5d6af278c677e" title=" " alt="" coords="1027,392,1206,426"/>
<area shape="poly" title=" " alt="" coords="877,255,928,316,964,350,1005,379,1014,383,1012,388,1002,383,961,354,924,320,873,259"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a6de877c20c7b55fa52c80e7be87715fa" title=" " alt="" coords="1067,277,1166,311"/>
<area shape="poly" title=" " alt="" coords="917,249,1052,278,1051,283,916,254"/>
<area shape="rect" href="../../da/d23/list_8h.html#abb4dd1eb7346eb35ea621351220e80ce" title=" " alt="" coords="1059,335,1174,368"/>
<area shape="poly" title=" " alt="" coords="889,255,941,288,1005,321,1045,335,1044,340,1003,326,938,293,886,259"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a212673459e8e8ff2e11a8d093602d35e" title=" " alt="" coords="1055,111,1178,144"/>
<area shape="poly" title=" " alt="" coords="886,220,938,186,1003,153,1039,141,1041,146,1005,158,941,191,889,224"/>
<area shape="poly" title=" " alt="" coords="1199,200,1311,224,1310,229,1198,205"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="1515,307,1617,340"/>
<area shape="poly" title=" " alt="" coords="1414,254,1512,298,1510,303,1412,259"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="1308,392,1437,426"/>
<area shape="poly" title=" " alt="" coords="1206,406,1292,406,1292,412,1206,412"/>
<area shape="poly" title=" " alt="" coords="1412,389,1511,345,1513,350,1414,394"/>
<area shape="poly" title=" " alt="" coords="1071,112,1066,101,1073,92,1090,86,1116,84,1145,86,1161,93,1159,98,1144,92,1116,89,1091,91,1076,96,1071,102,1076,109"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a67b3db37af2f8ebc4f6895202c358604" title=" " alt="" coords="1298,139,1447,172"/>
<area shape="poly" title=" " alt="" coords="1179,132,1282,143,1282,148,1178,137"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab84f86be5fe7f7abcf8ffb6fa0a38700" title=" " alt="" coords="1290,81,1454,115"/>
<area shape="poly" title=" " alt="" coords="1178,118,1274,107,1275,112,1179,123"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#aaf08ec177405c5e004b1ca33808f19da" title=" " alt="" coords="1517,139,1615,172"/>
<area shape="poly" title=" " alt="" coords="1447,153,1502,153,1502,158,1447,158"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e2d83bace7533ed4cc93bdf2a94ad95" title=" " alt="" coords="1520,81,1612,115"/>
<area shape="poly" title=" " alt="" coords="1431,135,1467,125,1505,114,1506,119,1468,130,1433,141"/>
<area shape="poly" title=" " alt="" coords="1433,113,1468,124,1503,134,1502,139,1467,129,1431,118"/>
<area shape="poly" title=" " alt="" coords="1455,96,1504,96,1504,101,1455,101"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="1317,955,1428,988"/>
<area shape="poly" title=" " alt="" coords="1193,846,1230,863,1247,877,1256,892,1265,906,1279,921,1316,945,1313,950,1275,926,1260,910,1252,894,1243,880,1228,867,1191,851"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="1282,820,1463,854"/>
<area shape="poly" title=" " alt="" coords="1193,834,1266,834,1266,840,1193,840"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ac239a83ed3c7f835e2b49f785953c934" title=" " alt="" coords="1287,877,1457,911"/>
<area shape="poly" title=" " alt="" coords="1193,851,1280,871,1279,876,1192,856"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a7613e130753e766f5d381c06b1f7b86f" title=" " alt="" coords="1277,763,1467,796"/>
<area shape="poly" title=" " alt="" coords="1192,817,1279,798,1280,803,1193,822"/>
<area shape="poly" title=" " alt="" coords="700,562,761,561,827,567,894,582,957,609,985,629,1010,652,1052,705,1084,759,1105,804,1101,807,1079,761,1048,708,1006,655,982,633,954,614,893,587,826,572,760,566,700,567"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052" title=" " alt="" coords="767,1039,956,1072"/>
<area shape="poly" title=" " alt="" coords="354,960,409,990,477,1017,547,1033,619,1044,752,1053,751,1059,618,1049,546,1038,475,1022,407,995,351,964"/>
<area shape="poly" title=" " alt="" coords="887,1036,921,1009,953,974,968,944,974,916,981,890,989,876,1002,863,1025,849,1028,853,1005,867,993,879,986,892,979,918,973,946,958,977,925,1013,891,1040"/>
<area shape="poly" title=" " alt="" coords="956,1044,1086,1029,1228,1006,1301,989,1302,994,1230,1011,1086,1034,957,1050"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a9921d2b89577d3344abbb66f24773e32" title=" " alt="" coords="1323,1075,1421,1108"/>
<area shape="poly" title=" " alt="" coords="956,1059,1307,1084,1307,1090,956,1065"/>
<area shape="poly" title=" " alt="" coords="338,773,360,805,391,845,431,885,477,919,507,932,545,943,639,961,750,972,872,978,1114,979,1301,973,1301,978,1114,984,872,983,750,977,638,966,544,949,506,937,475,923,428,889,387,848,355,808,334,776"/>
<area shape="poly" title=" " alt="" coords="406,752,476,750,719,750,838,749,890,749,956,754,1034,764,1093,775,1230,805,1274,814,1273,819,1228,810,1092,780,1033,769,955,759,889,755,838,754,719,755,476,755,406,757"/>
<area shape="poly" title=" " alt="" coords="372,737,421,722,476,710,687,680,773,670,854,665,935,666,1020,673,1117,687,1230,710,1284,729,1332,752,1329,757,1282,733,1228,715,1116,693,1020,678,934,671,854,670,774,675,688,685,476,715,423,727,373,742"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#ac79cacbc6a47f754832dc10bafa3b761" title=" " alt="" coords="818,769,905,803"/>
<area shape="poly" title=" " alt="" coords="406,759,803,780,802,786,406,764"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5a5283071ac5677652515d9a8460e655" title=" " alt="" coords="476,875,719,908"/>
<area shape="poly" title=" " alt="" coords="362,772,549,865,546,870,359,777"/>
<area shape="poly" title=" " alt="" coords="720,876,1025,844,1026,849,720,881"/>
<area shape="poly" title=" " alt="" coords="628,906,821,1028,819,1033,625,911"/>
<area shape="poly" title=" " alt="" coords="640,872,766,820,802,805,804,810,768,825,642,876"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6b6c429265d86411d05951d2fae7289a" title=" " alt="" coords="774,929,949,963"/>
<area shape="poly" title=" " alt="" coords="683,906,762,923,761,928,682,912"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a2c4753820a7472bba7b999fbba79df01" title=" " alt="" coords="791,1105,932,1139"/>
<area shape="poly" title=" " alt="" coords="612,907,673,990,718,1039,769,1083,792,1096,789,1101,766,1087,714,1043,669,993,608,910"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a131936c081164c18e6241d79f3b276d1" title=" " alt="" coords="1004,877,1229,911"/>
<area shape="poly" title=" " alt="" coords="720,889,988,891,988,896,720,895"/>
<area shape="poly" title=" " alt="" coords="933,1119,1070,1116,1229,1108,1307,1099,1308,1104,1229,1113,1070,1122,933,1125"/>
<area shape="poly" title=" " alt="" coords="1175,909,1302,948,1301,953,1174,914"/>
<area shape="poly" title=" " alt="" coords="1194,874,1279,855,1280,860,1195,879"/>
<area shape="poly" title=" " alt="" coords="1229,892,1271,892,1271,897,1229,897"/>
<area shape="poly" title=" " alt="" coords="1207,875,1227,864,1242,850,1251,836,1260,820,1275,805,1282,801,1285,806,1279,810,1264,824,1255,838,1247,854,1231,868,1209,879"/>
<area shape="poly" title=" " alt="" coords="1141,909,1339,1063,1335,1067,1138,913"/>
<area shape="poly" title=" " alt="" coords="397,501,476,486,590,473,687,465,852,460,1018,456,1115,449,1229,436,1292,424,1293,430,1229,441,1115,454,1018,461,853,466,687,470,590,478,476,491,398,506"/>
<area shape="poly" title=" " alt="" coords="413,536,495,552,494,558,412,541"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="555,501,640,535"/>
<area shape="poly" title=" " alt="" coords="428,517,539,516,539,521,428,522"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="814,501,909,535"/>
<area shape="poly" title=" " alt="" coords="641,516,799,516,799,521,641,521"/>
</map>
</div>

</div>
</div>
<a id="a26cdf624337a8578902d903d2ed76b6c" name="a26cdf624337a8578902d903d2ed76b6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26cdf624337a8578902d903d2ed76b6c">&#9670;&#160;</a></span>parseOCImountopts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parseOCImountopts </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *</td>          <td class="paramname"><span class="paramname"><em>mount_flags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *</td>          <td class="paramname"><span class="paramname"><em>propagation_flags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>mount_data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>error</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00248">248</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  249</span>{</div>
<div class="line"><span class="lineno">  250</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *cur;</div>
<div class="line"><span class="lineno">  251</span>    <span class="keywordtype">int</span> rem;</div>
<div class="line"><span class="lineno">  252</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> mf = 0;</div>
<div class="line"><span class="lineno">  253</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> pf = 0;</div>
<div class="line"><span class="lineno">  254</span>    <span class="keywordtype">char</span> *tmp;</div>
<div class="line"><span class="lineno">  255</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../da/d23/list_8h.html#d9/d93/structlist__head">list_head</a> fsopts = <a class="code hl_define" href="../../da/d23/list_8h.html#a4642d4b7df28478bb762fe43c85b5c63">LIST_HEAD_INIT</a>(fsopts);</div>
<div class="line"><span class="lineno">  256</span>    <span class="keywordtype">size_t</span> len = 0;</div>
<div class="line"><span class="lineno">  257</span>    <span class="keyword">struct </span><a class="code hl_struct" href="#d4/d9d/structmount__opt">mount_opt</a> *opt, *tmpopt;</div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span>    <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, msg, rem) {</div>
<div class="line"><span class="lineno">  260</span>        tmp = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(cur);</div>
<div class="line"><span class="lineno">  261</span>        <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;ro&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  262</span>            mf |= MS_RDONLY;</div>
<div class="line"><span class="lineno">  263</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;rw&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  264</span>            mf &amp;= ~MS_RDONLY;</div>
<div class="line"><span class="lineno">  265</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;bind&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  266</span>            mf = MS_BIND;</div>
<div class="line"><span class="lineno">  267</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;rbind&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  268</span>            mf |= MS_BIND | MS_REC;</div>
<div class="line"><span class="lineno">  269</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;sync&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  270</span>            mf |= MS_SYNCHRONOUS;</div>
<div class="line"><span class="lineno">  271</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;async&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  272</span>            mf &amp;= ~MS_SYNCHRONOUS;</div>
<div class="line"><span class="lineno">  273</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;atime&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  274</span>            mf &amp;= ~MS_NOATIME;</div>
<div class="line"><span class="lineno">  275</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;noatime&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  276</span>            mf |= MS_NOATIME;</div>
<div class="line"><span class="lineno">  277</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;defaults&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  278</span>            mf = 0; <span class="comment">/* rw, suid, dev, exec, auto, nouser, and async */</span></div>
<div class="line"><span class="lineno">  279</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;dev&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  280</span>            mf &amp;= ~MS_NODEV;</div>
<div class="line"><span class="lineno">  281</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;nodev&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  282</span>            mf |= MS_NODEV;</div>
<div class="line"><span class="lineno">  283</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;iversion&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  284</span>            mf |= MS_I_VERSION;</div>
<div class="line"><span class="lineno">  285</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;noiversion&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  286</span>            mf &amp;= ~MS_I_VERSION;</div>
<div class="line"><span class="lineno">  287</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;diratime&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  288</span>            mf &amp;= ~MS_NODIRATIME;</div>
<div class="line"><span class="lineno">  289</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;nodiratime&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  290</span>            mf |= MS_NODIRATIME;</div>
<div class="line"><span class="lineno">  291</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;dirsync&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  292</span>            mf |= MS_DIRSYNC;</div>
<div class="line"><span class="lineno">  293</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;exec&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  294</span>            mf &amp;= ~MS_NOEXEC;</div>
<div class="line"><span class="lineno">  295</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;noexec&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  296</span>            mf |= MS_NOEXEC;</div>
<div class="line"><span class="lineno">  297</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;mand&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  298</span>            mf |= MS_MANDLOCK;</div>
<div class="line"><span class="lineno">  299</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;nomand&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  300</span>            mf &amp;= ~MS_MANDLOCK;</div>
<div class="line"><span class="lineno">  301</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;relatime&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  302</span>            mf |= MS_RELATIME;</div>
<div class="line"><span class="lineno">  303</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;norelatime&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  304</span>            mf &amp;= ~MS_RELATIME;</div>
<div class="line"><span class="lineno">  305</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;strictatime&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  306</span>            mf |= MS_STRICTATIME;</div>
<div class="line"><span class="lineno">  307</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;nostrictatime&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  308</span>            mf &amp;= ~MS_STRICTATIME;</div>
<div class="line"><span class="lineno">  309</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;lazytime&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  310</span>            mf |= MS_LAZYTIME;</div>
<div class="line"><span class="lineno">  311</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;nolazytime&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  312</span>            mf &amp;= ~MS_LAZYTIME;</div>
<div class="line"><span class="lineno">  313</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;suid&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  314</span>            mf &amp;= ~MS_NOSUID;</div>
<div class="line"><span class="lineno">  315</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;nosuid&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  316</span>            mf |= MS_NOSUID;</div>
<div class="line"><span class="lineno">  317</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;remount&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  318</span>            mf |= MS_REMOUNT;</div>
<div class="line"><span class="lineno">  319</span>        <span class="comment">/* propagation flags */</span></div>
<div class="line"><span class="lineno">  320</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;private&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  321</span>            pf |= MS_PRIVATE;</div>
<div class="line"><span class="lineno">  322</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;rprivate&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  323</span>            pf |= MS_PRIVATE | MS_REC;</div>
<div class="line"><span class="lineno">  324</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;slave&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  325</span>            pf |= MS_SLAVE;</div>
<div class="line"><span class="lineno">  326</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;rslave&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  327</span>            pf |= MS_SLAVE | MS_REC;</div>
<div class="line"><span class="lineno">  328</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;shared&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  329</span>            pf |= MS_SHARED;</div>
<div class="line"><span class="lineno">  330</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;rshared&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  331</span>            pf |= MS_SHARED | MS_REC;</div>
<div class="line"><span class="lineno">  332</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;unbindable&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  333</span>            pf |= MS_UNBINDABLE;</div>
<div class="line"><span class="lineno">  334</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;runbindable&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  335</span>            pf |= MS_UNBINDABLE | MS_REC;</div>
<div class="line"><span class="lineno">  336</span>        <span class="comment">/* special case: &#39;nofail&#39; */</span></div>
<div class="line"><span class="lineno">  337</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(<span class="stringliteral">&quot;nofail&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  338</span>            *error = 0;</div>
<div class="line"><span class="lineno">  339</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;auto&quot;</span>, tmp) ||</div>
<div class="line"><span class="lineno">  340</span>             !strcmp(<span class="stringliteral">&quot;noauto&quot;</span>, tmp) ||</div>
<div class="line"><span class="lineno">  341</span>             !strcmp(<span class="stringliteral">&quot;user&quot;</span>, tmp) ||</div>
<div class="line"><span class="lineno">  342</span>             !strcmp(<span class="stringliteral">&quot;group&quot;</span>, tmp) ||</div>
<div class="line"><span class="lineno">  343</span>             !strcmp(<span class="stringliteral">&quot;_netdev&quot;</span>, tmp))</div>
<div class="line"><span class="lineno">  344</span>            <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;ignoring built-in mount option %s\n&quot;</span>, tmp);</div>
<div class="line"><span class="lineno">  345</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  346</span>            <span class="comment">/* filesystem-specific free-form option */</span></div>
<div class="line"><span class="lineno">  347</span>            opt = calloc(1, <span class="keyword">sizeof</span>(*opt));</div>
<div class="line"><span class="lineno">  348</span>            opt-&gt;<a class="code hl_variable" href="#ad449ad31833bc131110de43958c1d796">optstr</a> = tmp;</div>
<div class="line"><span class="lineno">  349</span>            <a class="code hl_function" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1">list_add_tail</a>(&amp;opt-&gt;<a class="code hl_variable" href="#a7c6e7dc9bda2140c2920a7c881f411c2">list</a>, &amp;fsopts);</div>
<div class="line"><span class="lineno">  350</span>        }</div>
<div class="line"><span class="lineno">  351</span>    };</div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span>    *mount_flags = mf;</div>
<div class="line"><span class="lineno">  354</span>    *propagation_flags = pf;</div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>    <a class="code hl_define" href="../../da/d23/list_8h.html#a6b4019bb70de70adc3caddbe3a024c27">list_for_each_entry</a>(opt, &amp;fsopts, <a class="code hl_variable" href="#a7c6e7dc9bda2140c2920a7c881f411c2">list</a>) {</div>
<div class="line"><span class="lineno">  357</span>        <span class="keywordflow">if</span> (len)</div>
<div class="line"><span class="lineno">  358</span>            ++len;</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span>        len += strlen(opt-&gt;<a class="code hl_variable" href="#ad449ad31833bc131110de43958c1d796">optstr</a>);</div>
<div class="line"><span class="lineno">  361</span>    };</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>    <span class="keywordflow">if</span> (len) {</div>
<div class="line"><span class="lineno">  364</span>        *mount_data = calloc(len + 1, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div>
<div class="line"><span class="lineno">  365</span>        <span class="keywordflow">if</span> (!(*mount_data))</div>
<div class="line"><span class="lineno">  366</span>            <span class="keywordflow">return</span> ENOMEM;</div>
<div class="line"><span class="lineno">  367</span> </div>
<div class="line"><span class="lineno">  368</span>        len = 0;</div>
<div class="line"><span class="lineno">  369</span>        <a class="code hl_define" href="../../da/d23/list_8h.html#a6b4019bb70de70adc3caddbe3a024c27">list_for_each_entry</a>(opt, &amp;fsopts, <a class="code hl_variable" href="#a7c6e7dc9bda2140c2920a7c881f411c2">list</a>) {</div>
<div class="line"><span class="lineno">  370</span>            <span class="keywordflow">if</span> (len)</div>
<div class="line"><span class="lineno">  371</span>                strcat(*mount_data, <span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>            strcat(*mount_data, opt-&gt;<a class="code hl_variable" href="#ad449ad31833bc131110de43958c1d796">optstr</a>);</div>
<div class="line"><span class="lineno">  374</span>            ++len;</div>
<div class="line"><span class="lineno">  375</span>        }</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>        <a class="code hl_define" href="../../da/d23/list_8h.html#a698670b36c7c0ca13822698ee825ddc8">list_for_each_entry_safe</a>(opt, tmpopt, &amp;fsopts, <a class="code hl_variable" href="#a7c6e7dc9bda2140c2920a7c881f411c2">list</a>) {</div>
<div class="line"><span class="lineno">  378</span>            <a class="code hl_function" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5">list_del</a>(&amp;opt-&gt;<a class="code hl_variable" href="#a7c6e7dc9bda2140c2920a7c881f411c2">list</a>);</div>
<div class="line"><span class="lineno">  379</span>            free(opt);</div>
<div class="line"><span class="lineno">  380</span>        }</div>
<div class="line"><span class="lineno">  381</span>    }</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>    <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;mount flags(%08lx) propagation(%08lx) fsopts(\&quot;%s\&quot;)\n&quot;</span>, mf, pf, *mount_data?:<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  386</span>}</div>
<div class="ttc" id="ablobmsg_8h_html_a69a81065d5c7977bc26fbd093f21a132"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a></div><div class="ttdeci">#define blobmsg_for_each_attr(pos, attr, rem)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00364">blobmsg.h:364</a></div></div>
<div class="ttc" id="afs_8c_html_a7c6e7dc9bda2140c2920a7c881f411c2"><div class="ttname"><a href="#a7c6e7dc9bda2140c2920a7c881f411c2">mount_opt::list</a></div><div class="ttdeci">struct list_head list</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00240">fs.c:240</a></div></div>
<div class="ttc" id="afs_8c_html_ad449ad31833bc131110de43958c1d796"><div class="ttname"><a href="#ad449ad31833bc131110de43958c1d796">mount_opt::optstr</a></div><div class="ttdeci">char * optstr</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00241">fs.c:241</a></div></div>
<div class="ttc" id="afs_8c_html_d4/d9d/structmount__opt"><div class="ttname"><a href="#d4/d9d/structmount__opt">mount_opt</a></div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00239">fs.c:239</a></div></div>
<div class="ttc" id="alist_8h_html_a4642d4b7df28478bb762fe43c85b5c63"><div class="ttname"><a href="../../da/d23/list_8h.html#a4642d4b7df28478bb762fe43c85b5c63">LIST_HEAD_INIT</a></div><div class="ttdeci">#define LIST_HEAD_INIT(name)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d23/list_8h_source.html#l00058">list.h:58</a></div></div>
<div class="ttc" id="alist_8h_html_a5f3c4582c49b990c9fb4f5c83f8400d1"><div class="ttname"><a href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1">list_add_tail</a></div><div class="ttdeci">static void list_add_tail(struct list_head *_new, struct list_head *head)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d23/list_8h_source.html#l00165">list.h:165</a></div></div>
<div class="ttc" id="alist_8h_html_a698670b36c7c0ca13822698ee825ddc8"><div class="ttname"><a href="../../da/d23/list_8h.html#a698670b36c7c0ca13822698ee825ddc8">list_for_each_entry_safe</a></div><div class="ttdeci">#define list_for_each_entry_safe(p, n, h, field)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d23/list_8h_source.html#l00146">list.h:146</a></div></div>
<div class="ttc" id="alist_8h_html_a6b4019bb70de70adc3caddbe3a024c27"><div class="ttname"><a href="../../da/d23/list_8h.html#a6b4019bb70de70adc3caddbe3a024c27">list_for_each_entry</a></div><div class="ttdeci">#define list_for_each_entry(p, h, field)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d23/list_8h_source.html#l00132">list.h:132</a></div></div>
<div class="ttc" id="alist_8h_html_ab1708206f0f7e0a56550b35372203ba5"><div class="ttname"><a href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5">list_del</a></div><div class="ttdeci">static void list_del(struct list_head *entry)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d23/list_8h_source.html#l00096">list.h:96</a></div></div>
<div class="ttc" id="alist_8h_html_d9/d93/structlist__head"><div class="ttname"><a href="../../da/d23/list_8h.html#d9/d93/structlist__head">list_head</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/d23/list_8h_source.html#l00053">list.h:53</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00364">blobmsg_for_each_attr</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00348">blobmsg_get_string()</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00240">mount_opt::list</a>, <a class="el" href="../../da/d23/list_8h_source.html#l00165">list_add_tail()</a>, <a class="el" href="../../da/d23/list_8h_source.html#l00096">list_del()</a>, <a class="el" href="../../da/d23/list_8h_source.html#l00132">list_for_each_entry</a>, <a class="el" href="../../da/d23/list_8h_source.html#l00146">list_for_each_entry_safe</a>, <a class="el" href="../../da/d23/list_8h_source.html#l00058">LIST_HEAD_INIT</a>, and <a class="el" href="../../d2/d5a/fs_8c_source.html#l00241">mount_opt::optstr</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d5a/fs_8c_source.html#l00388">parseOCImount()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d5a/fs_8c_a26cdf624337a8578902d903d2ed76b6c_cgraph.png" border="0" usemap="#ad2/d5a/fs_8c_a26cdf624337a8578902d903d2ed76b6c_cgraph" alt=""/></div>
<map name="ad2/d5a/fs_8c_a26cdf624337a8578902d903d2ed76b6c_cgraph" id="ad2/d5a/fs_8c_a26cdf624337a8578902d903d2ed76b6c_cgraph">
<area shape="rect" title=" " alt="" coords="5,148,213,182"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603" title=" " alt="" coords="261,91,464,124"/>
<area shape="poly" title=" " alt="" coords="186,145,269,126,270,131,187,150"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="298,148,427,182"/>
<area shape="poly" title=" " alt="" coords="213,162,282,162,282,168,213,168"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="320,205,405,239"/>
<area shape="poly" title=" " alt="" coords="187,180,305,207,304,212,186,185"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="512,91,663,124"/>
<area shape="poly" title=" " alt="" coords="465,105,497,105,497,110,465,110"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="751,5,862,39"/>
<area shape="poly" title=" " alt="" coords="622,88,710,48,736,39,737,44,712,53,624,92"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="716,63,897,96"/>
<area shape="poly" title=" " alt="" coords="664,95,700,90,701,96,664,100"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ac239a83ed3c7f835e2b49f785953c934" title=" " alt="" coords="721,120,892,154"/>
<area shape="poly" title=" " alt="" coords="664,115,706,121,705,126,664,120"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a7613e130753e766f5d381c06b1f7b86f" title=" " alt="" coords="711,177,902,211"/>
<area shape="poly" title=" " alt="" coords="641,122,665,133,689,149,713,164,725,169,723,174,710,169,686,153,662,138,639,127"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="537,148,638,182"/>
<area shape="poly" title=" " alt="" coords="427,162,522,162,522,168,427,168"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="541,205,635,239"/>
<area shape="poly" title=" " alt="" coords="406,220,525,220,525,225,406,225"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab73004ccbdbc7a5bcf2d7534135070c5" name="ab73004ccbdbc7a5bcf2d7534135070c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab73004ccbdbc7a5bcf2d7534135070c5">&#9670;&#160;</a></span>mounts</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d3/d51/avl_8h.html#dd/d4a/structavl__tree">avl_tree</a> mounts</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00056">56</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d5a/fs_8c_source.html#l00158">_add_mount()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00486">add_2paths_and_deps()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00429">mount_all()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00446">mount_free()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00459">mount_list_init()</a>, and <a class="el" href="../../d8/d1d/procd_2system_8c_source.html#l00049">system_rootfs_type()</a>.</p>

</div>
</div>
<a id="a8d2e0c6d0d920485aff6684dd9f7bf0a" name="a8d2e0c6d0d920485aff6684dd9f7bf0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d2e0c6d0d920485aff6684dd9f7bf0a">&#9670;&#160;</a></span>oci_mount_policy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a> oci_mount_policy[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [<a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6a5f0311ba1acd526e02715d4b2adc2b27">OCI_MOUNT_SOURCE</a>] = { <span class="stringliteral">&quot;source&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6aad5881700d0b39d0d3f1f3547b74f42c">OCI_MOUNT_DESTINATION</a>] = { <span class="stringliteral">&quot;destination&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6a69970528af4b2b0a369aac82a7c817d3">OCI_MOUNT_TYPE</a>] = { <span class="stringliteral">&quot;type&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6a3f174c99d2381e1742a714e6f4643e7b">OCI_MOUNT_OPTIONS</a>] = { <span class="stringliteral">&quot;options&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">}</div>
<div class="ttc" id="ablobmsg_8h_html_a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a></div><div class="ttdeci">@ BLOBMSG_TYPE_STRING</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00029">blobmsg.h:29</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a></div><div class="ttdeci">@ BLOBMSG_TYPE_ARRAY</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00027">blobmsg.h:27</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d2/d5a/fs_8c_source.html#l00232">232</a> of file <a class="el" href="../../d2/d5a/fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  232</span>                                                        {</div>
<div class="line"><span class="lineno">  233</span>    [<a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6a5f0311ba1acd526e02715d4b2adc2b27">OCI_MOUNT_SOURCE</a>] = { <span class="stringliteral">&quot;source&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno">  234</span>    [<a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6aad5881700d0b39d0d3f1f3547b74f42c">OCI_MOUNT_DESTINATION</a>] = { <span class="stringliteral">&quot;destination&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno">  235</span>    [<a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6a69970528af4b2b0a369aac82a7c817d3">OCI_MOUNT_TYPE</a>] = { <span class="stringliteral">&quot;type&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno">  236</span>    [<a class="code hl_enumvalue" href="#ae6dceca96ec2c7a1b4aa211264a87ef6a3f174c99d2381e1742a714e6f4643e7b">OCI_MOUNT_OPTIONS</a>] = { <span class="stringliteral">&quot;options&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno">  237</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d2/d5a/fs_8c_source.html#l00388">parseOCImount()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
