<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>zbus: /home/g41797/CLionProjects/github.com/g41797/zbus/src/libs/ustp/brmon.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">zbus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_87a455bccb09a92130c26a11a880c98a.html">libs</a></li><li class="navelem"><a class="el" href="../../dir_dce3ccdac7694adc3671ba6ea4820239.html">ustp</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">brmon.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;netinet/in.h&gt;</code><br />
<code>#include &lt;linux/if_bridge.h&gt;</code><br />
<code>#include &lt;<a class="el" href="../../dc/d56/uloop_8h_source.html">libubox/uloop.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="../../dc/df2/ustp_2log_8h_source.html">log.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/da4/libnetlink_8h_source.html">libnetlink.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/dcc/bridge__ctl_8h_source.html">bridge_ctl.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d23/netif__utils_8h_source.html">netif_utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../da/da5/worker_8h_source.html">worker.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for brmon.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d76/brmon_8c__incl.png" border="0" usemap="#a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2ustp_2brmon_8c" alt=""/></div>
<map name="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2ustp_2brmon_8c" id="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2ustp_2brmon_8c">
<area shape="rect" title=" " alt="" coords="716,5,1002,85"/>
<area shape="rect" title=" " alt="" coords="412,215,496,248"/>
<area shape="poly" title=" " alt="" coords="864,86,858,129,850,150,836,169,809,185,772,196,682,206,587,211,516,217,512,218,511,213,515,212,587,205,681,201,771,190,807,180,832,165,845,148,853,128,859,85"/>
<area shape="rect" title=" " alt="" coords="1099,296,1190,330"/>
<area shape="poly" title=" " alt="" coords="1003,51,1050,62,1097,78,1141,100,1180,131,1202,158,1212,186,1211,215,1202,249,1191,269,1177,287,1173,283,1187,266,1197,247,1206,215,1206,187,1197,161,1176,135,1138,105,1095,83,1049,67,1002,57"/>
<area shape="rect" title=" " alt="" coords="395,133,475,167"/>
<area shape="poly" title=" " alt="" coords="716,80,491,135,490,130,715,75"/>
<area shape="rect" title=" " alt="" coords="500,133,627,167"/>
<area shape="poly" title=" " alt="" coords="746,88,625,130,623,125,745,83"/>
<area shape="rect" title=" " alt="" coords="651,133,822,167"/>
<area shape="poly" title=" " alt="" coords="814,88,769,125,765,121,810,84"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html" title=" " alt="" coords="100,215,264,248"/>
<area shape="poly" title=" " alt="" coords="716,62,478,91,370,112,327,123,294,135,268,150,245,168,206,205,202,201,241,164,265,146,291,131,325,118,369,106,478,86,715,57"/>
<area shape="rect" href="../../dc/df2/ustp_2log_8h.html" title=" " alt="" coords="304,133,372,167"/>
<area shape="poly" title=" " alt="" coords="716,69,561,96,387,135,386,130,560,91,715,64"/>
<area shape="rect" href="../../d5/da4/libnetlink_8h.html" title=" " alt="" coords="897,133,1021,167"/>
<area shape="poly" title=" " alt="" coords="899,84,935,120,931,124,896,88"/>
<area shape="rect" href="../../d0/dcc/bridge__ctl_8h.html" title=" " alt="" coords="1214,296,1344,330"/>
<area shape="poly" title=" " alt="" coords="1003,47,1116,54,1233,69,1286,80,1333,94,1370,111,1396,131,1407,152,1409,174,1403,195,1391,217,1356,257,1317,289,1314,285,1352,253,1386,214,1398,193,1404,173,1402,153,1392,135,1367,115,1331,99,1285,85,1232,74,1116,60,1002,52"/>
<area shape="rect" href="../../dd/d23/netif__utils_8h.html" title=" " alt="" coords="1252,133,1381,167"/>
<area shape="poly" title=" " alt="" coords="1003,76,1237,128,1236,133,1002,81"/>
<area shape="rect" href="../../da/da5/worker_8h.html" title=" " alt="" coords="1065,133,1165,167"/>
<area shape="poly" title=" " alt="" coords="958,83,1062,124,1060,129,956,88"/>
<area shape="rect" title=" " alt="" coords="123,296,241,330"/>
<area shape="poly" title=" " alt="" coords="185,249,185,281,179,281,179,249"/>
<area shape="rect" title=" " alt="" coords="470,296,598,330"/>
<area shape="poly" title=" " alt="" coords="254,246,456,292,455,297,253,252"/>
<area shape="rect" title=" " alt="" coords="731,378,838,412"/>
<area shape="poly" title=" " alt="" coords="232,246,371,294,414,312,459,327,595,360,716,381,715,386,594,365,457,333,413,317,369,299,230,251"/>
<area shape="rect" title=" " alt="" coords="265,296,357,330"/>
<area shape="poly" title=" " alt="" coords="209,247,274,286,271,290,207,251"/>
<area shape="rect" title=" " alt="" coords="5,296,100,330"/>
<area shape="poly" title=" " alt="" coords="157,251,93,290,90,286,154,247"/>
<area shape="rect" href="../../da/d23/list_8h.html" title=" " alt="" coords="814,296,880,330"/>
<area shape="poly" title=" " alt="" coords="265,244,277,246,573,282,799,305,798,310,572,287,276,251,264,249"/>
<area shape="poly" title=" " alt="" coords="837,332,809,367,805,364,832,329"/>
<area shape="rect" title=" " alt="" coords="862,378,958,412"/>
<area shape="poly" title=" " alt="" coords="862,329,890,364,886,367,858,332"/>
<area shape="poly" title=" " alt="" coords="363,165,419,203,416,208,360,169"/>
<area shape="rect" title=" " alt="" coords="289,215,387,248"/>
<area shape="poly" title=" " alt="" coords="341,167,341,199,335,199,335,167"/>
<area shape="poly" title=" " alt="" coords="897,166,878,169,776,183,696,192,617,201,516,217,512,218,511,213,515,212,616,195,696,186,776,178,877,164,896,161"/>
<area shape="poly" title=" " alt="" coords="897,164,863,169,794,175,705,180,619,192,585,202,561,217,550,230,543,247,536,281,531,280,538,245,545,227,557,213,583,197,618,187,705,175,794,170,863,164,896,159"/>
<area shape="rect" title=" " alt="" coords="942,215,1078,248"/>
<area shape="poly" title=" " alt="" coords="972,166,994,200,989,203,967,169"/>
<area shape="rect" title=" " alt="" coords="572,215,725,248"/>
<area shape="poly" title=" " alt="" coords="897,170,727,213,726,208,896,164"/>
<area shape="rect" title=" " alt="" coords="750,215,918,248"/>
<area shape="poly" title=" " alt="" coords="935,169,873,209,870,204,932,165"/>
<area shape="poly" title=" " alt="" coords="1214,331,1202,333,1106,347,1029,355,952,364,854,380,853,375,951,359,1029,350,1105,342,1201,327,1213,325"/>
<area shape="rect" title=" " alt="" coords="1163,378,1249,412"/>
<area shape="poly" title=" " alt="" coords="1266,332,1233,368,1229,365,1262,329"/>
<area shape="rect" title=" " alt="" coords="1272,378,1430,412"/>
<area shape="poly" title=" " alt="" coords="1296,329,1328,365,1324,368,1292,332"/>
<area shape="rect" href="../../d0/d5f/mstp_8h.html" title=" " alt="" coords="1101,215,1188,248"/>
<area shape="poly" title=" " alt="" coords="1124,166,1136,199,1131,201,1119,168"/>
<area shape="poly" title=" " alt="" coords="1147,249,1147,281,1142,281,1142,249"/>
<area shape="poly" title=" " alt="" coords="1102,248,1090,251,960,273,829,290,613,310,613,304,829,285,959,268,1089,246,1101,243"/>
<area shape="poly" title=" " alt="" coords="1102,248,1091,251,897,302,895,297,1089,246,1100,243"/>
<area shape="poly" title=" " alt="" coords="1173,247,1240,286,1238,291,1170,251"/>
</map>
</div>
</div>
<p><a href="../../d1/db2/brmon_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ac6bfa7273251ec8fc11ef21ca645ad90" id="r_ac6bfa7273251ec8fc11ef21ca645ad90"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="#ac6bfa7273251ec8fc11ef21ca645ad90ad79c69035bf7ba9393e440759ddced4d">IF_OPER_UNKNOWN</a>
, <a class="el" href="#ac6bfa7273251ec8fc11ef21ca645ad90af28f982b2fbf50c1c3533fc5a47bfd19">IF_OPER_NOTPRESENT</a>
, <a class="el" href="#ac6bfa7273251ec8fc11ef21ca645ad90ae70e5f7c84fa2cdf4cdcdf4b8cc7a6b0">IF_OPER_DOWN</a>
, <a class="el" href="#ac6bfa7273251ec8fc11ef21ca645ad90a0dffc68065aa94fa306df4c5ecc8928e">IF_OPER_LOWERLAYERDOWN</a>
, <br />
&#160;&#160;<a class="el" href="#ac6bfa7273251ec8fc11ef21ca645ad90a042504491c802899b30c17a2461ff60e">IF_OPER_TESTING</a>
, <a class="el" href="#ac6bfa7273251ec8fc11ef21ca645ad90a4c9d55aae13f50b964fef02468fda0d2">IF_OPER_DORMANT</a>
, <a class="el" href="#ac6bfa7273251ec8fc11ef21ca645ad90a9922914e19e684a23b40e13d49a8aa2d">IF_OPER_UP</a>
<br />
 }</td></tr>
<tr class="separator:ac6bfa7273251ec8fc11ef21ca645ad90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63cbfa53a16c7eeb228a37be887ccf54" id="r_a63cbfa53a16c7eeb228a37be887ccf54"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="#a63cbfa53a16c7eeb228a37be887ccf54ab9d1ee8baec082920f7069c270dc14b5">IF_LINK_MODE_DEFAULT</a>
, <a class="el" href="#a63cbfa53a16c7eeb228a37be887ccf54a319bea570d0a719ededb53f4826f17af">IF_LINK_MODE_DORMANT</a>
 }</td></tr>
<tr class="separator:a63cbfa53a16c7eeb228a37be887ccf54"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0db6d708a3545bc41ee2412fc0f38310" id="r_a0db6d708a3545bc41ee2412fc0f38310"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0db6d708a3545bc41ee2412fc0f38310">dump_msg</a> (const struct sockaddr_nl *who, struct nlmsghdr *n, void *arg)</td></tr>
<tr class="separator:a0db6d708a3545bc41ee2412fc0f38310"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33a5825c015c299d30fbf2b77a67bbaf" id="r_a33a5825c015c299d30fbf2b77a67bbaf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a33a5825c015c299d30fbf2b77a67bbaf">bridge_event_handler</a> (void)</td></tr>
<tr class="separator:a33a5825c015c299d30fbf2b77a67bbaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9a6b4d196a1b5592bba5833f61ac930" id="r_ac9a6b4d196a1b5592bba5833f61ac930"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac9a6b4d196a1b5592bba5833f61ac930">bridge_event_cb</a> (struct <a class="el" href="../../dc/d56/uloop_8h.html#db/d9e/structuloop__fd">uloop_fd</a> *fd, unsigned int <a class="el" href="../../d3/d91/uloop-epoll_8c.html#a0e992398f478de38db56a1146ea84e93">events</a>)</td></tr>
<tr class="separator:ac9a6b4d196a1b5592bba5833f61ac930"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cb1f9cfe718d5010b8d72ee3ae2b734" id="r_a0cb1f9cfe718d5010b8d72ee3ae2b734"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0cb1f9cfe718d5010b8d72ee3ae2b734">init_bridge_ops</a> (void)</td></tr>
<tr class="separator:a0cb1f9cfe718d5010b8d72ee3ae2b734"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a998860464d2d411d2e90d637a9fb604c" id="r_a998860464d2d411d2e90d637a9fb604c"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a998860464d2d411d2e90d637a9fb604c">port_states</a> []</td></tr>
<tr class="separator:a998860464d2d411d2e90d637a9fb604c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a052e2f2ddaba32f35e414adab16b5fb4" id="r_a052e2f2ddaba32f35e414adab16b5fb4"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d5/da4/libnetlink_8h.html#d2/dee/structrtnl__handle">rtnl_handle</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a052e2f2ddaba32f35e414adab16b5fb4">rth</a></td></tr>
<tr class="separator:a052e2f2ddaba32f35e414adab16b5fb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad019ccbab85e770de7ac22b8093b20ab" id="r_ad019ccbab85e770de7ac22b8093b20ab"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dc/d56/uloop_8h.html#db/d9e/structuloop__fd">uloop_fd</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad019ccbab85e770de7ac22b8093b20ab">ufd</a></td></tr>
<tr class="separator:ad019ccbab85e770de7ac22b8093b20ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a883459b4943f3c3535a17e95da3f08dc" id="r_a883459b4943f3c3535a17e95da3f08dc"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d5/da4/libnetlink_8h.html#d2/dee/structrtnl__handle">rtnl_handle</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a883459b4943f3c3535a17e95da3f08dc">rth_state</a></td></tr>
<tr class="separator:a883459b4943f3c3535a17e95da3f08dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ac6bfa7273251ec8fc11ef21ca645ad90" name="ac6bfa7273251ec8fc11ef21ca645ad90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6bfa7273251ec8fc11ef21ca645ad90">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ac6bfa7273251ec8fc11ef21ca645ad90ad79c69035bf7ba9393e440759ddced4d" name="ac6bfa7273251ec8fc11ef21ca645ad90ad79c69035bf7ba9393e440759ddced4d"></a>IF_OPER_UNKNOWN&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac6bfa7273251ec8fc11ef21ca645ad90af28f982b2fbf50c1c3533fc5a47bfd19" name="ac6bfa7273251ec8fc11ef21ca645ad90af28f982b2fbf50c1c3533fc5a47bfd19"></a>IF_OPER_NOTPRESENT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac6bfa7273251ec8fc11ef21ca645ad90ae70e5f7c84fa2cdf4cdcdf4b8cc7a6b0" name="ac6bfa7273251ec8fc11ef21ca645ad90ae70e5f7c84fa2cdf4cdcdf4b8cc7a6b0"></a>IF_OPER_DOWN&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac6bfa7273251ec8fc11ef21ca645ad90a0dffc68065aa94fa306df4c5ecc8928e" name="ac6bfa7273251ec8fc11ef21ca645ad90a0dffc68065aa94fa306df4c5ecc8928e"></a>IF_OPER_LOWERLAYERDOWN&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac6bfa7273251ec8fc11ef21ca645ad90a042504491c802899b30c17a2461ff60e" name="ac6bfa7273251ec8fc11ef21ca645ad90a042504491c802899b30c17a2461ff60e"></a>IF_OPER_TESTING&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac6bfa7273251ec8fc11ef21ca645ad90a4c9d55aae13f50b964fef02468fda0d2" name="ac6bfa7273251ec8fc11ef21ca645ad90a4c9d55aae13f50b964fef02468fda0d2"></a>IF_OPER_DORMANT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac6bfa7273251ec8fc11ef21ca645ad90a9922914e19e684a23b40e13d49a8aa2d" name="ac6bfa7273251ec8fc11ef21ca645ad90a9922914e19e684a23b40e13d49a8aa2d"></a>IF_OPER_UP&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d1/db2/brmon_8c_source.html#l00030">30</a> of file <a class="el" href="../../d1/db2/brmon_8c_source.html">brmon.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   31</span>{</div>
<div class="line"><span class="lineno">   32</span>    <a class="code hl_enumvalue" href="#ac6bfa7273251ec8fc11ef21ca645ad90ad79c69035bf7ba9393e440759ddced4d">IF_OPER_UNKNOWN</a>,</div>
<div class="line"><span class="lineno">   33</span>    <a class="code hl_enumvalue" href="#ac6bfa7273251ec8fc11ef21ca645ad90af28f982b2fbf50c1c3533fc5a47bfd19">IF_OPER_NOTPRESENT</a>,</div>
<div class="line"><span class="lineno">   34</span>    <a class="code hl_enumvalue" href="#ac6bfa7273251ec8fc11ef21ca645ad90ae70e5f7c84fa2cdf4cdcdf4b8cc7a6b0">IF_OPER_DOWN</a>,</div>
<div class="line"><span class="lineno">   35</span>    <a class="code hl_enumvalue" href="#ac6bfa7273251ec8fc11ef21ca645ad90a0dffc68065aa94fa306df4c5ecc8928e">IF_OPER_LOWERLAYERDOWN</a>,</div>
<div class="line"><span class="lineno">   36</span>    <a class="code hl_enumvalue" href="#ac6bfa7273251ec8fc11ef21ca645ad90a042504491c802899b30c17a2461ff60e">IF_OPER_TESTING</a>,</div>
<div class="line"><span class="lineno">   37</span>    <a class="code hl_enumvalue" href="#ac6bfa7273251ec8fc11ef21ca645ad90a4c9d55aae13f50b964fef02468fda0d2">IF_OPER_DORMANT</a>,</div>
<div class="line"><span class="lineno">   38</span>    <a class="code hl_enumvalue" href="#ac6bfa7273251ec8fc11ef21ca645ad90a9922914e19e684a23b40e13d49a8aa2d">IF_OPER_UP</a>,</div>
<div class="line"><span class="lineno">   39</span>};</div>
<div class="ttc" id="abrmon_8c_html_ac6bfa7273251ec8fc11ef21ca645ad90a042504491c802899b30c17a2461ff60e"><div class="ttname"><a href="#ac6bfa7273251ec8fc11ef21ca645ad90a042504491c802899b30c17a2461ff60e">IF_OPER_TESTING</a></div><div class="ttdeci">@ IF_OPER_TESTING</div><div class="ttdef"><b>Definition</b> <a href="../../d1/db2/brmon_8c_source.html#l00036">brmon.c:36</a></div></div>
<div class="ttc" id="abrmon_8c_html_ac6bfa7273251ec8fc11ef21ca645ad90a0dffc68065aa94fa306df4c5ecc8928e"><div class="ttname"><a href="#ac6bfa7273251ec8fc11ef21ca645ad90a0dffc68065aa94fa306df4c5ecc8928e">IF_OPER_LOWERLAYERDOWN</a></div><div class="ttdeci">@ IF_OPER_LOWERLAYERDOWN</div><div class="ttdef"><b>Definition</b> <a href="../../d1/db2/brmon_8c_source.html#l00035">brmon.c:35</a></div></div>
<div class="ttc" id="abrmon_8c_html_ac6bfa7273251ec8fc11ef21ca645ad90a4c9d55aae13f50b964fef02468fda0d2"><div class="ttname"><a href="#ac6bfa7273251ec8fc11ef21ca645ad90a4c9d55aae13f50b964fef02468fda0d2">IF_OPER_DORMANT</a></div><div class="ttdeci">@ IF_OPER_DORMANT</div><div class="ttdef"><b>Definition</b> <a href="../../d1/db2/brmon_8c_source.html#l00037">brmon.c:37</a></div></div>
<div class="ttc" id="abrmon_8c_html_ac6bfa7273251ec8fc11ef21ca645ad90a9922914e19e684a23b40e13d49a8aa2d"><div class="ttname"><a href="#ac6bfa7273251ec8fc11ef21ca645ad90a9922914e19e684a23b40e13d49a8aa2d">IF_OPER_UP</a></div><div class="ttdeci">@ IF_OPER_UP</div><div class="ttdef"><b>Definition</b> <a href="../../d1/db2/brmon_8c_source.html#l00038">brmon.c:38</a></div></div>
<div class="ttc" id="abrmon_8c_html_ac6bfa7273251ec8fc11ef21ca645ad90ad79c69035bf7ba9393e440759ddced4d"><div class="ttname"><a href="#ac6bfa7273251ec8fc11ef21ca645ad90ad79c69035bf7ba9393e440759ddced4d">IF_OPER_UNKNOWN</a></div><div class="ttdeci">@ IF_OPER_UNKNOWN</div><div class="ttdef"><b>Definition</b> <a href="../../d1/db2/brmon_8c_source.html#l00032">brmon.c:32</a></div></div>
<div class="ttc" id="abrmon_8c_html_ac6bfa7273251ec8fc11ef21ca645ad90ae70e5f7c84fa2cdf4cdcdf4b8cc7a6b0"><div class="ttname"><a href="#ac6bfa7273251ec8fc11ef21ca645ad90ae70e5f7c84fa2cdf4cdcdf4b8cc7a6b0">IF_OPER_DOWN</a></div><div class="ttdeci">@ IF_OPER_DOWN</div><div class="ttdef"><b>Definition</b> <a href="../../d1/db2/brmon_8c_source.html#l00034">brmon.c:34</a></div></div>
<div class="ttc" id="abrmon_8c_html_ac6bfa7273251ec8fc11ef21ca645ad90af28f982b2fbf50c1c3533fc5a47bfd19"><div class="ttname"><a href="#ac6bfa7273251ec8fc11ef21ca645ad90af28f982b2fbf50c1c3533fc5a47bfd19">IF_OPER_NOTPRESENT</a></div><div class="ttdeci">@ IF_OPER_NOTPRESENT</div><div class="ttdef"><b>Definition</b> <a href="../../d1/db2/brmon_8c_source.html#l00033">brmon.c:33</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a63cbfa53a16c7eeb228a37be887ccf54" name="a63cbfa53a16c7eeb228a37be887ccf54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63cbfa53a16c7eeb228a37be887ccf54">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a63cbfa53a16c7eeb228a37be887ccf54ab9d1ee8baec082920f7069c270dc14b5" name="a63cbfa53a16c7eeb228a37be887ccf54ab9d1ee8baec082920f7069c270dc14b5"></a>IF_LINK_MODE_DEFAULT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a63cbfa53a16c7eeb228a37be887ccf54a319bea570d0a719ededb53f4826f17af" name="a63cbfa53a16c7eeb228a37be887ccf54a319bea570d0a719ededb53f4826f17af"></a>IF_LINK_MODE_DORMANT&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d1/db2/brmon_8c_source.html#l00042">42</a> of file <a class="el" href="../../d1/db2/brmon_8c_source.html">brmon.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   43</span>{</div>
<div class="line"><span class="lineno">   44</span>    <a class="code hl_enumvalue" href="#a63cbfa53a16c7eeb228a37be887ccf54ab9d1ee8baec082920f7069c270dc14b5">IF_LINK_MODE_DEFAULT</a>,</div>
<div class="line"><span class="lineno">   45</span>    <a class="code hl_enumvalue" href="#a63cbfa53a16c7eeb228a37be887ccf54a319bea570d0a719ededb53f4826f17af">IF_LINK_MODE_DORMANT</a>, <span class="comment">/* limit upward transition to dormant */</span></div>
<div class="line"><span class="lineno">   46</span>};</div>
<div class="ttc" id="abrmon_8c_html_a63cbfa53a16c7eeb228a37be887ccf54a319bea570d0a719ededb53f4826f17af"><div class="ttname"><a href="#a63cbfa53a16c7eeb228a37be887ccf54a319bea570d0a719ededb53f4826f17af">IF_LINK_MODE_DORMANT</a></div><div class="ttdeci">@ IF_LINK_MODE_DORMANT</div><div class="ttdef"><b>Definition</b> <a href="../../d1/db2/brmon_8c_source.html#l00045">brmon.c:45</a></div></div>
<div class="ttc" id="abrmon_8c_html_a63cbfa53a16c7eeb228a37be887ccf54ab9d1ee8baec082920f7069c270dc14b5"><div class="ttname"><a href="#a63cbfa53a16c7eeb228a37be887ccf54ab9d1ee8baec082920f7069c270dc14b5">IF_LINK_MODE_DEFAULT</a></div><div class="ttdeci">@ IF_LINK_MODE_DEFAULT</div><div class="ttdef"><b>Definition</b> <a href="../../d1/db2/brmon_8c_source.html#l00044">brmon.c:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac9a6b4d196a1b5592bba5833f61ac930" name="ac9a6b4d196a1b5592bba5833f61ac930"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9a6b4d196a1b5592bba5833f61ac930">&#9670;&#160;</a></span>bridge_event_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void bridge_event_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dc/d56/uloop_8h.html#db/d9e/structuloop__fd">uloop_fd</a> *</td>          <td class="paramname"><span class="paramname"><em>fd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int</td>          <td class="paramname"><span class="paramname"><em>events</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/db2/brmon_8c_source.html#l00178">178</a> of file <a class="el" href="../../d1/db2/brmon_8c_source.html">brmon.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  179</span>{</div>
<div class="line"><span class="lineno">  180</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../da/da5/worker_8h.html#d1/d19/structworker__event">worker_event</a> ev = {</div>
<div class="line"><span class="lineno">  181</span>        .type = <a class="code hl_enumvalue" href="../../da/da5/worker_8h.html#a6eba0546c9033f869280df9d91400728aabeef5ef3b471da81153e49aef3fe8f4">WORKER_EV_BRIDGE_EVENT</a></div>
<div class="line"><span class="lineno">  182</span>    };</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>    <a class="code hl_function" href="../../dc/d8e/worker_8c.html#ab15dfc282bf3fe773ef4eb0fb90adbe8">worker_queue_event</a>(&amp;ev);</div>
<div class="line"><span class="lineno">  185</span>}</div>
<div class="ttc" id="aworker_8c_html_ab15dfc282bf3fe773ef4eb0fb90adbe8"><div class="ttname"><a href="../../dc/d8e/worker_8c.html#ab15dfc282bf3fe773ef4eb0fb90adbe8">worker_queue_event</a></div><div class="ttdeci">void worker_queue_event(struct worker_event *ev)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d8e/worker_8c_source.html#l00123">worker.c:123</a></div></div>
<div class="ttc" id="aworker_8h_html_a6eba0546c9033f869280df9d91400728aabeef5ef3b471da81153e49aef3fe8f4"><div class="ttname"><a href="../../da/da5/worker_8h.html#a6eba0546c9033f869280df9d91400728aabeef5ef3b471da81153e49aef3fe8f4">WORKER_EV_BRIDGE_EVENT</a></div><div class="ttdeci">@ WORKER_EV_BRIDGE_EVENT</div><div class="ttdef"><b>Definition</b> <a href="../../da/da5/worker_8h_source.html#l00022">worker.h:22</a></div></div>
<div class="ttc" id="aworker_8h_html_d1/d19/structworker__event"><div class="ttname"><a href="../../da/da5/worker_8h.html#d1/d19/structworker__event">worker_event</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/da5/worker_8h_source.html#l00028">worker.h:28</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/da5/worker_8h_source.html#l00022">WORKER_EV_BRIDGE_EVENT</a>, and <a class="el" href="../../dc/d8e/worker_8c_source.html#l00123">worker_queue_event()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/db2/brmon_8c_source.html#l00187">init_bridge_ops()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/db2/brmon_8c_ac9a6b4d196a1b5592bba5833f61ac930_cgraph.png" border="0" usemap="#ad1/db2/brmon_8c_ac9a6b4d196a1b5592bba5833f61ac930_cgraph" alt=""/></div>
<map name="ad1/db2/brmon_8c_ac9a6b4d196a1b5592bba5833f61ac930_cgraph" id="ad1/db2/brmon_8c_ac9a6b4d196a1b5592bba5833f61ac930_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,179,39"/>
<area shape="rect" href="../../dc/d8e/worker_8c.html#ab15dfc282bf3fe773ef4eb0fb90adbe8" title=" " alt="" coords="227,5,439,39"/>
<area shape="poly" title=" " alt="" coords="179,20,211,20,211,25,179,25"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="487,5,616,39"/>
<area shape="poly" title=" " alt="" coords="439,20,472,20,472,25,439,25"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="664,5,766,39"/>
<area shape="poly" title=" " alt="" coords="617,20,649,20,649,25,617,25"/>
</map>
</div>

</div>
</div>
<a id="a33a5825c015c299d30fbf2b77a67bbaf" name="a33a5825c015c299d30fbf2b77a67bbaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33a5825c015c299d30fbf2b77a67bbaf">&#9670;&#160;</a></span>bridge_event_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bridge_event_handler </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/db2/brmon_8c_source.html#l00170">170</a> of file <a class="el" href="../../d1/db2/brmon_8c_source.html">brmon.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  171</span>{</div>
<div class="line"><span class="lineno">  172</span>    <span class="keywordflow">if</span>(<a class="code hl_function" href="../../d4/dab/libnetlink_8c.html#a5ccc90cdc3b573eef42d694aef62fdcc">rtnl_listen</a>(&amp;<a class="code hl_variable" href="#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>, <a class="code hl_function" href="#a0db6d708a3545bc41ee2412fc0f38310">dump_msg</a>, stdout) &lt; 0)</div>
<div class="line"><span class="lineno">  173</span>    {</div>
<div class="line"><span class="lineno">  174</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Error on bridge monitoring socket\n&quot;</span>);</div>
<div class="line"><span class="lineno">  175</span>    }</div>
<div class="line"><span class="lineno">  176</span>}</div>
<div class="ttc" id="abrmon_8c_html_a052e2f2ddaba32f35e414adab16b5fb4"><div class="ttname"><a href="#a052e2f2ddaba32f35e414adab16b5fb4">rth</a></div><div class="ttdeci">static struct rtnl_handle rth</div><div class="ttdef"><b>Definition</b> <a href="../../d1/db2/brmon_8c_source.html#l00057">brmon.c:57</a></div></div>
<div class="ttc" id="abrmon_8c_html_a0db6d708a3545bc41ee2412fc0f38310"><div class="ttname"><a href="#a0db6d708a3545bc41ee2412fc0f38310">dump_msg</a></div><div class="ttdeci">static int dump_msg(const struct sockaddr_nl *who, struct nlmsghdr *n, void *arg)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/db2/brmon_8c_source.html#l00062">brmon.c:62</a></div></div>
<div class="ttc" id="alibnetlink_8c_html_a5ccc90cdc3b573eef42d694aef62fdcc"><div class="ttname"><a href="../../d4/dab/libnetlink_8c.html#a5ccc90cdc3b573eef42d694aef62fdcc">rtnl_listen</a></div><div class="ttdeci">int rtnl_listen(struct rtnl_handle *rtnl, rtnl_filter_t handler, void *jarg)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dab/libnetlink_8c_source.html#l00379">libnetlink.c:379</a></div></div>
<div class="ttc" id="aprocd_2jail_2log_8h_html_a15378cd15bafb3a79061424b452497aa"><div class="ttname"><a href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a></div><div class="ttdeci">#define ERROR(fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">log.h:27</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/db2/brmon_8c_source.html#l00062">dump_msg()</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../d1/db2/brmon_8c_source.html#l00057">rth</a>, and <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00379">rtnl_listen()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d8e/worker_8c_source.html#l00057">handle_worker_event()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/db2/brmon_8c_a33a5825c015c299d30fbf2b77a67bbaf_cgraph.png" border="0" usemap="#ad1/db2/brmon_8c_a33a5825c015c299d30fbf2b77a67bbaf_cgraph" alt=""/></div>
<map name="ad1/db2/brmon_8c_a33a5825c015c299d30fbf2b77a67bbaf_cgraph" id="ad1/db2/brmon_8c_a33a5825c015c299d30fbf2b77a67bbaf_cgraph">
<area shape="rect" title=" " alt="" coords="5,92,228,126"/>
<area shape="rect" href="../../d1/db2/brmon_8c.html#a0db6d708a3545bc41ee2412fc0f38310" title=" " alt="" coords="276,63,400,96"/>
<area shape="poly" title=" " alt="" coords="227,91,260,87,261,92,228,97"/>
<area shape="rect" href="../../d4/dab/libnetlink_8c.html#a5ccc90cdc3b573eef42d694aef62fdcc" title=" " alt="" coords="282,120,394,154"/>
<area shape="poly" title=" " alt="" coords="228,120,266,125,266,130,227,126"/>
<area shape="rect" href="../../d7/d10/bridge__track_8c.html#a866cd25eb628ca59a4bb923024c7de63" title=" " alt="" coords="448,5,590,39"/>
<area shape="poly" title=" " alt="" coords="392,60,448,42,450,47,394,65"/>
<area shape="rect" href="../../da/dbf/netif__utils_8c.html#a9b10b4d46fa7f9567b9de1afc4a11518" title=" " alt="" coords="467,63,572,96"/>
<area shape="poly" title=" " alt="" coords="401,77,451,77,451,82,401,82"/>
<area shape="rect" href="../../d4/dab/libnetlink_8c.html#aed575cd447219f8c2f67e2011aaee4d8" title=" " alt="" coords="454,120,584,154"/>
<area shape="poly" title=" " alt="" coords="394,94,450,112,448,117,392,99"/>
</map>
</div>

</div>
</div>
<a id="a0db6d708a3545bc41ee2412fc0f38310" name="a0db6d708a3545bc41ee2412fc0f38310"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0db6d708a3545bc41ee2412fc0f38310">&#9670;&#160;</a></span>dump_msg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int dump_msg </td>
          <td>(</td>
          <td class="paramtype">const struct sockaddr_nl *</td>          <td class="paramname"><span class="paramname"><em>who</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct nlmsghdr *</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>arg</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/db2/brmon_8c_source.html#l00062">62</a> of file <a class="el" href="../../d1/db2/brmon_8c_source.html">brmon.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   64</span>{</div>
<div class="line"><span class="lineno">   65</span>    <span class="keyword">struct </span>ifinfomsg *ifi = NLMSG_DATA(n);</div>
<div class="line"><span class="lineno">   66</span>    <span class="keyword">struct </span>rtattr * tb[IFLA_MAX + 1];</div>
<div class="line"><span class="lineno">   67</span>    <span class="keywordtype">int</span> len = n-&gt;nlmsg_len;</div>
<div class="line"><span class="lineno">   68</span>    <span class="keywordtype">char</span> b1[IFNAMSIZ];</div>
<div class="line"><span class="lineno">   69</span>    <span class="keywordtype">int</span> af_family;</div>
<div class="line"><span class="lineno">   70</span>    <span class="keywordtype">bool</span> newlink;</div>
<div class="line"><span class="lineno">   71</span>    <span class="keywordtype">int</span> br_index;</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>    <span class="keywordflow">if</span>(n-&gt;nlmsg_type == NLMSG_DONE)</div>
<div class="line"><span class="lineno">   74</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>    len -= NLMSG_LENGTH(<span class="keyword">sizeof</span>(*ifi));</div>
<div class="line"><span class="lineno">   77</span>    <span class="keywordflow">if</span>(len &lt; 0)</div>
<div class="line"><span class="lineno">   78</span>    {</div>
<div class="line"><span class="lineno">   79</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">   80</span>    }</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>    af_family = ifi-&gt;ifi_family;</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>    <span class="keywordflow">if</span>(af_family != AF_BRIDGE &amp;&amp; af_family != AF_UNSPEC)</div>
<div class="line"><span class="lineno">   85</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>    <span class="keywordflow">if</span>(n-&gt;nlmsg_type != RTM_NEWLINK &amp;&amp; n-&gt;nlmsg_type != RTM_DELLINK)</div>
<div class="line"><span class="lineno">   88</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>    <a class="code hl_function" href="../../d4/dab/libnetlink_8c.html#aed575cd447219f8c2f67e2011aaee4d8">parse_rtattr</a>(tb, IFLA_MAX, IFLA_RTA(ifi), len);</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>    <span class="comment">/* Check if we got this from bonding */</span></div>
<div class="line"><span class="lineno">   93</span>    <span class="keywordflow">if</span>(tb[IFLA_MASTER] &amp;&amp; af_family != AF_BRIDGE)</div>
<div class="line"><span class="lineno">   94</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordflow">if</span>(tb[IFLA_IFNAME] == NULL)</div>
<div class="line"><span class="lineno">   97</span>    {</div>
<div class="line"><span class="lineno">   98</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;BUG: nil ifname\n&quot;</span>);</div>
<div class="line"><span class="lineno">   99</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  100</span>    }</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>    <span class="keywordflow">if</span>(n-&gt;nlmsg_type == RTM_DELLINK)</div>
<div class="line"><span class="lineno">  103</span>        <a class="code hl_define" href="../../d9/d1e/procd_2log_8h.html#a159ca84d25a5487d8e81e4438725df19">LOG</a>(<span class="stringliteral">&quot;Deleted &quot;</span>);</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>    <a class="code hl_define" href="../../d9/d1e/procd_2log_8h.html#a159ca84d25a5487d8e81e4438725df19">LOG</a>(<span class="stringliteral">&quot;%d: %s &quot;</span>, ifi-&gt;ifi_index, (<span class="keywordtype">char</span>*)RTA_DATA(tb[IFLA_IFNAME]));</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordflow">if</span>(tb[IFLA_OPERSTATE])</div>
<div class="line"><span class="lineno">  108</span>    {</div>
<div class="line"><span class="lineno">  109</span>        __u8 <a class="code hl_variable" href="../../dd/d21/lua_2uloop_8c.html#a6d868643f77c65afe8f86ae76bf60641">state</a> = *(__u8*)RTA_DATA(tb[IFLA_OPERSTATE]);</div>
<div class="line"><span class="lineno">  110</span>        <span class="keywordflow">switch</span> (<a class="code hl_variable" href="../../dd/d21/lua_2uloop_8c.html#a6d868643f77c65afe8f86ae76bf60641">state</a>)</div>
<div class="line"><span class="lineno">  111</span>        {</div>
<div class="line"><span class="lineno">  112</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#ac6bfa7273251ec8fc11ef21ca645ad90ad79c69035bf7ba9393e440759ddced4d">IF_OPER_UNKNOWN</a>:</div>
<div class="line"><span class="lineno">  113</span>                <a class="code hl_define" href="../../d9/d1e/procd_2log_8h.html#a159ca84d25a5487d8e81e4438725df19">LOG</a>(<span class="stringliteral">&quot;Unknown &quot;</span>);</div>
<div class="line"><span class="lineno">  114</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  115</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#ac6bfa7273251ec8fc11ef21ca645ad90af28f982b2fbf50c1c3533fc5a47bfd19">IF_OPER_NOTPRESENT</a>:</div>
<div class="line"><span class="lineno">  116</span>                <a class="code hl_define" href="../../d9/d1e/procd_2log_8h.html#a159ca84d25a5487d8e81e4438725df19">LOG</a>(<span class="stringliteral">&quot;Not Present &quot;</span>);</div>
<div class="line"><span class="lineno">  117</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  118</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#ac6bfa7273251ec8fc11ef21ca645ad90ae70e5f7c84fa2cdf4cdcdf4b8cc7a6b0">IF_OPER_DOWN</a>:</div>
<div class="line"><span class="lineno">  119</span>                <a class="code hl_define" href="../../d9/d1e/procd_2log_8h.html#a159ca84d25a5487d8e81e4438725df19">LOG</a>(<span class="stringliteral">&quot;Down &quot;</span>);</div>
<div class="line"><span class="lineno">  120</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  121</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#ac6bfa7273251ec8fc11ef21ca645ad90a0dffc68065aa94fa306df4c5ecc8928e">IF_OPER_LOWERLAYERDOWN</a>:</div>
<div class="line"><span class="lineno">  122</span>                <a class="code hl_define" href="../../d9/d1e/procd_2log_8h.html#a159ca84d25a5487d8e81e4438725df19">LOG</a>(<span class="stringliteral">&quot;Lowerlayerdown &quot;</span>);</div>
<div class="line"><span class="lineno">  123</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  124</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#ac6bfa7273251ec8fc11ef21ca645ad90a042504491c802899b30c17a2461ff60e">IF_OPER_TESTING</a>:</div>
<div class="line"><span class="lineno">  125</span>                <a class="code hl_define" href="../../d9/d1e/procd_2log_8h.html#a159ca84d25a5487d8e81e4438725df19">LOG</a>(<span class="stringliteral">&quot;Testing &quot;</span>);</div>
<div class="line"><span class="lineno">  126</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  127</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#ac6bfa7273251ec8fc11ef21ca645ad90a4c9d55aae13f50b964fef02468fda0d2">IF_OPER_DORMANT</a>:</div>
<div class="line"><span class="lineno">  128</span>                <a class="code hl_define" href="../../d9/d1e/procd_2log_8h.html#a159ca84d25a5487d8e81e4438725df19">LOG</a>(<span class="stringliteral">&quot;Dormant &quot;</span>);</div>
<div class="line"><span class="lineno">  129</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  130</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#ac6bfa7273251ec8fc11ef21ca645ad90a9922914e19e684a23b40e13d49a8aa2d">IF_OPER_UP</a>:</div>
<div class="line"><span class="lineno">  131</span>                <a class="code hl_define" href="../../d9/d1e/procd_2log_8h.html#a159ca84d25a5487d8e81e4438725df19">LOG</a>(<span class="stringliteral">&quot;Up &quot;</span>);</div>
<div class="line"><span class="lineno">  132</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  133</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  134</span>                <a class="code hl_define" href="../../d9/d1e/procd_2log_8h.html#a159ca84d25a5487d8e81e4438725df19">LOG</a>(<span class="stringliteral">&quot;State(%d) &quot;</span>, <a class="code hl_variable" href="../../dd/d21/lua_2uloop_8c.html#a6d868643f77c65afe8f86ae76bf60641">state</a>);</div>
<div class="line"><span class="lineno">  135</span>        }</div>
<div class="line"><span class="lineno">  136</span>    }</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>    <span class="keywordflow">if</span>(tb[IFLA_MTU])</div>
<div class="line"><span class="lineno">  139</span>        <a class="code hl_define" href="../../d9/d1e/procd_2log_8h.html#a159ca84d25a5487d8e81e4438725df19">LOG</a>(<span class="stringliteral">&quot;mtu %u &quot;</span>, *(<span class="keywordtype">int</span>*)RTA_DATA(tb[IFLA_MTU]));</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>    <span class="keywordflow">if</span>(tb[IFLA_MASTER])</div>
<div class="line"><span class="lineno">  142</span>    {</div>
<div class="line"><span class="lineno">  143</span>        <a class="code hl_define" href="../../d9/d1e/procd_2log_8h.html#a159ca84d25a5487d8e81e4438725df19">LOG</a>(<span class="stringliteral">&quot;master %s &quot;</span>,</div>
<div class="line"><span class="lineno">  144</span>                if_indextoname(*(<span class="keywordtype">int</span>*)RTA_DATA(tb[IFLA_MASTER]), b1));</div>
<div class="line"><span class="lineno">  145</span>    }</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>    <span class="keywordflow">if</span>(tb[IFLA_PROTINFO])</div>
<div class="line"><span class="lineno">  148</span>    {</div>
<div class="line"><span class="lineno">  149</span>        uint8_t <a class="code hl_variable" href="../../dd/d21/lua_2uloop_8c.html#a6d868643f77c65afe8f86ae76bf60641">state</a> = *(uint8_t *)RTA_DATA(tb[IFLA_PROTINFO]);</div>
<div class="line"><span class="lineno">  150</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../dd/d21/lua_2uloop_8c.html#a6d868643f77c65afe8f86ae76bf60641">state</a> &lt;= BR_STATE_BLOCKING)</div>
<div class="line"><span class="lineno">  151</span>            <a class="code hl_define" href="../../d9/d1e/procd_2log_8h.html#a159ca84d25a5487d8e81e4438725df19">LOG</a>(<span class="stringliteral">&quot;state %s&quot;</span>, <a class="code hl_variable" href="#a998860464d2d411d2e90d637a9fb604c">port_states</a>[<a class="code hl_variable" href="../../dd/d21/lua_2uloop_8c.html#a6d868643f77c65afe8f86ae76bf60641">state</a>]);</div>
<div class="line"><span class="lineno">  152</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  153</span>            <a class="code hl_define" href="../../d9/d1e/procd_2log_8h.html#a159ca84d25a5487d8e81e4438725df19">LOG</a>(<span class="stringliteral">&quot;state (%d)&quot;</span>, <a class="code hl_variable" href="../../dd/d21/lua_2uloop_8c.html#a6d868643f77c65afe8f86ae76bf60641">state</a>);</div>
<div class="line"><span class="lineno">  154</span>    }</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>    newlink = (n-&gt;nlmsg_type == RTM_NEWLINK);</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>    <span class="keywordflow">if</span>(tb[IFLA_MASTER])</div>
<div class="line"><span class="lineno">  159</span>        br_index = *(<span class="keywordtype">int</span>*)RTA_DATA(tb[IFLA_MASTER]);</div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_function" href="../../da/dbf/netif__utils_8c.html#a9b10b4d46fa7f9567b9de1afc4a11518">is_bridge</a>((<span class="keywordtype">char</span>*)RTA_DATA(tb[IFLA_IFNAME])))</div>
<div class="line"><span class="lineno">  161</span>        br_index = ifi-&gt;ifi_index;</div>
<div class="line"><span class="lineno">  162</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  163</span>        br_index = -1;</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>    <a class="code hl_function" href="../../d0/dcc/bridge__ctl_8h.html#a866cd25eb628ca59a4bb923024c7de63">bridge_notify</a>(br_index, ifi-&gt;ifi_index, newlink, ifi-&gt;ifi_flags);</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  168</span>}</div>
<div class="ttc" id="abridge__ctl_8h_html_a866cd25eb628ca59a4bb923024c7de63"><div class="ttname"><a href="../../d0/dcc/bridge__ctl_8h.html#a866cd25eb628ca59a4bb923024c7de63">bridge_notify</a></div><div class="ttdeci">int bridge_notify(int br_index, int if_index, bool newlink, unsigned flags)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d10/bridge__track_8c_source.html#l00282">bridge_track.c:282</a></div></div>
<div class="ttc" id="abrmon_8c_html_a998860464d2d411d2e90d637a9fb604c"><div class="ttname"><a href="#a998860464d2d411d2e90d637a9fb604c">port_states</a></div><div class="ttdeci">static const char * port_states[]</div><div class="ttdef"><b>Definition</b> <a href="../../d1/db2/brmon_8c_source.html#l00048">brmon.c:48</a></div></div>
<div class="ttc" id="alibnetlink_8c_html_aed575cd447219f8c2f67e2011aaee4d8"><div class="ttname"><a href="../../d4/dab/libnetlink_8c.html#aed575cd447219f8c2f67e2011aaee4d8">parse_rtattr</a></div><div class="ttdeci">int parse_rtattr(struct rtattr *tb[], int max, struct rtattr *rta, int len)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dab/libnetlink_8c_source.html#l00650">libnetlink.c:650</a></div></div>
<div class="ttc" id="alua_2uloop_8c_html_a6d868643f77c65afe8f86ae76bf60641"><div class="ttname"><a href="../../dd/d21/lua_2uloop_8c.html#a6d868643f77c65afe8f86ae76bf60641">state</a></div><div class="ttdeci">static lua_State * state</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d21/lua_2uloop_8c_source.html#l00054">uloop.c:54</a></div></div>
<div class="ttc" id="anetif__utils_8c_html_a9b10b4d46fa7f9567b9de1afc4a11518"><div class="ttname"><a href="../../da/dbf/netif__utils_8c.html#a9b10b4d46fa7f9567b9de1afc4a11518">is_bridge</a></div><div class="ttdeci">bool is_bridge(char *if_name)</div><div class="ttdef"><b>Definition</b> <a href="../../da/dbf/netif__utils_8c_source.html#l00130">netif_utils.c:130</a></div></div>
<div class="ttc" id="aprocd_2log_8h_html_a159ca84d25a5487d8e81e4438725df19"><div class="ttname"><a href="../../d9/d1e/procd_2log_8h.html#a159ca84d25a5487d8e81e4438725df19">LOG</a></div><div class="ttdeci">#define LOG</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d1e/procd_2log_8h_source.html#l00032">log.h:32</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d10/bridge__track_8c_source.html#l00282">bridge_notify()</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../d1/db2/brmon_8c_source.html#l00037">IF_OPER_DORMANT</a>, <a class="el" href="../../d1/db2/brmon_8c_source.html#l00034">IF_OPER_DOWN</a>, <a class="el" href="../../d1/db2/brmon_8c_source.html#l00035">IF_OPER_LOWERLAYERDOWN</a>, <a class="el" href="../../d1/db2/brmon_8c_source.html#l00033">IF_OPER_NOTPRESENT</a>, <a class="el" href="../../d1/db2/brmon_8c_source.html#l00036">IF_OPER_TESTING</a>, <a class="el" href="../../d1/db2/brmon_8c_source.html#l00032">IF_OPER_UNKNOWN</a>, <a class="el" href="../../d1/db2/brmon_8c_source.html#l00038">IF_OPER_UP</a>, <a class="el" href="../../da/dbf/netif__utils_8c_source.html#l00130">is_bridge()</a>, <a class="el" href="../../d9/d1e/procd_2log_8h_source.html#l00032">LOG</a>, <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00650">parse_rtattr()</a>, <a class="el" href="../../d1/db2/brmon_8c_source.html#l00048">port_states</a>, and <a class="el" href="../../dd/d21/lua_2uloop_8c_source.html#l00054">state</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/db2/brmon_8c_source.html#l00170">bridge_event_handler()</a>, and <a class="el" href="../../d1/db2/brmon_8c_source.html#l00187">init_bridge_ops()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/db2/brmon_8c_a0db6d708a3545bc41ee2412fc0f38310_cgraph.png" border="0" usemap="#ad1/db2/brmon_8c_a0db6d708a3545bc41ee2412fc0f38310_cgraph" alt=""/></div>
<map name="ad1/db2/brmon_8c_a0db6d708a3545bc41ee2412fc0f38310_cgraph" id="ad1/db2/brmon_8c_a0db6d708a3545bc41ee2412fc0f38310_cgraph">
<area shape="rect" title=" " alt="" coords="5,63,130,96"/>
<area shape="rect" href="../../d7/d10/bridge__track_8c.html#a866cd25eb628ca59a4bb923024c7de63" title=" " alt="" coords="178,5,320,39"/>
<area shape="poly" title=" " alt="" coords="122,60,178,42,179,47,124,65"/>
<area shape="rect" href="../../da/dbf/netif__utils_8c.html#a9b10b4d46fa7f9567b9de1afc4a11518" title=" " alt="" coords="196,63,302,96"/>
<area shape="poly" title=" " alt="" coords="130,77,181,77,181,82,130,82"/>
<area shape="rect" href="../../d4/dab/libnetlink_8c.html#aed575cd447219f8c2f67e2011aaee4d8" title=" " alt="" coords="184,120,314,154"/>
<area shape="poly" title=" " alt="" coords="124,94,179,112,178,117,122,99"/>
</map>
</div>

</div>
</div>
<a id="a0cb1f9cfe718d5010b8d72ee3ae2b734" name="a0cb1f9cfe718d5010b8d72ee3ae2b734"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cb1f9cfe718d5010b8d72ee3ae2b734">&#9670;&#160;</a></span>init_bridge_ops()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int init_bridge_ops </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/db2/brmon_8c_source.html#l00187">187</a> of file <a class="el" href="../../d1/db2/brmon_8c_source.html">brmon.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  188</span>{</div>
<div class="line"><span class="lineno">  189</span>    <span class="keywordflow">if</span>(<a class="code hl_function" href="../../d4/dab/libnetlink_8c.html#af6a834b458ad515cfe591cd720b5a3fd">rtnl_open</a>(&amp;<a class="code hl_variable" href="#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>, RTMGRP_LINK) &lt; 0)</div>
<div class="line"><span class="lineno">  190</span>    {</div>
<div class="line"><span class="lineno">  191</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Couldn&#39;t open rtnl socket for monitoring\n&quot;</span>);</div>
<div class="line"><span class="lineno">  192</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  193</span>    }</div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span>    <span class="keywordflow">if</span>(<a class="code hl_function" href="../../d4/dab/libnetlink_8c.html#af6a834b458ad515cfe591cd720b5a3fd">rtnl_open</a>(&amp;<a class="code hl_variable" href="#a883459b4943f3c3535a17e95da3f08dc">rth_state</a>, 0) &lt; 0)</div>
<div class="line"><span class="lineno">  196</span>    {</div>
<div class="line"><span class="lineno">  197</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Couldn&#39;t open rtnl socket for setting state\n&quot;</span>);</div>
<div class="line"><span class="lineno">  198</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  199</span>    }</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>    <span class="keywordflow">if</span>(<a class="code hl_function" href="../../d4/dab/libnetlink_8c.html#ae723f19314cbb031a26abaee33928b84">rtnl_wilddump_request</a>(&amp;<a class="code hl_variable" href="#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>, PF_BRIDGE, RTM_GETLINK) &lt; 0)</div>
<div class="line"><span class="lineno">  202</span>    {</div>
<div class="line"><span class="lineno">  203</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Cannot send dump request: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno">  204</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  205</span>    }</div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>    <span class="keywordflow">if</span>(<a class="code hl_function" href="../../d4/dab/libnetlink_8c.html#a0c981a8de14fd51a25027ef407e799ca">rtnl_dump_filter</a>(&amp;<a class="code hl_variable" href="#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>, <a class="code hl_function" href="#a0db6d708a3545bc41ee2412fc0f38310">dump_msg</a>, stdout, NULL, NULL) &lt; 0)</div>
<div class="line"><span class="lineno">  208</span>    {</div>
<div class="line"><span class="lineno">  209</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Dump terminated\n&quot;</span>);</div>
<div class="line"><span class="lineno">  210</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  211</span>    }</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>    <span class="keywordflow">if</span>(fcntl(<a class="code hl_variable" href="#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>.<a class="code hl_variable" href="../../d5/da4/libnetlink_8h.html#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, F_SETFL, O_NONBLOCK) &lt; 0)</div>
<div class="line"><span class="lineno">  214</span>    {</div>
<div class="line"><span class="lineno">  215</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Error setting O_NONBLOCK: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno">  216</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  217</span>    }</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>    <a class="code hl_variable" href="#ad019ccbab85e770de7ac22b8093b20ab">ufd</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#ad8badf8512adcf9a8819ed088bde09cc">fd</a> = <a class="code hl_variable" href="#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>.<a class="code hl_variable" href="../../d5/da4/libnetlink_8h.html#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>;</div>
<div class="line"><span class="lineno">  220</span>    <a class="code hl_variable" href="#ad019ccbab85e770de7ac22b8093b20ab">ufd</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#ae413fa6bfe9ee31b5764d402d9795fdc">cb</a> = <a class="code hl_function" href="#ac9a6b4d196a1b5592bba5833f61ac930">bridge_event_cb</a>;</div>
<div class="line"><span class="lineno">  221</span>    <a class="code hl_function" href="../../d1/d08/uloop_8c.html#a570d5b4ff73cb373a6ca0ac54a9726a0">uloop_fd_add</a>(&amp;<a class="code hl_variable" href="#ad019ccbab85e770de7ac22b8093b20ab">ufd</a>, <a class="code hl_define" href="../../dc/d56/uloop_8h.html#ac20cd5fed660ef784791db47283d9ebf">ULOOP_READ</a> | <a class="code hl_define" href="../../dc/d56/uloop_8h.html#ae0a4bba54063aede5669dbd4782ad6f5">ULOOP_EDGE_TRIGGER</a>);</div>
<div class="line"><span class="lineno">  222</span>    <a class="code hl_function" href="#ac9a6b4d196a1b5592bba5833f61ac930">bridge_event_cb</a>(&amp;<a class="code hl_variable" href="#ad019ccbab85e770de7ac22b8093b20ab">ufd</a>, 0);</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  225</span>}</div>
<div class="ttc" id="abrmon_8c_html_a883459b4943f3c3535a17e95da3f08dc"><div class="ttname"><a href="#a883459b4943f3c3535a17e95da3f08dc">rth_state</a></div><div class="ttdeci">struct rtnl_handle rth_state</div><div class="ttdef"><b>Definition</b> <a href="../../d1/db2/brmon_8c_source.html#l00060">brmon.c:60</a></div></div>
<div class="ttc" id="abrmon_8c_html_ac9a6b4d196a1b5592bba5833f61ac930"><div class="ttname"><a href="#ac9a6b4d196a1b5592bba5833f61ac930">bridge_event_cb</a></div><div class="ttdeci">static void bridge_event_cb(struct uloop_fd *fd, unsigned int events)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/db2/brmon_8c_source.html#l00178">brmon.c:178</a></div></div>
<div class="ttc" id="abrmon_8c_html_ad019ccbab85e770de7ac22b8093b20ab"><div class="ttname"><a href="#ad019ccbab85e770de7ac22b8093b20ab">ufd</a></div><div class="ttdeci">static struct uloop_fd ufd</div><div class="ttdef"><b>Definition</b> <a href="../../d1/db2/brmon_8c_source.html#l00058">brmon.c:58</a></div></div>
<div class="ttc" id="alibnetlink_8c_html_a0c981a8de14fd51a25027ef407e799ca"><div class="ttname"><a href="../../d4/dab/libnetlink_8c.html#a0c981a8de14fd51a25027ef407e799ca">rtnl_dump_filter</a></div><div class="ttdeci">int rtnl_dump_filter(struct rtnl_handle *rth, rtnl_filter_t filter, void *arg1, rtnl_filter_t junk, void *arg2)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dab/libnetlink_8c_source.html#l00170">libnetlink.c:170</a></div></div>
<div class="ttc" id="alibnetlink_8c_html_ae723f19314cbb031a26abaee33928b84"><div class="ttname"><a href="../../d4/dab/libnetlink_8c.html#ae723f19314cbb031a26abaee33928b84">rtnl_wilddump_request</a></div><div class="ttdeci">int rtnl_wilddump_request(struct rtnl_handle *rth, int family, int type)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dab/libnetlink_8c_source.html#l00108">libnetlink.c:108</a></div></div>
<div class="ttc" id="alibnetlink_8c_html_af6a834b458ad515cfe591cd720b5a3fd"><div class="ttname"><a href="../../d4/dab/libnetlink_8c.html#af6a834b458ad515cfe591cd720b5a3fd">rtnl_open</a></div><div class="ttdeci">int rtnl_open(struct rtnl_handle *rth, unsigned subscriptions)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dab/libnetlink_8c_source.html#l00103">libnetlink.c:103</a></div></div>
<div class="ttc" id="alibnetlink_8h_html_a58397dc05569f5250b2bde1e40d2ddd2"><div class="ttname"><a href="../../d5/da4/libnetlink_8h.html#a58397dc05569f5250b2bde1e40d2ddd2">rtnl_handle::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition</b> <a href="../../d5/da4/libnetlink_8h_source.html#l00012">libnetlink.h:12</a></div></div>
<div class="ttc" id="auloop_8c_html_a570d5b4ff73cb373a6ca0ac54a9726a0"><div class="ttname"><a href="../../d1/d08/uloop_8c.html#a570d5b4ff73cb373a6ca0ac54a9726a0">uloop_fd_add</a></div><div class="ttdeci">int uloop_fd_add(struct uloop_fd *sock, unsigned int flags)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d08/uloop_8c_source.html#l00235">uloop.c:235</a></div></div>
<div class="ttc" id="auloop_8h_html_ac20cd5fed660ef784791db47283d9ebf"><div class="ttname"><a href="../../dc/d56/uloop_8h.html#ac20cd5fed660ef784791db47283d9ebf">ULOOP_READ</a></div><div class="ttdeci">#define ULOOP_READ</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d56/uloop_8h_source.html#l00047">uloop.h:47</a></div></div>
<div class="ttc" id="auloop_8h_html_ad8badf8512adcf9a8819ed088bde09cc"><div class="ttname"><a href="../../dc/d56/uloop_8h.html#ad8badf8512adcf9a8819ed088bde09cc">uloop_fd::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d56/uloop_8h_source.html#l00065">uloop.h:65</a></div></div>
<div class="ttc" id="auloop_8h_html_ae0a4bba54063aede5669dbd4782ad6f5"><div class="ttname"><a href="../../dc/d56/uloop_8h.html#ae0a4bba54063aede5669dbd4782ad6f5">ULOOP_EDGE_TRIGGER</a></div><div class="ttdeci">#define ULOOP_EDGE_TRIGGER</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d56/uloop_8h_source.html#l00049">uloop.h:49</a></div></div>
<div class="ttc" id="auloop_8h_html_ae413fa6bfe9ee31b5764d402d9795fdc"><div class="ttname"><a href="../../dc/d56/uloop_8h.html#ae413fa6bfe9ee31b5764d402d9795fdc">uloop_fd::cb</a></div><div class="ttdeci">uloop_fd_handler cb</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d56/uloop_8h_source.html#l00064">uloop.h:64</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/db2/brmon_8c_source.html#l00178">bridge_event_cb()</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00064">uloop_fd::cb</a>, <a class="el" href="../../d1/db2/brmon_8c_source.html#l00062">dump_msg()</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00012">rtnl_handle::fd</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00065">uloop_fd::fd</a>, <a class="el" href="../../d1/db2/brmon_8c_source.html#l00057">rth</a>, <a class="el" href="../../d1/db2/brmon_8c_source.html#l00060">rth_state</a>, <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00170">rtnl_dump_filter()</a>, <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00103">rtnl_open()</a>, <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00108">rtnl_wilddump_request()</a>, <a class="el" href="../../d1/db2/brmon_8c_source.html#l00058">ufd</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00049">ULOOP_EDGE_TRIGGER</a>, <a class="el" href="../../d1/d08/uloop_8c_source.html#l00235">uloop_fd_add()</a>, and <a class="el" href="../../dc/d56/uloop_8h_source.html#l00047">ULOOP_READ</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d10/ustp_2main_8c_source.html#l00055">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/db2/brmon_8c_a0cb1f9cfe718d5010b8d72ee3ae2b734_cgraph.png" border="0" usemap="#ad1/db2/brmon_8c_a0cb1f9cfe718d5010b8d72ee3ae2b734_cgraph" alt=""/></div>
<map name="ad1/db2/brmon_8c_a0cb1f9cfe718d5010b8d72ee3ae2b734_cgraph" id="ad1/db2/brmon_8c_a0cb1f9cfe718d5010b8d72ee3ae2b734_cgraph">
<area shape="rect" title=" " alt="" coords="5,207,167,240"/>
<area shape="rect" href="../../d1/db2/brmon_8c.html#ac9a6b4d196a1b5592bba5833f61ac930" title=" " alt="" coords="244,35,418,68"/>
<area shape="poly" title=" " alt="" coords="101,204,149,157,213,105,272,73,274,77,216,110,153,161,105,208"/>
<area shape="rect" href="../../d1/db2/brmon_8c.html#a0db6d708a3545bc41ee2412fc0f38310" title=" " alt="" coords="269,120,393,154"/>
<area shape="poly" title=" " alt="" coords="119,204,163,183,214,162,253,151,254,156,216,167,166,188,121,209"/>
<area shape="rect" href="../../d4/dab/libnetlink_8c.html#a0c981a8de14fd51a25027ef407e799ca" title=" " alt="" coords="247,177,415,211"/>
<area shape="poly" title=" " alt="" coords="167,211,231,203,231,209,168,216"/>
<area shape="rect" href="../../d4/dab/libnetlink_8c.html#af6a834b458ad515cfe591cd720b5a3fd" title=" " alt="" coords="277,235,385,268"/>
<area shape="poly" title=" " alt="" coords="168,230,261,241,261,246,167,235"/>
<area shape="rect" href="../../d4/dab/libnetlink_8c.html#ae723f19314cbb031a26abaee33928b84" title=" " alt="" coords="215,292,447,326"/>
<area shape="poly" title=" " alt="" coords="122,238,216,278,236,285,235,290,214,283,120,243"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a570d5b4ff73cb373a6ca0ac54a9726a0" title=" " alt="" coords="259,349,403,383"/>
<area shape="poly" title=" " alt="" coords="103,239,150,288,182,314,216,336,245,348,243,353,213,341,178,318,147,291,100,243"/>
<area shape="rect" href="../../dc/d8e/worker_8c.html#ab15dfc282bf3fe773ef4eb0fb90adbe8" title=" " alt="" coords="495,5,707,39"/>
<area shape="poly" title=" " alt="" coords="418,39,479,33,480,38,418,45"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="800,5,930,39"/>
<area shape="poly" title=" " alt="" coords="708,20,785,20,785,25,708,25"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="1023,5,1124,39"/>
<area shape="poly" title=" " alt="" coords="930,20,1007,20,1007,25,930,25"/>
<area shape="rect" href="../../d7/d10/bridge__track_8c.html#a866cd25eb628ca59a4bb923024c7de63" title=" " alt="" coords="530,63,672,96"/>
<area shape="poly" title=" " alt="" coords="393,121,514,95,516,100,394,126"/>
<area shape="rect" href="../../da/dbf/netif__utils_8c.html#a9b10b4d46fa7f9567b9de1afc4a11518" title=" " alt="" coords="549,120,654,154"/>
<area shape="poly" title=" " alt="" coords="394,134,533,134,533,140,394,140"/>
<area shape="rect" href="../../d4/dab/libnetlink_8c.html#aed575cd447219f8c2f67e2011aaee4d8" title=" " alt="" coords="536,177,666,211"/>
<area shape="poly" title=" " alt="" coords="394,147,521,175,520,180,393,153"/>
<area shape="rect" href="../../d4/dab/libnetlink_8c.html#adcef0338bcf67064f61e984ea6542a4f" title=" " alt="" coords="507,235,695,268"/>
<area shape="poly" title=" " alt="" coords="385,249,491,249,491,254,385,254"/>
<area shape="rect" href="../../d3/d91/uloop-epoll_8c.html#a1b6212744c4241320adc3a2170525f20" title=" " alt="" coords="534,320,668,354"/>
<area shape="poly" title=" " alt="" coords="403,356,519,343,519,348,404,361"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="518,377,684,411"/>
<area shape="poly" title=" " alt="" coords="404,371,503,381,503,387,403,376"/>
<area shape="rect" href="../../d3/d91/uloop-epoll_8c.html#ae98d2f54596aacb1f0f176d0e565e2e2" title=" " alt="" coords="773,348,957,382"/>
<area shape="poly" title=" " alt="" coords="684,382,757,374,757,379,685,388"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#abe443fe3f794c14f0aaa0c5f18a27ddd" title=" " alt="" coords="755,405,975,439"/>
<area shape="poly" title=" " alt="" coords="685,400,740,406,740,412,684,406"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a998860464d2d411d2e90d637a9fb604c" name="a998860464d2d411d2e90d637a9fb604c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a998860464d2d411d2e90d637a9fb604c">&#9670;&#160;</a></span>port_states</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* port_states[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">{</div>
<div class="line">    [BR_STATE_DISABLED] = <span class="stringliteral">&quot;disabled&quot;</span>,</div>
<div class="line">    [BR_STATE_LISTENING] = <span class="stringliteral">&quot;listening&quot;</span>,</div>
<div class="line">    [BR_STATE_LEARNING] = <span class="stringliteral">&quot;learning&quot;</span>,</div>
<div class="line">    [BR_STATE_FORWARDING] = <span class="stringliteral">&quot;forwarding&quot;</span>,</div>
<div class="line">    [BR_STATE_BLOCKING] = <span class="stringliteral">&quot;blocking&quot;</span>,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d1/db2/brmon_8c_source.html#l00048">48</a> of file <a class="el" href="../../d1/db2/brmon_8c_source.html">brmon.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   49</span>{</div>
<div class="line"><span class="lineno">   50</span>    [BR_STATE_DISABLED] = <span class="stringliteral">&quot;disabled&quot;</span>,</div>
<div class="line"><span class="lineno">   51</span>    [BR_STATE_LISTENING] = <span class="stringliteral">&quot;listening&quot;</span>,</div>
<div class="line"><span class="lineno">   52</span>    [BR_STATE_LEARNING] = <span class="stringliteral">&quot;learning&quot;</span>,</div>
<div class="line"><span class="lineno">   53</span>    [BR_STATE_FORWARDING] = <span class="stringliteral">&quot;forwarding&quot;</span>,</div>
<div class="line"><span class="lineno">   54</span>    [BR_STATE_BLOCKING] = <span class="stringliteral">&quot;blocking&quot;</span>,</div>
<div class="line"><span class="lineno">   55</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d1/db2/brmon_8c_source.html#l00062">dump_msg()</a>.</p>

</div>
</div>
<a id="a052e2f2ddaba32f35e414adab16b5fb4" name="a052e2f2ddaba32f35e414adab16b5fb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a052e2f2ddaba32f35e414adab16b5fb4">&#9670;&#160;</a></span>rth</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d5/da4/libnetlink_8h.html#d2/dee/structrtnl__handle">rtnl_handle</a> rth</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/db2/brmon_8c_source.html#l00057">57</a> of file <a class="el" href="../../d1/db2/brmon_8c_source.html">brmon.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d10/bridge__track_8c_source.html#l00428">br_set_state()</a>, <a class="el" href="../../d1/db2/brmon_8c_source.html#l00170">bridge_event_handler()</a>, <a class="el" href="../../d1/db2/brmon_8c_source.html#l00187">init_bridge_ops()</a>, <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00040">rtnl_close()</a>, <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00170">rtnl_dump_filter()</a>, <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00142">rtnl_dump_request()</a>, <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00103">rtnl_open()</a>, <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00045">rtnl_open_byproto()</a>, <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00131">rtnl_send()</a>, and <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00108">rtnl_wilddump_request()</a>.</p>

</div>
</div>
<a id="a883459b4943f3c3535a17e95da3f08dc" name="a883459b4943f3c3535a17e95da3f08dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a883459b4943f3c3535a17e95da3f08dc">&#9670;&#160;</a></span>rth_state</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d5/da4/libnetlink_8h.html#d2/dee/structrtnl__handle">rtnl_handle</a> rth_state</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/db2/brmon_8c_source.html#l00060">60</a> of file <a class="el" href="../../d1/db2/brmon_8c_source.html">brmon.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/db2/brmon_8c_source.html#l00187">init_bridge_ops()</a>, and <a class="el" href="../../d7/d10/bridge__track_8c_source.html#l00478">MSTP_OUT_set_state()</a>.</p>

</div>
</div>
<a id="ad019ccbab85e770de7ac22b8093b20ab" name="ad019ccbab85e770de7ac22b8093b20ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad019ccbab85e770de7ac22b8093b20ab">&#9670;&#160;</a></span>ufd</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dc/d56/uloop_8h.html#db/d9e/structuloop__fd">uloop_fd</a> ufd</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/db2/brmon_8c_source.html#l00058">58</a> of file <a class="el" href="../../d1/db2/brmon_8c_source.html">brmon.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/db2/brmon_8c_source.html#l00187">init_bridge_ops()</a>, <a class="el" href="../../dd/d21/lua_2uloop_8c_source.html#l00238">ul_ufd_add()</a>, <a class="el" href="../../dd/d21/lua_2uloop_8c_source.html#l00173">ul_ufd_cb()</a>, and <a class="el" href="../../dd/d21/lua_2uloop_8c_source.html#l00210">ul_ufd_delete()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
