<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>zbus: /home/g41797/CLionProjects/github.com/g41797/zbus/src/libs/procd/trace/trace.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">zbus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_87a455bccb09a92130c26a11a880c98a.html">libs</a></li><li class="navelem"><a class="el" href="../../dir_63350b749fcf74007a53c7c917c10773.html">procd</a></li><li class="navelem"><a class="el" href="../../dir_9d1982a5a439b1aa9b360e72bce5fa23.html">trace</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">trace.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;sys/ptrace.h&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;sys/user.h&gt;</code><br />
<code>#include &lt;sys/wait.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;libgen.h&gt;</code><br />
<code>#include &lt;syslog.h&gt;</code><br />
<code>#include &lt;limits.h&gt;</code><br />
<code>#include &lt;<a class="el" href="../../df/df3/ulog_8h_source.html">libubox/ulog.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../dc/d56/uloop_8h_source.html">libubox/uloop.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../dd/dad/blobmsg_8h_source.html">libubox/blobmsg.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d5/dea/blobmsg__json_8h_source.html">libubox/blobmsg_json.h</a>&gt;</code><br />
<code>#include &quot;../syscall-names.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for trace.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/dd5/trace_8c__incl.png" border="0" usemap="#a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2procd_2trace_2trace_8c" alt=""/></div>
<map name="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2procd_2trace_2trace_8c" id="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2procd_2trace_2trace_8c">
<area shape="rect" title=" " alt="" coords="1298,5,1585,85"/>
<area shape="rect" title=" " alt="" coords="5,133,86,167"/>
<area shape="poly" title=" " alt="" coords="1298,49,1068,54,770,67,438,93,269,112,105,136,101,136,100,131,104,130,269,107,438,88,770,62,1068,49,1298,44"/>
<area shape="rect" title=" " alt="" coords="125,460,222,493"/>
<area shape="poly" title=" " alt="" coords="1298,54,970,72,776,86,582,105,405,128,259,157,203,174,161,192,134,211,128,220,125,230,125,314,129,350,137,385,161,445,156,446,132,387,124,351,120,315,120,230,123,218,130,207,158,187,201,169,258,152,404,123,582,99,776,81,970,66,1298,49"/>
<area shape="rect" title=" " alt="" coords="1631,133,1767,167"/>
<area shape="poly" title=" " alt="" coords="1541,83,1645,124,1643,129,1539,88"/>
<area shape="rect" title=" " alt="" coords="1362,460,1473,493"/>
<area shape="poly" title=" " alt="" coords="1480,84,1503,114,1524,149,1539,188,1545,230,1545,315,1544,344,1540,367,1530,389,1513,413,1491,436,1466,454,1463,449,1488,432,1509,410,1525,386,1535,366,1539,343,1540,314,1540,230,1534,190,1519,151,1498,117,1476,87"/>
<area shape="rect" title=" " alt="" coords="842,460,969,493"/>
<area shape="poly" title=" " alt="" coords="1461,85,1484,152,1492,191,1495,230,1495,314,1495,369,1487,392,1469,414,1430,435,1377,448,1313,456,1244,459,1103,459,985,462,985,457,1103,453,1244,453,1313,450,1376,443,1428,430,1465,410,1483,389,1490,369,1490,315,1490,230,1486,191,1478,153,1456,86"/>
<area shape="rect" title=" " alt="" coords="1791,133,1906,167"/>
<area shape="poly" title=" " alt="" coords="1586,80,1776,128,1775,133,1584,85"/>
<area shape="rect" title=" " alt="" coords="1930,133,2044,167"/>
<area shape="poly" title=" " alt="" coords="1585,68,1915,130,1914,135,1584,74"/>
<area shape="rect" title=" " alt="" coords="1524,460,1621,493"/>
<area shape="poly" title=" " alt="" coords="1503,84,1536,112,1566,146,1588,186,1594,207,1596,230,1596,315,1591,385,1581,445,1576,444,1586,384,1591,314,1591,230,1589,208,1583,188,1561,149,1532,115,1500,88"/>
<area shape="rect" title=" " alt="" coords="1144,378,1235,412"/>
<area shape="poly" title=" " alt="" coords="1418,87,1305,250,1214,368,1210,364,1301,247,1414,84"/>
<area shape="rect" title=" " alt="" coords="1259,378,1344,412"/>
<area shape="poly" title=" " alt="" coords="1435,86,1401,218,1381,284,1361,331,1333,368,1328,365,1357,329,1376,282,1396,216,1430,85"/>
<area shape="rect" title=" " alt="" coords="1367,378,1455,412"/>
<area shape="poly" title=" " alt="" coords="1441,86,1416,363,1411,362,1435,85"/>
<area shape="rect" title=" " alt="" coords="2068,133,2164,167"/>
<area shape="poly" title=" " alt="" coords="1585,59,1802,88,2054,130,2053,135,1801,93,1585,65"/>
<area shape="rect" title=" " alt="" coords="1192,215,1291,248"/>
<area shape="poly" title=" " alt="" coords="1383,88,1323,135,1291,170,1264,204,1259,200,1287,166,1320,131,1379,83"/>
<area shape="rect" title=" " alt="" coords="2189,133,2278,167"/>
<area shape="poly" title=" " alt="" coords="1585,54,1855,82,2013,103,2174,130,2174,136,2013,108,1854,87,1585,60"/>
<area shape="rect" href="../../df/df3/ulog_8h.html" title=" " alt="" coords="1098,133,1252,167"/>
<area shape="poly" title=" " alt="" coords="1340,88,1232,129,1230,124,1338,83"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html" title=" " alt="" coords="487,296,577,330"/>
<area shape="poly" title=" " alt="" coords="1298,57,1183,67,1050,83,910,105,771,136,660,159,616,178,594,194,570,216,550,248,539,282,534,280,545,246,566,213,591,190,614,174,659,154,770,130,909,100,1050,77,1183,62,1298,52"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html" title=" " alt="" coords="921,215,1114,248"/>
<area shape="poly" title=" " alt="" coords="1298,61,1245,71,1191,87,1137,108,1088,135,1071,150,1056,167,1033,203,1029,200,1052,164,1067,146,1085,131,1135,103,1189,81,1244,66,1297,56"/>
<area shape="rect" href="../../d5/dea/blobmsg__json_8h.html" title=" " alt="" coords="783,133,1023,167"/>
<area shape="poly" title=" " alt="" coords="1298,76,1004,132,1003,127,1297,71"/>
<area shape="rect" title=" " alt="" coords="2302,133,2490,167"/>
<area shape="poly" title=" " alt="" coords="1585,57,1903,87,2287,130,2286,135,1902,92,1585,62"/>
<area shape="poly" title=" " alt="" coords="1190,165,1220,201,1216,204,1186,169"/>
<area shape="rect" href="../../de/dd2/udebug_8h.html" title=" " alt="" coords="580,215,690,248"/>
<area shape="poly" title=" " alt="" coords="1098,165,706,222,705,217,1098,160"/>
<area shape="poly" title=" " alt="" coords="654,247,878,447,875,451,651,251"/>
<area shape="rect" title=" " alt="" coords="583,460,676,493"/>
<area shape="poly" title=" " alt="" coords="637,249,633,444,628,444,632,249"/>
<area shape="rect" title=" " alt="" coords="926,296,1024,330"/>
<area shape="poly" title=" " alt="" coords="691,243,911,294,910,299,690,248"/>
<area shape="rect" href="../../da/d23/list_8h.html" title=" " alt="" coords="312,378,379,412"/>
<area shape="poly" title=" " alt="" coords="586,251,532,272,476,299,422,334,377,370,374,365,419,329,474,294,530,267,584,246"/>
<area shape="poly" title=" " alt="" coords="616,251,567,289,563,284,612,247"/>
<area shape="rect" href="../../d3/d51/avl_8h.html" title=" " alt="" coords="287,296,353,330"/>
<area shape="poly" title=" " alt="" coords="580,249,369,302,368,297,579,244"/>
<area shape="poly" title=" " alt="" coords="313,414,223,455,221,450,311,409"/>
<area shape="rect" title=" " alt="" coords="327,460,434,493"/>
<area shape="poly" title=" " alt="" coords="355,411,370,444,365,446,350,413"/>
<area shape="poly" title=" " alt="" coords="571,328,855,451,853,456,569,333"/>
<area shape="poly" title=" " alt="" coords="544,329,614,445,610,448,540,332"/>
<area shape="poly" title=" " alt="" coords="495,333,394,376,392,371,493,328"/>
<area shape="poly" title=" " alt="" coords="505,333,474,354,443,380,417,413,397,447,393,444,413,410,440,376,470,349,502,328"/>
<area shape="rect" title=" " alt="" coords="700,460,818,493"/>
<area shape="poly" title=" " alt="" coords="556,328,725,448,722,452,553,333"/>
<area shape="rect" title=" " alt="" coords="453,378,547,412"/>
<area shape="poly" title=" " alt="" coords="528,331,515,364,510,362,523,329"/>
<area shape="poly" title=" " alt="" coords="308,332,200,450,196,446,304,329"/>
<area shape="poly" title=" " alt="" coords="328,330,338,362,333,364,323,331"/>
<area shape="poly" title=" " alt="" coords="313,331,300,369,298,390,303,411,318,432,337,449,334,453,314,435,298,413,292,391,294,368,308,329"/>
<area shape="poly" title=" " alt="" coords="1011,250,993,284,988,281,1007,248"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html" title=" " alt="" coords="1049,296,1128,330"/>
<area shape="poly" title=" " alt="" coords="1034,247,1066,283,1062,286,1030,251"/>
<area shape="poly" title=" " alt="" coords="1110,328,1159,366,1155,370,1107,333"/>
<area shape="poly" title=" " alt="" coords="1129,327,1246,370,1244,375,1127,332"/>
<area shape="poly" title=" " alt="" coords="1129,321,1353,374,1352,380,1128,326"/>
<area shape="poly" title=" " alt="" coords="1049,331,690,457,689,452,1047,326"/>
<area shape="poly" title=" " alt="" coords="1049,329,1037,333,925,358,813,381,450,462,448,457,812,375,924,353,1036,327,1047,324"/>
<area shape="rect" title=" " alt="" coords="926,378,1019,412"/>
<area shape="poly" title=" " alt="" coords="1066,333,1010,371,1007,367,1063,328"/>
<area shape="rect" href="../../d5/d1d/libubox_2utils_8h.html" title=" " alt="" coords="1042,378,1121,412"/>
<area shape="poly" title=" " alt="" coords="1089,331,1087,363,1081,362,1084,330"/>
<area shape="poly" title=" " alt="" coords="1122,406,1133,409,1347,458,1346,464,1132,414,1121,411"/>
<area shape="poly" title=" " alt="" coords="1047,415,956,455,954,450,1045,410"/>
<area shape="poly" title=" " alt="" coords="1122,406,1133,409,1231,427,1308,437,1386,444,1486,457,1509,461,1508,466,1485,462,1386,449,1308,442,1230,433,1132,414,1121,412"/>
<area shape="poly" title=" " alt="" coords="1042,412,1031,414,938,431,863,439,788,447,691,462,691,457,787,442,863,434,937,426,1030,409,1041,406"/>
<area shape="poly" title=" " alt="" coords="1042,412,1031,414,778,442,450,472,449,467,777,437,1030,409,1041,407"/>
<area shape="poly" title=" " alt="" coords="1042,411,1032,414,833,461,832,456,1030,409,1041,406"/>
<area shape="rect" title=" " alt="" coords="1204,460,1284,493"/>
<area shape="poly" title=" " alt="" coords="1116,410,1199,450,1196,455,1113,415"/>
<area shape="rect" title=" " alt="" coords="993,460,1181,493"/>
<area shape="poly" title=" " alt="" coords="1085,412,1087,444,1082,444,1080,412"/>
<area shape="poly" title=" " alt="" coords="783,164,642,181,490,208,419,225,357,246,309,271,277,298,271,320,273,352,280,385,292,410,311,432,334,449,330,454,307,436,287,413,275,386,267,352,265,319,273,295,306,266,355,241,418,220,489,202,642,175,782,158"/>
<area shape="poly" title=" " alt="" coords="928,165,983,203,980,208,925,169"/>
</map>
</div>
</div>
<p><a href="../../d8/ddc/trace_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:d1/dd5/structtracee" id="r_d1/dd5/structtracee"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#d1/dd5/structtracee">tracee</a></td></tr>
<tr class="separator:d1/dd5/structtracee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d8/def/structsyscall" id="r_d8/def/structsyscall"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#d8/def/structsyscall">syscall</a></td></tr>
<tr class="separator:d8/def/structsyscall"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a369266c24eacffb87046522897a570d5" id="r_a369266c24eacffb87046522897a570d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a369266c24eacffb87046522897a570d5">_GNU_SOURCE</a></td></tr>
<tr class="separator:a369266c24eacffb87046522897a570d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacb3d7f5a6fd8aa90aff3f06fb3b6b62" id="r_aacb3d7f5a6fd8aa90aff3f06fb3b6b62"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aacb3d7f5a6fd8aa90aff3f06fb3b6b62">PTRACE_EVENT_STOP</a>&#160;&#160;&#160;128</td></tr>
<tr class="separator:aacb3d7f5a6fd8aa90aff3f06fb3b6b62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a654df7969d864c02c935acc5fd21b684" id="r_a654df7969d864c02c935acc5fd21b684"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a654df7969d864c02c935acc5fd21b684">PTRACE_EVENT_SECCOMP</a>&#160;&#160;&#160;7</td></tr>
<tr class="separator:a654df7969d864c02c935acc5fd21b684"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b5044bfb6ae66731853bd55b26ae32b" id="r_a3b5044bfb6ae66731853bd55b26ae32b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3b5044bfb6ae66731853bd55b26ae32b">_offsetof</a>(a,  <a class="el" href="../../d1/ddb/jshn_8c.html#a8f565d46decc2d5d8ac81923ceec43fd">b</a>)</td></tr>
<tr class="separator:a3b5044bfb6ae66731853bd55b26ae32b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c7c6a69f690fc8d2abf0e385280a532" id="r_a3c7c6a69f690fc8d2abf0e385280a532"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3c7c6a69f690fc8d2abf0e385280a532">ARRAY_SIZE</a>(arr)</td></tr>
<tr class="separator:a3c7c6a69f690fc8d2abf0e385280a532"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a1a6b6fb557d8d37d59700faf4e4c9167" id="r_a1a6b6fb557d8d37d59700faf4e4c9167"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1a6b6fb557d8d37d59700faf4e4c9167">mode</a> { <a class="el" href="#a1a6b6fb557d8d37d59700faf4e4c9167a02db5102db3837f19ac287142187ee39">UTRACE</a>
, <a class="el" href="#a1a6b6fb557d8d37d59700faf4e4c9167a66191239920cdb8872936c632b2a7a1b">SECCOMP_TRACE</a>
 }</td></tr>
<tr class="separator:a1a6b6fb557d8d37d59700faf4e4c9167"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad8faffdf0a5671f78363c8f9385df835" id="r_ad8faffdf0a5671f78363c8f9385df835"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad8faffdf0a5671f78363c8f9385df835">set_syscall</a> (const char *name, int val)</td></tr>
<tr class="separator:ad8faffdf0a5671f78363c8f9385df835"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48abf8a63c2b4db8f0b6986e149755f9" id="r_a48abf8a63c2b4db8f0b6986e149755f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a48abf8a63c2b4db8f0b6986e149755f9">cmp_count</a> (const void *a, const void *<a class="el" href="../../d1/ddb/jshn_8c.html#a8f565d46decc2d5d8ac81923ceec43fd">b</a>)</td></tr>
<tr class="separator:a48abf8a63c2b4db8f0b6986e149755f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a477196cba57cf20817595f49a4da4177" id="r_a477196cba57cf20817595f49a4da4177"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a477196cba57cf20817595f49a4da4177">print_syscalls</a> (int policy, const char *<a class="el" href="#ab9fe5820ba8505faef30e8a07c86ae87">json</a>)</td></tr>
<tr class="separator:a477196cba57cf20817595f49a4da4177"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36c7f7226dc2fdf6c44dd4ded35fd485" id="r_a36c7f7226dc2fdf6c44dd4ded35fd485"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a36c7f7226dc2fdf6c44dd4ded35fd485">report_seccomp_vialation</a> (pid_t pid, unsigned <a class="el" href="#d8/def/structsyscall">syscall</a>)</td></tr>
<tr class="separator:a36c7f7226dc2fdf6c44dd4ded35fd485"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af723cecaad03597fd09ecf1fb0d04829" id="r_af723cecaad03597fd09ecf1fb0d04829"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af723cecaad03597fd09ecf1fb0d04829">tracer_cb</a> (struct <a class="el" href="../../dc/d56/uloop_8h.html#da/d43/structuloop__process">uloop_process</a> *c, int ret)</td></tr>
<tr class="separator:af723cecaad03597fd09ecf1fb0d04829"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45659e3b4b13b6182b3488b65445d1b1" id="r_a45659e3b4b13b6182b3488b65445d1b1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a45659e3b4b13b6182b3488b65445d1b1">sigterm_handler</a> (int signum)</td></tr>
<tr class="separator:a45659e3b4b13b6182b3488b65445d1b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a647f21a28344e1d9c643f4115516d7c9" id="r_a647f21a28344e1d9c643f4115516d7c9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a647f21a28344e1d9c643f4115516d7c9">main</a> (int argc, char **argv, char **envp)</td></tr>
<tr class="separator:a647f21a28344e1d9c643f4115516d7c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad28882416bed9eb87abd2834f1eec8cd" id="r_ad28882416bed9eb87abd2834f1eec8cd"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="#a1a6b6fb557d8d37d59700faf4e4c9167">mode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad28882416bed9eb87abd2834f1eec8cd">mode</a> = <a class="el" href="#a1a6b6fb557d8d37d59700faf4e4c9167a02db5102db3837f19ac287142187ee39">UTRACE</a></td></tr>
<tr class="separator:ad28882416bed9eb87abd2834f1eec8cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add93701af89df3429ca1e3f9e6b5efd7" id="r_add93701af89df3429ca1e3f9e6b5efd7"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="#d1/dd5/structtracee">tracee</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#add93701af89df3429ca1e3f9e6b5efd7">tracer</a></td></tr>
<tr class="separator:add93701af89df3429ca1e3f9e6b5efd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18886d554d9242ea748cff51b0dbfadc" id="r_a18886d554d9242ea748cff51b0dbfadc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a18886d554d9242ea748cff51b0dbfadc">syscall_count</a> [SYSCALL_COUNT]</td></tr>
<tr class="separator:a18886d554d9242ea748cff51b0dbfadc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11da24fcc3ac9ca2386d8f695b21900b" id="r_a11da24fcc3ac9ca2386d8f695b21900b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a11da24fcc3ac9ca2386d8f695b21900b">violation_count</a></td></tr>
<tr class="separator:a11da24fcc3ac9ca2386d8f695b21900b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f565d46decc2d5d8ac81923ceec43fd" id="r_a8f565d46decc2d5d8ac81923ceec43fd"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d8/d3c/blob_8h.html#d3/dcb/structblob__buf">blob_buf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8f565d46decc2d5d8ac81923ceec43fd">b</a></td></tr>
<tr class="separator:a8f565d46decc2d5d8ac81923ceec43fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3e1795766a80ec63b157951b4b9a7d4" id="r_ac3e1795766a80ec63b157951b4b9a7d4"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac3e1795766a80ec63b157951b4b9a7d4">debug</a></td></tr>
<tr class="separator:ac3e1795766a80ec63b157951b4b9a7d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9fe5820ba8505faef30e8a07c86ae87" id="r_ab9fe5820ba8505faef30e8a07c86ae87"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab9fe5820ba8505faef30e8a07c86ae87">json</a> = NULL</td></tr>
<tr class="separator:ab9fe5820ba8505faef30e8a07c86ae87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fc2f6b584bec6a0a6840dfef0ee5bec" id="r_a2fc2f6b584bec6a0a6840dfef0ee5bec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2fc2f6b584bec6a0a6840dfef0ee5bec">ptrace_restart</a></td></tr>
<tr class="separator:a2fc2f6b584bec6a0a6840dfef0ee5bec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<hr/><h2 class="groupheader">Class Documentation</h2>
<a name="d1/dd5/structtracee" id="d1/dd5/structtracee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#d1/dd5/structtracee">&#9670;&#160;</a></span>tracee</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct tracee</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00080">80</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>
</div><div class="dynheader">
Collaboration diagram for tracee:</div>
<div class="dyncontent">
<div class="center"><img src="../../d4/d82/structtracee__coll__graph.png" border="0" usemap="#atracee_coll__map" alt="Collaboration graph"/></div>
<map name="atracee_coll__map" id="atracee_coll__map">
<area shape="rect" title=" " alt="" coords="283,227,362,261"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#da/d43/structuloop__process" title=" " alt="" coords="158,122,311,156"/>
<area shape="poly" title=" " alt="" coords="260,166,310,225,306,228,256,170"/>
<area shape="poly" title=" " alt="" coords="327,130,337,139,329,148,311,151,310,146,327,143,332,139,324,135"/>
<area shape="rect" href="../../da/d23/list_8h.html#d9/d93/structlist__head" title=" " alt="" coords="5,12,109,45"/>
<area shape="poly" title=" " alt="" coords="97,51,209,120,207,124,94,56"/>
<area shape="poly" title=" " alt="" coords="125,18,132,22,135,29,127,38,109,42,108,37,125,34,130,28,128,25,123,22"/>
<area shape="rect" title=" " alt="" coords="204,12,265,45"/>
<area shape="poly" title=" " alt="" coords="237,61,237,122,232,122,232,61"/>
<area shape="rect" title=" " alt="" coords="315,12,381,45"/>
<area shape="poly" title=" " alt="" coords="342,61,334,81,320,100,304,114,285,124,283,119,301,109,316,97,329,79,338,59"/>
<area shape="rect" title=" " alt="" coords="386,122,432,156"/>
<area shape="poly" title=" " alt="" coords="388,170,338,228,334,225,384,166"/>
</map>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Class Members</th></tr>
<tr><td class="fieldtype">
<a id="abaaf57a3c2a0198b8056764c428d4eb0" name="abaaf57a3c2a0198b8056764c428d4eb0"></a>int</td>
<td class="fieldname">
in_syscall</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a6a9fd5feae6009e2ffaec4c55f6a3537" name="a6a9fd5feae6009e2ffaec4c55f6a3537"></a>struct <a class="el" href="../../dc/d56/uloop_8h.html#da/d43/structuloop__process">uloop_process</a></td>
<td class="fieldname">
proc</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="d8/def/structsyscall" id="d8/def/structsyscall"></a>
<h2 class="memtitle"><span class="permalink"><a href="#d8/def/structsyscall">&#9670;&#160;</a></span>syscall</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct syscall</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00106">106</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>
</div><div class="dynheader">
Collaboration diagram for syscall:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/ddf/structsyscall__coll__graph.png" border="0" usemap="#asyscall_coll__map" alt="Collaboration graph"/></div>
<map name="asyscall_coll__map" id="asyscall_coll__map">
<area shape="rect" title=" " alt="" coords="5,133,89,167"/>
<area shape="rect" title=" " alt="" coords="24,5,70,39"/>
<area shape="poly" title=" " alt="" coords="50,54,50,132,44,132,44,54"/>
</map>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Class Members</th></tr>
<tr><td class="fieldtype">
<a id="a043b36efc93c76e988b1e670e162e2eb" name="a043b36efc93c76e988b1e670e162e2eb"></a>int</td>
<td class="fieldname">
count</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a356ea72b80f1b78145f586f8dce93591" name="a356ea72b80f1b78145f586f8dce93591"></a>int</td>
<td class="fieldname">
syscall</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a369266c24eacffb87046522897a570d5" name="a369266c24eacffb87046522897a570d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a369266c24eacffb87046522897a570d5">&#9670;&#160;</a></span>_GNU_SOURCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _GNU_SOURCE</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00014">14</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>

</div>
</div>
<a id="a3b5044bfb6ae66731853bd55b26ae32b" name="a3b5044bfb6ae66731853bd55b26ae32b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b5044bfb6ae66731853bd55b26ae32b">&#9670;&#160;</a></span>_offsetof</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _offsetof</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em><a class="el" href="../../d1/ddb/jshn_8c.html#a8f565d46decc2d5d8ac81923ceec43fd">b</a></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">__builtin_offsetof(a,<a class="code hl_variable" href="#a8f565d46decc2d5d8ac81923ceec43fd">b</a>)</div>
<div class="ttc" id="atrace_8c_html_a8f565d46decc2d5d8ac81923ceec43fd"><div class="ttname"><a href="#a8f565d46decc2d5d8ac81923ceec43fd">b</a></div><div class="ttdeci">static struct blob_buf b</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00088">trace.c:88</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00048">48</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>

</div>
</div>
<a id="a3c7c6a69f690fc8d2abf0e385280a532" name="a3c7c6a69f690fc8d2abf0e385280a532"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c7c6a69f690fc8d2abf0e385280a532">&#9670;&#160;</a></span>ARRAY_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ARRAY_SIZE</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>arr</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(<span class="keyword">sizeof</span>(arr) / <span class="keyword">sizeof</span>((arr)[0]))</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00049">49</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>

</div>
</div>
<a id="a654df7969d864c02c935acc5fd21b684" name="a654df7969d864c02c935acc5fd21b684"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a654df7969d864c02c935acc5fd21b684">&#9670;&#160;</a></span>PTRACE_EVENT_SECCOMP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PTRACE_EVENT_SECCOMP&#160;&#160;&#160;7</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00038">38</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/ddc/trace_8c_source.html#l00218">tracer_cb()</a>.</p>

</div>
</div>
<a id="aacb3d7f5a6fd8aa90aff3f06fb3b6b62" name="aacb3d7f5a6fd8aa90aff3f06fb3b6b62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacb3d7f5a6fd8aa90aff3f06fb3b6b62">&#9670;&#160;</a></span>PTRACE_EVENT_STOP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PTRACE_EVENT_STOP&#160;&#160;&#160;128</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00033">33</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/ddc/trace_8c_source.html#l00218">tracer_cb()</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a1a6b6fb557d8d37d59700faf4e4c9167" name="a1a6b6fb557d8d37d59700faf4e4c9167"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a6b6fb557d8d37d59700faf4e4c9167">&#9670;&#160;</a></span>mode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#a1a6b6fb557d8d37d59700faf4e4c9167">mode</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a1a6b6fb557d8d37d59700faf4e4c9167a02db5102db3837f19ac287142187ee39" name="a1a6b6fb557d8d37d59700faf4e4c9167a02db5102db3837f19ac287142187ee39"></a>UTRACE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a1a6b6fb557d8d37d59700faf4e4c9167a66191239920cdb8872936c632b2a7a1b" name="a1a6b6fb557d8d37d59700faf4e4c9167a66191239920cdb8872936c632b2a7a1b"></a>SECCOMP_TRACE&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00075">75</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   75</span>          {</div>
<div class="line"><span class="lineno">   76</span>    <a class="code hl_enumvalue" href="#a1a6b6fb557d8d37d59700faf4e4c9167a02db5102db3837f19ac287142187ee39">UTRACE</a>,</div>
<div class="line"><span class="lineno">   77</span>    <a class="code hl_enumvalue" href="#a1a6b6fb557d8d37d59700faf4e4c9167a66191239920cdb8872936c632b2a7a1b">SECCOMP_TRACE</a>,</div>
<div class="line"><span class="lineno">   78</span>} <a class="code hl_enumeration" href="#a1a6b6fb557d8d37d59700faf4e4c9167">mode</a> = <a class="code hl_enumvalue" href="#a1a6b6fb557d8d37d59700faf4e4c9167a02db5102db3837f19ac287142187ee39">UTRACE</a>;</div>
<div class="ttc" id="atrace_8c_html_a1a6b6fb557d8d37d59700faf4e4c9167"><div class="ttname"><a href="#a1a6b6fb557d8d37d59700faf4e4c9167">mode</a></div><div class="ttdeci">mode</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00075">trace.c:75</a></div></div>
<div class="ttc" id="atrace_8c_html_a1a6b6fb557d8d37d59700faf4e4c9167a02db5102db3837f19ac287142187ee39"><div class="ttname"><a href="#a1a6b6fb557d8d37d59700faf4e4c9167a02db5102db3837f19ac287142187ee39">UTRACE</a></div><div class="ttdeci">@ UTRACE</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00076">trace.c:76</a></div></div>
<div class="ttc" id="atrace_8c_html_a1a6b6fb557d8d37d59700faf4e4c9167a66191239920cdb8872936c632b2a7a1b"><div class="ttname"><a href="#a1a6b6fb557d8d37d59700faf4e4c9167a66191239920cdb8872936c632b2a7a1b">SECCOMP_TRACE</a></div><div class="ttdeci">@ SECCOMP_TRACE</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00077">trace.c:77</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a48abf8a63c2b4db8f0b6986e149755f9" name="a48abf8a63c2b4db8f0b6986e149755f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48abf8a63c2b4db8f0b6986e149755f9">&#9670;&#160;</a></span>cmp_count()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cmp_count </td>
          <td>(</td>
          <td class="paramtype">const void *</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00111">111</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  112</span>{</div>
<div class="line"><span class="lineno">  113</span>    <span class="keywordflow">return</span> ((<span class="keyword">struct</span> <a class="code hl_struct" href="#d8/def/structsyscall">syscall</a>*)<a class="code hl_variable" href="#a8f565d46decc2d5d8ac81923ceec43fd">b</a>)-&gt;count - ((<span class="keyword">struct </span><a class="code hl_struct" href="#d8/def/structsyscall">syscall</a>*)a)-&gt;<a class="code hl_variable" href="#a043b36efc93c76e988b1e670e162e2eb">count</a>;</div>
<div class="line"><span class="lineno">  114</span>}</div>
<div class="ttc" id="atrace_8c_html_a043b36efc93c76e988b1e670e162e2eb"><div class="ttname"><a href="#a043b36efc93c76e988b1e670e162e2eb">syscall::count</a></div><div class="ttdeci">int count</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00108">trace.c:108</a></div></div>
<div class="ttc" id="atrace_8c_html_d8/def/structsyscall"><div class="ttname"><a href="#d8/def/structsyscall">syscall</a></div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00106">trace.c:106</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/ddc/trace_8c_source.html#l00088">b</a>, and <a class="el" href="../../d8/ddc/trace_8c_source.html#l00108">syscall::count</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/ddc/trace_8c_source.html#l00116">print_syscalls()</a>.</p>

</div>
</div>
<a id="a647f21a28344e1d9c643f4115516d7c9" name="a647f21a28344e1d9c643f4115516d7c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a647f21a28344e1d9c643f4115516d7c9">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>argc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>envp</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00308">308</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  309</span>{</div>
<div class="line"><span class="lineno">  310</span>    <span class="keywordtype">int</span> status, ch, policy = EPERM;</div>
<div class="line"><span class="lineno">  311</span>    pid_t child;</div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>    <span class="comment">/* When invoked via seccomp-trace symlink, work as seccomp</span></div>
<div class="line"><span class="lineno">  314</span><span class="comment">     * violation logger rather than as syscall tracer */</span></div>
<div class="line"><span class="lineno">  315</span>    <span class="keywordflow">if</span> (strstr(argv[0], <span class="stringliteral">&quot;seccomp-trace&quot;</span>))</div>
<div class="line"><span class="lineno">  316</span>        <a class="code hl_enumeration" href="#a1a6b6fb557d8d37d59700faf4e4c9167">mode</a> = <a class="code hl_enumvalue" href="#a1a6b6fb557d8d37d59700faf4e4c9167a66191239920cdb8872936c632b2a7a1b">SECCOMP_TRACE</a>;</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>    <span class="keywordflow">while</span> ((ch = getopt(argc, argv, <span class="stringliteral">&quot;f:p:&quot;</span>)) != -1) {</div>
<div class="line"><span class="lineno">  319</span>        <span class="keywordflow">switch</span> (ch) {</div>
<div class="line"><span class="lineno">  320</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>:</div>
<div class="line"><span class="lineno">  321</span>            <a class="code hl_variable" href="#ab9fe5820ba8505faef30e8a07c86ae87">json</a> = optarg;</div>
<div class="line"><span class="lineno">  322</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  323</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>:</div>
<div class="line"><span class="lineno">  324</span>            policy = atoi(optarg);</div>
<div class="line"><span class="lineno">  325</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  326</span>        }</div>
<div class="line"><span class="lineno">  327</span>    }</div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab9fe5820ba8505faef30e8a07c86ae87">json</a>)</div>
<div class="line"><span class="lineno">  330</span>        <a class="code hl_variable" href="#ab9fe5820ba8505faef30e8a07c86ae87">json</a> = getenv(<span class="stringliteral">&quot;SECCOMP_FILE&quot;</span>);</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span>    argc -= optind;</div>
<div class="line"><span class="lineno">  333</span>    argv += optind;</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>    <span class="keywordflow">if</span> (!argc)</div>
<div class="line"><span class="lineno">  336</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span>    <span class="keywordflow">if</span> (getenv(<span class="stringliteral">&quot;TRACE_DEBUG&quot;</span>))</div>
<div class="line"><span class="lineno">  339</span>        <a class="code hl_variable" href="#ac3e1795766a80ec63b157951b4b9a7d4">debug</a> = 1;</div>
<div class="line"><span class="lineno">  340</span>    unsetenv(<span class="stringliteral">&quot;TRACE_DEBUG&quot;</span>);</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>    child = fork();</div>
<div class="line"><span class="lineno">  343</span> </div>
<div class="line"><span class="lineno">  344</span>    <span class="keywordflow">if</span> (child == 0) {</div>
<div class="line"><span class="lineno">  345</span>        <span class="keywordtype">char</span> **_argv = calloc(argc + 1, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span> *));</div>
<div class="line"><span class="lineno">  346</span>        <span class="keywordtype">char</span> **_envp;</div>
<div class="line"><span class="lineno">  347</span>        <span class="keywordtype">char</span> *preload = NULL;</div>
<div class="line"><span class="lineno">  348</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *old_preload = getenv(<span class="stringliteral">&quot;LD_PRELOAD&quot;</span>);</div>
<div class="line"><span class="lineno">  349</span>        <span class="keywordtype">int</span> newenv = 0;</div>
<div class="line"><span class="lineno">  350</span>        <span class="keywordtype">int</span> envc = 0;</div>
<div class="line"><span class="lineno">  351</span>        <span class="keywordtype">int</span> ret;</div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span>        memcpy(_argv, argv, argc * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span> *));</div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>        <span class="keywordflow">while</span> (envp[envc++])</div>
<div class="line"><span class="lineno">  356</span>            ;</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>        _envp = calloc(envc + 2, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span> *));</div>
<div class="line"><span class="lineno">  359</span>        <span class="keywordflow">switch</span> (<a class="code hl_enumeration" href="#a1a6b6fb557d8d37d59700faf4e4c9167">mode</a>) {</div>
<div class="line"><span class="lineno">  360</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a1a6b6fb557d8d37d59700faf4e4c9167a02db5102db3837f19ac287142187ee39">UTRACE</a>:</div>
<div class="line"><span class="lineno">  361</span>            preload = <span class="stringliteral">&quot;/lib/libpreload-trace.so&quot;</span>;</div>
<div class="line"><span class="lineno">  362</span>            newenv = 1;</div>
<div class="line"><span class="lineno">  363</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  364</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a1a6b6fb557d8d37d59700faf4e4c9167a66191239920cdb8872936c632b2a7a1b">SECCOMP_TRACE</a>:</div>
<div class="line"><span class="lineno">  365</span>            preload = <span class="stringliteral">&quot;/lib/libpreload-seccomp.so&quot;</span>;</div>
<div class="line"><span class="lineno">  366</span>            newenv = 2;</div>
<div class="line"><span class="lineno">  367</span>            <span class="keywordflow">if</span> (asprintf(&amp;_envp[1], <span class="stringliteral">&quot;SECCOMP_FILE=%s&quot;</span>, <a class="code hl_variable" href="#ab9fe5820ba8505faef30e8a07c86ae87">json</a> ? <a class="code hl_variable" href="#ab9fe5820ba8505faef30e8a07c86ae87">json</a> : <span class="stringliteral">&quot;&quot;</span>) &lt; 0)</div>
<div class="line"><span class="lineno">  368</span>                <a class="code hl_define" href="../../df/df3/ulog_8h.html#ac15751a1b0b4f336453b64c070c8a981">ULOG_ERR</a>(<span class="stringliteral">&quot;failed to allocate SECCOMP_FILE env: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>            kill(getpid(), SIGSTOP);</div>
<div class="line"><span class="lineno">  371</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  372</span>        }</div>
<div class="line"><span class="lineno">  373</span>        <span class="keywordflow">if</span> (asprintf(&amp;_envp[0], <span class="stringliteral">&quot;LD_PRELOAD=%s%s%s&quot;</span>, preload,</div>
<div class="line"><span class="lineno">  374</span>                 old_preload ? <span class="stringliteral">&quot;:&quot;</span> : <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno">  375</span>                  old_preload ? old_preload : <span class="stringliteral">&quot;&quot;</span>) &lt; 0)</div>
<div class="line"><span class="lineno">  376</span>            <a class="code hl_define" href="../../df/df3/ulog_8h.html#ac15751a1b0b4f336453b64c070c8a981">ULOG_ERR</a>(<span class="stringliteral">&quot;failed to allocate LD_PRELOAD env: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>        memcpy(&amp;_envp[newenv], envp, envc * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span> *));</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>        ret = execve(_argv[0], _argv, _envp);</div>
<div class="line"><span class="lineno">  381</span>        <a class="code hl_define" href="../../df/df3/ulog_8h.html#ac15751a1b0b4f336453b64c070c8a981">ULOG_ERR</a>(<span class="stringliteral">&quot;failed to exec %s: %m\n&quot;</span>, _argv[0]);</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>        free(_argv);</div>
<div class="line"><span class="lineno">  384</span>        <span class="keywordflow">if</span> (_envp[0])</div>
<div class="line"><span class="lineno">  385</span>            free(_envp[0]);</div>
<div class="line"><span class="lineno">  386</span>        <span class="keywordflow">if</span> (newenv == 2 &amp;&amp; _envp[1])</div>
<div class="line"><span class="lineno">  387</span>            free(_envp[1]);</div>
<div class="line"><span class="lineno">  388</span>        free(_envp);</div>
<div class="line"><span class="lineno">  389</span>        <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno">  390</span>    }</div>
<div class="line"><span class="lineno">  391</span> </div>
<div class="line"><span class="lineno">  392</span>    <span class="keywordflow">if</span> (child &lt; 0)</div>
<div class="line"><span class="lineno">  393</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>    waitpid(child, &amp;status, WUNTRACED);</div>
<div class="line"><span class="lineno">  396</span>    <span class="keywordflow">if</span> (!WIFSTOPPED(status)) {</div>
<div class="line"><span class="lineno">  397</span>        <a class="code hl_define" href="../../df/df3/ulog_8h.html#ac15751a1b0b4f336453b64c070c8a981">ULOG_ERR</a>(<span class="stringliteral">&quot;failed to start %s\n&quot;</span>, *argv);</div>
<div class="line"><span class="lineno">  398</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  399</span>    }</div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>    <span class="comment">/* Initialize uloop to catch all ptrace stops from now on. */</span></div>
<div class="line"><span class="lineno">  402</span>    <a class="code hl_function" href="../../d1/d08/uloop_8c.html#ae960d01033fb72572bc1aa539a501fe7">uloop_init</a>();</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>    <span class="keywordtype">int</span> ptrace_options = PTRACE_O_TRACEFORK | PTRACE_O_TRACEVFORK | PTRACE_O_TRACECLONE;</div>
<div class="line"><span class="lineno">  405</span>    <span class="keywordflow">switch</span> (<a class="code hl_enumeration" href="#a1a6b6fb557d8d37d59700faf4e4c9167">mode</a>) {</div>
<div class="line"><span class="lineno">  406</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a1a6b6fb557d8d37d59700faf4e4c9167a02db5102db3837f19ac287142187ee39">UTRACE</a>:</div>
<div class="line"><span class="lineno">  407</span>        ptrace_options |= PTRACE_O_TRACESYSGOOD;</div>
<div class="line"><span class="lineno">  408</span>        <a class="code hl_variable" href="#a2fc2f6b584bec6a0a6840dfef0ee5bec">ptrace_restart</a> = PTRACE_SYSCALL;</div>
<div class="line"><span class="lineno">  409</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  410</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a1a6b6fb557d8d37d59700faf4e4c9167a66191239920cdb8872936c632b2a7a1b">SECCOMP_TRACE</a>:</div>
<div class="line"><span class="lineno">  411</span>        ptrace_options |= PTRACE_O_TRACESECCOMP;</div>
<div class="line"><span class="lineno">  412</span>        <a class="code hl_variable" href="#a2fc2f6b584bec6a0a6840dfef0ee5bec">ptrace_restart</a> = PTRACE_CONT;</div>
<div class="line"><span class="lineno">  413</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  414</span>    }</div>
<div class="line"><span class="lineno">  415</span>    <span class="keywordflow">if</span> (ptrace(PTRACE_SEIZE, child, 0, ptrace_options) == -1) {</div>
<div class="line"><span class="lineno">  416</span>        <a class="code hl_define" href="../../df/df3/ulog_8h.html#ac15751a1b0b4f336453b64c070c8a981">ULOG_ERR</a>(<span class="stringliteral">&quot;PTRACE_SEIZE: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno">  417</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  418</span>    }</div>
<div class="line"><span class="lineno">  419</span>    <span class="keywordflow">if</span> (ptrace(<a class="code hl_variable" href="#a2fc2f6b584bec6a0a6840dfef0ee5bec">ptrace_restart</a>, child, 0, SIGCONT) == -1) {</div>
<div class="line"><span class="lineno">  420</span>        <a class="code hl_define" href="../../df/df3/ulog_8h.html#ac15751a1b0b4f336453b64c070c8a981">ULOG_ERR</a>(<span class="stringliteral">&quot;ptrace_restart: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno">  421</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  422</span>    }</div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span>    <a class="code hl_variable" href="#add93701af89df3429ca1e3f9e6b5efd7">tracer</a>.<a class="code hl_variable" href="#a6a9fd5feae6009e2ffaec4c55f6a3537">proc</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a> = child;</div>
<div class="line"><span class="lineno">  425</span>    <a class="code hl_variable" href="#add93701af89df3429ca1e3f9e6b5efd7">tracer</a>.<a class="code hl_variable" href="#a6a9fd5feae6009e2ffaec4c55f6a3537">proc</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a46406fa271016311e9876c440d30897f">cb</a> = <a class="code hl_function" href="#af723cecaad03597fd09ecf1fb0d04829">tracer_cb</a>;</div>
<div class="line"><span class="lineno">  426</span>    <a class="code hl_function" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb">uloop_process_add</a>(&amp;<a class="code hl_variable" href="#add93701af89df3429ca1e3f9e6b5efd7">tracer</a>.<a class="code hl_variable" href="#a6a9fd5feae6009e2ffaec4c55f6a3537">proc</a>);</div>
<div class="line"><span class="lineno">  427</span>    signal(SIGTERM, <a class="code hl_function" href="#a45659e3b4b13b6182b3488b65445d1b1">sigterm_handler</a>); <span class="comment">/* Override uloop&#39;s SIGTERM handler */</span></div>
<div class="line"><span class="lineno">  428</span>    <a class="code hl_function" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077">uloop_run</a>();</div>
<div class="line"><span class="lineno">  429</span>    <a class="code hl_function" href="../../d1/d08/uloop_8c.html#ac0bcdd57d004a600844745bd38e83a2d">uloop_done</a>();</div>
<div class="line"><span class="lineno">  430</span> </div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>    <span class="keywordflow">switch</span> (<a class="code hl_enumeration" href="#a1a6b6fb557d8d37d59700faf4e4c9167">mode</a>) {</div>
<div class="line"><span class="lineno">  433</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a1a6b6fb557d8d37d59700faf4e4c9167a02db5102db3837f19ac287142187ee39">UTRACE</a>:</div>
<div class="line"><span class="lineno">  434</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab9fe5820ba8505faef30e8a07c86ae87">json</a>)</div>
<div class="line"><span class="lineno">  435</span>            <span class="keywordflow">if</span> (asprintf(&amp;<a class="code hl_variable" href="#ab9fe5820ba8505faef30e8a07c86ae87">json</a>, <span class="stringliteral">&quot;/tmp/%s.%u.json&quot;</span>, basename(*argv), child) &lt; 0)</div>
<div class="line"><span class="lineno">  436</span>                <a class="code hl_define" href="../../df/df3/ulog_8h.html#ac15751a1b0b4f336453b64c070c8a981">ULOG_ERR</a>(<span class="stringliteral">&quot;failed to allocate output path: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno">  437</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  438</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a1a6b6fb557d8d37d59700faf4e4c9167a66191239920cdb8872936c632b2a7a1b">SECCOMP_TRACE</a>:</div>
<div class="line"><span class="lineno">  439</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#a11da24fcc3ac9ca2386d8f695b21900b">violation_count</a>)</div>
<div class="line"><span class="lineno">  440</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  441</span>        <span class="keywordflow">if</span> (asprintf(&amp;<a class="code hl_variable" href="#ab9fe5820ba8505faef30e8a07c86ae87">json</a>, <span class="stringliteral">&quot;/tmp/%s.%u.violations.json&quot;</span>, basename(*argv), child) &lt; 0)</div>
<div class="line"><span class="lineno">  442</span>            <a class="code hl_define" href="../../df/df3/ulog_8h.html#ac15751a1b0b4f336453b64c070c8a981">ULOG_ERR</a>(<span class="stringliteral">&quot;failed to allocate violations output path: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno">  443</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  444</span>    }</div>
<div class="line"><span class="lineno">  445</span>    <a class="code hl_function" href="#a477196cba57cf20817595f49a4da4177">print_syscalls</a>(policy, <a class="code hl_variable" href="#ab9fe5820ba8505faef30e8a07c86ae87">json</a>);</div>
<div class="line"><span class="lineno">  446</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  447</span>}</div>
<div class="ttc" id="atrace_8c_html_a11da24fcc3ac9ca2386d8f695b21900b"><div class="ttname"><a href="#a11da24fcc3ac9ca2386d8f695b21900b">violation_count</a></div><div class="ttdeci">static int violation_count</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00087">trace.c:87</a></div></div>
<div class="ttc" id="atrace_8c_html_a2fc2f6b584bec6a0a6840dfef0ee5bec"><div class="ttname"><a href="#a2fc2f6b584bec6a0a6840dfef0ee5bec">ptrace_restart</a></div><div class="ttdeci">int ptrace_restart</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00091">trace.c:91</a></div></div>
<div class="ttc" id="atrace_8c_html_a45659e3b4b13b6182b3488b65445d1b1"><div class="ttname"><a href="#a45659e3b4b13b6182b3488b65445d1b1">sigterm_handler</a></div><div class="ttdeci">static void sigterm_handler(int signum)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00299">trace.c:299</a></div></div>
<div class="ttc" id="atrace_8c_html_a477196cba57cf20817595f49a4da4177"><div class="ttname"><a href="#a477196cba57cf20817595f49a4da4177">print_syscalls</a></div><div class="ttdeci">static void print_syscalls(int policy, const char *json)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00116">trace.c:116</a></div></div>
<div class="ttc" id="atrace_8c_html_a6a9fd5feae6009e2ffaec4c55f6a3537"><div class="ttname"><a href="#a6a9fd5feae6009e2ffaec4c55f6a3537">tracee::proc</a></div><div class="ttdeci">struct uloop_process proc</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00081">trace.c:81</a></div></div>
<div class="ttc" id="atrace_8c_html_ab9fe5820ba8505faef30e8a07c86ae87"><div class="ttname"><a href="#ab9fe5820ba8505faef30e8a07c86ae87">json</a></div><div class="ttdeci">char * json</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00090">trace.c:90</a></div></div>
<div class="ttc" id="atrace_8c_html_ac3e1795766a80ec63b157951b4b9a7d4"><div class="ttname"><a href="#ac3e1795766a80ec63b157951b4b9a7d4">debug</a></div><div class="ttdeci">static int debug</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00089">trace.c:89</a></div></div>
<div class="ttc" id="atrace_8c_html_add93701af89df3429ca1e3f9e6b5efd7"><div class="ttname"><a href="#add93701af89df3429ca1e3f9e6b5efd7">tracer</a></div><div class="ttdeci">static struct tracee tracer</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00085">trace.c:85</a></div></div>
<div class="ttc" id="atrace_8c_html_af723cecaad03597fd09ecf1fb0d04829"><div class="ttname"><a href="#af723cecaad03597fd09ecf1fb0d04829">tracer_cb</a></div><div class="ttdeci">static void tracer_cb(struct uloop_process *c, int ret)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00218">trace.c:218</a></div></div>
<div class="ttc" id="aulog_8h_html_ac15751a1b0b4f336453b64c070c8a981"><div class="ttname"><a href="../../df/df3/ulog_8h.html#ac15751a1b0b4f336453b64c070c8a981">ULOG_ERR</a></div><div class="ttdeci">#define ULOG_ERR(fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="../../df/df3/ulog_8h_source.html#l00044">ulog.h:44</a></div></div>
<div class="ttc" id="auloop_8c_html_ac0bcdd57d004a600844745bd38e83a2d"><div class="ttname"><a href="../../d1/d08/uloop_8c.html#ac0bcdd57d004a600844745bd38e83a2d">uloop_done</a></div><div class="ttdeci">void uloop_done(void)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d08/uloop_8c_source.html#l00686">uloop.c:686</a></div></div>
<div class="ttc" id="auloop_8c_html_ae960d01033fb72572bc1aa539a501fe7"><div class="ttname"><a href="../../d1/d08/uloop_8c.html#ae960d01033fb72572bc1aa539a501fe7">uloop_init</a></div><div class="ttdeci">int uloop_init(void)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d08/uloop_8c_source.html#l00150">uloop.c:150</a></div></div>
<div class="ttc" id="auloop_8c_html_af511d1bcbdfcfaba211d4ae1b0930dbb"><div class="ttname"><a href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb">uloop_process_add</a></div><div class="ttdeci">int uloop_process_add(struct uloop_process *p)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d08/uloop_8c_source.html#l00391">uloop.c:391</a></div></div>
<div class="ttc" id="auloop_8h_html_a41e26562918b24966ac2e0d7906fb1b8"><div class="ttname"><a href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">uloop_process::pid</a></div><div class="ttdeci">pid_t pid</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d56/uloop_8h_source.html#l00087">uloop.h:87</a></div></div>
<div class="ttc" id="auloop_8h_html_a46406fa271016311e9876c440d30897f"><div class="ttname"><a href="../../dc/d56/uloop_8h.html#a46406fa271016311e9876c440d30897f">uloop_process::cb</a></div><div class="ttdeci">uloop_process_handler cb</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d56/uloop_8h_source.html#l00086">uloop.h:86</a></div></div>
<div class="ttc" id="auloop_8h_html_aba97081464ac3304fef640bcfc7d3077"><div class="ttname"><a href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077">uloop_run</a></div><div class="ttdeci">static int uloop_run(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d56/uloop_8h_source.html#l00147">uloop.h:147</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d56/uloop_8h_source.html#l00086">uloop_process::cb</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00089">debug</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00090">json</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00087">uloop_process::pid</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00116">print_syscalls()</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00081">tracee::proc</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00091">ptrace_restart</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00077">SECCOMP_TRACE</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00299">sigterm_handler()</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00085">tracer</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00218">tracer_cb()</a>, <a class="el" href="../../df/df3/ulog_8h_source.html#l00044">ULOG_ERR</a>, <a class="el" href="../../d1/d08/uloop_8c_source.html#l00686">uloop_done()</a>, <a class="el" href="../../d1/d08/uloop_8c_source.html#l00150">uloop_init()</a>, <a class="el" href="../../d1/d08/uloop_8c_source.html#l00391">uloop_process_add()</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00147">uloop_run()</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00076">UTRACE</a>, and <a class="el" href="../../d8/ddc/trace_8c_source.html#l00087">violation_count</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d8/ddc/trace_8c_a647f21a28344e1d9c643f4115516d7c9_cgraph.png" border="0" usemap="#ad8/ddc/trace_8c_a647f21a28344e1d9c643f4115516d7c9_cgraph" alt=""/></div>
<map name="ad8/ddc/trace_8c_a647f21a28344e1d9c643f4115516d7c9_cgraph" id="ad8/ddc/trace_8c_a647f21a28344e1d9c643f4115516d7c9_cgraph">
<area shape="rect" title=" " alt="" coords="5,777,73,811"/>
<area shape="rect" href="../../d8/ddc/trace_8c.html#a477196cba57cf20817595f49a4da4177" title=" " alt="" coords="133,373,280,407"/>
<area shape="poly" title=" " alt="" coords="45,776,190,420,195,422,50,778"/>
<area shape="rect" href="../../d8/ddc/trace_8c.html#a45659e3b4b13b6182b3488b65445d1b1" title=" " alt="" coords="121,641,292,675"/>
<area shape="poly" title=" " alt="" coords="47,776,75,730,95,705,119,684,124,681,127,685,122,688,99,709,79,733,51,778"/>
<area shape="rect" href="../../d8/ddc/trace_8c.html#af723cecaad03597fd09ecf1fb0d04829" title=" " alt="" coords="153,723,260,756"/>
<area shape="poly" title=" " alt="" coords="72,781,137,759,139,764,74,786"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb" title=" " alt="" coords="370,775,566,808"/>
<area shape="poly" title=" " alt="" coords="73,791,354,790,354,795,73,797"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ac0bcdd57d004a600844745bd38e83a2d" title=" " alt="" coords="404,832,531,866"/>
<area shape="poly" title=" " alt="" coords="73,796,389,836,388,841,73,801"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae960d01033fb72572bc1aa539a501fe7" title=" " alt="" coords="151,887,262,920"/>
<area shape="poly" title=" " alt="" coords="58,809,87,837,122,864,146,877,143,882,119,868,83,841,54,813"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077" title=" " alt="" coords="150,1000,263,1034"/>
<area shape="poly" title=" " alt="" coords="51,810,80,866,123,931,176,988,172,991,119,934,75,868,46,813"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#af8ca2237342df92c699fbb2ddb5f390b" title=" " alt="" coords="398,63,537,96"/>
<area shape="poly" title=" " alt="" coords="208,372,219,320,243,247,260,208,281,171,307,136,338,105,359,93,382,84,384,89,361,97,342,110,311,139,286,173,265,211,248,249,224,321,213,374"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a4bba0979961750f86b8dc9915b2fa4d6" title=" " alt="" coords="364,120,572,154"/>
<area shape="poly" title=" " alt="" coords="210,372,225,329,251,272,288,213,312,186,338,163,348,156,351,161,342,167,315,190,292,216,255,274,230,331,215,374"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a56794b194617d9a858dbc783dd2a0c32" title=" " alt="" coords="361,177,575,211"/>
<area shape="poly" title=" " alt="" coords="214,372,232,339,259,298,295,255,338,220,345,216,348,220,342,224,299,259,264,301,236,342,218,374"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a3252218dfc4cb4c8b54772196e8c2a14" title=" " alt="" coords="362,235,574,268"/>
<area shape="poly" title=" " alt="" coords="222,371,271,325,303,300,339,278,355,271,357,276,341,283,306,304,274,329,225,375"/>
<area shape="rect" href="../../d5/dea/blobmsg__json_8h.html#a23cb7f433dba5a13adc055ff21e259b2" title=" " alt="" coords="359,293,577,349"/>
<area shape="poly" title=" " alt="" coords="272,370,343,351,344,356,274,375"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a938ceeed1d840f9df7946262f1835214" title=" " alt="" coords="361,373,574,407"/>
<area shape="poly" title=" " alt="" coords="280,388,345,388,345,393,280,393"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a2de3b7599bec41a8c9919f780bd28f1a" title=" " alt="" coords="362,431,573,464"/>
<area shape="poly" title=" " alt="" coords="281,404,373,424,372,429,279,409"/>
<area shape="rect" href="../../d8/ddc/trace_8c.html#a48abf8a63c2b4db8f0b6986e149755f9" title=" " alt="" coords="407,488,529,522"/>
<area shape="poly" title=" " alt="" coords="230,405,279,441,341,474,392,490,391,495,339,479,276,445,227,410"/>
<area shape="rect" href="../../d8/ddc/trace_8c.html#ad8faffdf0a5671f78363c8f9385df835" title=" " alt="" coords="408,545,528,579"/>
<area shape="poly" title=" " alt="" coords="221,406,268,469,302,503,341,532,366,543,393,551,391,556,364,548,339,536,298,507,264,472,216,409"/>
<area shape="rect" href="../../d8/ddc/trace_8c.html#a356ea72b80f1b78145f586f8dce93591" title=" " alt="" coords="389,603,546,636"/>
<area shape="poly" title=" " alt="" coords="216,406,232,445,259,495,295,546,317,570,341,589,376,606,373,610,339,594,314,573,291,550,254,498,228,447,211,408"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#af8de35ec0673663c45f2aad7c876d329" title=" " alt="" coords="705,5,810,39"/>
<area shape="poly" title=" " alt="" coords="537,63,689,33,690,38,538,68"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6f17715cbf1ce82b0981a452537b4dc6" title=" " alt="" coords="667,63,848,96"/>
<area shape="poly" title=" " alt="" coords="538,77,652,77,652,82,538,82"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5bf37ab2b48095b7fb16ac11449b08f6" title=" " alt="" coords="660,120,855,154"/>
<area shape="poly" title=" " alt="" coords="572,134,645,134,645,140,572,140"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#aa980250f4a411659367b8bffaf5d6118" title=" " alt="" coords="680,207,835,240"/>
<area shape="poly" title=" " alt="" coords="575,202,665,212,665,217,575,208"/>
<area shape="poly" title=" " alt="" coords="574,239,665,230,665,235,575,244"/>
<area shape="rect" href="../../d5/d7f/blobmsg__json_8c.html#a20cac5fc41d47c810e63e4a5fb68638c" title=" " alt="" coords="648,293,867,349"/>
<area shape="poly" title=" " alt="" coords="577,318,633,318,633,324,577,324"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#aaac450f6a679be8a392d17c3ed8700b4" title=" " alt="" coords="643,403,872,436"/>
<area shape="poly" title=" " alt="" coords="575,398,628,404,628,409,574,404"/>
<area shape="poly" title=" " alt="" coords="574,435,628,429,628,435,574,440"/>
<area shape="poly" title=" " alt="" coords="176,723,172,713,177,704,188,698,206,696,226,699,237,705,234,710,224,704,206,701,190,703,181,708,178,714,181,721"/>
<area shape="rect" href="../../d8/ddc/trace_8c.html#a36c7f7226dc2fdf6c44dd4ded35fd485" title=" " alt="" coords="340,660,595,694"/>
<area shape="poly" title=" " alt="" coords="260,723,339,702,370,695,371,700,341,707,261,728"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#a5881608c3589830842d1db287f1f896e" title=" " alt="" coords="410,717,526,751"/>
<area shape="poly" title=" " alt="" coords="261,736,394,733,394,738,261,741"/>
<area shape="poly" title=" " alt="" coords="261,748,365,768,364,774,260,753"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="693,689,822,723"/>
<area shape="poly" title=" " alt="" coords="563,772,594,761,618,747,642,732,677,720,679,725,644,737,621,751,596,766,565,777"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a13ca20f7af9aa4aa3057b1114e23e7f1" title=" " alt="" coords="644,747,871,780"/>
<area shape="poly" title=" " alt="" coords="531,837,594,818,618,804,642,789,658,783,660,788,645,794,621,809,596,823,533,842"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#afe30e87975d460220899f69103f90d0d" title=" " alt="" coords="649,804,866,838"/>
<area shape="poly" title=" " alt="" coords="531,840,634,830,634,835,532,845"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="674,861,841,895"/>
<area shape="poly" title=" " alt="" coords="532,853,659,866,659,871,531,858"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a28e87c6264a681dc2a422d32794416c5" title=" " alt="" coords="654,919,861,952"/>
<area shape="poly" title=" " alt="" coords="533,862,596,882,644,905,664,911,662,916,642,910,594,887,531,867"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a49ba044023de765e2d9d14db25d1845b" title=" " alt="" coords="921,747,1139,780"/>
<area shape="poly" title=" " alt="" coords="872,761,905,761,905,766,872,766"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="920,804,1140,838"/>
<area shape="poly" title=" " alt="" coords="866,818,904,818,904,824,866,824"/>
<area shape="poly" title=" " alt="" coords="261,889,388,863,389,868,262,895"/>
<area shape="poly" title=" " alt="" coords="262,904,638,926,638,931,262,909"/>
<area shape="rect" href="../../d3/d91/uloop-epoll_8c.html#a5b8f7c4e758eaf7384d7dafa9cd59502" title=" " alt="" coords="382,941,553,975"/>
<area shape="poly" title=" " alt="" coords="262,912,369,935,368,940,261,918"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae9d27835a99bfac45ed3f07a26287d7a" title=" " alt="" coords="411,999,525,1032"/>
<area shape="poly" title=" " alt="" coords="231,919,280,953,341,985,397,1002,395,1007,339,990,277,957,228,923"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a14d4e1fa83f245cd59f0c68f48c90d75" title=" " alt="" coords="371,1056,564,1090"/>
<area shape="poly" title=" " alt="" coords="264,1026,372,1050,371,1055,263,1031"/>
</map>
</div>

</div>
</div>
<a id="a477196cba57cf20817595f49a4da4177" name="a477196cba57cf20817595f49a4da4177"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a477196cba57cf20817595f49a4da4177">&#9670;&#160;</a></span>print_syscalls()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void print_syscalls </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>policy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>json</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00116">116</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  117</span>{</div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordtype">void</span> *c, *d, *e;</div>
<div class="line"><span class="lineno">  119</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  120</span>    <span class="keywordtype">char</span> *tmp;</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>    <span class="keywordflow">if</span> (<a class="code hl_enumeration" href="#a1a6b6fb557d8d37d59700faf4e4c9167">mode</a> == <a class="code hl_enumvalue" href="#a1a6b6fb557d8d37d59700faf4e4c9167a02db5102db3837f19ac287142187ee39">UTRACE</a>) {</div>
<div class="line"><span class="lineno">  123</span>        <a class="code hl_function" href="#ad8faffdf0a5671f78363c8f9385df835">set_syscall</a>(<span class="stringliteral">&quot;rt_sigaction&quot;</span>, 1);</div>
<div class="line"><span class="lineno">  124</span>        <a class="code hl_function" href="#ad8faffdf0a5671f78363c8f9385df835">set_syscall</a>(<span class="stringliteral">&quot;sigreturn&quot;</span>, 1);</div>
<div class="line"><span class="lineno">  125</span>        <a class="code hl_function" href="#ad8faffdf0a5671f78363c8f9385df835">set_syscall</a>(<span class="stringliteral">&quot;rt_sigreturn&quot;</span>, 1);</div>
<div class="line"><span class="lineno">  126</span>        <a class="code hl_function" href="#ad8faffdf0a5671f78363c8f9385df835">set_syscall</a>(<span class="stringliteral">&quot;exit_group&quot;</span>, 1);</div>
<div class="line"><span class="lineno">  127</span>        <a class="code hl_function" href="#ad8faffdf0a5671f78363c8f9385df835">set_syscall</a>(<span class="stringliteral">&quot;exit&quot;</span>, 1);</div>
<div class="line"><span class="lineno">  128</span>    }</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>    <span class="keyword">struct </span><a class="code hl_struct" href="#d8/def/structsyscall">syscall</a> sorted[SYSCALL_COUNT];</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordflow">for</span> (i = 0; i &lt; SYSCALL_COUNT; i++) {</div>
<div class="line"><span class="lineno">  133</span>        sorted[i].syscall = syscall_index_to_number(i);</div>
<div class="line"><span class="lineno">  134</span>        sorted[i].count = <a class="code hl_variable" href="#a18886d554d9242ea748cff51b0dbfadc">syscall_count</a>[i];</div>
<div class="line"><span class="lineno">  135</span>    }</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>    qsort(sorted, SYSCALL_COUNT, <span class="keyword">sizeof</span>(sorted[0]), <a class="code hl_function" href="#a48abf8a63c2b4db8f0b6986e149755f9">cmp_count</a>);</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>    <a class="code hl_function" href="../../d4/da0/blob_8c.html#af8ca2237342df92c699fbb2ddb5f390b">blob_buf_init</a>(&amp;<a class="code hl_variable" href="#a8f565d46decc2d5d8ac81923ceec43fd">b</a>, 0);</div>
<div class="line"><span class="lineno">  140</span>    <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a4bba0979961750f86b8dc9915b2fa4d6">blobmsg_add_string</a>(&amp;<a class="code hl_variable" href="#a8f565d46decc2d5d8ac81923ceec43fd">b</a>, <span class="stringliteral">&quot;defaultAction&quot;</span>, <span class="stringliteral">&quot;SCMP_ACT_KILL_PROCESS&quot;</span>);</div>
<div class="line"><span class="lineno">  141</span>    c = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a938ceeed1d840f9df7946262f1835214">blobmsg_open_array</a>(&amp;<a class="code hl_variable" href="#a8f565d46decc2d5d8ac81923ceec43fd">b</a>, <span class="stringliteral">&quot;syscalls&quot;</span>);</div>
<div class="line"><span class="lineno">  142</span>    d = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a2de3b7599bec41a8c9919f780bd28f1a">blobmsg_open_table</a>(&amp;<a class="code hl_variable" href="#a8f565d46decc2d5d8ac81923ceec43fd">b</a>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  143</span>    e = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a938ceeed1d840f9df7946262f1835214">blobmsg_open_array</a>(&amp;<a class="code hl_variable" href="#a8f565d46decc2d5d8ac81923ceec43fd">b</a>, <span class="stringliteral">&quot;names&quot;</span>);</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>    <span class="keywordflow">for</span> (i = 0; i &lt; SYSCALL_COUNT; i++) {</div>
<div class="line"><span class="lineno">  146</span>        <span class="keywordtype">int</span> sc = sorted[i].syscall;</div>
<div class="line"><span class="lineno">  147</span>        <span class="keywordflow">if</span> (!sorted[i].<a class="code hl_variable" href="#a043b36efc93c76e988b1e670e162e2eb">count</a>)</div>
<div class="line"><span class="lineno">  148</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  149</span>        <span class="keywordflow">if</span> (syscall_name(sc)) {</div>
<div class="line"><span class="lineno">  150</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><span class="lineno">  151</span>                printf(<span class="stringliteral">&quot;syscall %d (%s) was called %d times\n&quot;</span>,</div>
<div class="line"><span class="lineno">  152</span>                       sc, syscall_name(sc), sorted[i].<a class="code hl_variable" href="#a043b36efc93c76e988b1e670e162e2eb">count</a>);</div>
<div class="line"><span class="lineno">  153</span>            <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a4bba0979961750f86b8dc9915b2fa4d6">blobmsg_add_string</a>(&amp;<a class="code hl_variable" href="#a8f565d46decc2d5d8ac81923ceec43fd">b</a>, NULL, syscall_name(sc));</div>
<div class="line"><span class="lineno">  154</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  155</span>            <a class="code hl_define" href="../../df/df3/ulog_8h.html#ac15751a1b0b4f336453b64c070c8a981">ULOG_ERR</a>(<span class="stringliteral">&quot;no name found for syscall(%d)\n&quot;</span>, sc);</div>
<div class="line"><span class="lineno">  156</span>        }</div>
<div class="line"><span class="lineno">  157</span>    }</div>
<div class="line"><span class="lineno">  158</span>    <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a56794b194617d9a858dbc783dd2a0c32">blobmsg_close_array</a>(&amp;<a class="code hl_variable" href="#a8f565d46decc2d5d8ac81923ceec43fd">b</a>, e);</div>
<div class="line"><span class="lineno">  159</span>    <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a4bba0979961750f86b8dc9915b2fa4d6">blobmsg_add_string</a>(&amp;<a class="code hl_variable" href="#a8f565d46decc2d5d8ac81923ceec43fd">b</a>, <span class="stringliteral">&quot;action&quot;</span>, <span class="stringliteral">&quot;SCMP_ACT_ALLOW&quot;</span>);</div>
<div class="line"><span class="lineno">  160</span>    <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a3252218dfc4cb4c8b54772196e8c2a14">blobmsg_close_table</a>(&amp;<a class="code hl_variable" href="#a8f565d46decc2d5d8ac81923ceec43fd">b</a>, d);</div>
<div class="line"><span class="lineno">  161</span>    <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a56794b194617d9a858dbc783dd2a0c32">blobmsg_close_array</a>(&amp;<a class="code hl_variable" href="#a8f565d46decc2d5d8ac81923ceec43fd">b</a>, c);</div>
<div class="line"><span class="lineno">  162</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab9fe5820ba8505faef30e8a07c86ae87">json</a>) {</div>
<div class="line"><span class="lineno">  163</span>        FILE *fp = fopen(<a class="code hl_variable" href="#ab9fe5820ba8505faef30e8a07c86ae87">json</a>, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><span class="lineno">  164</span>        <span class="keywordflow">if</span> (fp) {</div>
<div class="line"><span class="lineno">  165</span>            tmp = <a class="code hl_function" href="../../d5/dea/blobmsg__json_8h.html#a23cb7f433dba5a13adc055ff21e259b2">blobmsg_format_json_indent</a>(<a class="code hl_variable" href="#a8f565d46decc2d5d8ac81923ceec43fd">b</a>.<a class="code hl_variable" href="../../d8/d3c/blob_8h.html#af6065d74116605108b22c11e75ec669c">head</a>, <span class="keyword">true</span>, 0);</div>
<div class="line"><span class="lineno">  166</span>            <span class="keywordflow">if</span> (!tmp) {</div>
<div class="line"><span class="lineno">  167</span>                fclose(fp);</div>
<div class="line"><span class="lineno">  168</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  169</span>            }</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>            fprintf(fp, <span class="stringliteral">&quot;%s\n&quot;</span>, tmp);</div>
<div class="line"><span class="lineno">  172</span>            free(tmp);</div>
<div class="line"><span class="lineno">  173</span>            fclose(fp);</div>
<div class="line"><span class="lineno">  174</span>            <a class="code hl_define" href="../../df/df3/ulog_8h.html#a3b7e6bcea896368cf58a503b31198c5e">ULOG_INFO</a>(<span class="stringliteral">&quot;saving syscall trace to %s\n&quot;</span>, <a class="code hl_variable" href="#ab9fe5820ba8505faef30e8a07c86ae87">json</a>);</div>
<div class="line"><span class="lineno">  175</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  176</span>            <a class="code hl_define" href="../../df/df3/ulog_8h.html#ac15751a1b0b4f336453b64c070c8a981">ULOG_ERR</a>(<span class="stringliteral">&quot;failed to open %s\n&quot;</span>, <a class="code hl_variable" href="#ab9fe5820ba8505faef30e8a07c86ae87">json</a>);</div>
<div class="line"><span class="lineno">  177</span>        }</div>
<div class="line"><span class="lineno">  178</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  179</span>        tmp = <a class="code hl_function" href="../../d5/dea/blobmsg__json_8h.html#a23cb7f433dba5a13adc055ff21e259b2">blobmsg_format_json_indent</a>(<a class="code hl_variable" href="#a8f565d46decc2d5d8ac81923ceec43fd">b</a>.<a class="code hl_variable" href="../../d8/d3c/blob_8h.html#af6065d74116605108b22c11e75ec669c">head</a>, <span class="keyword">true</span>, 0);</div>
<div class="line"><span class="lineno">  180</span>        <span class="keywordflow">if</span> (!tmp)</div>
<div class="line"><span class="lineno">  181</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>        printf(<span class="stringliteral">&quot;%s\n&quot;</span>, tmp);</div>
<div class="line"><span class="lineno">  184</span>        free(tmp);</div>
<div class="line"><span class="lineno">  185</span>    }</div>
<div class="line"><span class="lineno">  186</span>}</div>
<div class="ttc" id="ablob_8c_html_af8ca2237342df92c699fbb2ddb5f390b"><div class="ttname"><a href="../../d4/da0/blob_8c.html#af8ca2237342df92c699fbb2ddb5f390b">blob_buf_init</a></div><div class="ttdeci">int blob_buf_init(struct blob_buf *buf, int id)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/da0/blob_8c_source.html#l00091">blob.c:91</a></div></div>
<div class="ttc" id="ablob_8h_html_af6065d74116605108b22c11e75ec669c"><div class="ttname"><a href="../../d8/d3c/blob_8h.html#af6065d74116605108b22c11e75ec669c">blob_buf::head</a></div><div class="ttdeci">struct blob_attr * head</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d3c/blob_8h_source.html#l00065">blob.h:65</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a2de3b7599bec41a8c9919f780bd28f1a"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a2de3b7599bec41a8c9919f780bd28f1a">blobmsg_open_table</a></div><div class="ttdeci">static void * blobmsg_open_table(struct blob_buf *buf, const char *name)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00256">blobmsg.h:256</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a3252218dfc4cb4c8b54772196e8c2a14"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a3252218dfc4cb4c8b54772196e8c2a14">blobmsg_close_table</a></div><div class="ttdeci">static void blobmsg_close_table(struct blob_buf *buf, void *cookie)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00268">blobmsg.h:268</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a4bba0979961750f86b8dc9915b2fa4d6"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a4bba0979961750f86b8dc9915b2fa4d6">blobmsg_add_string</a></div><div class="ttdeci">static int blobmsg_add_string(struct blob_buf *buf, const char *name, const char *string)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00235">blobmsg.h:235</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a56794b194617d9a858dbc783dd2a0c32"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a56794b194617d9a858dbc783dd2a0c32">blobmsg_close_array</a></div><div class="ttdeci">static void blobmsg_close_array(struct blob_buf *buf, void *cookie)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00262">blobmsg.h:262</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a938ceeed1d840f9df7946262f1835214"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a938ceeed1d840f9df7946262f1835214">blobmsg_open_array</a></div><div class="ttdeci">static void * blobmsg_open_array(struct blob_buf *buf, const char *name)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00250">blobmsg.h:250</a></div></div>
<div class="ttc" id="ablobmsg__json_8h_html_a23cb7f433dba5a13adc055ff21e259b2"><div class="ttname"><a href="../../d5/dea/blobmsg__json_8h.html#a23cb7f433dba5a13adc055ff21e259b2">blobmsg_format_json_indent</a></div><div class="ttdeci">static char * blobmsg_format_json_indent(struct blob_attr *attr, bool list, int indent)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/dea/blobmsg__json_8h_source.html#l00040">blobmsg_json.h:40</a></div></div>
<div class="ttc" id="atrace_8c_html_a18886d554d9242ea748cff51b0dbfadc"><div class="ttname"><a href="#a18886d554d9242ea748cff51b0dbfadc">syscall_count</a></div><div class="ttdeci">static int syscall_count[SYSCALL_COUNT]</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00086">trace.c:86</a></div></div>
<div class="ttc" id="atrace_8c_html_a48abf8a63c2b4db8f0b6986e149755f9"><div class="ttname"><a href="#a48abf8a63c2b4db8f0b6986e149755f9">cmp_count</a></div><div class="ttdeci">static int cmp_count(const void *a, const void *b)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00111">trace.c:111</a></div></div>
<div class="ttc" id="atrace_8c_html_ad8faffdf0a5671f78363c8f9385df835"><div class="ttname"><a href="#ad8faffdf0a5671f78363c8f9385df835">set_syscall</a></div><div class="ttdeci">static void set_syscall(const char *name, int val)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00093">trace.c:93</a></div></div>
<div class="ttc" id="aulog_8h_html_a3b7e6bcea896368cf58a503b31198c5e"><div class="ttname"><a href="../../df/df3/ulog_8h.html#a3b7e6bcea896368cf58a503b31198c5e">ULOG_INFO</a></div><div class="ttdeci">#define ULOG_INFO(fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="../../df/df3/ulog_8h_source.html#l00041">ulog.h:41</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/ddc/trace_8c_source.html#l00088">b</a>, <a class="el" href="../../d4/da0/blob_8c_source.html#l00091">blob_buf_init()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00235">blobmsg_add_string()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00262">blobmsg_close_array()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00268">blobmsg_close_table()</a>, <a class="el" href="../../d5/dea/blobmsg__json_8h_source.html#l00040">blobmsg_format_json_indent()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00250">blobmsg_open_array()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00256">blobmsg_open_table()</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00111">cmp_count()</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00108">syscall::count</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00089">debug</a>, <a class="el" href="../../d8/d3c/blob_8h_source.html#l00065">blob_buf::head</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00090">json</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00093">set_syscall()</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00107">syscall::syscall</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00086">syscall_count</a>, <a class="el" href="../../df/df3/ulog_8h_source.html#l00044">ULOG_ERR</a>, <a class="el" href="../../df/df3/ulog_8h_source.html#l00041">ULOG_INFO</a>, and <a class="el" href="../../d8/ddc/trace_8c_source.html#l00076">UTRACE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/ddc/trace_8c_source.html#l00308">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d8/ddc/trace_8c_a477196cba57cf20817595f49a4da4177_cgraph.png" border="0" usemap="#ad8/ddc/trace_8c_a477196cba57cf20817595f49a4da4177_cgraph" alt=""/></div>
<map name="ad8/ddc/trace_8c_a477196cba57cf20817595f49a4da4177_cgraph" id="ad8/ddc/trace_8c_a477196cba57cf20817595f49a4da4177_cgraph">
<area shape="rect" title=" " alt="" coords="5,427,152,461"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#af8ca2237342df92c699fbb2ddb5f390b" title=" " alt="" coords="239,163,379,197"/>
<area shape="poly" title=" " alt="" coords="83,426,98,387,122,336,156,281,198,231,219,215,243,201,245,206,222,219,202,235,160,284,127,339,103,389,88,428"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a4bba0979961750f86b8dc9915b2fa4d6" title=" " alt="" coords="471,454,679,487"/>
<area shape="poly" title=" " alt="" coords="152,445,456,462,456,467,152,450"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a56794b194617d9a858dbc783dd2a0c32" title=" " alt="" coords="468,232,682,266"/>
<area shape="poly" title=" " alt="" coords="85,425,102,395,126,357,159,320,198,290,260,263,326,247,391,239,452,237,453,243,392,245,326,252,262,268,201,294,162,324,131,360,106,398,90,428"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a3252218dfc4cb4c8b54772196e8c2a14" title=" " alt="" coords="469,290,681,323"/>
<area shape="poly" title=" " alt="" coords="89,425,133,374,163,348,199,327,262,306,328,294,393,290,454,291,454,296,393,295,328,300,263,311,201,332,167,352,136,378,93,429"/>
<area shape="rect" href="../../d5/dea/blobmsg__json_8h.html#a23cb7f433dba5a13adc055ff21e259b2" title=" " alt="" coords="200,508,418,564"/>
<area shape="poly" title=" " alt="" coords="124,459,223,499,221,504,122,464"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a938ceeed1d840f9df7946262f1835214" title=" " alt="" coords="202,342,416,375"/>
<area shape="poly" title=" " alt="" coords="111,424,199,384,217,378,219,383,201,389,113,429"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a2de3b7599bec41a8c9919f780bd28f1a" title=" " alt="" coords="203,399,415,433"/>
<area shape="poly" title=" " alt="" coords="152,432,187,428,188,433,152,438"/>
<area shape="rect" href="../../d8/ddc/trace_8c.html#a48abf8a63c2b4db8f0b6986e149755f9" title=" " alt="" coords="248,588,370,622"/>
<area shape="poly" title=" " alt="" coords="93,460,136,516,166,547,201,574,234,588,232,593,198,578,163,551,132,520,89,463"/>
<area shape="rect" href="../../d8/ddc/trace_8c.html#ad8faffdf0a5671f78363c8f9385df835" title=" " alt="" coords="249,646,369,679"/>
<area shape="poly" title=" " alt="" coords="88,460,103,497,127,543,159,592,179,614,201,632,235,649,233,654,198,637,175,617,155,595,122,546,98,499,83,462"/>
<area shape="rect" href="../../d8/ddc/trace_8c.html#a356ea72b80f1b78145f586f8dce93591" title=" " alt="" coords="230,703,388,737"/>
<area shape="poly" title=" " alt="" coords="86,460,97,506,118,569,153,634,175,664,201,690,217,700,214,705,198,694,171,668,148,637,114,571,92,508,80,461"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#af8de35ec0673663c45f2aad7c876d329" title=" " alt="" coords="523,99,628,133"/>
<area shape="poly" title=" " alt="" coords="378,161,507,129,508,135,380,166"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6f17715cbf1ce82b0981a452537b4dc6" title=" " alt="" coords="485,163,665,197"/>
<area shape="poly" title=" " alt="" coords="379,177,469,177,469,183,379,183"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a99c424ce706ada40920b2f57259e223b" title=" " alt="" coords="1092,12,1234,46"/>
<area shape="poly" title=" " alt="" coords="597,96,655,57,692,38,732,24,823,8,915,3,1002,6,1077,13,1076,18,1002,11,915,8,823,13,733,29,694,43,658,62,600,101"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#ab4e3964334a7aec029ab29a2c724f248" title=" " alt="" coords="782,39,938,73"/>
<area shape="poly" title=" " alt="" coords="628,102,767,73,768,78,629,108"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a686c428a3ab7c421820e049ab2384d47" title=" " alt="" coords="1092,99,1234,133"/>
<area shape="poly" title=" " alt="" coords="629,124,733,140,860,147,987,140,1076,129,1077,134,988,145,860,152,732,145,628,130"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#abe9f6013aad507ac84630ee773b806b6" title=" " alt="" coords="792,206,928,239"/>
<area shape="poly" title=" " alt="" coords="629,126,686,148,710,167,734,184,778,202,776,207,731,189,707,171,683,153,627,131"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a4fb5423718fbcc165ed995360ab3ea96" title=" " alt="" coords="810,96,910,130"/>
<area shape="poly" title=" " alt="" coords="628,113,795,111,795,117,628,118"/>
<area shape="poly" title=" " alt="" coords="938,46,1076,34,1077,39,938,52"/>
<area shape="poly" title=" " alt="" coords="939,69,1077,96,1076,102,938,74"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a3071b18c2bb742e04d7622379ee8fd3b" title=" " alt="" coords="1092,208,1234,242"/>
<area shape="poly" title=" " alt="" coords="929,221,1076,222,1076,227,929,226"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a2c4753820a7472bba7b999fbba79df01" title=" " alt="" coords="1343,208,1484,242"/>
<area shape="poly" title=" " alt="" coords="928,207,1035,193,1163,185,1219,186,1290,193,1338,202,1337,207,1290,199,1219,192,1163,190,1036,199,929,213"/>
<area shape="poly" title=" " alt="" coords="1235,223,1328,223,1328,228,1235,228"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a9921d2b89577d3344abbb66f24773e32" title=" " alt="" coords="1579,362,1677,395"/>
<area shape="poly" title=" " alt="" coords="1457,240,1491,259,1551,305,1601,349,1597,353,1548,309,1488,263,1454,245"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5bf37ab2b48095b7fb16ac11449b08f6" title=" " alt="" coords="763,454,957,487"/>
<area shape="poly" title=" " alt="" coords="680,468,747,468,747,473,680,473"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#aed178aa087a351c74f7f6cd34e56ba0c" title=" " alt="" coords="1089,563,1237,597"/>
<area shape="poly" title=" " alt="" coords="910,485,1100,555,1099,560,908,490"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="1572,667,1684,701"/>
<area shape="poly" title=" " alt="" coords="1238,593,1490,649,1558,665,1557,670,1489,655,1237,598"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="1338,722,1489,755"/>
<area shape="poly" title=" " alt="" coords="1238,586,1265,594,1292,606,1333,646,1389,708,1385,712,1329,650,1288,610,1264,599,1237,591"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ac239a83ed3c7f835e2b49f785953c934" title=" " alt="" coords="1543,566,1713,599"/>
<area shape="poly" title=" " alt="" coords="1237,578,1527,579,1527,585,1237,583"/>
<area shape="poly" title=" " alt="" coords="1482,719,1556,699,1558,705,1483,724"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="1537,780,1719,814"/>
<area shape="poly" title=" " alt="" coords="1479,753,1550,773,1549,778,1477,759"/>
<area shape="poly" title=" " alt="" coords="1437,719,1590,607,1593,611,1440,723"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#aa980250f4a411659367b8bffaf5d6118" title=" " alt="" coords="783,263,937,297"/>
<area shape="poly" title=" " alt="" coords="683,258,768,267,767,273,682,263"/>
<area shape="poly" title=" " alt="" coords="937,269,963,261,986,250,1002,237,1011,224,1020,210,1034,194,1074,164,1114,138,1117,143,1077,168,1037,198,1024,213,1015,227,1005,241,989,254,965,266,939,274"/>
<area shape="poly" title=" " alt="" coords="937,263,1076,238,1077,243,938,269"/>
<area shape="poly" title=" " alt="" coords="938,278,1100,285,1196,292,1290,303,1439,329,1565,359,1563,364,1438,335,1290,308,1195,297,1100,290,937,284"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a189526712fcc12adfb6ea6a5c8eede54" title=" " alt="" coords="1074,318,1252,351"/>
<area shape="poly" title=" " alt="" coords="938,291,1059,313,1058,318,937,296"/>
<area shape="poly" title=" " alt="" coords="682,294,767,286,767,291,682,299"/>
<area shape="rect" href="../../d5/d7f/blobmsg__json_8c.html#a20cac5fc41d47c810e63e4a5fb68638c" title=" " alt="" coords="466,664,684,720"/>
<area shape="poly" title=" " alt="" coords="397,562,419,574,479,611,531,651,528,656,476,616,417,578,394,567"/>
<area shape="poly" title=" " alt="" coords="685,691,960,700,1125,708,1290,720,1322,723,1322,729,1290,725,1125,713,960,705,685,696"/>
<area shape="poly" title=" " alt="" coords="605,718,661,767,696,790,733,808,842,839,955,858,1070,865,1182,864,1289,856,1387,844,1542,815,1543,821,1387,849,1289,861,1182,869,1070,870,955,863,841,845,731,813,693,795,658,771,601,722"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052" title=" " alt="" coords="1069,620,1257,654"/>
<area shape="poly" title=" " alt="" coords="684,676,732,671,1053,643,1053,648,733,676,685,681"/>
<area shape="rect" href="../../d5/d7f/blobmsg__json_8c.html#a445428378f952f09725ce73c166b10bc" title=" " alt="" coords="732,730,988,763"/>
<area shape="poly" title=" " alt="" coords="685,710,754,724,753,729,684,716"/>
<area shape="rect" href="../../d5/d7f/blobmsg__json_8c.html#a4b1c22b1492528fb0ff87735ec027d55" title=" " alt="" coords="1036,780,1290,814"/>
<area shape="poly" title=" " alt="" coords="619,719,672,749,733,773,805,789,880,798,953,803,1020,803,1020,808,952,808,879,804,804,794,732,778,670,754,617,723"/>
<area shape="rect" href="../../d5/d7f/blobmsg__json_8c.html#a6d1e787102e0b5ea6231761020b810df" title=" " alt="" coords="1345,460,1483,494"/>
<area shape="poly" title=" " alt="" coords="666,660,732,640,882,591,1035,548,1191,514,1329,488,1330,494,1192,519,1036,553,884,596,733,645,668,666"/>
<area shape="poly" title=" " alt="" coords="1255,617,1289,607,1393,564,1436,540,1488,504,1549,454,1599,405,1603,409,1553,458,1491,509,1438,544,1395,569,1291,612,1256,622"/>
<area shape="poly" title=" " alt="" coords="1257,644,1557,674,1557,680,1257,649"/>
<area shape="poly" title=" " alt="" coords="1239,652,1291,671,1316,685,1339,700,1362,712,1360,717,1337,705,1313,689,1289,676,1237,657"/>
<area shape="poly" title=" " alt="" coords="988,742,1322,737,1322,743,988,747"/>
<area shape="poly" title=" " alt="" coords="908,727,1099,657,1100,662,910,732"/>
<area shape="poly" title=" " alt="" coords="922,761,1021,780,1020,785,921,767"/>
<area shape="poly" title=" " alt="" coords="1101,782,1003,764,1004,759,1102,777"/>
<area shape="poly" title=" " alt="" coords="1451,457,1574,400,1577,405,1453,462"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#aaac450f6a679be8a392d17c3ed8700b4" title=" " alt="" coords="746,375,974,409"/>
<area shape="poly" title=" " alt="" coords="416,362,730,381,730,387,416,368"/>
<area shape="poly" title=" " alt="" coords="891,372,1116,248,1118,252,894,377"/>
<area shape="poly" title=" " alt="" coords="918,407,989,439,1031,466,1070,495,1134,550,1131,554,1067,499,1028,470,986,444,915,412"/>
<area shape="poly" title=" " alt="" coords="954,407,1036,419,1136,422,1266,421,1394,425,1448,433,1490,445,1527,467,1560,495,1609,552,1605,555,1556,499,1524,472,1488,450,1447,438,1393,431,1265,426,1136,427,1035,424,953,412"/>
<area shape="poly" title=" " alt="" coords="952,372,1058,352,1059,357,953,377"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a99c424ce706ada40920b2f57259e223b" title=" " alt="" coords="1092,375,1234,409"/>
<area shape="poly" title=" " alt="" coords="975,389,1076,389,1076,395,975,395"/>
<area shape="poly" title=" " alt="" coords="415,409,730,395,731,400,415,414"/>
</map>
</div>

</div>
</div>
<a id="a36c7f7226dc2fdf6c44dd4ded35fd485" name="a36c7f7226dc2fdf6c44dd4ded35fd485"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36c7f7226dc2fdf6c44dd4ded35fd485">&#9670;&#160;</a></span>report_seccomp_vialation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void report_seccomp_vialation </td>
          <td>(</td>
          <td class="paramtype">pid_t</td>          <td class="paramname"><span class="paramname"><em>pid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned</td>          <td class="paramname"><span class="paramname"><em>syscall</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00188">188</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  189</span>{</div>
<div class="line"><span class="lineno">  190</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>[200];</div>
<div class="line"><span class="lineno">  191</span>    snprintf(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>), <span class="stringliteral">&quot;/proc/%d/cmdline&quot;</span>, pid);</div>
<div class="line"><span class="lineno">  192</span>    <span class="keywordtype">int</span> f = open(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, O_RDONLY);</div>
<div class="line"><span class="lineno">  193</span>    <span class="keywordflow">if</span> (f &lt; 0)</div>
<div class="line"><span class="lineno">  194</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="../../d1/d5c/rcS_8c.html#abf8f2f9d123823e95527a9d26ff031c8">r</a> = read(f, <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>) - 1);</div>
<div class="line"><span class="lineno">  197</span>    <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>[<span class="keyword">sizeof</span>(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>) - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d5c/rcS_8c.html#abf8f2f9d123823e95527a9d26ff031c8">r</a> &gt;= 0)</div>
<div class="line"><span class="lineno">  200</span>        <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>[<a class="code hl_variable" href="../../d1/d5c/rcS_8c.html#abf8f2f9d123823e95527a9d26ff031c8">r</a>] = 0;</div>
<div class="line"><span class="lineno">  201</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  202</span>        strcpy(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, <span class="stringliteral">&quot;unknown?&quot;</span>);</div>
<div class="line"><span class="lineno">  203</span>    close(f);</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a11da24fcc3ac9ca2386d8f695b21900b">violation_count</a> &lt; INT_MAX)</div>
<div class="line"><span class="lineno">  206</span>        <a class="code hl_variable" href="#a11da24fcc3ac9ca2386d8f695b21900b">violation_count</a>++;</div>
<div class="line"><span class="lineno">  207</span>    <span class="keywordtype">int</span> i = syscall_index(<a class="code hl_struct" href="#d8/def/structsyscall">syscall</a>);</div>
<div class="line"><span class="lineno">  208</span>    <span class="keywordflow">if</span> (i &gt;= 0) {</div>
<div class="line"><span class="lineno">  209</span>        <a class="code hl_variable" href="#a18886d554d9242ea748cff51b0dbfadc">syscall_count</a>[i]++;</div>
<div class="line"><span class="lineno">  210</span>        <a class="code hl_define" href="../../df/df3/ulog_8h.html#ac15751a1b0b4f336453b64c070c8a981">ULOG_ERR</a>(<span class="stringliteral">&quot;%s[%u] tried to call non-whitelisted syscall: %s (see %s)\n&quot;</span>,</div>
<div class="line"><span class="lineno">  211</span>             <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, pid,  syscall_name(<a class="code hl_struct" href="#d8/def/structsyscall">syscall</a>), <a class="code hl_variable" href="#ab9fe5820ba8505faef30e8a07c86ae87">json</a>);</div>
<div class="line"><span class="lineno">  212</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  213</span>        <a class="code hl_define" href="../../df/df3/ulog_8h.html#ac15751a1b0b4f336453b64c070c8a981">ULOG_ERR</a>(<span class="stringliteral">&quot;%s[%u] tried to call non-whitelisted syscall: %d (see %s)\n&quot;</span>,</div>
<div class="line"><span class="lineno">  214</span>             <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, pid,  <a class="code hl_struct" href="#d8/def/structsyscall">syscall</a>, <a class="code hl_variable" href="#ab9fe5820ba8505faef30e8a07c86ae87">json</a>);</div>
<div class="line"><span class="lineno">  215</span>    }</div>
<div class="line"><span class="lineno">  216</span>}</div>
<div class="ttc" id="amkdev_8c_html_a024e65f7d9664cdc767f51c283fd8353"><div class="ttname"><a href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a></div><div class="ttdeci">static char buf[PATH_MAX]</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d9a/mkdev_8c_source.html#l00034">mkdev.c:34</a></div></div>
<div class="ttc" id="arcS_8c_html_abf8f2f9d123823e95527a9d26ff031c8"><div class="ttname"><a href="../../d1/d5c/rcS_8c.html#abf8f2f9d123823e95527a9d26ff031c8">r</a></div><div class="ttdeci">static struct runqueue q r</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d5c/rcS_8c_source.html#l00036">rcS.c:36</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00090">json</a>, <a class="el" href="../../d1/d5c/rcS_8c_source.html#l00036">r</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00086">syscall_count</a>, <a class="el" href="../../df/df3/ulog_8h_source.html#l00044">ULOG_ERR</a>, and <a class="el" href="../../d8/ddc/trace_8c_source.html#l00087">violation_count</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/ddc/trace_8c_source.html#l00218">tracer_cb()</a>.</p>

</div>
</div>
<a id="ad8faffdf0a5671f78363c8f9385df835" name="ad8faffdf0a5671f78363c8f9385df835"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8faffdf0a5671f78363c8f9385df835">&#9670;&#160;</a></span>set_syscall()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_syscall </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>val</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00093">93</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   94</span>{</div>
<div class="line"><span class="lineno">   95</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>    <span class="keywordflow">for</span> (i = 0; i &lt; SYSCALL_COUNT; i++) {</div>
<div class="line"><span class="lineno">   98</span>        <span class="keywordtype">int</span> sc = syscall_index_to_number(i);</div>
<div class="line"><span class="lineno">   99</span>        <span class="keywordflow">if</span> (syscall_name(sc) &amp;&amp; !strcmp(syscall_name(sc), name)) {</div>
<div class="line"><span class="lineno">  100</span>            <a class="code hl_variable" href="#a18886d554d9242ea748cff51b0dbfadc">syscall_count</a>[i] = val;</div>
<div class="line"><span class="lineno">  101</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  102</span>        }</div>
<div class="line"><span class="lineno">  103</span>    }</div>
<div class="line"><span class="lineno">  104</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/ddc/trace_8c_source.html#l00086">syscall_count</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/ddc/trace_8c_source.html#l00116">print_syscalls()</a>.</p>

</div>
</div>
<a id="a45659e3b4b13b6182b3488b65445d1b1" name="a45659e3b4b13b6182b3488b65445d1b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45659e3b4b13b6182b3488b65445d1b1">&#9670;&#160;</a></span>sigterm_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sigterm_handler </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>signum</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00299">299</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  300</span>{</div>
<div class="line"><span class="lineno">  301</span>    <span class="comment">/* When we receive SIGTERM, we forward it to the tracee. After</span></div>
<div class="line"><span class="lineno">  302</span><span class="comment">     * the tracee exits, trace_cb() will be called and make us</span></div>
<div class="line"><span class="lineno">  303</span><span class="comment">     * exit too. */</span></div>
<div class="line"><span class="lineno">  304</span>    kill(<a class="code hl_variable" href="#add93701af89df3429ca1e3f9e6b5efd7">tracer</a>.<a class="code hl_variable" href="#a6a9fd5feae6009e2ffaec4c55f6a3537">proc</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, SIGTERM);</div>
<div class="line"><span class="lineno">  305</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d56/uloop_8h_source.html#l00087">uloop_process::pid</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00081">tracee::proc</a>, and <a class="el" href="../../d8/ddc/trace_8c_source.html#l00085">tracer</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/ddc/trace_8c_source.html#l00308">main()</a>.</p>

</div>
</div>
<a id="af723cecaad03597fd09ecf1fb0d04829" name="af723cecaad03597fd09ecf1fb0d04829"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af723cecaad03597fd09ecf1fb0d04829">&#9670;&#160;</a></span>tracer_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tracer_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dc/d56/uloop_8h.html#da/d43/structuloop__process">uloop_process</a> *</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ret</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00218">218</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  219</span>{</div>
<div class="line"><span class="lineno">  220</span>    <span class="keyword">struct </span><a class="code hl_struct" href="#d1/dd5/structtracee">tracee</a> *<a class="code hl_struct" href="#d1/dd5/structtracee">tracee</a> = <a class="code hl_define" href="../../da/d23/list_8h.html#af8c317a42292b61c93aae91e59118a46">container_of</a>(c, <span class="keyword">struct</span> <a class="code hl_struct" href="#d1/dd5/structtracee">tracee</a>, <a class="code hl_variable" href="#a6a9fd5feae6009e2ffaec4c55f6a3537">proc</a>);</div>
<div class="line"><span class="lineno">  221</span>    <span class="keywordtype">int</span> inject_signal = 0;</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>    <span class="comment">/* We explicitely check for events in upper 16 bits, because</span></div>
<div class="line"><span class="lineno">  224</span><span class="comment">     * musl (as opposed to glibc) does not report</span></div>
<div class="line"><span class="lineno">  225</span><span class="comment">     * PTRACE_EVENT_STOP as WIFSTOPPED */</span></div>
<div class="line"><span class="lineno">  226</span>    <span class="keywordflow">if</span> (WIFSTOPPED(ret) || (ret &gt;&gt; 16)) {</div>
<div class="line"><span class="lineno">  227</span>        <span class="keywordflow">if</span> (WSTOPSIG(ret) &amp; 0x80) {</div>
<div class="line"><span class="lineno">  228</span>            <span class="keywordflow">if</span> (!<a class="code hl_struct" href="#d1/dd5/structtracee">tracee</a>-&gt;<a class="code hl_variable" href="#abaaf57a3c2a0198b8056764c428d4eb0">in_syscall</a>) {</div>
<div class="line"><span class="lineno">  229</span><span class="preprocessor">#ifdef __aarch64__</span></div>
<div class="line"><span class="lineno">  230</span>                <span class="keywordtype">int</span> <a class="code hl_struct" href="#d8/def/structsyscall">syscall</a> = -1;</div>
<div class="line"><span class="lineno">  231</span>                <span class="keyword">struct </span>ptrace_syscall_info ptsi = {.op=PTRACE_SYSCALL_INFO_ENTRY};</div>
<div class="line"><span class="lineno">  232</span>                <span class="keywordflow">if</span> (ptrace(PTRACE_GET_SYSCALL_INFO, c-&gt;<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, <span class="keyword">sizeof</span>(ptsi), &amp;ptsi) != -1)</div>
<div class="line"><span class="lineno">  233</span>                    <a class="code hl_struct" href="#d8/def/structsyscall">syscall</a> = ptsi.entry.nr;</div>
<div class="line"><span class="lineno">  234</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  235</span>                <span class="keywordtype">int</span> <a class="code hl_struct" href="#d8/def/structsyscall">syscall</a> = ptrace(PTRACE_PEEKUSER, c-&gt;<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, reg_syscall_nr);</div>
<div class="line"><span class="lineno">  236</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  237</span>                <span class="keywordtype">int</span> i = syscall_index(<a class="code hl_struct" href="#d8/def/structsyscall">syscall</a>);</div>
<div class="line"><span class="lineno">  238</span>                <span class="keywordflow">if</span> (i &gt;= 0) {</div>
<div class="line"><span class="lineno">  239</span>                    <a class="code hl_variable" href="#a18886d554d9242ea748cff51b0dbfadc">syscall_count</a>[i]++;</div>
<div class="line"><span class="lineno">  240</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><span class="lineno">  241</span>                        fprintf(stderr, <span class="stringliteral">&quot;%s()\n&quot;</span>, syscall_name(<a class="code hl_struct" href="#d8/def/structsyscall">syscall</a>));</div>
<div class="line"><span class="lineno">  242</span>                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>) {</div>
<div class="line"><span class="lineno">  243</span>                    fprintf(stderr, <span class="stringliteral">&quot;syscal(%d)\n&quot;</span>, <a class="code hl_struct" href="#d8/def/structsyscall">syscall</a>);</div>
<div class="line"><span class="lineno">  244</span>                }</div>
<div class="line"><span class="lineno">  245</span>            }</div>
<div class="line"><span class="lineno">  246</span>            <a class="code hl_struct" href="#d1/dd5/structtracee">tracee</a>-&gt;<a class="code hl_variable" href="#abaaf57a3c2a0198b8056764c428d4eb0">in_syscall</a> = !<a class="code hl_struct" href="#d1/dd5/structtracee">tracee</a>-&gt;<a class="code hl_variable" href="#abaaf57a3c2a0198b8056764c428d4eb0">in_syscall</a>;</div>
<div class="line"><span class="lineno">  247</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((ret &gt;&gt; 8) == (SIGTRAP | (PTRACE_EVENT_FORK &lt;&lt; 8)) ||</div>
<div class="line"><span class="lineno">  248</span>               (ret &gt;&gt; 8) == (SIGTRAP | (PTRACE_EVENT_VFORK &lt;&lt; 8)) ||</div>
<div class="line"><span class="lineno">  249</span>               (ret &gt;&gt; 8) == (SIGTRAP | (PTRACE_EVENT_CLONE &lt;&lt; 8))) {</div>
<div class="line"><span class="lineno">  250</span>            <span class="keyword">struct </span><a class="code hl_struct" href="#d1/dd5/structtracee">tracee</a> *child = calloc(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="#d1/dd5/structtracee">tracee</a>));</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>            <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> msg;</div>
<div class="line"><span class="lineno">  253</span>            ptrace(PTRACE_GETEVENTMSG, c-&gt;<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, 0, &amp;msg);</div>
<div class="line"><span class="lineno">  254</span>            child-&gt;<a class="code hl_variable" href="#a6a9fd5feae6009e2ffaec4c55f6a3537">proc</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a> = msg;</div>
<div class="line"><span class="lineno">  255</span>            child-&gt;<a class="code hl_variable" href="#a6a9fd5feae6009e2ffaec4c55f6a3537">proc</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a46406fa271016311e9876c440d30897f">cb</a> = <a class="code hl_function" href="#af723cecaad03597fd09ecf1fb0d04829">tracer_cb</a>;</div>
<div class="line"><span class="lineno">  256</span>            ptrace(<a class="code hl_variable" href="#a2fc2f6b584bec6a0a6840dfef0ee5bec">ptrace_restart</a>, child-&gt;<a class="code hl_variable" href="#a6a9fd5feae6009e2ffaec4c55f6a3537">proc</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, 0, 0);</div>
<div class="line"><span class="lineno">  257</span>            <a class="code hl_function" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb">uloop_process_add</a>(&amp;child-&gt;<a class="code hl_variable" href="#a6a9fd5feae6009e2ffaec4c55f6a3537">proc</a>);</div>
<div class="line"><span class="lineno">  258</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><span class="lineno">  259</span>                fprintf(stderr, <span class="stringliteral">&quot;Tracing new child %d\n&quot;</span>, child-&gt;<a class="code hl_variable" href="#a6a9fd5feae6009e2ffaec4c55f6a3537">proc</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>);</div>
<div class="line"><span class="lineno">  260</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((ret &gt;&gt; 16) == <a class="code hl_define" href="#aacb3d7f5a6fd8aa90aff3f06fb3b6b62">PTRACE_EVENT_STOP</a>) {</div>
<div class="line"><span class="lineno">  261</span>            <span class="comment">/* Nothing special to do here */</span></div>
<div class="line"><span class="lineno">  262</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((ret &gt;&gt; 8) == (SIGTRAP | (<a class="code hl_define" href="#a654df7969d864c02c935acc5fd21b684">PTRACE_EVENT_SECCOMP</a> &lt;&lt; 8))) {</div>
<div class="line"><span class="lineno">  263</span><span class="preprocessor">#ifdef __aarch64__</span></div>
<div class="line"><span class="lineno">  264</span>            <span class="keywordtype">int</span> <a class="code hl_struct" href="#d8/def/structsyscall">syscall</a> = -1;</div>
<div class="line"><span class="lineno">  265</span>            <span class="keyword">struct </span>ptrace_syscall_info ptsi = {.op=PTRACE_SYSCALL_INFO_SECCOMP};</div>
<div class="line"><span class="lineno">  266</span>            <span class="keywordflow">if</span> (ptrace(PTRACE_GET_SYSCALL_INFO, c-&gt;<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, <span class="keyword">sizeof</span>(ptsi), &amp;ptsi) != -1)</div>
<div class="line"><span class="lineno">  267</span>                <a class="code hl_struct" href="#d8/def/structsyscall">syscall</a> = ptsi.entry.nr;</div>
<div class="line"><span class="lineno">  268</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  269</span>            <span class="keywordtype">int</span> <a class="code hl_struct" href="#d8/def/structsyscall">syscall</a> = ptrace(PTRACE_PEEKUSER, c-&gt;<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, reg_syscall_nr);</div>
<div class="line"><span class="lineno">  270</span><span class="preprocessor">#if defined(__arm__)</span></div>
<div class="line"><span class="lineno">  271</span>            ptrace(PTRACE_SET_SYSCALL, c-&gt;<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, 0, -1);</div>
<div class="line"><span class="lineno">  272</span>            ptrace(PTRACE_POKEUSER, c-&gt;<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, reg_retval_nr, -ENOSYS);</div>
<div class="line"><span class="lineno">  273</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  274</span>            ptrace(PTRACE_POKEUSER, c-&gt;<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, reg_syscall_nr, -1);</div>
<div class="line"><span class="lineno">  275</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  276</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  277</span>            <a class="code hl_function" href="#a36c7f7226dc2fdf6c44dd4ded35fd485">report_seccomp_vialation</a>(c-&gt;<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, <a class="code hl_struct" href="#d8/def/structsyscall">syscall</a>);</div>
<div class="line"><span class="lineno">  278</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  279</span>            inject_signal = WSTOPSIG(ret);</div>
<div class="line"><span class="lineno">  280</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><span class="lineno">  281</span>                fprintf(stderr, <span class="stringliteral">&quot;Injecting signal %d into pid %d\n&quot;</span>,</div>
<div class="line"><span class="lineno">  282</span>                    inject_signal, <a class="code hl_struct" href="#d1/dd5/structtracee">tracee</a>-&gt;<a class="code hl_variable" href="#a6a9fd5feae6009e2ffaec4c55f6a3537">proc</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>);</div>
<div class="line"><span class="lineno">  283</span>        }</div>
<div class="line"><span class="lineno">  284</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (WIFEXITED(ret) || (WIFSIGNALED(ret) &amp;&amp; WTERMSIG(ret))) {</div>
<div class="line"><span class="lineno">  285</span>        <span class="keywordflow">if</span> (<a class="code hl_struct" href="#d1/dd5/structtracee">tracee</a> == &amp;<a class="code hl_variable" href="#add93701af89df3429ca1e3f9e6b5efd7">tracer</a>) {</div>
<div class="line"><span class="lineno">  286</span>            <a class="code hl_function" href="../../dc/d56/uloop_8h.html#a5881608c3589830842d1db287f1f896e">uloop_end</a>(); <span class="comment">/* Main process exit */</span></div>
<div class="line"><span class="lineno">  287</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  288</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><span class="lineno">  289</span>                fprintf(stderr, <span class="stringliteral">&quot;Child %d exited\n&quot;</span>, <a class="code hl_struct" href="#d1/dd5/structtracee">tracee</a>-&gt;<a class="code hl_variable" href="#a6a9fd5feae6009e2ffaec4c55f6a3537">proc</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>);</div>
<div class="line"><span class="lineno">  290</span>            free(<a class="code hl_struct" href="#d1/dd5/structtracee">tracee</a>);</div>
<div class="line"><span class="lineno">  291</span>        }</div>
<div class="line"><span class="lineno">  292</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  293</span>    }</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>    ptrace(<a class="code hl_variable" href="#a2fc2f6b584bec6a0a6840dfef0ee5bec">ptrace_restart</a>, c-&gt;<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, 0, inject_signal);</div>
<div class="line"><span class="lineno">  296</span>    <a class="code hl_function" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb">uloop_process_add</a>(c);</div>
<div class="line"><span class="lineno">  297</span>}</div>
<div class="ttc" id="alist_8h_html_af8c317a42292b61c93aae91e59118a46"><div class="ttname"><a href="../../da/d23/list_8h.html#af8c317a42292b61c93aae91e59118a46">container_of</a></div><div class="ttdeci">#define container_of(ptr, type, member)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d23/list_8h_source.html#l00038">list.h:38</a></div></div>
<div class="ttc" id="atrace_8c_html_a36c7f7226dc2fdf6c44dd4ded35fd485"><div class="ttname"><a href="#a36c7f7226dc2fdf6c44dd4ded35fd485">report_seccomp_vialation</a></div><div class="ttdeci">static void report_seccomp_vialation(pid_t pid, unsigned syscall)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00188">trace.c:188</a></div></div>
<div class="ttc" id="atrace_8c_html_a654df7969d864c02c935acc5fd21b684"><div class="ttname"><a href="#a654df7969d864c02c935acc5fd21b684">PTRACE_EVENT_SECCOMP</a></div><div class="ttdeci">#define PTRACE_EVENT_SECCOMP</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00038">trace.c:38</a></div></div>
<div class="ttc" id="atrace_8c_html_aacb3d7f5a6fd8aa90aff3f06fb3b6b62"><div class="ttname"><a href="#aacb3d7f5a6fd8aa90aff3f06fb3b6b62">PTRACE_EVENT_STOP</a></div><div class="ttdeci">#define PTRACE_EVENT_STOP</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00033">trace.c:33</a></div></div>
<div class="ttc" id="atrace_8c_html_abaaf57a3c2a0198b8056764c428d4eb0"><div class="ttname"><a href="#abaaf57a3c2a0198b8056764c428d4eb0">tracee::in_syscall</a></div><div class="ttdeci">int in_syscall</div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00082">trace.c:82</a></div></div>
<div class="ttc" id="atrace_8c_html_d1/dd5/structtracee"><div class="ttname"><a href="#d1/dd5/structtracee">tracee</a></div><div class="ttdef"><b>Definition</b> <a href="../../d8/ddc/trace_8c_source.html#l00080">trace.c:80</a></div></div>
<div class="ttc" id="auloop_8h_html_a5881608c3589830842d1db287f1f896e"><div class="ttname"><a href="../../dc/d56/uloop_8h.html#a5881608c3589830842d1db287f1f896e">uloop_end</a></div><div class="ttdeci">static void uloop_end(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d56/uloop_8h_source.html#l00140">uloop.h:140</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d56/uloop_8h_source.html#l00086">uloop_process::cb</a>, <a class="el" href="../../da/d23/list_8h_source.html#l00038">container_of</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00089">debug</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00082">tracee::in_syscall</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00087">uloop_process::pid</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00081">tracee::proc</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00038">PTRACE_EVENT_SECCOMP</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00033">PTRACE_EVENT_STOP</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00091">ptrace_restart</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00188">report_seccomp_vialation()</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00086">syscall_count</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00085">tracer</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00218">tracer_cb()</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00140">uloop_end()</a>, and <a class="el" href="../../d1/d08/uloop_8c_source.html#l00391">uloop_process_add()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/ddc/trace_8c_source.html#l00308">main()</a>, and <a class="el" href="../../d8/ddc/trace_8c_source.html#l00218">tracer_cb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d8/ddc/trace_8c_af723cecaad03597fd09ecf1fb0d04829_cgraph.png" border="0" usemap="#ad8/ddc/trace_8c_af723cecaad03597fd09ecf1fb0d04829_cgraph" alt=""/></div>
<map name="ad8/ddc/trace_8c_af723cecaad03597fd09ecf1fb0d04829_cgraph" id="ad8/ddc/trace_8c_af723cecaad03597fd09ecf1fb0d04829_cgraph">
<area shape="rect" title=" " alt="" coords="5,63,113,96"/>
<area shape="poly" title=" " alt="" coords="18,63,13,53,19,44,35,38,59,36,85,38,100,45,98,50,84,44,59,41,36,43,23,48,19,54,23,61"/>
<area shape="rect" href="../../d8/ddc/trace_8c.html#a36c7f7226dc2fdf6c44dd4ded35fd485" title=" " alt="" coords="161,5,416,39"/>
<area shape="poly" title=" " alt="" coords="113,61,160,48,189,40,190,46,161,53,114,66"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#a5881608c3589830842d1db287f1f896e" title=" " alt="" coords="230,63,347,96"/>
<area shape="poly" title=" " alt="" coords="113,77,214,77,214,82,113,82"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb" title=" " alt="" coords="190,120,387,154"/>
<area shape="poly" title=" " alt="" coords="114,93,161,106,190,113,189,119,160,111,113,98"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="464,120,593,154"/>
<area shape="poly" title=" " alt="" coords="387,134,448,134,448,140,387,140"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="641,120,743,154"/>
<area shape="poly" title=" " alt="" coords="594,134,626,134,626,140,594,140"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a8f565d46decc2d5d8ac81923ceec43fd" name="a8f565d46decc2d5d8ac81923ceec43fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f565d46decc2d5d8ac81923ceec43fd">&#9670;&#160;</a></span>b</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d8/d3c/blob_8h.html#d3/dcb/structblob__buf">blob_buf</a> b</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00088">88</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/ddc/trace_8c_source.html#l00111">cmp_count()</a>, and <a class="el" href="../../d8/ddc/trace_8c_source.html#l00116">print_syscalls()</a>.</p>

</div>
</div>
<a id="ac3e1795766a80ec63b157951b4b9a7d4" name="ac3e1795766a80ec63b157951b4b9a7d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3e1795766a80ec63b157951b4b9a7d4">&#9670;&#160;</a></span>debug</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int debug</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00089">89</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/ddc/trace_8c_source.html#l00308">main()</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00116">print_syscalls()</a>, and <a class="el" href="../../d8/ddc/trace_8c_source.html#l00218">tracer_cb()</a>.</p>

</div>
</div>
<a id="ab9fe5820ba8505faef30e8a07c86ae87" name="ab9fe5820ba8505faef30e8a07c86ae87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9fe5820ba8505faef30e8a07c86ae87">&#9670;&#160;</a></span>json</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* json = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00090">90</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/df5/test-blob-parse_8c_source.html#l00128">cert_dump_blob()</a>, <a class="el" href="../../d0/d77/test-blobmsg_8c_source.html#l00153">main()</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00308">main()</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00116">print_syscalls()</a>, and <a class="el" href="../../d8/ddc/trace_8c_source.html#l00188">report_seccomp_vialation()</a>.</p>

</div>
</div>
<a id="ad28882416bed9eb87abd2834f1eec8cd" name="ad28882416bed9eb87abd2834f1eec8cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad28882416bed9eb87abd2834f1eec8cd">&#9670;&#160;</a></span>mode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#a1a6b6fb557d8d37d59700faf4e4c9167">mode</a> <a class="el" href="#a1a6b6fb557d8d37d59700faf4e4c9167">mode</a> = <a class="el" href="#a1a6b6fb557d8d37d59700faf4e4c9167a02db5102db3837f19ac287142187ee39">UTRACE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2fc2f6b584bec6a0a6840dfef0ee5bec" name="a2fc2f6b584bec6a0a6840dfef0ee5bec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fc2f6b584bec6a0a6840dfef0ee5bec">&#9670;&#160;</a></span>ptrace_restart</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ptrace_restart</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00091">91</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/ddc/trace_8c_source.html#l00308">main()</a>, and <a class="el" href="../../d8/ddc/trace_8c_source.html#l00218">tracer_cb()</a>.</p>

</div>
</div>
<a id="a18886d554d9242ea748cff51b0dbfadc" name="a18886d554d9242ea748cff51b0dbfadc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18886d554d9242ea748cff51b0dbfadc">&#9670;&#160;</a></span>syscall_count</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int syscall_count[SYSCALL_COUNT]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00086">86</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/ddc/trace_8c_source.html#l00116">print_syscalls()</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00188">report_seccomp_vialation()</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00093">set_syscall()</a>, and <a class="el" href="../../d8/ddc/trace_8c_source.html#l00218">tracer_cb()</a>.</p>

</div>
</div>
<a id="add93701af89df3429ca1e3f9e6b5efd7" name="add93701af89df3429ca1e3f9e6b5efd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add93701af89df3429ca1e3f9e6b5efd7">&#9670;&#160;</a></span>tracer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="#d1/dd5/structtracee">tracee</a> tracer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00085">85</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/ddc/trace_8c_source.html#l00308">main()</a>, <a class="el" href="../../d8/ddc/trace_8c_source.html#l00299">sigterm_handler()</a>, and <a class="el" href="../../d8/ddc/trace_8c_source.html#l00218">tracer_cb()</a>.</p>

</div>
</div>
<a id="a11da24fcc3ac9ca2386d8f695b21900b" name="a11da24fcc3ac9ca2386d8f695b21900b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11da24fcc3ac9ca2386d8f695b21900b">&#9670;&#160;</a></span>violation_count</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int violation_count</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/ddc/trace_8c_source.html#l00087">87</a> of file <a class="el" href="../../d8/ddc/trace_8c_source.html">trace.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/ddc/trace_8c_source.html#l00308">main()</a>, and <a class="el" href="../../d8/ddc/trace_8c_source.html#l00188">report_seccomp_vialation()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
