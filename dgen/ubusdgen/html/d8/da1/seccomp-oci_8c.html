<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>zbus: /home/g41797/CLionProjects/github.com/g41797/zbus/src/libs/procd/jail/seccomp-oci.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">zbus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_87a455bccb09a92130c26a11a880c98a.html">libs</a></li><li class="navelem"><a class="el" href="../../dir_63350b749fcf74007a53c7c917c10773.html">procd</a></li><li class="navelem"><a class="el" href="../../dir_332eccd3a674db599d080e188d7046bc.html">jail</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">seccomp-oci.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d5/d1d/libubox_2utils_8h_source.html">libubox/utils.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../dd/dad/blobmsg_8h_source.html">libubox/blobmsg.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d5/dea/blobmsg__json_8h_source.html">libubox/blobmsg_json.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html">log.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/dbd/seccomp-bpf_8h_source.html">seccomp-bpf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/dbb/seccomp-oci_8h_source.html">seccomp-oci.h</a>&quot;</code><br />
<code>#include &quot;../syscall-names.h&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d1/da1/seccomp-syscalls-helpers_8h_source.html">seccomp-syscalls-helpers.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for seccomp-oci.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/d8e/seccomp-oci_8c__incl.png" border="0" usemap="#a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2procd_2jail_2seccomp-oci_8c" alt=""/></div>
<map name="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2procd_2jail_2seccomp-oci_8c" id="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2procd_2jail_2seccomp-oci_8c">
<area shape="rect" title=" " alt="" coords="839,5,1159,85"/>
<area shape="rect" title=" " alt="" coords="562,133,658,167"/>
<area shape="poly" title=" " alt="" coords="850,88,674,134,673,129,849,83"/>
<area shape="rect" title=" " alt="" coords="999,378,1095,412"/>
<area shape="poly" title=" " alt="" coords="962,87,920,138,899,168,882,200,870,233,865,266,868,298,882,328,919,347,985,371,984,376,917,352,878,332,863,300,860,266,865,232,877,198,895,165,915,135,958,84"/>
<area shape="rect" title=" " alt="" coords="885,378,975,412"/>
<area shape="poly" title=" " alt="" coords="943,88,918,110,896,135,874,172,863,215,859,273,860,307,864,329,877,349,894,366,890,370,873,352,859,331,855,307,853,273,858,214,869,170,892,131,914,106,939,84"/>
<area shape="rect" title=" " alt="" coords="866,460,964,493"/>
<area shape="poly" title=" " alt="" coords="875,88,828,113,788,144,772,163,759,183,751,206,748,230,748,314,751,337,759,359,772,378,787,396,825,427,864,450,861,455,822,431,784,400,767,382,755,361,746,339,743,315,743,230,746,204,754,181,767,160,784,140,825,108,873,83"/>
<area shape="rect" href="../../d5/d1d/libubox_2utils_8h.html" title=" " alt="" coords="556,378,709,412"/>
<area shape="poly" title=" " alt="" coords="840,74,780,98,753,115,729,135,707,160,688,189,661,252,645,313,638,363,632,362,640,312,656,250,683,187,702,157,725,131,750,111,778,94,838,69"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html" title=" " alt="" coords="897,215,1090,248"/>
<area shape="poly" title=" " alt="" coords="971,87,958,109,948,134,945,150,948,166,957,184,969,201,965,205,952,187,943,168,940,150,943,132,953,107,966,84"/>
<area shape="rect" href="../../d5/dea/blobmsg__json_8h.html" title=" " alt="" coords="958,133,1198,167"/>
<area shape="poly" title=" " alt="" coords="1031,84,1058,119,1054,122,1027,87"/>
<area shape="rect" href="../../d8/d30/procd_2jail_2log_8h.html" title=" " alt="" coords="1221,133,1289,167"/>
<area shape="poly" title=" " alt="" coords="1098,83,1208,127,1206,132,1096,88"/>
<area shape="rect" href="../../d0/dbd/seccomp-bpf_8h.html" title=" " alt="" coords="1475,296,1632,330"/>
<area shape="poly" title=" " alt="" coords="1160,79,1232,102,1301,131,1368,167,1430,209,1526,284,1523,288,1427,213,1365,172,1299,135,1230,107,1158,84"/>
<area shape="rect" href="../../d8/dbb/seccomp-oci_8h.html" title=" " alt="" coords="1662,215,1816,248"/>
<area shape="poly" title=" " alt="" coords="1160,70,1268,95,1376,131,1405,148,1433,164,1487,182,1543,197,1647,216,1646,222,1542,202,1486,187,1431,169,1402,152,1374,135,1266,100,1159,75"/>
<area shape="rect" title=" " alt="" coords="1445,133,1633,167"/>
<area shape="poly" title=" " alt="" coords="1160,74,1439,127,1438,132,1159,79"/>
<area shape="rect" href="../../d1/da1/seccomp-syscalls-helpers_8h.html" title=" " alt="" coords="1657,133,1933,167"/>
<area shape="poly" title=" " alt="" coords="1159,64,1655,128,1654,133,1159,70"/>
<area shape="poly" title=" " alt="" coords="691,410,852,455,851,460,689,415"/>
<area shape="rect" title=" " alt="" coords="217,460,328,493"/>
<area shape="poly" title=" " alt="" coords="558,415,343,462,342,457,557,410"/>
<area shape="rect" title=" " alt="" coords="353,460,480,493"/>
<area shape="poly" title=" " alt="" coords="590,415,476,456,474,451,588,410"/>
<area shape="rect" title=" " alt="" coords="504,460,622,493"/>
<area shape="poly" title=" " alt="" coords="620,414,589,450,585,446,616,410"/>
<area shape="rect" title=" " alt="" coords="750,460,843,493"/>
<area shape="poly" title=" " alt="" coords="667,410,751,450,748,455,664,415"/>
<area shape="rect" title=" " alt="" coords="988,460,1095,493"/>
<area shape="poly" title=" " alt="" coords="710,407,973,457,972,462,709,412"/>
<area shape="rect" title=" " alt="" coords="646,460,726,493"/>
<area shape="poly" title=" " alt="" coords="645,411,669,445,664,448,641,414"/>
<area shape="rect" title=" " alt="" coords="5,460,193,493"/>
<area shape="poly" title=" " alt="" coords="556,410,209,462,208,456,556,405"/>
<area shape="rect" title=" " alt="" coords="893,296,991,330"/>
<area shape="poly" title=" " alt="" coords="985,250,963,285,958,282,981,247"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html" title=" " alt="" coords="1015,296,1095,330"/>
<area shape="poly" title=" " alt="" coords="1008,247,1035,282,1031,286,1004,250"/>
<area shape="poly" title=" " alt="" coords="1031,333,969,372,966,367,1028,328"/>
<area shape="poly" title=" " alt="" coords="1015,330,1004,333,857,362,724,384,723,378,856,357,1002,327,1014,324"/>
<area shape="poly" title=" " alt="" coords="1016,330,863,380,833,412,812,447,807,444,829,409,860,376,1014,324"/>
<area shape="poly" title=" " alt="" coords="1016,330,926,359,874,380,869,395,875,410,889,422,913,435,974,456,972,461,911,439,886,427,870,413,863,395,870,376,925,354,1014,325"/>
<area shape="rect" title=" " alt="" coords="1170,378,1263,412"/>
<area shape="poly" title=" " alt="" coords="1089,328,1171,369,1169,373,1086,333"/>
<area shape="rect" title=" " alt="" coords="1398,378,1483,412"/>
<area shape="poly" title=" " alt="" coords="1096,318,1220,340,1384,375,1382,380,1219,346,1095,324"/>
<area shape="rect" title=" " alt="" coords="1287,378,1375,412"/>
<area shape="poly" title=" " alt="" coords="1096,323,1273,374,1271,379,1094,329"/>
<area shape="poly" title=" " alt="" coords="1087,166,1103,210,1119,272,1123,307,1124,343,1120,379,1109,413,1096,434,1079,452,1075,448,1092,431,1105,411,1115,378,1119,343,1118,308,1114,273,1098,212,1082,168"/>
<area shape="poly" title=" " alt="" coords="1062,169,1024,206,1020,202,1059,165"/>
<area shape="poly" title=" " alt="" coords="1240,169,1225,186,1212,206,1206,227,1211,247,1226,271,1245,292,1290,327,1339,354,1385,374,1383,379,1337,359,1287,332,1242,296,1222,274,1206,249,1201,227,1208,204,1221,183,1236,166"/>
<area shape="rect" title=" " alt="" coords="1221,215,1319,248"/>
<area shape="poly" title=" " alt="" coords="1261,167,1267,199,1261,200,1255,168"/>
<area shape="poly" title=" " alt="" coords="1475,329,1111,386,1110,381,1474,324"/>
<area shape="poly" title=" " alt="" coords="1475,322,1260,342,1127,358,990,380,989,375,1126,353,1259,336,1474,317"/>
<area shape="poly" title=" " alt="" coords="1577,329,1597,347,1614,368,1623,391,1621,403,1614,414,1600,423,1577,430,1511,441,1423,449,1322,453,1121,458,979,463,979,458,1121,452,1322,448,1422,443,1510,436,1576,425,1598,418,1610,410,1616,401,1617,392,1610,371,1593,350,1574,333"/>
<area shape="poly" title=" " alt="" coords="1480,333,1278,380,1277,375,1479,328"/>
<area shape="poly" title=" " alt="" coords="1532,333,1477,371,1474,367,1529,328"/>
<area shape="poly" title=" " alt="" coords="1509,333,1390,375,1389,370,1508,328"/>
<area shape="rect" title=" " alt="" coords="1507,378,1601,412"/>
<area shape="poly" title=" " alt="" coords="1556,330,1556,363,1551,363,1551,330"/>
<area shape="rect" title=" " alt="" coords="1675,378,1777,412"/>
<area shape="poly" title=" " alt="" coords="1590,328,1678,369,1676,374,1587,333"/>
<area shape="rect" title=" " alt="" coords="1800,378,1918,412"/>
<area shape="poly" title=" " alt="" coords="1616,328,1786,372,1785,377,1615,333"/>
<area shape="rect" title=" " alt="" coords="1942,378,2091,412"/>
<area shape="poly" title=" " alt="" coords="1633,325,1927,375,1926,380,1632,330"/>
<area shape="rect" title=" " alt="" coords="2114,378,2252,412"/>
<area shape="poly" title=" " alt="" coords="1633,319,1840,341,2099,375,2098,380,1839,346,1632,324"/>
<area shape="rect" title=" " alt="" coords="2276,378,2407,412"/>
<area shape="poly" title=" " alt="" coords="1633,316,1907,336,2081,353,2261,375,2260,380,2081,358,1906,341,1633,321"/>
<area shape="poly" title=" " alt="" coords="1800,246,2267,371,2266,376,1799,252"/>
</map>
</div>
</div>
<p><a href="../../d8/da1/seccomp-oci_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a369266c24eacffb87046522897a570d5" id="r_a369266c24eacffb87046522897a570d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a369266c24eacffb87046522897a570d5">_GNU_SOURCE</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a369266c24eacffb87046522897a570d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aa156d1cebb38c8a65846c4d9c006012a" id="r_aa156d1cebb38c8a65846c4d9c006012a"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="#aa156d1cebb38c8a65846c4d9c006012aa412668793ef8889b9f0d50144e9c3c29">OCI_LINUX_SECCOMP_DEFAULTACTION</a>
, <a class="el" href="#aa156d1cebb38c8a65846c4d9c006012aae458d1f367df8d456464a1b290ec2f1f">OCI_LINUX_SECCOMP_ARCHITECTURES</a>
, <a class="el" href="#aa156d1cebb38c8a65846c4d9c006012aa55e2eca61872174f3c1fb35d7305a7d2">OCI_LINUX_SECCOMP_FLAGS</a>
, <a class="el" href="#aa156d1cebb38c8a65846c4d9c006012aa184911ae3d78b8ea0375c56c4282d82f">OCI_LINUX_SECCOMP_SYSCALLS</a>
, <br />
&#160;&#160;<a class="el" href="#aa156d1cebb38c8a65846c4d9c006012aa09a481995703db613622a4b45a9c9124">__OCI_LINUX_SECCOMP_MAX</a>
<br />
 }</td></tr>
<tr class="separator:aa156d1cebb38c8a65846c4d9c006012a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8654c714018c6241d9ebd01f3fb5a26" id="r_af8654c714018c6241d9ebd01f3fb5a26"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="#af8654c714018c6241d9ebd01f3fb5a26a1efbc5bb9a94393a22cea27db34994f3">OCI_LINUX_SECCOMP_SYSCALLS_NAMES</a>
, <a class="el" href="#af8654c714018c6241d9ebd01f3fb5a26a5eae989fa9d816f01d5f56207c0b8fa8">OCI_LINUX_SECCOMP_SYSCALLS_ACTION</a>
, <a class="el" href="#af8654c714018c6241d9ebd01f3fb5a26a7a8319f7cebb28f8fd2cf6b0f5794e77">OCI_LINUX_SECCOMP_SYSCALLS_ERRNORET</a>
, <a class="el" href="#af8654c714018c6241d9ebd01f3fb5a26a9c400808e68a191a65483332929d3ffe">OCI_LINUX_SECCOMP_SYSCALLS_ARGS</a>
, <br />
&#160;&#160;<a class="el" href="#af8654c714018c6241d9ebd01f3fb5a26afc3adc3411e4440e30f1f28c5dcee163">__OCI_LINUX_SECCOMP_SYSCALLS_MAX</a>
<br />
 }</td></tr>
<tr class="separator:af8654c714018c6241d9ebd01f3fb5a26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f80701c36e79c0640d91c788feee0b3" id="r_a2f80701c36e79c0640d91c788feee0b3"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="#a2f80701c36e79c0640d91c788feee0b3a7e5fc851b7f8b56f87fe0639cafca197">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_INDEX</a>
, <a class="el" href="#a2f80701c36e79c0640d91c788feee0b3a2e5b128da6eb01c318cfe1aa68002985">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUE</a>
, <a class="el" href="#a2f80701c36e79c0640d91c788feee0b3a08bf505c4afd3c95c92bb4fa3a42fd6e">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUETWO</a>
, <a class="el" href="#a2f80701c36e79c0640d91c788feee0b3ae3d1fb54e12a7ae1d760a4424b0cb9c9">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_OP</a>
, <br />
&#160;&#160;<a class="el" href="#a2f80701c36e79c0640d91c788feee0b3a4edf5bf11f75ac3c6d12753e51b07501">__OCI_LINUX_SECCOMP_SYSCALLS_ARGS_MAX</a>
<br />
 }</td></tr>
<tr class="separator:a2f80701c36e79c0640d91c788feee0b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa5c3a75ac3e60404d1158734452a4f66" id="r_aa5c3a75ac3e60404d1158734452a4f66"><td class="memItemLeft" align="right" valign="top">static uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa5c3a75ac3e60404d1158734452a4f66">resolve_action</a> (char *actname)</td></tr>
<tr class="separator:aa5c3a75ac3e60404d1158734452a4f66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a629da0c7d64e185e273c72f083630cb9" id="r_a629da0c7d64e185e273c72f083630cb9"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a629da0c7d64e185e273c72f083630cb9">resolve_op_ins</a> (const char *op)</td></tr>
<tr class="separator:a629da0c7d64e185e273c72f083630cb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a459df353e08836d2ffe1001a8c4d289b" id="r_a459df353e08836d2ffe1001a8c4d289b"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a459df353e08836d2ffe1001a8c4d289b">resolve_op_is_masked</a> (const char *op)</td></tr>
<tr class="separator:a459df353e08836d2ffe1001a8c4d289b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9afb34481ea621a4fb776aa7da95e00" id="r_ac9afb34481ea621a4fb776aa7da95e00"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac9afb34481ea621a4fb776aa7da95e00">resolve_op_inv</a> (const char *op)</td></tr>
<tr class="separator:ac9afb34481ea621a4fb776aa7da95e00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0436ecb75f262b8eef277e2861a97f9d" id="r_a0436ecb75f262b8eef277e2861a97f9d"><td class="memItemLeft" align="right" valign="top">static uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0436ecb75f262b8eef277e2861a97f9d">resolve_architecture</a> (char *archname)</td></tr>
<tr class="separator:a0436ecb75f262b8eef277e2861a97f9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac693b398071b4ee41b25e6b9d117803c" id="r_ac693b398071b4ee41b25e6b9d117803c"><td class="memItemLeft" align="right" valign="top">struct sock_fprog *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac693b398071b4ee41b25e6b9d117803c">parseOCIlinuxseccomp</a> (struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *msg)</td></tr>
<tr class="separator:ac693b398071b4ee41b25e6b9d117803c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cd5004c8913a313ee7b35e8bbd27d50" id="r_a1cd5004c8913a313ee7b35e8bbd27d50"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1cd5004c8913a313ee7b35e8bbd27d50">applyOCIlinuxseccomp</a> (struct sock_fprog *prog)</td></tr>
<tr class="separator:a1cd5004c8913a313ee7b35e8bbd27d50"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae2e350552680f6a95c57167deb867ff1" id="r_ae2e350552680f6a95c57167deb867ff1"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae2e350552680f6a95c57167deb867ff1">oci_linux_seccomp_policy</a> []</td></tr>
<tr class="separator:ae2e350552680f6a95c57167deb867ff1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68a7dab872d9c5e1d3d582eaea30aa96" id="r_a68a7dab872d9c5e1d3d582eaea30aa96"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a68a7dab872d9c5e1d3d582eaea30aa96">oci_linux_seccomp_syscalls_policy</a> []</td></tr>
<tr class="separator:a68a7dab872d9c5e1d3d582eaea30aa96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0394a97ad911ae61d20e8147f801f098" id="r_a0394a97ad911ae61d20e8147f801f098"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0394a97ad911ae61d20e8147f801f098">oci_linux_seccomp_syscalls_args_policy</a> []</td></tr>
<tr class="separator:a0394a97ad911ae61d20e8147f801f098"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a369266c24eacffb87046522897a570d5" name="a369266c24eacffb87046522897a570d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a369266c24eacffb87046522897a570d5">&#9670;&#160;</a></span>_GNU_SOURCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _GNU_SOURCE&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00023">23</a> of file <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html">seccomp-oci.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="aa156d1cebb38c8a65846c4d9c006012a" name="aa156d1cebb38c8a65846c4d9c006012a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa156d1cebb38c8a65846c4d9c006012a">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aa156d1cebb38c8a65846c4d9c006012aa412668793ef8889b9f0d50144e9c3c29" name="aa156d1cebb38c8a65846c4d9c006012aa412668793ef8889b9f0d50144e9c3c29"></a>OCI_LINUX_SECCOMP_DEFAULTACTION&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aa156d1cebb38c8a65846c4d9c006012aae458d1f367df8d456464a1b290ec2f1f" name="aa156d1cebb38c8a65846c4d9c006012aae458d1f367df8d456464a1b290ec2f1f"></a>OCI_LINUX_SECCOMP_ARCHITECTURES&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aa156d1cebb38c8a65846c4d9c006012aa55e2eca61872174f3c1fb35d7305a7d2" name="aa156d1cebb38c8a65846c4d9c006012aa55e2eca61872174f3c1fb35d7305a7d2"></a>OCI_LINUX_SECCOMP_FLAGS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aa156d1cebb38c8a65846c4d9c006012aa184911ae3d78b8ea0375c56c4282d82f" name="aa156d1cebb38c8a65846c4d9c006012aa184911ae3d78b8ea0375c56c4282d82f"></a>OCI_LINUX_SECCOMP_SYSCALLS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aa156d1cebb38c8a65846c4d9c006012aa09a481995703db613622a4b45a9c9124" name="aa156d1cebb38c8a65846c4d9c006012aa09a481995703db613622a4b45a9c9124"></a>__OCI_LINUX_SECCOMP_MAX&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00154">154</a> of file <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html">seccomp-oci.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  154</span>     {</div>
<div class="line"><span class="lineno">  155</span>    <a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aa412668793ef8889b9f0d50144e9c3c29">OCI_LINUX_SECCOMP_DEFAULTACTION</a>,</div>
<div class="line"><span class="lineno">  156</span>    <a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aae458d1f367df8d456464a1b290ec2f1f">OCI_LINUX_SECCOMP_ARCHITECTURES</a>,</div>
<div class="line"><span class="lineno">  157</span>    <a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aa55e2eca61872174f3c1fb35d7305a7d2">OCI_LINUX_SECCOMP_FLAGS</a>,</div>
<div class="line"><span class="lineno">  158</span>    <a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aa184911ae3d78b8ea0375c56c4282d82f">OCI_LINUX_SECCOMP_SYSCALLS</a>,</div>
<div class="line"><span class="lineno">  159</span>    <a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aa09a481995703db613622a4b45a9c9124">__OCI_LINUX_SECCOMP_MAX</a>,</div>
<div class="line"><span class="lineno">  160</span>};</div>
<div class="ttc" id="aseccomp-oci_8c_html_aa156d1cebb38c8a65846c4d9c006012aa09a481995703db613622a4b45a9c9124"><div class="ttname"><a href="#aa156d1cebb38c8a65846c4d9c006012aa09a481995703db613622a4b45a9c9124">__OCI_LINUX_SECCOMP_MAX</a></div><div class="ttdeci">@ __OCI_LINUX_SECCOMP_MAX</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00159">seccomp-oci.c:159</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_aa156d1cebb38c8a65846c4d9c006012aa184911ae3d78b8ea0375c56c4282d82f"><div class="ttname"><a href="#aa156d1cebb38c8a65846c4d9c006012aa184911ae3d78b8ea0375c56c4282d82f">OCI_LINUX_SECCOMP_SYSCALLS</a></div><div class="ttdeci">@ OCI_LINUX_SECCOMP_SYSCALLS</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00158">seccomp-oci.c:158</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_aa156d1cebb38c8a65846c4d9c006012aa412668793ef8889b9f0d50144e9c3c29"><div class="ttname"><a href="#aa156d1cebb38c8a65846c4d9c006012aa412668793ef8889b9f0d50144e9c3c29">OCI_LINUX_SECCOMP_DEFAULTACTION</a></div><div class="ttdeci">@ OCI_LINUX_SECCOMP_DEFAULTACTION</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00155">seccomp-oci.c:155</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_aa156d1cebb38c8a65846c4d9c006012aa55e2eca61872174f3c1fb35d7305a7d2"><div class="ttname"><a href="#aa156d1cebb38c8a65846c4d9c006012aa55e2eca61872174f3c1fb35d7305a7d2">OCI_LINUX_SECCOMP_FLAGS</a></div><div class="ttdeci">@ OCI_LINUX_SECCOMP_FLAGS</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00157">seccomp-oci.c:157</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_aa156d1cebb38c8a65846c4d9c006012aae458d1f367df8d456464a1b290ec2f1f"><div class="ttname"><a href="#aa156d1cebb38c8a65846c4d9c006012aae458d1f367df8d456464a1b290ec2f1f">OCI_LINUX_SECCOMP_ARCHITECTURES</a></div><div class="ttdeci">@ OCI_LINUX_SECCOMP_ARCHITECTURES</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00156">seccomp-oci.c:156</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af8654c714018c6241d9ebd01f3fb5a26" name="af8654c714018c6241d9ebd01f3fb5a26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8654c714018c6241d9ebd01f3fb5a26">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="af8654c714018c6241d9ebd01f3fb5a26a1efbc5bb9a94393a22cea27db34994f3" name="af8654c714018c6241d9ebd01f3fb5a26a1efbc5bb9a94393a22cea27db34994f3"></a>OCI_LINUX_SECCOMP_SYSCALLS_NAMES&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="af8654c714018c6241d9ebd01f3fb5a26a5eae989fa9d816f01d5f56207c0b8fa8" name="af8654c714018c6241d9ebd01f3fb5a26a5eae989fa9d816f01d5f56207c0b8fa8"></a>OCI_LINUX_SECCOMP_SYSCALLS_ACTION&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="af8654c714018c6241d9ebd01f3fb5a26a7a8319f7cebb28f8fd2cf6b0f5794e77" name="af8654c714018c6241d9ebd01f3fb5a26a7a8319f7cebb28f8fd2cf6b0f5794e77"></a>OCI_LINUX_SECCOMP_SYSCALLS_ERRNORET&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="af8654c714018c6241d9ebd01f3fb5a26a9c400808e68a191a65483332929d3ffe" name="af8654c714018c6241d9ebd01f3fb5a26a9c400808e68a191a65483332929d3ffe"></a>OCI_LINUX_SECCOMP_SYSCALLS_ARGS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="af8654c714018c6241d9ebd01f3fb5a26afc3adc3411e4440e30f1f28c5dcee163" name="af8654c714018c6241d9ebd01f3fb5a26afc3adc3411e4440e30f1f28c5dcee163"></a>__OCI_LINUX_SECCOMP_SYSCALLS_MAX&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00169">169</a> of file <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html">seccomp-oci.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  169</span>     {</div>
<div class="line"><span class="lineno">  170</span>    <a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a1efbc5bb9a94393a22cea27db34994f3">OCI_LINUX_SECCOMP_SYSCALLS_NAMES</a>,</div>
<div class="line"><span class="lineno">  171</span>    <a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a5eae989fa9d816f01d5f56207c0b8fa8">OCI_LINUX_SECCOMP_SYSCALLS_ACTION</a>,</div>
<div class="line"><span class="lineno">  172</span>    <a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a7a8319f7cebb28f8fd2cf6b0f5794e77">OCI_LINUX_SECCOMP_SYSCALLS_ERRNORET</a>,</div>
<div class="line"><span class="lineno">  173</span>    <a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a9c400808e68a191a65483332929d3ffe">OCI_LINUX_SECCOMP_SYSCALLS_ARGS</a>,</div>
<div class="line"><span class="lineno">  174</span>    <a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26afc3adc3411e4440e30f1f28c5dcee163">__OCI_LINUX_SECCOMP_SYSCALLS_MAX</a></div>
<div class="line"><span class="lineno">  175</span>};</div>
<div class="ttc" id="aseccomp-oci_8c_html_af8654c714018c6241d9ebd01f3fb5a26a1efbc5bb9a94393a22cea27db34994f3"><div class="ttname"><a href="#af8654c714018c6241d9ebd01f3fb5a26a1efbc5bb9a94393a22cea27db34994f3">OCI_LINUX_SECCOMP_SYSCALLS_NAMES</a></div><div class="ttdeci">@ OCI_LINUX_SECCOMP_SYSCALLS_NAMES</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00170">seccomp-oci.c:170</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_af8654c714018c6241d9ebd01f3fb5a26a5eae989fa9d816f01d5f56207c0b8fa8"><div class="ttname"><a href="#af8654c714018c6241d9ebd01f3fb5a26a5eae989fa9d816f01d5f56207c0b8fa8">OCI_LINUX_SECCOMP_SYSCALLS_ACTION</a></div><div class="ttdeci">@ OCI_LINUX_SECCOMP_SYSCALLS_ACTION</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00171">seccomp-oci.c:171</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_af8654c714018c6241d9ebd01f3fb5a26a7a8319f7cebb28f8fd2cf6b0f5794e77"><div class="ttname"><a href="#af8654c714018c6241d9ebd01f3fb5a26a7a8319f7cebb28f8fd2cf6b0f5794e77">OCI_LINUX_SECCOMP_SYSCALLS_ERRNORET</a></div><div class="ttdeci">@ OCI_LINUX_SECCOMP_SYSCALLS_ERRNORET</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00172">seccomp-oci.c:172</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_af8654c714018c6241d9ebd01f3fb5a26a9c400808e68a191a65483332929d3ffe"><div class="ttname"><a href="#af8654c714018c6241d9ebd01f3fb5a26a9c400808e68a191a65483332929d3ffe">OCI_LINUX_SECCOMP_SYSCALLS_ARGS</a></div><div class="ttdeci">@ OCI_LINUX_SECCOMP_SYSCALLS_ARGS</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00173">seccomp-oci.c:173</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_af8654c714018c6241d9ebd01f3fb5a26afc3adc3411e4440e30f1f28c5dcee163"><div class="ttname"><a href="#af8654c714018c6241d9ebd01f3fb5a26afc3adc3411e4440e30f1f28c5dcee163">__OCI_LINUX_SECCOMP_SYSCALLS_MAX</a></div><div class="ttdeci">@ __OCI_LINUX_SECCOMP_SYSCALLS_MAX</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00175">seccomp-oci.c:174</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f80701c36e79c0640d91c788feee0b3" name="a2f80701c36e79c0640d91c788feee0b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f80701c36e79c0640d91c788feee0b3">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a2f80701c36e79c0640d91c788feee0b3a7e5fc851b7f8b56f87fe0639cafca197" name="a2f80701c36e79c0640d91c788feee0b3a7e5fc851b7f8b56f87fe0639cafca197"></a>OCI_LINUX_SECCOMP_SYSCALLS_ARGS_INDEX&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a2f80701c36e79c0640d91c788feee0b3a2e5b128da6eb01c318cfe1aa68002985" name="a2f80701c36e79c0640d91c788feee0b3a2e5b128da6eb01c318cfe1aa68002985"></a>OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a2f80701c36e79c0640d91c788feee0b3a08bf505c4afd3c95c92bb4fa3a42fd6e" name="a2f80701c36e79c0640d91c788feee0b3a08bf505c4afd3c95c92bb4fa3a42fd6e"></a>OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUETWO&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a2f80701c36e79c0640d91c788feee0b3ae3d1fb54e12a7ae1d760a4424b0cb9c9" name="a2f80701c36e79c0640d91c788feee0b3ae3d1fb54e12a7ae1d760a4424b0cb9c9"></a>OCI_LINUX_SECCOMP_SYSCALLS_ARGS_OP&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a2f80701c36e79c0640d91c788feee0b3a4edf5bf11f75ac3c6d12753e51b07501" name="a2f80701c36e79c0640d91c788feee0b3a4edf5bf11f75ac3c6d12753e51b07501"></a>__OCI_LINUX_SECCOMP_SYSCALLS_ARGS_MAX&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00184">184</a> of file <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html">seccomp-oci.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  184</span>     {</div>
<div class="line"><span class="lineno">  185</span>    <a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a7e5fc851b7f8b56f87fe0639cafca197">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_INDEX</a>,</div>
<div class="line"><span class="lineno">  186</span>    <a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a2e5b128da6eb01c318cfe1aa68002985">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUE</a>,</div>
<div class="line"><span class="lineno">  187</span>    <a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a08bf505c4afd3c95c92bb4fa3a42fd6e">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUETWO</a>,</div>
<div class="line"><span class="lineno">  188</span>    <a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3ae3d1fb54e12a7ae1d760a4424b0cb9c9">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_OP</a>,</div>
<div class="line"><span class="lineno">  189</span>    <a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a4edf5bf11f75ac3c6d12753e51b07501">__OCI_LINUX_SECCOMP_SYSCALLS_ARGS_MAX</a></div>
<div class="line"><span class="lineno">  190</span>};</div>
<div class="ttc" id="aseccomp-oci_8c_html_a2f80701c36e79c0640d91c788feee0b3a08bf505c4afd3c95c92bb4fa3a42fd6e"><div class="ttname"><a href="#a2f80701c36e79c0640d91c788feee0b3a08bf505c4afd3c95c92bb4fa3a42fd6e">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUETWO</a></div><div class="ttdeci">@ OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUETWO</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00187">seccomp-oci.c:187</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_a2f80701c36e79c0640d91c788feee0b3a2e5b128da6eb01c318cfe1aa68002985"><div class="ttname"><a href="#a2f80701c36e79c0640d91c788feee0b3a2e5b128da6eb01c318cfe1aa68002985">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUE</a></div><div class="ttdeci">@ OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUE</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00186">seccomp-oci.c:186</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_a2f80701c36e79c0640d91c788feee0b3a4edf5bf11f75ac3c6d12753e51b07501"><div class="ttname"><a href="#a2f80701c36e79c0640d91c788feee0b3a4edf5bf11f75ac3c6d12753e51b07501">__OCI_LINUX_SECCOMP_SYSCALLS_ARGS_MAX</a></div><div class="ttdeci">@ __OCI_LINUX_SECCOMP_SYSCALLS_ARGS_MAX</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00190">seccomp-oci.c:189</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_a2f80701c36e79c0640d91c788feee0b3a7e5fc851b7f8b56f87fe0639cafca197"><div class="ttname"><a href="#a2f80701c36e79c0640d91c788feee0b3a7e5fc851b7f8b56f87fe0639cafca197">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_INDEX</a></div><div class="ttdeci">@ OCI_LINUX_SECCOMP_SYSCALLS_ARGS_INDEX</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00185">seccomp-oci.c:185</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_a2f80701c36e79c0640d91c788feee0b3ae3d1fb54e12a7ae1d760a4424b0cb9c9"><div class="ttname"><a href="#a2f80701c36e79c0640d91c788feee0b3ae3d1fb54e12a7ae1d760a4424b0cb9c9">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_OP</a></div><div class="ttdeci">@ OCI_LINUX_SECCOMP_SYSCALLS_ARGS_OP</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00188">seccomp-oci.c:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a1cd5004c8913a313ee7b35e8bbd27d50" name="a1cd5004c8913a313ee7b35e8bbd27d50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cd5004c8913a313ee7b35e8bbd27d50">&#9670;&#160;</a></span>applyOCIlinuxseccomp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int applyOCIlinuxseccomp </td>
          <td>(</td>
          <td class="paramtype">struct sock_fprog *</td>          <td class="paramname"><span class="paramname"><em>prog</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00430">430</a> of file <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html">seccomp-oci.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  431</span>{</div>
<div class="line"><span class="lineno">  432</span>    <span class="keywordflow">if</span> (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {</div>
<div class="line"><span class="lineno">  433</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;prctl(PR_SET_NO_NEW_PRIVS) failed: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno">  434</span>        <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno">  435</span>    }</div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span>    <span class="keywordflow">if</span> (prctl(PR_SET_SECCOMP, <a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#ac98f9fb027964226b03d64c3a5cbe087">SECCOMP_MODE_FILTER</a>, prog)) {</div>
<div class="line"><span class="lineno">  438</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;prctl(PR_SET_SECCOMP) failed: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno">  439</span>        <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno">  440</span>    }</div>
<div class="line"><span class="lineno">  441</span>    free(prog);</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>errout:</div>
<div class="line"><span class="lineno">  446</span>    free(prog-&gt;filter);</div>
<div class="line"><span class="lineno">  447</span>    free(prog);</div>
<div class="line"><span class="lineno">  448</span>    <span class="keywordflow">return</span> errno;</div>
<div class="line"><span class="lineno">  449</span>}</div>
<div class="ttc" id="aprocd_2jail_2log_8h_html_a15378cd15bafb3a79061424b452497aa"><div class="ttname"><a href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a></div><div class="ttdeci">#define ERROR(fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">log.h:27</a></div></div>
<div class="ttc" id="aseccomp-bpf_8h_html_ac98f9fb027964226b03d64c3a5cbe087"><div class="ttname"><a href="../../d0/dbd/seccomp-bpf_8h.html#ac98f9fb027964226b03d64c3a5cbe087">SECCOMP_MODE_FILTER</a></div><div class="ttdeci">#define SECCOMP_MODE_FILTER</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dbd/seccomp-bpf_8h_source.html#l00039">seccomp-bpf.h:39</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, and <a class="el" href="../../d0/dbd/seccomp-bpf_8h_source.html#l00039">SECCOMP_MODE_FILTER</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d4f/seccomp_8c_source.html#l00025">install_syscall_filter()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l01256">post_start_hook()</a>.</p>

</div>
</div>
<a id="ac693b398071b4ee41b25e6b9d117803c" name="ac693b398071b4ee41b25e6b9d117803c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac693b398071b4ee41b25e6b9d117803c">&#9670;&#160;</a></span>parseOCIlinuxseccomp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct sock_fprog * parseOCIlinuxseccomp </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00199">199</a> of file <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html">seccomp-oci.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  200</span>{</div>
<div class="line"><span class="lineno">  201</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *tb[<a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aa09a481995703db613622a4b45a9c9124">__OCI_LINUX_SECCOMP_MAX</a>];</div>
<div class="line"><span class="lineno">  202</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *tbn[<a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26afc3adc3411e4440e30f1f28c5dcee163">__OCI_LINUX_SECCOMP_SYSCALLS_MAX</a>];</div>
<div class="line"><span class="lineno">  203</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *tba[<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a4edf5bf11f75ac3c6d12753e51b07501">__OCI_LINUX_SECCOMP_SYSCALLS_ARGS_MAX</a>];</div>
<div class="line"><span class="lineno">  204</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *cur, *curn, *curarg;</div>
<div class="line"><span class="lineno">  205</span>    <span class="keywordtype">int</span> rem, remn, remargs, sc;</div>
<div class="line"><span class="lineno">  206</span>    <span class="keyword">struct </span>sock_filter *filter;</div>
<div class="line"><span class="lineno">  207</span>    <span class="keyword">struct </span>sock_fprog *prog;</div>
<div class="line"><span class="lineno">  208</span>    <span class="keywordtype">int</span> sz = 4, idx = 0;</div>
<div class="line"><span class="lineno">  209</span>    uint32_t default_policy = 0;</div>
<div class="line"><span class="lineno">  210</span>    uint32_t seccomp_arch;</div>
<div class="line"><span class="lineno">  211</span>    <span class="keywordtype">bool</span> arch_matched;</div>
<div class="line"><span class="lineno">  212</span>    <span class="keywordtype">char</span> *op_str;</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>    <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#ae2e350552680f6a95c57167deb867ff1">oci_linux_seccomp_policy</a>, <a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aa09a481995703db613622a4b45a9c9124">__OCI_LINUX_SECCOMP_MAX</a>,</div>
<div class="line"><span class="lineno">  215</span>              tb, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(msg), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a>(msg));</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>    <span class="keywordflow">if</span> (!tb[<a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aa412668793ef8889b9f0d50144e9c3c29">OCI_LINUX_SECCOMP_DEFAULTACTION</a>]) {</div>
<div class="line"><span class="lineno">  218</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;seccomp: no default action set\n&quot;</span>);</div>
<div class="line"><span class="lineno">  219</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  220</span>    }</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>    default_policy = <a class="code hl_function" href="#aa5c3a75ac3e60404d1158734452a4f66">resolve_action</a>(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aa412668793ef8889b9f0d50144e9c3c29">OCI_LINUX_SECCOMP_DEFAULTACTION</a>]));</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>    <span class="comment">/* verify architecture while ignoring the x86_64 anomaly for now */</span></div>
<div class="line"><span class="lineno">  225</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aae458d1f367df8d456464a1b290ec2f1f">OCI_LINUX_SECCOMP_ARCHITECTURES</a>]) {</div>
<div class="line"><span class="lineno">  226</span>        arch_matched = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  227</span>        <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, tb[<a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aae458d1f367df8d456464a1b290ec2f1f">OCI_LINUX_SECCOMP_ARCHITECTURES</a>], rem) {</div>
<div class="line"><span class="lineno">  228</span>            seccomp_arch = <a class="code hl_function" href="#a0436ecb75f262b8eef277e2861a97f9d">resolve_architecture</a>(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(cur));</div>
<div class="line"><span class="lineno">  229</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#a9da8e91d4a08fa12a91c38602dab4d07">ARCH_NR</a> == seccomp_arch) {</div>
<div class="line"><span class="lineno">  230</span>                arch_matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  231</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  232</span>            }</div>
<div class="line"><span class="lineno">  233</span>        }</div>
<div class="line"><span class="lineno">  234</span>        <span class="keywordflow">if</span> (!arch_matched) {</div>
<div class="line"><span class="lineno">  235</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;seccomp architecture doesn&#39;t match system\n&quot;</span>);</div>
<div class="line"><span class="lineno">  236</span>            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  237</span>        }</div>
<div class="line"><span class="lineno">  238</span>    }</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>    <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, tb[<a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aa184911ae3d78b8ea0375c56c4282d82f">OCI_LINUX_SECCOMP_SYSCALLS</a>], rem) {</div>
<div class="line"><span class="lineno">  241</span>        sz += 2; <span class="comment">/* load and return */</span></div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>        <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#a68a7dab872d9c5e1d3d582eaea30aa96">oci_linux_seccomp_syscalls_policy</a>,</div>
<div class="line"><span class="lineno">  244</span>                  <a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26afc3adc3411e4440e30f1f28c5dcee163">__OCI_LINUX_SECCOMP_SYSCALLS_MAX</a>,</div>
<div class="line"><span class="lineno">  245</span>                  tbn, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a>(cur));</div>
<div class="line"><span class="lineno">  246</span>        <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(curn, tbn[<a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a1efbc5bb9a94393a22cea27db34994f3">OCI_LINUX_SECCOMP_SYSCALLS_NAMES</a>], remn) {</div>
<div class="line"><span class="lineno">  247</span>            sc = <a class="code hl_function" href="../../d1/da1/seccomp-syscalls-helpers_8h.html#a36bb0594e5fe07e7d3f864680bc00bc0">find_syscall</a>(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(curn));</div>
<div class="line"><span class="lineno">  248</span>            <span class="keywordflow">if</span> (sc == -1) {</div>
<div class="line"><span class="lineno">  249</span>                <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;unknown syscall &#39;%s&#39;\n&quot;</span>, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(curn));</div>
<div class="line"><span class="lineno">  250</span>                <span class="comment">/* TODO: support run.oci.seccomp_fail_unknown_syscall=1 annotation */</span></div>
<div class="line"><span class="lineno">  251</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  252</span>            }</div>
<div class="line"><span class="lineno">  253</span>            ++sz;</div>
<div class="line"><span class="lineno">  254</span>        }</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>        <span class="keywordflow">if</span> (tbn[<a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a9c400808e68a191a65483332929d3ffe">OCI_LINUX_SECCOMP_SYSCALLS_ARGS</a>]) {</div>
<div class="line"><span class="lineno">  257</span>            <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(curarg, tbn[<a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a9c400808e68a191a65483332929d3ffe">OCI_LINUX_SECCOMP_SYSCALLS_ARGS</a>], remargs) {</div>
<div class="line"><span class="lineno">  258</span>                sz += 2; <span class="comment">/* load and compare */</span></div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>                <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#a0394a97ad911ae61d20e8147f801f098">oci_linux_seccomp_syscalls_args_policy</a>,</div>
<div class="line"><span class="lineno">  261</span>                          <a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a4edf5bf11f75ac3c6d12753e51b07501">__OCI_LINUX_SECCOMP_SYSCALLS_ARGS_MAX</a>,</div>
<div class="line"><span class="lineno">  262</span>                          tba, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(curarg), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a>(curarg));</div>
<div class="line"><span class="lineno">  263</span>                <span class="keywordflow">if</span> (!tba[<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a7e5fc851b7f8b56f87fe0639cafca197">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_INDEX</a>] ||</div>
<div class="line"><span class="lineno">  264</span>                    !tba[<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a2e5b128da6eb01c318cfe1aa68002985">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUE</a>] ||</div>
<div class="line"><span class="lineno">  265</span>                    !tba[<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3ae3d1fb54e12a7ae1d760a4424b0cb9c9">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_OP</a>])</div>
<div class="line"><span class="lineno">  266</span>                    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>                <span class="keywordflow">if</span> (<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tba[<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a7e5fc851b7f8b56f87fe0639cafca197">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_INDEX</a>]) &gt; 5)</div>
<div class="line"><span class="lineno">  269</span>                    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>                op_str = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tba[<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3ae3d1fb54e12a7ae1d760a4424b0cb9c9">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_OP</a>]);</div>
<div class="line"><span class="lineno">  272</span>                <span class="keywordflow">if</span> (!<a class="code hl_function" href="#a629da0c7d64e185e273c72f083630cb9">resolve_op_ins</a>(op_str))</div>
<div class="line"><span class="lineno">  273</span>                    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>                <span class="keywordflow">if</span> (<a class="code hl_function" href="#a459df353e08836d2ffe1001a8c4d289b">resolve_op_is_masked</a>(op_str))</div>
<div class="line"><span class="lineno">  276</span>                    ++sz; <span class="comment">/* SCMP_CMP_MASKED_EQ needs an extra BPF_AND op */</span></div>
<div class="line"><span class="lineno">  277</span>            }</div>
<div class="line"><span class="lineno">  278</span>        }</div>
<div class="line"><span class="lineno">  279</span>    }</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>    <span class="keywordflow">if</span> (sz &lt; 6)</div>
<div class="line"><span class="lineno">  282</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>    prog = malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> sock_fprog));</div>
<div class="line"><span class="lineno">  285</span>    <span class="keywordflow">if</span> (!prog)</div>
<div class="line"><span class="lineno">  286</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    filter = calloc(sz, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sock_filter));</div>
<div class="line"><span class="lineno">  289</span>    <span class="keywordflow">if</span> (!filter) {</div>
<div class="line"><span class="lineno">  290</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to allocate memory for seccomp filter\n&quot;</span>);</div>
<div class="line"><span class="lineno">  291</span>        <span class="keywordflow">goto</span> errout2;</div>
<div class="line"><span class="lineno">  292</span>    }</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>    <span class="comment">/* validate arch */</span></div>
<div class="line"><span class="lineno">  295</span>    <a class="code hl_function" href="../../d1/da1/seccomp-syscalls-helpers_8h.html#a424cd37001ea76755e223633962ff0f2">set_filter</a>(&amp;filter[idx++], BPF_LD + BPF_W + BPF_ABS, 0, 0, <a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#a592a24edbf34064620492ff0a808e801">arch_nr</a>);</div>
<div class="line"><span class="lineno">  296</span>    <a class="code hl_function" href="../../d1/da1/seccomp-syscalls-helpers_8h.html#a424cd37001ea76755e223633962ff0f2">set_filter</a>(&amp;filter[idx++], BPF_JMP + BPF_JEQ + BPF_K, 1, 0, <a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#a9da8e91d4a08fa12a91c38602dab4d07">ARCH_NR</a>);</div>
<div class="line"><span class="lineno">  297</span>    <a class="code hl_function" href="../../d1/da1/seccomp-syscalls-helpers_8h.html#a424cd37001ea76755e223633962ff0f2">set_filter</a>(&amp;filter[idx++], BPF_RET + BPF_K, 0, 0, <a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#a619615b5d03400ad2b882bd6c326833a">SECCOMP_RET_KILL</a>);</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>    <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, tb[<a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aa184911ae3d78b8ea0375c56c4282d82f">OCI_LINUX_SECCOMP_SYSCALLS</a>], rem) {</div>
<div class="line"><span class="lineno">  300</span>        uint32_t action;</div>
<div class="line"><span class="lineno">  301</span>        uint32_t op_idx;</div>
<div class="line"><span class="lineno">  302</span>        uint8_t op_ins;</div>
<div class="line"><span class="lineno">  303</span>        <span class="keywordtype">bool</span> op_inv, op_masked;</div>
<div class="line"><span class="lineno">  304</span>        uint64_t op_val, op_val2;</div>
<div class="line"><span class="lineno">  305</span>        <span class="keywordtype">int</span> start_rule_idx;</div>
<div class="line"><span class="lineno">  306</span>        <span class="keywordtype">int</span> next_rule_idx;</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>        <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#a68a7dab872d9c5e1d3d582eaea30aa96">oci_linux_seccomp_syscalls_policy</a>,</div>
<div class="line"><span class="lineno">  309</span>                  <a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26afc3adc3411e4440e30f1f28c5dcee163">__OCI_LINUX_SECCOMP_SYSCALLS_MAX</a>,</div>
<div class="line"><span class="lineno">  310</span>                  tbn, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a>(cur));</div>
<div class="line"><span class="lineno">  311</span>        action = <a class="code hl_function" href="#aa5c3a75ac3e60404d1158734452a4f66">resolve_action</a>(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(</div>
<div class="line"><span class="lineno">  312</span>                tbn[<a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a5eae989fa9d816f01d5f56207c0b8fa8">OCI_LINUX_SECCOMP_SYSCALLS_ACTION</a>]));</div>
<div class="line"><span class="lineno">  313</span>        <span class="keywordflow">if</span> (tbn[<a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a7a8319f7cebb28f8fd2cf6b0f5794e77">OCI_LINUX_SECCOMP_SYSCALLS_ERRNORET</a>]) {</div>
<div class="line"><span class="lineno">  314</span>            <span class="keywordflow">if</span> (action != <a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#a92f80ce4712ae91d9a1d2a533cd2276b">SECCOMP_RET_ERRNO</a>)</div>
<div class="line"><span class="lineno">  315</span>                <span class="keywordflow">goto</span> errout1;</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>            action = <a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#a6bbf6c27de9385b8a39b9e5de7220329">SECCOMP_RET_ERROR</a>(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(</div>
<div class="line"><span class="lineno">  318</span>                    tbn[<a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a7a8319f7cebb28f8fd2cf6b0f5794e77">OCI_LINUX_SECCOMP_SYSCALLS_ERRNORET</a>]));</div>
<div class="line"><span class="lineno">  319</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (action == <a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#a92f80ce4712ae91d9a1d2a533cd2276b">SECCOMP_RET_ERRNO</a>)</div>
<div class="line"><span class="lineno">  320</span>            action = <a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#a6bbf6c27de9385b8a39b9e5de7220329">SECCOMP_RET_ERROR</a>(EPERM);</div>
<div class="line"><span class="lineno">  321</span> </div>
<div class="line"><span class="lineno">  322</span>        <span class="comment">/* load syscall */</span></div>
<div class="line"><span class="lineno">  323</span>        <a class="code hl_function" href="../../d1/da1/seccomp-syscalls-helpers_8h.html#a424cd37001ea76755e223633962ff0f2">set_filter</a>(&amp;filter[idx++], BPF_LD + BPF_W + BPF_ABS, 0, 0, <a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#ac76a1d42a72c2d883554b922d6437dd0">syscall_nr</a>);</div>
<div class="line"><span class="lineno">  324</span> </div>
<div class="line"><span class="lineno">  325</span>        <span class="comment">/* get number of syscall names */</span></div>
<div class="line"><span class="lineno">  326</span>        next_rule_idx = idx;</div>
<div class="line"><span class="lineno">  327</span>        <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(curn, tbn[<a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a1efbc5bb9a94393a22cea27db34994f3">OCI_LINUX_SECCOMP_SYSCALLS_NAMES</a>], remn) {</div>
<div class="line"><span class="lineno">  328</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d1/da1/seccomp-syscalls-helpers_8h.html#a36bb0594e5fe07e7d3f864680bc00bc0">find_syscall</a>(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(curn)) == -1)</div>
<div class="line"><span class="lineno">  329</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>            ++next_rule_idx;</div>
<div class="line"><span class="lineno">  332</span>        }</div>
<div class="line"><span class="lineno">  333</span>        start_rule_idx = next_rule_idx;</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>        <span class="comment">/* calculate length of argument filter rules */</span></div>
<div class="line"><span class="lineno">  336</span>        <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(curn, tbn[<a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a9c400808e68a191a65483332929d3ffe">OCI_LINUX_SECCOMP_SYSCALLS_ARGS</a>], remn) {</div>
<div class="line"><span class="lineno">  337</span>            <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#a0394a97ad911ae61d20e8147f801f098">oci_linux_seccomp_syscalls_args_policy</a>,</div>
<div class="line"><span class="lineno">  338</span>                      <a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a4edf5bf11f75ac3c6d12753e51b07501">__OCI_LINUX_SECCOMP_SYSCALLS_ARGS_MAX</a>,</div>
<div class="line"><span class="lineno">  339</span>                      tba, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(curn), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a>(curn));</div>
<div class="line"><span class="lineno">  340</span>            next_rule_idx += 2;</div>
<div class="line"><span class="lineno">  341</span>            op_str = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tba[<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3ae3d1fb54e12a7ae1d760a4424b0cb9c9">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_OP</a>]);</div>
<div class="line"><span class="lineno">  342</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="#a459df353e08836d2ffe1001a8c4d289b">resolve_op_is_masked</a>(op_str))</div>
<div class="line"><span class="lineno">  343</span>                ++next_rule_idx;</div>
<div class="line"><span class="lineno">  344</span>        }</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>        ++next_rule_idx; <span class="comment">/* account for return action */</span></div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>        <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(curn, tbn[<a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a1efbc5bb9a94393a22cea27db34994f3">OCI_LINUX_SECCOMP_SYSCALLS_NAMES</a>], remn) {</div>
<div class="line"><span class="lineno">  349</span>            sc = <a class="code hl_function" href="../../d1/da1/seccomp-syscalls-helpers_8h.html#a36bb0594e5fe07e7d3f864680bc00bc0">find_syscall</a>(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(curn));</div>
<div class="line"><span class="lineno">  350</span>            <span class="keywordflow">if</span> (sc == -1)</div>
<div class="line"><span class="lineno">  351</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  352</span>            <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  353</span><span class="comment">             * check syscall, skip other syscall checks if match is found.</span></div>
<div class="line"><span class="lineno">  354</span><span class="comment">             * if no match is found, jump to next section</span></div>
<div class="line"><span class="lineno">  355</span><span class="comment">             */</span></div>
<div class="line"><span class="lineno">  356</span>            <a class="code hl_function" href="../../d1/da1/seccomp-syscalls-helpers_8h.html#a424cd37001ea76755e223633962ff0f2">set_filter</a>(&amp;filter[idx], BPF_JMP + BPF_JEQ + BPF_K,</div>
<div class="line"><span class="lineno">  357</span>                   start_rule_idx - (idx + 1),</div>
<div class="line"><span class="lineno">  358</span>                   ((idx + 1) == start_rule_idx)?(next_rule_idx - (idx + 1)):0,</div>
<div class="line"><span class="lineno">  359</span>                   sc);</div>
<div class="line"><span class="lineno">  360</span>            ++idx;</div>
<div class="line"><span class="lineno">  361</span>        }</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>        assert(idx = start_rule_idx);</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>        <span class="comment">/* generate argument filter rules */</span></div>
<div class="line"><span class="lineno">  366</span>        <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(curn, tbn[<a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a9c400808e68a191a65483332929d3ffe">OCI_LINUX_SECCOMP_SYSCALLS_ARGS</a>], remn) {</div>
<div class="line"><span class="lineno">  367</span>            <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#a0394a97ad911ae61d20e8147f801f098">oci_linux_seccomp_syscalls_args_policy</a>,</div>
<div class="line"><span class="lineno">  368</span>                      <a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a4edf5bf11f75ac3c6d12753e51b07501">__OCI_LINUX_SECCOMP_SYSCALLS_ARGS_MAX</a>,</div>
<div class="line"><span class="lineno">  369</span>                      tba, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(curn), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a>(curn));</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>            op_str = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tba[<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3ae3d1fb54e12a7ae1d760a4424b0cb9c9">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_OP</a>]);</div>
<div class="line"><span class="lineno">  372</span>            op_ins = <a class="code hl_function" href="#a629da0c7d64e185e273c72f083630cb9">resolve_op_ins</a>(op_str);</div>
<div class="line"><span class="lineno">  373</span>            op_inv = <a class="code hl_function" href="#ac9afb34481ea621a4fb776aa7da95e00">resolve_op_inv</a>(op_str);</div>
<div class="line"><span class="lineno">  374</span>            op_masked = <a class="code hl_function" href="#a459df353e08836d2ffe1001a8c4d289b">resolve_op_is_masked</a>(op_str);</div>
<div class="line"><span class="lineno">  375</span>            op_idx = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tba[<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a7e5fc851b7f8b56f87fe0639cafca197">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_INDEX</a>]);</div>
<div class="line"><span class="lineno">  376</span>            op_val = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a8f13b26eaebcdf626e534b33f887925c">blobmsg_cast_u64</a>(tba[<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a2e5b128da6eb01c318cfe1aa68002985">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUE</a>]);</div>
<div class="line"><span class="lineno">  377</span>            <span class="keywordflow">if</span> (tba[<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a08bf505c4afd3c95c92bb4fa3a42fd6e">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUETWO</a>])</div>
<div class="line"><span class="lineno">  378</span>                op_val2 = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a8f13b26eaebcdf626e534b33f887925c">blobmsg_cast_u64</a>(tba[<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a08bf505c4afd3c95c92bb4fa3a42fd6e">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUETWO</a>]);</div>
<div class="line"><span class="lineno">  379</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  380</span>                op_val2 = 0;</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>            <span class="comment">/* load argument */</span></div>
<div class="line"><span class="lineno">  383</span>            <a class="code hl_function" href="../../d1/da1/seccomp-syscalls-helpers_8h.html#a424cd37001ea76755e223633962ff0f2">set_filter</a>(&amp;filter[idx++], BPF_LD + BPF_W + BPF_ABS, 0, 0, <a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#ad355e76cdd2d66e7ffd64e7a86dc6d8f">syscall_arg</a>(op_idx));</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>            <span class="comment">/* apply mask */</span></div>
<div class="line"><span class="lineno">  386</span>            <span class="keywordflow">if</span> (op_masked)</div>
<div class="line"><span class="lineno">  387</span>                <a class="code hl_function" href="../../d1/da1/seccomp-syscalls-helpers_8h.html#a424cd37001ea76755e223633962ff0f2">set_filter</a>(&amp;filter[idx++], BPF_ALU + BPF_K + BPF_AND, 0, 0, op_val);</div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span>            <a class="code hl_function" href="../../d1/da1/seccomp-syscalls-helpers_8h.html#a424cd37001ea76755e223633962ff0f2">set_filter</a>(&amp;filter[idx], BPF_JMP + op_ins + BPF_K,</div>
<div class="line"><span class="lineno">  390</span>                   op_inv?(next_rule_idx - (idx + 1)):0,</div>
<div class="line"><span class="lineno">  391</span>                   op_inv?0:(next_rule_idx - (idx + 1)),</div>
<div class="line"><span class="lineno">  392</span>                   op_masked?op_val2:op_val);</div>
<div class="line"><span class="lineno">  393</span>            ++idx;</div>
<div class="line"><span class="lineno">  394</span>        }</div>
<div class="line"><span class="lineno">  395</span> </div>
<div class="line"><span class="lineno">  396</span>        <span class="comment">/* if we have reached until here, all conditions were met and we can return */</span></div>
<div class="line"><span class="lineno">  397</span>        <a class="code hl_function" href="../../d1/da1/seccomp-syscalls-helpers_8h.html#a424cd37001ea76755e223633962ff0f2">set_filter</a>(&amp;filter[idx++], BPF_RET + BPF_K, 0, 0, action);</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>        assert(idx == next_rule_idx);</div>
<div class="line"><span class="lineno">  400</span>    }</div>
<div class="line"><span class="lineno">  401</span> </div>
<div class="line"><span class="lineno">  402</span>    <a class="code hl_function" href="../../d1/da1/seccomp-syscalls-helpers_8h.html#a424cd37001ea76755e223633962ff0f2">set_filter</a>(&amp;filter[idx++], BPF_RET + BPF_K, 0, 0, default_policy);</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>    assert(idx == sz);</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>    prog-&gt;len = (<span class="keywordtype">unsigned</span> short) idx;</div>
<div class="line"><span class="lineno">  407</span>    prog-&gt;filter = filter;</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>    <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;generated seccomp-bpf program:\n&quot;</span>);</div>
<div class="line"><span class="lineno">  410</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d8/d60/init_8c.html#aa3770535f39c67ca0811e27731893370">debug</a>) {</div>
<div class="line"><span class="lineno">  411</span>        fprintf(stderr, <span class="stringliteral">&quot; [idx]\tcode\t jt\t jf\tk\n&quot;</span>);</div>
<div class="line"><span class="lineno">  412</span>        <span class="keywordflow">for</span> (idx=0; idx&lt;sz; idx++)</div>
<div class="line"><span class="lineno">  413</span>            fprintf(stderr, <span class="stringliteral">&quot; [%03d]\t%04hx\t%3hhu\t%3hhu\t%08x\n&quot;</span>, idx,</div>
<div class="line"><span class="lineno">  414</span>                filter[idx].code,</div>
<div class="line"><span class="lineno">  415</span>                filter[idx].jt,</div>
<div class="line"><span class="lineno">  416</span>                filter[idx].jf,</div>
<div class="line"><span class="lineno">  417</span>                filter[idx].k);</div>
<div class="line"><span class="lineno">  418</span>    }</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span>    <span class="keywordflow">return</span> prog;</div>
<div class="line"><span class="lineno">  421</span> </div>
<div class="line"><span class="lineno">  422</span>errout1:</div>
<div class="line"><span class="lineno">  423</span>    free(prog-&gt;filter);</div>
<div class="line"><span class="lineno">  424</span>errout2:</div>
<div class="line"><span class="lineno">  425</span>    free(prog);</div>
<div class="line"><span class="lineno">  426</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  427</span>}</div>
<div class="ttc" id="ablob_8h_html_dc/dd9/structblob__attr"><div class="ttname"><a href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a></div><div class="ttdef"><b>Definition</b> <a href="../../d8/d3c/blob_8h_source.html#l00052">blob.h:52</a></div></div>
<div class="ttc" id="ablobmsg_8c_html_afb56b36905412b6618a529c171e833ed"><div class="ttname"><a href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a></div><div class="ttdeci">int blobmsg_parse(const struct blobmsg_policy *policy, int policy_len, struct blob_attr **tb, void *data, unsigned int len)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d30/blobmsg_8c_source.html#l00166">blobmsg.c:166</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a2646be9952a62787018f5760ce95fdd5"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a></div><div class="ttdeci">static size_t blobmsg_len(const struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00108">blobmsg.h:108</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a69a81065d5c7977bc26fbd093f21a132"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a></div><div class="ttdeci">#define blobmsg_for_each_attr(pos, attr, rem)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00364">blobmsg.h:364</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a6c1cc8e52e96bf9698f6b0f65ad48603"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a></div><div class="ttdeci">static char * blobmsg_get_string(struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00348">blobmsg.h:348</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a856562b4d96007d3ce1a052998451a0f"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a></div><div class="ttdeci">static uint32_t blobmsg_get_u32(struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00293">blobmsg.h:293</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a8f13b26eaebcdf626e534b33f887925c"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a8f13b26eaebcdf626e534b33f887925c">blobmsg_cast_u64</a></div><div class="ttdeci">static uint64_t blobmsg_cast_u64(struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00306">blobmsg.h:306</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_ab788ffb2ae75d047fa39be6e79571d20"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a></div><div class="ttdeci">static void * blobmsg_data(const struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00078">blobmsg.h:78</a></div></div>
<div class="ttc" id="ainit_8c_html_aa3770535f39c67ca0811e27731893370"><div class="ttname"><a href="../../d8/d60/init_8c.html#aa3770535f39c67ca0811e27731893370">debug</a></div><div class="ttdeci">unsigned int debug</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d60/init_8c_source.html#l00042">init.c:42</a></div></div>
<div class="ttc" id="aseccomp-bpf_8h_html_a592a24edbf34064620492ff0a808e801"><div class="ttname"><a href="../../d0/dbd/seccomp-bpf_8h.html#a592a24edbf34064620492ff0a808e801">arch_nr</a></div><div class="ttdeci">#define arch_nr</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dbd/seccomp-bpf_8h_source.html#l00064">seccomp-bpf.h:64</a></div></div>
<div class="ttc" id="aseccomp-bpf_8h_html_a619615b5d03400ad2b882bd6c326833a"><div class="ttname"><a href="../../d0/dbd/seccomp-bpf_8h.html#a619615b5d03400ad2b882bd6c326833a">SECCOMP_RET_KILL</a></div><div class="ttdeci">#define SECCOMP_RET_KILL</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dbd/seccomp-bpf_8h_source.html#l00040">seccomp-bpf.h:40</a></div></div>
<div class="ttc" id="aseccomp-bpf_8h_html_a6bbf6c27de9385b8a39b9e5de7220329"><div class="ttname"><a href="../../d0/dbd/seccomp-bpf_8h.html#a6bbf6c27de9385b8a39b9e5de7220329">SECCOMP_RET_ERROR</a></div><div class="ttdeci">#define SECCOMP_RET_ERROR(x)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dbd/seccomp-bpf_8h_source.html#l00048">seccomp-bpf.h:48</a></div></div>
<div class="ttc" id="aseccomp-bpf_8h_html_a92f80ce4712ae91d9a1d2a533cd2276b"><div class="ttname"><a href="../../d0/dbd/seccomp-bpf_8h.html#a92f80ce4712ae91d9a1d2a533cd2276b">SECCOMP_RET_ERRNO</a></div><div class="ttdeci">#define SECCOMP_RET_ERRNO</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dbd/seccomp-bpf_8h_source.html#l00042">seccomp-bpf.h:42</a></div></div>
<div class="ttc" id="aseccomp-bpf_8h_html_a9da8e91d4a08fa12a91c38602dab4d07"><div class="ttname"><a href="../../d0/dbd/seccomp-bpf_8h.html#a9da8e91d4a08fa12a91c38602dab4d07">ARCH_NR</a></div><div class="ttdeci">#define ARCH_NR</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dbd/seccomp-bpf_8h_source.html#l00096">seccomp-bpf.h:96</a></div></div>
<div class="ttc" id="aseccomp-bpf_8h_html_ac76a1d42a72c2d883554b922d6437dd0"><div class="ttname"><a href="../../d0/dbd/seccomp-bpf_8h.html#ac76a1d42a72c2d883554b922d6437dd0">syscall_nr</a></div><div class="ttdeci">#define syscall_nr</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dbd/seccomp-bpf_8h_source.html#l00063">seccomp-bpf.h:63</a></div></div>
<div class="ttc" id="aseccomp-bpf_8h_html_ad355e76cdd2d66e7ffd64e7a86dc6d8f"><div class="ttname"><a href="../../d0/dbd/seccomp-bpf_8h.html#ad355e76cdd2d66e7ffd64e7a86dc6d8f">syscall_arg</a></div><div class="ttdeci">#define syscall_arg(x)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dbd/seccomp-bpf_8h_source.html#l00065">seccomp-bpf.h:65</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_a0394a97ad911ae61d20e8147f801f098"><div class="ttname"><a href="#a0394a97ad911ae61d20e8147f801f098">oci_linux_seccomp_syscalls_args_policy</a></div><div class="ttdeci">static const struct blobmsg_policy oci_linux_seccomp_syscalls_args_policy[]</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00192">seccomp-oci.c:192</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_a0436ecb75f262b8eef277e2861a97f9d"><div class="ttname"><a href="#a0436ecb75f262b8eef277e2861a97f9d">resolve_architecture</a></div><div class="ttdeci">static uint32_t resolve_architecture(char *archname)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00103">seccomp-oci.c:103</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_a459df353e08836d2ffe1001a8c4d289b"><div class="ttname"><a href="#a459df353e08836d2ffe1001a8c4d289b">resolve_op_is_masked</a></div><div class="ttdeci">static bool resolve_op_is_masked(const char *op)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00085">seccomp-oci.c:85</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_a629da0c7d64e185e273c72f083630cb9"><div class="ttname"><a href="#a629da0c7d64e185e273c72f083630cb9">resolve_op_ins</a></div><div class="ttdeci">static uint8_t resolve_op_ins(const char *op)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00063">seccomp-oci.c:63</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_a68a7dab872d9c5e1d3d582eaea30aa96"><div class="ttname"><a href="#a68a7dab872d9c5e1d3d582eaea30aa96">oci_linux_seccomp_syscalls_policy</a></div><div class="ttdeci">static const struct blobmsg_policy oci_linux_seccomp_syscalls_policy[]</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00177">seccomp-oci.c:177</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_aa5c3a75ac3e60404d1158734452a4f66"><div class="ttname"><a href="#aa5c3a75ac3e60404d1158734452a4f66">resolve_action</a></div><div class="ttdeci">static uint32_t resolve_action(char *actname)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00039">seccomp-oci.c:39</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_ac9afb34481ea621a4fb776aa7da95e00"><div class="ttname"><a href="#ac9afb34481ea621a4fb776aa7da95e00">resolve_op_inv</a></div><div class="ttdeci">static bool resolve_op_inv(const char *op)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00093">seccomp-oci.c:93</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_ae2e350552680f6a95c57167deb867ff1"><div class="ttname"><a href="#ae2e350552680f6a95c57167deb867ff1">oci_linux_seccomp_policy</a></div><div class="ttdeci">static const struct blobmsg_policy oci_linux_seccomp_policy[]</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00162">seccomp-oci.c:162</a></div></div>
<div class="ttc" id="aseccomp-syscalls-helpers_8h_html_a36bb0594e5fe07e7d3f864680bc00bc0"><div class="ttname"><a href="../../d1/da1/seccomp-syscalls-helpers_8h.html#a36bb0594e5fe07e7d3f864680bc00bc0">find_syscall</a></div><div class="ttdeci">static int find_syscall(const char *name)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/da1/seccomp-syscalls-helpers_8h_source.html#l00016">seccomp-syscalls-helpers.h:16</a></div></div>
<div class="ttc" id="aseccomp-syscalls-helpers_8h_html_a424cd37001ea76755e223633962ff0f2"><div class="ttname"><a href="../../d1/da1/seccomp-syscalls-helpers_8h.html#a424cd37001ea76755e223633962ff0f2">set_filter</a></div><div class="ttdeci">static void set_filter(struct sock_filter *filter, __u16 code, __u8 jt, __u8 jf, __u32 k)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/da1/seccomp-syscalls-helpers_8h_source.html#l00029">seccomp-syscalls-helpers.h:29</a></div></div>
<div class="ttc" id="asystem-dummy_8c_html_ad72dbcf6d0153db1b8d8a58001feed83"><div class="ttname"><a href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a></div><div class="ttdeci">#define DEBUG</div><div class="ttdef"><b>Definition</b> <a href="../../da/d12/system-dummy_8c_source.html#l00021">system-dummy.c:21</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00159">__OCI_LINUX_SECCOMP_MAX</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00189">__OCI_LINUX_SECCOMP_SYSCALLS_ARGS_MAX</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00174">__OCI_LINUX_SECCOMP_SYSCALLS_MAX</a>, <a class="el" href="../../d0/dbd/seccomp-bpf_8h_source.html#l00096">ARCH_NR</a>, <a class="el" href="../../d0/dbd/seccomp-bpf_8h_source.html#l00064">arch_nr</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00306">blobmsg_cast_u64()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00078">blobmsg_data()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00364">blobmsg_for_each_attr</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00348">blobmsg_get_string()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00293">blobmsg_get_u32()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00108">blobmsg_len()</a>, <a class="el" href="../../d1/d30/blobmsg_8c_source.html#l00166">blobmsg_parse()</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../d8/d60/init_8c_source.html#l00042">debug</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../d1/da1/seccomp-syscalls-helpers_8h_source.html#l00016">find_syscall()</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00156">OCI_LINUX_SECCOMP_ARCHITECTURES</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00155">OCI_LINUX_SECCOMP_DEFAULTACTION</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00162">oci_linux_seccomp_policy</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00158">OCI_LINUX_SECCOMP_SYSCALLS</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00171">OCI_LINUX_SECCOMP_SYSCALLS_ACTION</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00173">OCI_LINUX_SECCOMP_SYSCALLS_ARGS</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00185">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_INDEX</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00188">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_OP</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00192">oci_linux_seccomp_syscalls_args_policy</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00186">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUE</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00187">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUETWO</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00172">OCI_LINUX_SECCOMP_SYSCALLS_ERRNORET</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00170">OCI_LINUX_SECCOMP_SYSCALLS_NAMES</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00177">oci_linux_seccomp_syscalls_policy</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00039">resolve_action()</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00103">resolve_architecture()</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00063">resolve_op_ins()</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00093">resolve_op_inv()</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00085">resolve_op_is_masked()</a>, <a class="el" href="../../d0/dbd/seccomp-bpf_8h_source.html#l00042">SECCOMP_RET_ERRNO</a>, <a class="el" href="../../d0/dbd/seccomp-bpf_8h_source.html#l00048">SECCOMP_RET_ERROR</a>, <a class="el" href="../../d0/dbd/seccomp-bpf_8h_source.html#l00040">SECCOMP_RET_KILL</a>, <a class="el" href="../../d1/da1/seccomp-syscalls-helpers_8h_source.html#l00029">set_filter()</a>, <a class="el" href="../../d0/dbd/seccomp-bpf_8h_source.html#l00065">syscall_arg</a>, and <a class="el" href="../../d0/dbd/seccomp-bpf_8h_source.html#l00063">syscall_nr</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d4f/seccomp_8c_source.html#l00025">install_syscall_filter()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l02198">parseOCIlinux()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d8/da1/seccomp-oci_8c_ac693b398071b4ee41b25e6b9d117803c_cgraph.png" border="0" usemap="#ad8/da1/seccomp-oci_8c_ac693b398071b4ee41b25e6b9d117803c_cgraph" alt=""/></div>
<map name="ad8/da1/seccomp-oci_8c_ac693b398071b4ee41b25e6b9d117803c_cgraph" id="ad8/da1/seccomp-oci_8c_ac693b398071b4ee41b25e6b9d117803c_cgraph">
<area shape="rect" title=" " alt="" coords="5,435,240,469"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a8f13b26eaebcdf626e534b33f887925c" title=" " alt="" coords="585,154,778,187"/>
<area shape="poly" title=" " alt="" coords="127,433,146,386,179,323,200,290,225,259,254,230,286,207,320,190,355,177,429,160,502,154,569,155,569,160,502,159,429,165,356,182,322,195,289,211,257,234,229,262,204,294,183,326,151,389,132,435"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="1125,262,1276,295"/>
<area shape="poly" title=" " alt="" coords="126,434,143,380,175,307,197,268,222,229,252,194,286,163,359,114,426,80,488,59,550,47,684,37,762,32,851,24,905,14,949,5,991,5,1015,12,1041,24,1072,45,1099,71,1123,100,1143,132,1173,194,1192,246,1187,247,1169,196,1138,134,1118,104,1095,75,1068,49,1038,29,1013,17,991,11,949,10,906,19,852,29,762,38,684,42,551,52,490,64,428,85,362,118,289,167,256,197,226,232,201,270,180,309,148,382,131,435"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f" title=" " alt="" coords="853,211,1038,245"/>
<area shape="poly" title=" " alt="" coords="133,433,157,400,192,360,236,318,286,285,356,257,429,236,503,221,578,212,719,207,837,212,837,218,719,212,578,217,504,226,430,241,358,262,289,290,239,323,195,363,161,404,137,436"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603" title=" " alt="" coords="580,266,783,299"/>
<area shape="poly" title=" " alt="" coords="139,433,200,379,242,351,287,328,356,306,429,291,500,282,564,279,565,284,500,288,430,296,358,311,289,333,244,355,203,383,142,437"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5" title=" " alt="" coords="613,323,751,357"/>
<area shape="poly" title=" " alt="" coords="147,432,209,395,247,377,287,363,368,345,451,336,529,332,597,333,597,338,529,337,451,341,369,350,288,368,249,382,211,400,150,437"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed" title=" " alt="" coords="319,378,481,411"/>
<area shape="poly" title=" " alt="" coords="207,432,303,412,304,417,208,437"/>
<area shape="rect" href="../../d1/da1/seccomp-syscalls-helpers_8h.html#a36bb0594e5fe07e7d3f864680bc00bc0" title=" " alt="" coords="336,435,464,469"/>
<area shape="poly" title=" " alt="" coords="240,449,320,449,320,454,240,454"/>
<area shape="rect" href="../../d8/da1/seccomp-oci_8c.html#aa5c3a75ac3e60404d1158734452a4f66" title=" " alt="" coords="324,492,476,526"/>
<area shape="poly" title=" " alt="" coords="208,467,309,488,308,493,207,472"/>
<area shape="rect" href="../../d8/da1/seccomp-oci_8c.html#a0436ecb75f262b8eef277e2861a97f9d" title=" " alt="" coords="297,550,503,583"/>
<area shape="poly" title=" " alt="" coords="153,467,214,502,289,536,306,542,305,547,287,541,212,506,151,472"/>
<area shape="rect" href="../../d8/da1/seccomp-oci_8c.html#a629da0c7d64e185e273c72f083630cb9" title=" " alt="" coords="322,607,478,641"/>
<area shape="poly" title=" " alt="" coords="140,467,201,529,243,564,289,593,309,602,306,607,286,598,240,568,197,533,136,471"/>
<area shape="rect" href="../../d8/da1/seccomp-oci_8c.html#ac9afb34481ea621a4fb776aa7da95e00" title=" " alt="" coords="322,664,478,698"/>
<area shape="poly" title=" " alt="" coords="135,468,157,506,192,556,236,607,262,631,289,651,308,661,306,666,286,655,258,635,232,611,187,559,153,509,130,470"/>
<area shape="rect" href="../../d8/da1/seccomp-oci_8c.html#a459df353e08836d2ffe1001a8c4d289b" title=" " alt="" coords="288,722,512,755"/>
<area shape="poly" title=" " alt="" coords="132,468,151,516,184,582,230,650,258,682,289,708,294,712,291,716,286,713,254,685,226,654,179,584,146,519,127,470"/>
<area shape="rect" href="../../d1/da1/seccomp-syscalls-helpers_8h.html#a424cd37001ea76755e223633962ff0f2" title=" " alt="" coords="349,779,451,813"/>
<area shape="poly" title=" " alt="" coords="130,468,146,526,176,607,197,650,223,693,254,732,289,766,311,778,335,787,333,792,308,783,286,770,250,736,219,696,193,653,171,609,141,528,125,470"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a38fb5688af8a7f3e9eae5c653ed2bb50" title=" " alt="" coords="853,39,1038,73"/>
<area shape="poly" title=" " alt="" coords="711,151,774,117,850,81,865,76,867,81,852,86,777,121,714,155"/>
<area shape="poly" title=" " alt="" coords="763,185,851,205,849,210,762,191"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab631ab3a5e71a8742449cd374a63ecec" title=" " alt="" coords="853,96,1038,130"/>
<area shape="poly" title=" " alt="" coords="762,150,849,131,851,136,763,156"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#af2c32f6db6f49388da60dda520d86c4d" title=" " alt="" coords="859,154,1032,187"/>
<area shape="poly" title=" " alt="" coords="779,168,843,168,843,173,779,173"/>
<area shape="poly" title=" " alt="" coords="1021,71,1041,82,1088,120,1128,164,1160,209,1184,246,1180,249,1156,212,1124,168,1084,124,1038,86,1018,75"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="1401,319,1512,353"/>
<area shape="poly" title=" " alt="" coords="1277,293,1386,317,1385,323,1276,298"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="1366,376,1547,410"/>
<area shape="poly" title=" " alt="" coords="1230,293,1290,328,1362,363,1377,368,1375,373,1360,368,1287,332,1228,298"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ac239a83ed3c7f835e2b49f785953c934" title=" " alt="" coords="1371,262,1541,295"/>
<area shape="poly" title=" " alt="" coords="1277,276,1356,276,1356,281,1277,281"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a7613e130753e766f5d381c06b1f7b86f" title=" " alt="" coords="1361,434,1551,467"/>
<area shape="poly" title=" " alt="" coords="1218,294,1277,356,1318,390,1362,420,1371,425,1369,429,1360,425,1314,394,1273,359,1214,298"/>
<area shape="poly" title=" " alt="" coords="1034,243,1110,258,1109,263,1033,248"/>
<area shape="poly" title=" " alt="" coords="1017,128,1041,139,1080,164,1117,193,1175,248,1172,252,1114,197,1077,168,1038,143,1015,133"/>
<area shape="poly" title=" " alt="" coords="1011,185,1041,196,1102,223,1157,252,1154,256,1100,228,1039,201,1009,190"/>
<area shape="poly" title=" " alt="" coords="784,279,1109,276,1109,282,784,284"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052" title=" " alt="" coords="851,422,1040,455"/>
<area shape="poly" title=" " alt="" coords="730,355,885,413,883,418,728,360"/>
<area shape="poly" title=" " alt="" coords="998,419,1038,400,1163,303,1166,307,1041,405,1001,423"/>
<area shape="poly" title=" " alt="" coords="1030,418,1087,407,1384,347,1386,352,1088,412,1031,424"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a9921d2b89577d3344abbb66f24773e32" title=" " alt="" coords="1407,491,1505,525"/>
<area shape="poly" title=" " alt="" coords="1025,453,1088,465,1252,487,1392,500,1391,505,1252,492,1087,470,1024,459"/>
<area shape="poly" title=" " alt="" coords="482,387,1385,337,1385,342,482,393"/>
<area shape="poly" title=" " alt="" coords="483,401,499,409,514,421,533,448,541,476,541,505,537,533,534,560,534,587,542,613,562,638,618,683,672,712,725,726,779,730,836,724,897,713,1039,683,1124,669,1190,655,1220,645,1249,629,1279,606,1311,575,1325,556,1331,537,1333,498,1336,459,1344,439,1359,419,1361,418,1364,422,1363,423,1348,442,1341,460,1339,498,1337,538,1329,558,1315,579,1283,610,1252,633,1222,649,1192,660,1125,674,1040,688,898,718,837,730,780,735,724,732,670,717,615,688,558,642,538,615,529,588,529,560,532,532,536,504,536,477,528,451,510,424,496,414,480,406"/>
<area shape="poly" title=" " alt="" coords="483,400,499,409,514,421,529,441,539,461,547,503,543,544,534,585,525,625,523,664,526,682,533,700,545,718,562,735,609,773,657,805,704,830,752,850,799,865,846,873,893,877,940,875,987,867,1034,855,1080,837,1127,815,1173,788,1219,756,1311,679,1329,656,1337,632,1338,607,1336,582,1333,556,1334,529,1341,503,1359,477,1360,475,1364,479,1363,480,1346,505,1339,530,1338,555,1341,581,1344,607,1343,633,1334,658,1315,683,1222,761,1176,793,1129,820,1082,842,1035,860,988,873,940,880,893,882,845,879,798,870,750,855,702,835,654,809,606,777,558,739,541,721,529,703,521,684,518,664,520,624,529,584,538,543,542,503,534,463,525,444,510,424,496,413,480,405"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#ac79cacbc6a47f754832dc10bafa3b761" title=" " alt="" coords="902,639,989,673"/>
<area shape="poly" title=" " alt="" coords="483,403,514,420,526,433,533,446,539,471,545,496,551,508,562,521,599,550,640,574,684,595,728,611,814,635,887,647,886,652,813,640,727,616,682,600,638,579,596,554,558,524,547,511,540,498,534,472,528,448,521,436,510,425,480,408"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5a5283071ac5677652515d9a8460e655" title=" " alt="" coords="560,476,803,510"/>
<area shape="poly" title=" " alt="" coords="477,409,513,420,631,467,629,472,511,425,476,414"/>
<area shape="poly" title=" " alt="" coords="714,473,850,407,1001,346,1132,298,1134,303,1003,351,852,412,717,478"/>
<area shape="poly" title=" " alt="" coords="766,473,845,456,846,462,767,478"/>
<area shape="poly" title=" " alt="" coords="709,508,805,582,828,605,853,626,888,640,886,645,850,630,824,609,802,586,706,513"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6b6c429265d86411d05951d2fae7289a" title=" " alt="" coords="858,582,1033,615"/>
<area shape="poly" title=" " alt="" coords="726,508,852,560,886,573,884,578,850,565,724,513"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a2c4753820a7472bba7b999fbba79df01" title=" " alt="" coords="1130,531,1271,565"/>
<area shape="poly" title=" " alt="" coords="804,504,852,509,1114,537,1114,542,851,514,804,509"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a131936c081164c18e6241d79f3b276d1" title=" " alt="" coords="1088,422,1313,455"/>
<area shape="poly" title=" " alt="" coords="804,485,918,477,1039,465,1099,456,1100,461,1040,470,919,483,804,491"/>
<area shape="poly" title=" " alt="" coords="1271,534,1391,515,1392,520,1272,539"/>
<area shape="poly" title=" " alt="" coords="1268,419,1312,400,1335,381,1360,362,1385,351,1387,355,1362,366,1339,385,1314,405,1270,423"/>
<area shape="poly" title=" " alt="" coords="1299,418,1350,409,1351,414,1300,424"/>
<area shape="poly" title=" " alt="" coords="1216,419,1276,363,1316,332,1360,304,1370,299,1372,304,1362,309,1319,336,1279,367,1220,423"/>
<area shape="poly" title=" " alt="" coords="1314,441,1345,443,1345,448,1313,446"/>
<area shape="poly" title=" " alt="" coords="1266,453,1393,488,1391,493,1265,459"/>
</map>
</div>

</div>
</div>
<a id="aa5c3a75ac3e60404d1158734452a4f66" name="aa5c3a75ac3e60404d1158734452a4f66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5c3a75ac3e60404d1158734452a4f66">&#9670;&#160;</a></span>resolve_action()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint32_t resolve_action </td>
          <td>(</td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>actname</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00039">39</a> of file <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html">seccomp-oci.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   40</span>{</div>
<div class="line"><span class="lineno">   41</span>    <span class="keywordflow">if</span> (!strcmp(actname, <span class="stringliteral">&quot;SCMP_ACT_KILL&quot;</span>))</div>
<div class="line"><span class="lineno">   42</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#a619615b5d03400ad2b882bd6c326833a">SECCOMP_RET_KILL</a>;</div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(actname, <span class="stringliteral">&quot;SCMP_ACT_KILL_PROCESS&quot;</span>))</div>
<div class="line"><span class="lineno">   44</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#adfdb0082b55b0cfde167d46dde10ee3d">SECCOMP_RET_KILLPROCESS</a>;</div>
<div class="line"><span class="lineno">   45</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(actname, <span class="stringliteral">&quot;SCMP_ACT_TRAP&quot;</span>))</div>
<div class="line"><span class="lineno">   46</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#a64c96f849fe312dd777a8dbe683dda8a">SECCOMP_RET_TRAP</a>;</div>
<div class="line"><span class="lineno">   47</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(actname, <span class="stringliteral">&quot;SCMP_ACT_ERRNO&quot;</span>))</div>
<div class="line"><span class="lineno">   48</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#a92f80ce4712ae91d9a1d2a533cd2276b">SECCOMP_RET_ERRNO</a>;</div>
<div class="line"><span class="lineno">   49</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(actname, <span class="stringliteral">&quot;SCMP_ACT_ERROR&quot;</span>))</div>
<div class="line"><span class="lineno">   50</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#a92f80ce4712ae91d9a1d2a533cd2276b">SECCOMP_RET_ERRNO</a>;</div>
<div class="line"><span class="lineno">   51</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(actname, <span class="stringliteral">&quot;SCMP_ACT_TRACE&quot;</span>))</div>
<div class="line"><span class="lineno">   52</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#ae4e1ff683860f0e07b79a24fd12f249f">SECCOMP_RET_TRACE</a>;</div>
<div class="line"><span class="lineno">   53</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(actname, <span class="stringliteral">&quot;SCMP_ACT_ALLOW&quot;</span>))</div>
<div class="line"><span class="lineno">   54</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#a6b3bae4baa7f2871919c5a169fa33ba8">SECCOMP_RET_ALLOW</a>;</div>
<div class="line"><span class="lineno">   55</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(actname, <span class="stringliteral">&quot;SCMP_ACT_LOG&quot;</span>))</div>
<div class="line"><span class="lineno">   56</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#abfc5731b25d3624667c63ab9d6f5f3df">SECCOMP_RET_LOGALLOW</a>;</div>
<div class="line"><span class="lineno">   57</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   58</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;unknown seccomp action %s\n&quot;</span>, actname);</div>
<div class="line"><span class="lineno">   59</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../d0/dbd/seccomp-bpf_8h.html#a619615b5d03400ad2b882bd6c326833a">SECCOMP_RET_KILL</a>;</div>
<div class="line"><span class="lineno">   60</span>    }</div>
<div class="line"><span class="lineno">   61</span>}</div>
<div class="ttc" id="aseccomp-bpf_8h_html_a64c96f849fe312dd777a8dbe683dda8a"><div class="ttname"><a href="../../d0/dbd/seccomp-bpf_8h.html#a64c96f849fe312dd777a8dbe683dda8a">SECCOMP_RET_TRAP</a></div><div class="ttdeci">#define SECCOMP_RET_TRAP</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dbd/seccomp-bpf_8h_source.html#l00041">seccomp-bpf.h:41</a></div></div>
<div class="ttc" id="aseccomp-bpf_8h_html_a6b3bae4baa7f2871919c5a169fa33ba8"><div class="ttname"><a href="../../d0/dbd/seccomp-bpf_8h.html#a6b3bae4baa7f2871919c5a169fa33ba8">SECCOMP_RET_ALLOW</a></div><div class="ttdeci">#define SECCOMP_RET_ALLOW</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dbd/seccomp-bpf_8h_source.html#l00046">seccomp-bpf.h:46</a></div></div>
<div class="ttc" id="aseccomp-bpf_8h_html_abfc5731b25d3624667c63ab9d6f5f3df"><div class="ttname"><a href="../../d0/dbd/seccomp-bpf_8h.html#abfc5731b25d3624667c63ab9d6f5f3df">SECCOMP_RET_LOGALLOW</a></div><div class="ttdeci">#define SECCOMP_RET_LOGALLOW</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dbd/seccomp-bpf_8h_source.html#l00044">seccomp-bpf.h:44</a></div></div>
<div class="ttc" id="aseccomp-bpf_8h_html_adfdb0082b55b0cfde167d46dde10ee3d"><div class="ttname"><a href="../../d0/dbd/seccomp-bpf_8h.html#adfdb0082b55b0cfde167d46dde10ee3d">SECCOMP_RET_KILLPROCESS</a></div><div class="ttdeci">#define SECCOMP_RET_KILLPROCESS</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dbd/seccomp-bpf_8h_source.html#l00047">seccomp-bpf.h:47</a></div></div>
<div class="ttc" id="aseccomp-bpf_8h_html_ae4e1ff683860f0e07b79a24fd12f249f"><div class="ttname"><a href="../../d0/dbd/seccomp-bpf_8h.html#ae4e1ff683860f0e07b79a24fd12f249f">SECCOMP_RET_TRACE</a></div><div class="ttdeci">#define SECCOMP_RET_TRACE</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dbd/seccomp-bpf_8h_source.html#l00045">seccomp-bpf.h:45</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../d0/dbd/seccomp-bpf_8h_source.html#l00046">SECCOMP_RET_ALLOW</a>, <a class="el" href="../../d0/dbd/seccomp-bpf_8h_source.html#l00042">SECCOMP_RET_ERRNO</a>, <a class="el" href="../../d0/dbd/seccomp-bpf_8h_source.html#l00040">SECCOMP_RET_KILL</a>, <a class="el" href="../../d0/dbd/seccomp-bpf_8h_source.html#l00047">SECCOMP_RET_KILLPROCESS</a>, <a class="el" href="../../d0/dbd/seccomp-bpf_8h_source.html#l00044">SECCOMP_RET_LOGALLOW</a>, <a class="el" href="../../d0/dbd/seccomp-bpf_8h_source.html#l00045">SECCOMP_RET_TRACE</a>, and <a class="el" href="../../d0/dbd/seccomp-bpf_8h_source.html#l00041">SECCOMP_RET_TRAP</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00199">parseOCIlinuxseccomp()</a>.</p>

</div>
</div>
<a id="a0436ecb75f262b8eef277e2861a97f9d" name="a0436ecb75f262b8eef277e2861a97f9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0436ecb75f262b8eef277e2861a97f9d">&#9670;&#160;</a></span>resolve_architecture()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint32_t resolve_architecture </td>
          <td>(</td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>archname</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00103">103</a> of file <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html">seccomp-oci.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  104</span>{</div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordflow">if</span> (!archname)</div>
<div class="line"><span class="lineno">  106</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordflow">if</span> (!strcmp(archname, <span class="stringliteral">&quot;SCMP_ARCH_X86&quot;</span>))</div>
<div class="line"><span class="lineno">  109</span>        <span class="keywordflow">return</span> AUDIT_ARCH_I386;</div>
<div class="line"><span class="lineno">  110</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(archname, <span class="stringliteral">&quot;SCMP_ARCH_X86_64&quot;</span>))</div>
<div class="line"><span class="lineno">  111</span>        <span class="keywordflow">return</span> AUDIT_ARCH_X86_64;</div>
<div class="line"><span class="lineno">  112</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(archname, <span class="stringliteral">&quot;SCMP_ARCH_X32&quot;</span>))</div>
<div class="line"><span class="lineno">  113</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  114</span><span class="comment">         * return AUDIT_ARCH_X86_64;</span></div>
<div class="line"><span class="lineno">  115</span><span class="comment">         * 32-bit userland on 64-bit kernel is not supported yet</span></div>
<div class="line"><span class="lineno">  116</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno">  117</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(archname, <span class="stringliteral">&quot;SCMP_ARCH_ARM&quot;</span>))</div>
<div class="line"><span class="lineno">  119</span>        <span class="keywordflow">return</span> AUDIT_ARCH_ARM;</div>
<div class="line"><span class="lineno">  120</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(archname, <span class="stringliteral">&quot;SCMP_ARCH_AARCH64&quot;</span>))</div>
<div class="line"><span class="lineno">  121</span>        <span class="keywordflow">return</span> AUDIT_ARCH_AARCH64;</div>
<div class="line"><span class="lineno">  122</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(archname, <span class="stringliteral">&quot;SCMP_ARCH_MIPS&quot;</span>))</div>
<div class="line"><span class="lineno">  123</span>        <span class="keywordflow">return</span> AUDIT_ARCH_MIPS;</div>
<div class="line"><span class="lineno">  124</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(archname, <span class="stringliteral">&quot;SCMP_ARCH_MIPS64&quot;</span>))</div>
<div class="line"><span class="lineno">  125</span>        <span class="keywordflow">return</span> AUDIT_ARCH_MIPS64;</div>
<div class="line"><span class="lineno">  126</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(archname, <span class="stringliteral">&quot;SCMP_ARCH_MIPS64N32&quot;</span>))</div>
<div class="line"><span class="lineno">  127</span>        <span class="keywordflow">return</span> AUDIT_ARCH_MIPS64N32;</div>
<div class="line"><span class="lineno">  128</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(archname, <span class="stringliteral">&quot;SCMP_ARCH_MIPSEL&quot;</span>))</div>
<div class="line"><span class="lineno">  129</span>        <span class="keywordflow">return</span> AUDIT_ARCH_MIPSEL;</div>
<div class="line"><span class="lineno">  130</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(archname, <span class="stringliteral">&quot;SCMP_ARCH_MIPSEL64&quot;</span>))</div>
<div class="line"><span class="lineno">  131</span>        <span class="keywordflow">return</span> AUDIT_ARCH_MIPSEL64;</div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(archname, <span class="stringliteral">&quot;SCMP_ARCH_MIPSEL64N32&quot;</span>))</div>
<div class="line"><span class="lineno">  133</span>        <span class="keywordflow">return</span> AUDIT_ARCH_MIPSEL64N32;</div>
<div class="line"><span class="lineno">  134</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(archname, <span class="stringliteral">&quot;SCMP_ARCH_PPC&quot;</span>))</div>
<div class="line"><span class="lineno">  135</span>        <span class="keywordflow">return</span> AUDIT_ARCH_PPC;</div>
<div class="line"><span class="lineno">  136</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(archname, <span class="stringliteral">&quot;SCMP_ARCH_PPC64&quot;</span>))</div>
<div class="line"><span class="lineno">  137</span>        <span class="keywordflow">return</span> AUDIT_ARCH_PPC64;</div>
<div class="line"><span class="lineno">  138</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(archname, <span class="stringliteral">&quot;SCMP_ARCH_PPC64LE&quot;</span>))</div>
<div class="line"><span class="lineno">  139</span>        <span class="keywordflow">return</span> AUDIT_ARCH_PPC64LE;</div>
<div class="line"><span class="lineno">  140</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(archname, <span class="stringliteral">&quot;SCMP_ARCH_S390&quot;</span>))</div>
<div class="line"><span class="lineno">  141</span>        <span class="keywordflow">return</span> AUDIT_ARCH_S390;</div>
<div class="line"><span class="lineno">  142</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(archname, <span class="stringliteral">&quot;SCMP_ARCH_S390X&quot;</span>))</div>
<div class="line"><span class="lineno">  143</span>        <span class="keywordflow">return</span> AUDIT_ARCH_S390X;</div>
<div class="line"><span class="lineno">  144</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(archname, <span class="stringliteral">&quot;SCMP_ARCH_PARISC&quot;</span>))</div>
<div class="line"><span class="lineno">  145</span>        <span class="keywordflow">return</span> AUDIT_ARCH_PARISC;</div>
<div class="line"><span class="lineno">  146</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(archname, <span class="stringliteral">&quot;SCMP_ARCH_PARISC64&quot;</span>))</div>
<div class="line"><span class="lineno">  147</span>        <span class="keywordflow">return</span> AUDIT_ARCH_PARISC64;</div>
<div class="line"><span class="lineno">  148</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  149</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;unknown seccomp architecture %s\n&quot;</span>, archname);</div>
<div class="line"><span class="lineno">  150</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  151</span>    }</div>
<div class="line"><span class="lineno">  152</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00199">parseOCIlinuxseccomp()</a>.</p>

</div>
</div>
<a id="a629da0c7d64e185e273c72f083630cb9" name="a629da0c7d64e185e273c72f083630cb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a629da0c7d64e185e273c72f083630cb9">&#9670;&#160;</a></span>resolve_op_ins()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint8_t resolve_op_ins </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>op</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00063">63</a> of file <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html">seccomp-oci.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   64</span>{</div>
<div class="line"><span class="lineno">   65</span>    <span class="keywordflow">if</span> (!strcmp(op, <span class="stringliteral">&quot;SCMP_CMP_NE&quot;</span>)) <span class="comment">/* invert EQ */</span></div>
<div class="line"><span class="lineno">   66</span>        <span class="keywordflow">return</span> BPF_JEQ;</div>
<div class="line"><span class="lineno">   67</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(op, <span class="stringliteral">&quot;SCMP_CMP_LT&quot;</span>)) <span class="comment">/* invert GE */</span></div>
<div class="line"><span class="lineno">   68</span>        <span class="keywordflow">return</span> BPF_JGE;</div>
<div class="line"><span class="lineno">   69</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(op, <span class="stringliteral">&quot;SCMP_CMP_LE&quot;</span>)) <span class="comment">/* invert GT */</span></div>
<div class="line"><span class="lineno">   70</span>        <span class="keywordflow">return</span> BPF_JGT;</div>
<div class="line"><span class="lineno">   71</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(op, <span class="stringliteral">&quot;SCMP_CMP_EQ&quot;</span>))</div>
<div class="line"><span class="lineno">   72</span>        <span class="keywordflow">return</span> BPF_JEQ;</div>
<div class="line"><span class="lineno">   73</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(op, <span class="stringliteral">&quot;SCMP_CMP_GE&quot;</span>))</div>
<div class="line"><span class="lineno">   74</span>        <span class="keywordflow">return</span> BPF_JGE;</div>
<div class="line"><span class="lineno">   75</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(op, <span class="stringliteral">&quot;SCMP_CMP_GT&quot;</span>))</div>
<div class="line"><span class="lineno">   76</span>        <span class="keywordflow">return</span> BPF_JGT;</div>
<div class="line"><span class="lineno">   77</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(op, <span class="stringliteral">&quot;SCMP_CMP_MASKED_EQ&quot;</span>))</div>
<div class="line"><span class="lineno">   78</span>        <span class="keywordflow">return</span> BPF_JEQ;</div>
<div class="line"><span class="lineno">   79</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   80</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;unknown seccomp op %s\n&quot;</span>, op);</div>
<div class="line"><span class="lineno">   81</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   82</span>    }</div>
<div class="line"><span class="lineno">   83</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00199">parseOCIlinuxseccomp()</a>.</p>

</div>
</div>
<a id="ac9afb34481ea621a4fb776aa7da95e00" name="ac9afb34481ea621a4fb776aa7da95e00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9afb34481ea621a4fb776aa7da95e00">&#9670;&#160;</a></span>resolve_op_inv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool resolve_op_inv </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>op</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00093">93</a> of file <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html">seccomp-oci.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   94</span>{</div>
<div class="line"><span class="lineno">   95</span>    <span class="keywordflow">if</span> (!strcmp(op, <span class="stringliteral">&quot;SCMP_CMP_NE&quot;</span>) ||</div>
<div class="line"><span class="lineno">   96</span>        !strcmp(op, <span class="stringliteral">&quot;SCMP_CMP_LT&quot;</span>) ||</div>
<div class="line"><span class="lineno">   97</span>        !strcmp(op, <span class="stringliteral">&quot;SCMP_CMP_LE&quot;</span>))</div>
<div class="line"><span class="lineno">   98</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  101</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00199">parseOCIlinuxseccomp()</a>.</p>

</div>
</div>
<a id="a459df353e08836d2ffe1001a8c4d289b" name="a459df353e08836d2ffe1001a8c4d289b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a459df353e08836d2ffe1001a8c4d289b">&#9670;&#160;</a></span>resolve_op_is_masked()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool resolve_op_is_masked </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>op</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00085">85</a> of file <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html">seccomp-oci.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   86</span>{</div>
<div class="line"><span class="lineno">   87</span>    <span class="keywordflow">if</span> (!strcmp(op, <span class="stringliteral">&quot;SCMP_CMP_MASKED_EQ&quot;</span>))</div>
<div class="line"><span class="lineno">   88</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   91</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00199">parseOCIlinuxseccomp()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ae2e350552680f6a95c57167deb867ff1" name="ae2e350552680f6a95c57167deb867ff1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2e350552680f6a95c57167deb867ff1">&#9670;&#160;</a></span>oci_linux_seccomp_policy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a> oci_linux_seccomp_policy[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [<a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aa412668793ef8889b9f0d50144e9c3c29">OCI_LINUX_SECCOMP_DEFAULTACTION</a>] = { <span class="stringliteral">&quot;defaultAction&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aae458d1f367df8d456464a1b290ec2f1f">OCI_LINUX_SECCOMP_ARCHITECTURES</a>] = { <span class="stringliteral">&quot;architectures&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aa55e2eca61872174f3c1fb35d7305a7d2">OCI_LINUX_SECCOMP_FLAGS</a>] = { <span class="stringliteral">&quot;flags&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aa184911ae3d78b8ea0375c56c4282d82f">OCI_LINUX_SECCOMP_SYSCALLS</a>] = { <span class="stringliteral">&quot;syscalls&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">}</div>
<div class="ttc" id="ablobmsg_8h_html_a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a></div><div class="ttdeci">@ BLOBMSG_TYPE_STRING</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00029">blobmsg.h:29</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a></div><div class="ttdeci">@ BLOBMSG_TYPE_ARRAY</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00027">blobmsg.h:27</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00162">162</a> of file <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html">seccomp-oci.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  162</span>                                                                {</div>
<div class="line"><span class="lineno">  163</span>    [<a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aa412668793ef8889b9f0d50144e9c3c29">OCI_LINUX_SECCOMP_DEFAULTACTION</a>] = { <span class="stringliteral">&quot;defaultAction&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno">  164</span>    [<a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aae458d1f367df8d456464a1b290ec2f1f">OCI_LINUX_SECCOMP_ARCHITECTURES</a>] = { <span class="stringliteral">&quot;architectures&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno">  165</span>    [<a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aa55e2eca61872174f3c1fb35d7305a7d2">OCI_LINUX_SECCOMP_FLAGS</a>] = { <span class="stringliteral">&quot;flags&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno">  166</span>    [<a class="code hl_enumvalue" href="#aa156d1cebb38c8a65846c4d9c006012aa184911ae3d78b8ea0375c56c4282d82f">OCI_LINUX_SECCOMP_SYSCALLS</a>] = { <span class="stringliteral">&quot;syscalls&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno">  167</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00199">parseOCIlinuxseccomp()</a>.</p>

</div>
</div>
<a id="a0394a97ad911ae61d20e8147f801f098" name="a0394a97ad911ae61d20e8147f801f098"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0394a97ad911ae61d20e8147f801f098">&#9670;&#160;</a></span>oci_linux_seccomp_syscalls_args_policy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a> oci_linux_seccomp_syscalls_args_policy[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a7e5fc851b7f8b56f87fe0639cafca197">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_INDEX</a>] = { <span class="stringliteral">&quot;index&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a2e5b128da6eb01c318cfe1aa68002985">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUE</a>] = { <span class="stringliteral">&quot;value&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9af8b6d39ebfe3b118d2cdee1c448d2bc7">BLOBMSG_CAST_INT64</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a08bf505c4afd3c95c92bb4fa3a42fd6e">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUETWO</a>] = { <span class="stringliteral">&quot;valueTwo&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9af8b6d39ebfe3b118d2cdee1c448d2bc7">BLOBMSG_CAST_INT64</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3ae3d1fb54e12a7ae1d760a4424b0cb9c9">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_OP</a>] = { <span class="stringliteral">&quot;op&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">}</div>
<div class="ttc" id="ablobmsg_8h_html_a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a></div><div class="ttdeci">@ BLOBMSG_TYPE_INT32</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00031">blobmsg.h:31</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a9e3efca3093410d90ef04154aefde2c9af8b6d39ebfe3b118d2cdee1c448d2bc7"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9af8b6d39ebfe3b118d2cdee1c448d2bc7">BLOBMSG_CAST_INT64</a></div><div class="ttdeci">@ BLOBMSG_CAST_INT64</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00038">blobmsg.h:38</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00192">192</a> of file <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html">seccomp-oci.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  192</span>                                                                              {</div>
<div class="line"><span class="lineno">  193</span>    [<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a7e5fc851b7f8b56f87fe0639cafca197">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_INDEX</a>] = { <span class="stringliteral">&quot;index&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno">  194</span>    [<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a2e5b128da6eb01c318cfe1aa68002985">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUE</a>] = { <span class="stringliteral">&quot;value&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9af8b6d39ebfe3b118d2cdee1c448d2bc7">BLOBMSG_CAST_INT64</a> },</div>
<div class="line"><span class="lineno">  195</span>    [<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3a08bf505c4afd3c95c92bb4fa3a42fd6e">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_VALUETWO</a>] = { <span class="stringliteral">&quot;valueTwo&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9af8b6d39ebfe3b118d2cdee1c448d2bc7">BLOBMSG_CAST_INT64</a> },</div>
<div class="line"><span class="lineno">  196</span>    [<a class="code hl_enumvalue" href="#a2f80701c36e79c0640d91c788feee0b3ae3d1fb54e12a7ae1d760a4424b0cb9c9">OCI_LINUX_SECCOMP_SYSCALLS_ARGS_OP</a>] = { <span class="stringliteral">&quot;op&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno">  197</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00199">parseOCIlinuxseccomp()</a>.</p>

</div>
</div>
<a id="a68a7dab872d9c5e1d3d582eaea30aa96" name="a68a7dab872d9c5e1d3d582eaea30aa96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68a7dab872d9c5e1d3d582eaea30aa96">&#9670;&#160;</a></span>oci_linux_seccomp_syscalls_policy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a> oci_linux_seccomp_syscalls_policy[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [<a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a1efbc5bb9a94393a22cea27db34994f3">OCI_LINUX_SECCOMP_SYSCALLS_NAMES</a>] = { <span class="stringliteral">&quot;names&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a7a8319f7cebb28f8fd2cf6b0f5794e77">OCI_LINUX_SECCOMP_SYSCALLS_ERRNORET</a>] = { <span class="stringliteral">&quot;errnoRet&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a9c400808e68a191a65483332929d3ffe">OCI_LINUX_SECCOMP_SYSCALLS_ARGS</a>] = { <span class="stringliteral">&quot;args&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a5eae989fa9d816f01d5f56207c0b8fa8">OCI_LINUX_SECCOMP_SYSCALLS_ACTION</a>] = { <span class="stringliteral">&quot;action&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00177">177</a> of file <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html">seccomp-oci.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  177</span>                                                                         {</div>
<div class="line"><span class="lineno">  178</span>    [<a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a1efbc5bb9a94393a22cea27db34994f3">OCI_LINUX_SECCOMP_SYSCALLS_NAMES</a>] = { <span class="stringliteral">&quot;names&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno">  179</span>    [<a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a7a8319f7cebb28f8fd2cf6b0f5794e77">OCI_LINUX_SECCOMP_SYSCALLS_ERRNORET</a>] = { <span class="stringliteral">&quot;errnoRet&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno">  180</span>    [<a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a9c400808e68a191a65483332929d3ffe">OCI_LINUX_SECCOMP_SYSCALLS_ARGS</a>] = { <span class="stringliteral">&quot;args&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno">  181</span>    [<a class="code hl_enumvalue" href="#af8654c714018c6241d9ebd01f3fb5a26a5eae989fa9d816f01d5f56207c0b8fa8">OCI_LINUX_SECCOMP_SYSCALLS_ACTION</a>] = { <span class="stringliteral">&quot;action&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno">  182</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00199">parseOCIlinuxseccomp()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
