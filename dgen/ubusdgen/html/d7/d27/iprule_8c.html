<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>zbus: /home/g41797/CLionProjects/github.com/g41797/zbus/src/libs/netifd/iprule.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">zbus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_87a455bccb09a92130c26a11a880c98a.html">libs</a></li><li class="navelem"><a class="el" href="../../dir_985d5b6ca8a26cb2c33ab3bbdd47195e.html">netifd</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">iprule.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;arpa/inet.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d3/d75/netifd_2netifd_8h_source.html">netifd.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/de9/device_8h_source.html">device.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d4/da9/interface_8h_source.html">interface.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d40/iprule_8h_source.html">iprule.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/dd2/proto_8h_source.html">proto.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d9d/netifd_2ubus_8h_source.html">ubus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dc/db2/system_8h_source.html">system.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for iprule.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d9/d3f/iprule_8c__incl.png" border="0" usemap="#a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2netifd_2iprule_8c" alt=""/></div>
<map name="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2netifd_2iprule_8c" id="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2netifd_2iprule_8c">
<area shape="rect" title=" " alt="" coords="624,5,910,85"/>
<area shape="rect" title=" " alt="" coords="322,133,415,167"/>
<area shape="poly" title=" " alt="" coords="624,85,431,135,429,130,623,80"/>
<area shape="rect" title=" " alt="" coords="439,133,530,167"/>
<area shape="poly" title=" " alt="" coords="660,88,544,130,543,125,658,83"/>
<area shape="rect" title=" " alt="" coords="613,623,697,657"/>
<area shape="poly" title=" " alt="" coords="682,88,641,114,605,146,580,185,572,207,570,230,570,478,574,528,595,574,609,593,625,611,622,615,605,597,590,576,569,529,565,478,565,230,567,206,575,183,601,143,638,110,679,83"/>
<area shape="rect" title=" " alt="" coords="706,215,828,248"/>
<area shape="poly" title=" " alt="" coords="770,85,770,199,765,199,765,85"/>
<area shape="rect" href="../../d3/d75/netifd_2netifd_8h.html" title=" " alt="" coords="655,460,749,493"/>
<area shape="poly" title=" " alt="" coords="721,87,702,109,687,134,673,175,665,218,663,262,666,305,678,384,694,444,689,445,673,385,660,306,658,262,660,217,668,174,682,132,698,106,717,84"/>
<area shape="rect" href="../../db/de9/device_8h.html" title=" " alt="" coords="1287,460,1386,493"/>
<area shape="poly" title=" " alt="" coords="911,54,1014,65,1118,81,1209,102,1245,116,1271,131,1295,152,1309,173,1316,199,1318,230,1318,314,1323,384,1333,444,1327,445,1318,385,1313,315,1313,230,1311,199,1304,176,1291,155,1268,135,1243,121,1208,107,1117,86,1013,70,911,59"/>
<area shape="rect" href="../../d4/da9/interface_8h.html" title=" " alt="" coords="876,378,997,412"/>
<area shape="poly" title=" " alt="" coords="736,87,712,122,693,163,686,206,688,227,696,247,711,270,730,290,773,324,820,351,866,370,864,375,818,356,770,329,726,294,707,273,692,250,683,228,680,206,688,162,708,120,732,84"/>
<area shape="rect" href="../../de/d40/iprule_8h.html" title=" " alt="" coords="853,215,945,248"/>
<area shape="poly" title=" " alt="" coords="797,84,881,201,877,204,793,87"/>
<area shape="rect" href="../../de/dd2/proto_8h.html" title=" " alt="" coords="1061,133,1148,167"/>
<area shape="poly" title=" " alt="" coords="897,83,1047,128,1045,133,896,88"/>
<area shape="rect" href="../../d5/d9d/netifd_2ubus_8h.html" title=" " alt="" coords="1173,133,1258,167"/>
<area shape="poly" title=" " alt="" coords="911,73,1158,130,1157,135,910,78"/>
<area shape="rect" href="../../dc/db2/system_8h.html" title=" " alt="" coords="930,133,1036,167"/>
<area shape="poly" title=" " alt="" coords="851,83,937,124,935,128,849,88"/>
<area shape="poly" title=" " alt="" coords="729,492,749,508,768,529,778,552,778,564,774,576,762,592,747,605,713,624,710,619,744,601,758,588,769,574,773,563,773,553,763,532,746,512,725,496"/>
<area shape="rect" title=" " alt="" coords="986,541,1122,575"/>
<area shape="poly" title=" " alt="" coords="750,486,972,536,971,541,748,491"/>
<area shape="rect" title=" " alt="" coords="1146,541,1231,575"/>
<area shape="poly" title=" " alt="" coords="749,480,914,501,1132,538,1131,544,914,506,749,485"/>
<area shape="rect" title=" " alt="" coords="735,786,842,820"/>
<area shape="poly" title=" " alt="" coords="655,493,637,496,517,501,317,505,213,509,121,516,51,528,28,535,14,543,11,550,11,556,15,575,17,625,16,666,18,684,24,701,35,719,51,736,87,751,152,763,338,781,549,792,720,798,720,803,549,798,338,787,151,768,85,756,48,741,30,722,19,704,13,685,11,666,11,625,10,575,5,557,5,548,11,539,25,530,49,522,120,511,212,504,316,500,517,496,636,491,654,487"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html" title=" " alt="" coords="170,623,335,657"/>
<area shape="poly" title=" " alt="" coords="655,492,637,496,555,502,449,505,396,509,348,516,307,527,278,543,267,557,260,573,254,608,249,607,255,572,263,554,275,539,305,522,346,511,396,504,449,500,555,497,636,491,654,487"/>
<area shape="rect" href="../../da/d79/ustream_8h.html" title=" " alt="" coords="25,541,214,575"/>
<area shape="poly" title=" " alt="" coords="655,492,637,496,524,514,435,523,233,544,230,544,229,539,232,539,435,518,523,508,636,491,654,487"/>
<area shape="rect" href="../../d5/d1d/libubox_2utils_8h.html" title=" " alt="" coords="938,623,1090,657"/>
<area shape="poly" title=" " alt="" coords="749,481,834,500,881,517,925,539,965,573,997,609,993,612,962,576,922,544,879,522,832,505,748,486"/>
<area shape="rect" href="../../db/d55/libubus_8h.html" title=" " alt="" coords="423,541,530,575"/>
<area shape="poly" title=" " alt="" coords="657,496,538,538,536,533,655,491"/>
<area shape="rect" href="../../de/dd2/udebug_8h.html" title=" " alt="" coords="288,541,398,575"/>
<area shape="poly" title=" " alt="" coords="655,492,637,496,414,543,413,538,636,491,654,487"/>
<area shape="rect" title=" " alt="" coords="605,541,759,575"/>
<area shape="poly" title=" " alt="" coords="700,494,692,527,687,526,695,493"/>
<area shape="rect" href="../../d9/dd0/netifd_2utils_8h.html" title=" " alt="" coords="833,541,912,575"/>
<area shape="poly" title=" " alt="" coords="738,491,826,532,823,537,735,496"/>
<area shape="poly" title=" " alt="" coords="171,658,121,671,79,689,65,699,58,710,58,723,66,736,78,745,99,752,162,765,246,776,344,784,551,794,720,798,720,804,551,799,344,789,245,781,161,770,97,757,76,749,63,740,53,724,53,709,61,696,76,684,119,666,169,652"/>
<area shape="rect" title=" " alt="" coords="194,705,311,738"/>
<area shape="poly" title=" " alt="" coords="255,657,255,689,250,689,250,657"/>
<area shape="rect" title=" " alt="" coords="336,705,463,738"/>
<area shape="poly" title=" " alt="" coords="283,655,358,695,355,699,281,660"/>
<area shape="rect" title=" " alt="" coords="486,705,579,738"/>
<area shape="poly" title=" " alt="" coords="310,655,472,700,471,706,309,660"/>
<area shape="rect" title=" " alt="" coords="76,705,170,738"/>
<area shape="poly" title=" " alt="" coords="228,659,164,699,161,694,225,655"/>
<area shape="rect" href="../../da/d23/list_8h.html" title=" " alt="" coords="702,705,768,738"/>
<area shape="poly" title=" " alt="" coords="335,652,687,710,686,715,335,657"/>
<area shape="poly" title=" " alt="" coords="748,737,771,772,767,775,744,740"/>
<area shape="poly" title=" " alt="" coords="148,573,214,613,212,617,145,578"/>
<area shape="rect" title=" " alt="" coords="47,623,146,657"/>
<area shape="poly" title=" " alt="" coords="117,576,108,609,103,607,112,575"/>
<area shape="poly" title=" " alt="" coords="993,659,825,779,822,775,990,655"/>
<area shape="poly" title=" " alt="" coords="938,658,926,659,759,675,628,681,495,688,327,707,326,702,495,683,627,676,759,670,926,654,937,652"/>
<area shape="poly" title=" " alt="" coords="938,658,926,659,802,674,703,682,605,690,479,707,478,701,604,685,703,677,801,669,926,654,937,652"/>
<area shape="poly" title=" " alt="" coords="938,657,926,659,595,713,594,708,925,654,937,652"/>
<area shape="rect" title=" " alt="" coords="958,705,1070,738"/>
<area shape="poly" title=" " alt="" coords="1017,657,1017,689,1011,689,1011,657"/>
<area shape="rect" title=" " alt="" coords="1111,705,1208,738"/>
<area shape="poly" title=" " alt="" coords="1045,655,1118,695,1115,699,1042,659"/>
<area shape="poly" title=" " alt="" coords="432,578,313,620,312,615,430,573"/>
<area shape="poly" title=" " alt="" coords="485,575,524,689,519,691,480,576"/>
<area shape="poly" title=" " alt="" coords="496,573,542,612,602,654,646,678,689,698,686,703,643,683,599,659,539,616,492,577"/>
<area shape="rect" href="../../d3/d51/avl_8h.html" title=" " alt="" coords="773,623,913,657"/>
<area shape="poly" title=" " alt="" coords="531,569,758,617,757,623,530,574"/>
<area shape="poly" title=" " alt="" coords="840,658,801,772,796,771,835,656"/>
<area shape="poly" title=" " alt="" coords="823,659,771,697,768,693,820,655"/>
<area shape="poly" title=" " alt="" coords="327,577,284,615,280,611,323,573"/>
<area shape="poly" title=" " alt="" coords="351,575,391,689,386,691,346,576"/>
<area shape="poly" title=" " alt="" coords="364,573,504,693,501,697,360,578"/>
<area shape="poly" title=" " alt="" coords="376,573,455,612,551,654,688,703,686,708,549,659,452,616,373,578"/>
<area shape="poly" title=" " alt="" coords="294,578,161,621,159,616,292,573"/>
<area shape="poly" title=" " alt="" coords="399,570,412,572,597,603,758,625,757,631,596,608,411,578,398,575"/>
<area shape="poly" title=" " alt="" coords="834,576,713,620,711,615,832,571"/>
<area shape="poly" title=" " alt="" coords="834,575,796,595,778,609,763,625,747,656,740,690,734,689,742,655,758,621,774,605,793,591,832,570"/>
<area shape="poly" title=" " alt="" coords="902,573,974,613,971,618,900,578"/>
<area shape="poly" title=" " alt="" coords="913,564,1018,588,1069,604,1103,621,1119,636,1133,654,1151,689,1146,692,1128,656,1115,639,1100,625,1067,609,1017,593,911,569"/>
<area shape="poly" title=" " alt="" coords="869,576,857,609,852,607,864,575"/>
<area shape="poly" title=" " alt="" coords="1372,491,1401,508,1426,529,1440,552,1439,565,1432,577,1403,591,1351,601,1203,613,929,626,928,621,1203,608,1350,595,1401,585,1428,573,1434,563,1434,553,1422,532,1398,513,1369,496"/>
<area shape="rect" href="../../d0/d51/safe__list_8h.html" title=" " alt="" coords="1644,541,1832,575"/>
<area shape="poly" title=" " alt="" coords="1387,485,1642,535,1641,540,1386,490"/>
<area shape="rect" href="../../db/d29/kvlist_8h.html" title=" " alt="" coords="1255,541,1418,575"/>
<area shape="poly" title=" " alt="" coords="1339,494,1339,526,1334,526,1334,494"/>
<area shape="rect" title=" " alt="" coords="1493,541,1620,575"/>
<area shape="poly" title=" " alt="" coords="1382,491,1499,533,1497,538,1380,496"/>
<area shape="poly" title=" " alt="" coords="1701,578,1498,656,1362,701,1221,741,1123,762,1024,778,858,798,857,793,1023,773,1122,756,1220,736,1360,696,1496,651,1699,573"/>
<area shape="poly" title=" " alt="" coords="1644,577,784,715,783,710,1643,572"/>
<area shape="poly" title=" " alt="" coords="1643,576,1633,578,1486,593,1371,601,1256,610,1109,626,1106,626,1105,621,1108,620,1255,604,1370,596,1485,587,1632,572,1643,571"/>
<area shape="poly" title=" " alt="" coords="1256,576,1244,578,929,625,928,620,1243,572,1255,570"/>
<area shape="poly" title=" " alt="" coords="998,406,1272,460,1271,465,997,411"/>
<area shape="rect" href="../../d8/d8a/netifd_2config_8h.html" title=" " alt="" coords="888,460,985,493"/>
<area shape="poly" title=" " alt="" coords="939,412,939,444,934,444,934,412"/>
<area shape="rect" href="../../d9/d62/interface-ip_8h.html" title=" " alt="" coords="864,296,1009,330"/>
<area shape="poly" title=" " alt="" coords="909,248,925,281,920,283,904,250"/>
<area shape="poly" title=" " alt="" coords="939,330,939,363,934,363,934,330"/>
<area shape="poly" title=" " alt="" coords="940,170,826,211,825,206,939,165"/>
<area shape="poly" title=" " alt="" coords="1033,165,1071,184,1105,213,1123,237,1133,258,1137,282,1138,312,1138,396,1136,425,1130,448,1106,495,1081,531,1076,528,1101,492,1125,446,1131,424,1133,396,1133,312,1132,283,1128,260,1118,239,1101,216,1068,189,1031,169"/>
<area shape="poly" title=" " alt="" coords="1038,162,1087,182,1112,196,1134,213,1159,235,1176,256,1186,280,1190,312,1190,396,1191,526,1185,526,1185,396,1185,312,1181,281,1171,258,1155,239,1131,217,1109,200,1085,187,1036,167"/>
<area shape="poly" title=" " alt="" coords="986,168,981,208,973,231,960,250,937,266,899,283,788,318,482,394,321,433,178,472,70,509,35,527,15,543,10,554,8,568,13,602,24,634,37,655,55,664,90,675,180,700,178,705,88,681,53,669,33,659,20,637,8,604,3,569,5,553,10,540,32,522,68,504,176,467,320,428,481,389,787,313,897,278,934,261,956,246,968,228,976,207,981,167"/>
<area shape="poly" title=" " alt="" coords="1004,165,1030,191,1057,225,1078,266,1085,289,1087,312,1087,396,1083,425,1071,451,1053,473,1031,493,979,524,927,544,925,539,976,519,1027,489,1049,470,1066,448,1078,424,1082,396,1082,312,1080,290,1073,268,1052,228,1026,194,1000,169"/>
<area shape="poly" title=" " alt="" coords="1037,161,1140,188,1184,202,1207,212,1231,236,1247,259,1264,304,1276,353,1285,380,1299,410,1320,445,1315,448,1294,413,1280,382,1271,355,1259,306,1242,261,1227,239,1204,217,1182,207,1139,193,1036,167"/>
<area shape="poly" title=" " alt="" coords="968,169,929,206,925,202,964,165"/>
<area shape="poly" title=" " alt="" coords="994,166,1007,205,1009,227,1004,249,991,271,974,289,970,285,987,268,999,247,1004,227,1002,206,989,168"/>
</map>
</div>
</div>
<p><a href="../../d7/d27/iprule_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a39fca1837c5ce7715cbf571669660c13" id="r_a39fca1837c5ce7715cbf571669660c13"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="#a39fca1837c5ce7715cbf571669660c13a3734c412269e1a1b059ef1e9a4801324">RULE_INTERFACE_IN</a>
, <a class="el" href="#a39fca1837c5ce7715cbf571669660c13a85ed529b656cec86c741f84b15042b12">RULE_INTERFACE_OUT</a>
, <a class="el" href="#a39fca1837c5ce7715cbf571669660c13a8b1c0fc7b0865311fd8837f7df6b7a97">RULE_INVERT</a>
, <a class="el" href="#a39fca1837c5ce7715cbf571669660c13a20f430db8b13aee83375e15a12847b48">RULE_SRC</a>
, <br />
&#160;&#160;<a class="el" href="#a39fca1837c5ce7715cbf571669660c13a8e802bacb5e9abda18ee918fabff0b78">RULE_DEST</a>
, <a class="el" href="#a39fca1837c5ce7715cbf571669660c13abfc1cbaae027728ec95473abe584ce10">RULE_PRIORITY</a>
, <a class="el" href="#a39fca1837c5ce7715cbf571669660c13abf6e8954b22de38627c34cf914fc3128">RULE_TOS</a>
, <a class="el" href="#a39fca1837c5ce7715cbf571669660c13a1d8a34dea3d6af25048045b29f52214a">RULE_FWMARK</a>
, <br />
&#160;&#160;<a class="el" href="#a39fca1837c5ce7715cbf571669660c13afe4f03c8f5aecfac704de4a684a6abcf">RULE_LOOKUP</a>
, <a class="el" href="#a39fca1837c5ce7715cbf571669660c13aabb8f0102739331bf81420db7e784b0a">RULE_ACTION</a>
, <a class="el" href="#a39fca1837c5ce7715cbf571669660c13ae891aceac0cf247d1da0e4e51a1bcab9">RULE_GOTO</a>
, <a class="el" href="#a39fca1837c5ce7715cbf571669660c13a38ebfbf4132d1fa73eb054cabf8e5aab">RULE_SUP_PREFIXLEN</a>
, <br />
&#160;&#160;<a class="el" href="#a39fca1837c5ce7715cbf571669660c13a86412460bb1eb3257eff74f5745266c2">RULE_UIDRANGE</a>
, <a class="el" href="#a39fca1837c5ce7715cbf571669660c13a2ff54ab2b29ba773bba4e6b0f0ff4834">RULE_DISABLED</a>
, <a class="el" href="#a39fca1837c5ce7715cbf571669660c13ac5c28749ad128ba2107ccf6216200e2e">__RULE_MAX</a>
<br />
 }</td></tr>
<tr class="separator:a39fca1837c5ce7715cbf571669660c13"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4d0b448b056ef96781a7a739d10d0f77" id="r_a4d0b448b056ef96781a7a739d10d0f77"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4d0b448b056ef96781a7a739d10d0f77">rule_ready</a> (struct <a class="el" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a> *rule)</td></tr>
<tr class="separator:a4d0b448b056ef96781a7a739d10d0f77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99813a41e5341611f8950ab08efba553" id="r_a99813a41e5341611f8950ab08efba553"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a99813a41e5341611f8950ab08efba553">iprule_parse_mark</a> (const char *mark, struct <a class="el" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a> *rule)</td></tr>
<tr class="separator:a99813a41e5341611f8950ab08efba553"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90a4f46760b774e8d211619ea7a89d44" id="r_a90a4f46760b774e8d211619ea7a89d44"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a90a4f46760b774e8d211619ea7a89d44">rule_in_cb</a> (struct <a class="el" href="../../d4/da9/interface_8h.html#d0/d97/structinterface__user">interface_user</a> *dep, struct <a class="el" href="../../d4/da9/interface_8h.html#d9/dbe/structinterface">interface</a> *iface, enum <a class="el" href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579">interface_event</a> ev)</td></tr>
<tr class="separator:a90a4f46760b774e8d211619ea7a89d44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a513d2c8c9c692217478aa2ba34252df1" id="r_a513d2c8c9c692217478aa2ba34252df1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a513d2c8c9c692217478aa2ba34252df1">rule_out_cb</a> (struct <a class="el" href="../../d4/da9/interface_8h.html#d0/d97/structinterface__user">interface_user</a> *dep, struct <a class="el" href="../../d4/da9/interface_8h.html#d9/dbe/structinterface">interface</a> *iface, enum <a class="el" href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579">interface_event</a> ev)</td></tr>
<tr class="separator:a513d2c8c9c692217478aa2ba34252df1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f0f28a6bc17abaa9af5853a1a576016" id="r_a3f0f28a6bc17abaa9af5853a1a576016"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3f0f28a6bc17abaa9af5853a1a576016">generic_interface_cb</a> (struct <a class="el" href="../../d4/da9/interface_8h.html#d0/d97/structinterface__user">interface_user</a> *dep, struct <a class="el" href="../../d4/da9/interface_8h.html#d9/dbe/structinterface">interface</a> *iface, enum <a class="el" href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579">interface_event</a> ev)</td></tr>
<tr class="separator:a3f0f28a6bc17abaa9af5853a1a576016"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7aeb527c6c1a5d7511594e078bf9b72a" id="r_a7aeb527c6c1a5d7511594e078bf9b72a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7aeb527c6c1a5d7511594e078bf9b72a">iprule_add</a> (struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *attr, bool v6)</td></tr>
<tr class="separator:a7aeb527c6c1a5d7511594e078bf9b72a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4efb717e4ff73b537528d9d4b423d1aa" id="r_a4efb717e4ff73b537528d9d4b423d1aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4efb717e4ff73b537528d9d4b423d1aa">iprule_update_start</a> (void)</td></tr>
<tr class="separator:a4efb717e4ff73b537528d9d4b423d1aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59fa1dfb15dcb64514ef3fc697eea9bc" id="r_a59fa1dfb15dcb64514ef3fc697eea9bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a59fa1dfb15dcb64514ef3fc697eea9bc">iprule_update_complete</a> (void)</td></tr>
<tr class="separator:a59fa1dfb15dcb64514ef3fc697eea9bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2a778d5100d5f7eeddcc71f7cf14b0a" id="r_ad2a778d5100d5f7eeddcc71f7cf14b0a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad2a778d5100d5f7eeddcc71f7cf14b0a">rule_cmp</a> (const void *k1, const void *k2, void *ptr)</td></tr>
<tr class="separator:ad2a778d5100d5f7eeddcc71f7cf14b0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a326e42044fee1f72ada45cad41e761f9" id="r_a326e42044fee1f72ada45cad41e761f9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a326e42044fee1f72ada45cad41e761f9">deregister_interfaces</a> (struct <a class="el" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a> *rule)</td></tr>
<tr class="separator:a326e42044fee1f72ada45cad41e761f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd45e5b26b4573116b71d9b6d52eb4ea" id="r_afd45e5b26b4573116b71d9b6d52eb4ea"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afd45e5b26b4573116b71d9b6d52eb4ea">register_interfaces</a> (struct <a class="el" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a> *rule)</td></tr>
<tr class="separator:afd45e5b26b4573116b71d9b6d52eb4ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f6c0402fffb7ad118230b8d703d2588" id="r_a1f6c0402fffb7ad118230b8d703d2588"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1f6c0402fffb7ad118230b8d703d2588">iprule_update_rule</a> (struct <a class="el" href="../../dd/d1d/vlist_8h.html#d0/ddc/structvlist__tree">vlist_tree</a> *tree, struct <a class="el" href="../../dd/d1d/vlist_8h.html#d9/d32/structvlist__node">vlist_node</a> *node_new, struct <a class="el" href="../../dd/d1d/vlist_8h.html#d9/d32/structvlist__node">vlist_node</a> *node_old)</td></tr>
<tr class="separator:a1f6c0402fffb7ad118230b8d703d2588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a87efea3fb0e71473bb237159500343" id="r_a9a87efea3fb0e71473bb237159500343"><td class="memItemLeft" align="right" valign="top">static void <a class="el" href="../../d9/dd0/netifd_2utils_8h.html#aca8f1e05ca62886e6d99e8dc006e5500">__init</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9a87efea3fb0e71473bb237159500343">iprule_init_list</a> (void)</td></tr>
<tr class="separator:a9a87efea3fb0e71473bb237159500343"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a2b7e163136b707246437f4aa848fd10e" id="r_a2b7e163136b707246437f4aa848fd10e"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../dd/d1d/vlist_8h.html#d0/ddc/structvlist__tree">vlist_tree</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2b7e163136b707246437f4aa848fd10e">iprules</a></td></tr>
<tr class="separator:a2b7e163136b707246437f4aa848fd10e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf39fc0b9549ad16045996ee7e5a62d6" id="r_adf39fc0b9549ad16045996ee7e5a62d6"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adf39fc0b9549ad16045996ee7e5a62d6">iprules_flushed</a> = false</td></tr>
<tr class="separator:adf39fc0b9549ad16045996ee7e5a62d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee12ecfbf17681c5b79e422c9fbe2843" id="r_aee12ecfbf17681c5b79e422c9fbe2843"><td class="memItemLeft" align="right" valign="top">static unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aee12ecfbf17681c5b79e422c9fbe2843">iprules_counter</a> [2]</td></tr>
<tr class="separator:aee12ecfbf17681c5b79e422c9fbe2843"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb124dec6d59e002989d0ecf6f29a878" id="r_aeb124dec6d59e002989d0ecf6f29a878"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeb124dec6d59e002989d0ecf6f29a878">rule_attr</a> [<a class="el" href="#a39fca1837c5ce7715cbf571669660c13ac5c28749ad128ba2107ccf6216200e2e">__RULE_MAX</a>]</td></tr>
<tr class="separator:aeb124dec6d59e002989d0ecf6f29a878"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51b20390e0610b4fab3918c2965d5b2c" id="r_a51b20390e0610b4fab3918c2965d5b2c"><td class="memItemLeft" align="right" valign="top">const struct uci_blob_param_list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a51b20390e0610b4fab3918c2965d5b2c">rule_attr_list</a></td></tr>
<tr class="separator:a51b20390e0610b4fab3918c2965d5b2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a180e8ee9a1586c10d356bb4f3e1b76a1" id="r_a180e8ee9a1586c10d356bb4f3e1b76a1"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/da9/interface_8h.html#d0/d97/structinterface__user">interface_user</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a180e8ee9a1586c10d356bb4f3e1b76a1">generic_listener</a></td></tr>
<tr class="separator:a180e8ee9a1586c10d356bb4f3e1b76a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a39fca1837c5ce7715cbf571669660c13" name="a39fca1837c5ce7715cbf571669660c13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39fca1837c5ce7715cbf571669660c13">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13a3734c412269e1a1b059ef1e9a4801324" name="a39fca1837c5ce7715cbf571669660c13a3734c412269e1a1b059ef1e9a4801324"></a>RULE_INTERFACE_IN&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13a85ed529b656cec86c741f84b15042b12" name="a39fca1837c5ce7715cbf571669660c13a85ed529b656cec86c741f84b15042b12"></a>RULE_INTERFACE_OUT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13a8b1c0fc7b0865311fd8837f7df6b7a97" name="a39fca1837c5ce7715cbf571669660c13a8b1c0fc7b0865311fd8837f7df6b7a97"></a>RULE_INVERT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13a20f430db8b13aee83375e15a12847b48" name="a39fca1837c5ce7715cbf571669660c13a20f430db8b13aee83375e15a12847b48"></a>RULE_SRC&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13a8e802bacb5e9abda18ee918fabff0b78" name="a39fca1837c5ce7715cbf571669660c13a8e802bacb5e9abda18ee918fabff0b78"></a>RULE_DEST&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13abfc1cbaae027728ec95473abe584ce10" name="a39fca1837c5ce7715cbf571669660c13abfc1cbaae027728ec95473abe584ce10"></a>RULE_PRIORITY&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13abf6e8954b22de38627c34cf914fc3128" name="a39fca1837c5ce7715cbf571669660c13abf6e8954b22de38627c34cf914fc3128"></a>RULE_TOS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13a1d8a34dea3d6af25048045b29f52214a" name="a39fca1837c5ce7715cbf571669660c13a1d8a34dea3d6af25048045b29f52214a"></a>RULE_FWMARK&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13afe4f03c8f5aecfac704de4a684a6abcf" name="a39fca1837c5ce7715cbf571669660c13afe4f03c8f5aecfac704de4a684a6abcf"></a>RULE_LOOKUP&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13aabb8f0102739331bf81420db7e784b0a" name="a39fca1837c5ce7715cbf571669660c13aabb8f0102739331bf81420db7e784b0a"></a>RULE_ACTION&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13ae891aceac0cf247d1da0e4e51a1bcab9" name="a39fca1837c5ce7715cbf571669660c13ae891aceac0cf247d1da0e4e51a1bcab9"></a>RULE_GOTO&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13a38ebfbf4132d1fa73eb054cabf8e5aab" name="a39fca1837c5ce7715cbf571669660c13a38ebfbf4132d1fa73eb054cabf8e5aab"></a>RULE_SUP_PREFIXLEN&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13a86412460bb1eb3257eff74f5745266c2" name="a39fca1837c5ce7715cbf571669660c13a86412460bb1eb3257eff74f5745266c2"></a>RULE_UIDRANGE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13a2ff54ab2b29ba773bba4e6b0f0ff4834" name="a39fca1837c5ce7715cbf571669660c13a2ff54ab2b29ba773bba4e6b0f0ff4834"></a>RULE_DISABLED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39fca1837c5ce7715cbf571669660c13ac5c28749ad128ba2107ccf6216200e2e" name="a39fca1837c5ce7715cbf571669660c13ac5c28749ad128ba2107ccf6216200e2e"></a>__RULE_MAX&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00034">34</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   34</span>     {</div>
<div class="line"><span class="lineno">   35</span>    <a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a3734c412269e1a1b059ef1e9a4801324">RULE_INTERFACE_IN</a>,</div>
<div class="line"><span class="lineno">   36</span>    <a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a85ed529b656cec86c741f84b15042b12">RULE_INTERFACE_OUT</a>,</div>
<div class="line"><span class="lineno">   37</span>    <a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a8b1c0fc7b0865311fd8837f7df6b7a97">RULE_INVERT</a>,</div>
<div class="line"><span class="lineno">   38</span>    <a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a20f430db8b13aee83375e15a12847b48">RULE_SRC</a>,</div>
<div class="line"><span class="lineno">   39</span>    <a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a8e802bacb5e9abda18ee918fabff0b78">RULE_DEST</a>,</div>
<div class="line"><span class="lineno">   40</span>    <a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13abfc1cbaae027728ec95473abe584ce10">RULE_PRIORITY</a>,</div>
<div class="line"><span class="lineno">   41</span>    <a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13abf6e8954b22de38627c34cf914fc3128">RULE_TOS</a>,</div>
<div class="line"><span class="lineno">   42</span>    <a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a1d8a34dea3d6af25048045b29f52214a">RULE_FWMARK</a>,</div>
<div class="line"><span class="lineno">   43</span>    <a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13afe4f03c8f5aecfac704de4a684a6abcf">RULE_LOOKUP</a>,</div>
<div class="line"><span class="lineno">   44</span>    <a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13aabb8f0102739331bf81420db7e784b0a">RULE_ACTION</a>,</div>
<div class="line"><span class="lineno">   45</span>    <a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13ae891aceac0cf247d1da0e4e51a1bcab9">RULE_GOTO</a>,</div>
<div class="line"><span class="lineno">   46</span>    <a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a38ebfbf4132d1fa73eb054cabf8e5aab">RULE_SUP_PREFIXLEN</a>,</div>
<div class="line"><span class="lineno">   47</span>    <a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a86412460bb1eb3257eff74f5745266c2">RULE_UIDRANGE</a>,</div>
<div class="line"><span class="lineno">   48</span>    <a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a2ff54ab2b29ba773bba4e6b0f0ff4834">RULE_DISABLED</a>,</div>
<div class="line"><span class="lineno">   49</span>    <a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13ac5c28749ad128ba2107ccf6216200e2e">__RULE_MAX</a></div>
<div class="line"><span class="lineno">   50</span>};</div>
<div class="ttc" id="aiprule_8c_html_a39fca1837c5ce7715cbf571669660c13a1d8a34dea3d6af25048045b29f52214a"><div class="ttname"><a href="#a39fca1837c5ce7715cbf571669660c13a1d8a34dea3d6af25048045b29f52214a">RULE_FWMARK</a></div><div class="ttdeci">@ RULE_FWMARK</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00042">iprule.c:42</a></div></div>
<div class="ttc" id="aiprule_8c_html_a39fca1837c5ce7715cbf571669660c13a20f430db8b13aee83375e15a12847b48"><div class="ttname"><a href="#a39fca1837c5ce7715cbf571669660c13a20f430db8b13aee83375e15a12847b48">RULE_SRC</a></div><div class="ttdeci">@ RULE_SRC</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00038">iprule.c:38</a></div></div>
<div class="ttc" id="aiprule_8c_html_a39fca1837c5ce7715cbf571669660c13a2ff54ab2b29ba773bba4e6b0f0ff4834"><div class="ttname"><a href="#a39fca1837c5ce7715cbf571669660c13a2ff54ab2b29ba773bba4e6b0f0ff4834">RULE_DISABLED</a></div><div class="ttdeci">@ RULE_DISABLED</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00048">iprule.c:48</a></div></div>
<div class="ttc" id="aiprule_8c_html_a39fca1837c5ce7715cbf571669660c13a3734c412269e1a1b059ef1e9a4801324"><div class="ttname"><a href="#a39fca1837c5ce7715cbf571669660c13a3734c412269e1a1b059ef1e9a4801324">RULE_INTERFACE_IN</a></div><div class="ttdeci">@ RULE_INTERFACE_IN</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00035">iprule.c:35</a></div></div>
<div class="ttc" id="aiprule_8c_html_a39fca1837c5ce7715cbf571669660c13a38ebfbf4132d1fa73eb054cabf8e5aab"><div class="ttname"><a href="#a39fca1837c5ce7715cbf571669660c13a38ebfbf4132d1fa73eb054cabf8e5aab">RULE_SUP_PREFIXLEN</a></div><div class="ttdeci">@ RULE_SUP_PREFIXLEN</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00046">iprule.c:46</a></div></div>
<div class="ttc" id="aiprule_8c_html_a39fca1837c5ce7715cbf571669660c13a85ed529b656cec86c741f84b15042b12"><div class="ttname"><a href="#a39fca1837c5ce7715cbf571669660c13a85ed529b656cec86c741f84b15042b12">RULE_INTERFACE_OUT</a></div><div class="ttdeci">@ RULE_INTERFACE_OUT</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00036">iprule.c:36</a></div></div>
<div class="ttc" id="aiprule_8c_html_a39fca1837c5ce7715cbf571669660c13a86412460bb1eb3257eff74f5745266c2"><div class="ttname"><a href="#a39fca1837c5ce7715cbf571669660c13a86412460bb1eb3257eff74f5745266c2">RULE_UIDRANGE</a></div><div class="ttdeci">@ RULE_UIDRANGE</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00047">iprule.c:47</a></div></div>
<div class="ttc" id="aiprule_8c_html_a39fca1837c5ce7715cbf571669660c13a8b1c0fc7b0865311fd8837f7df6b7a97"><div class="ttname"><a href="#a39fca1837c5ce7715cbf571669660c13a8b1c0fc7b0865311fd8837f7df6b7a97">RULE_INVERT</a></div><div class="ttdeci">@ RULE_INVERT</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00037">iprule.c:37</a></div></div>
<div class="ttc" id="aiprule_8c_html_a39fca1837c5ce7715cbf571669660c13a8e802bacb5e9abda18ee918fabff0b78"><div class="ttname"><a href="#a39fca1837c5ce7715cbf571669660c13a8e802bacb5e9abda18ee918fabff0b78">RULE_DEST</a></div><div class="ttdeci">@ RULE_DEST</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00039">iprule.c:39</a></div></div>
<div class="ttc" id="aiprule_8c_html_a39fca1837c5ce7715cbf571669660c13aabb8f0102739331bf81420db7e784b0a"><div class="ttname"><a href="#a39fca1837c5ce7715cbf571669660c13aabb8f0102739331bf81420db7e784b0a">RULE_ACTION</a></div><div class="ttdeci">@ RULE_ACTION</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00044">iprule.c:44</a></div></div>
<div class="ttc" id="aiprule_8c_html_a39fca1837c5ce7715cbf571669660c13abf6e8954b22de38627c34cf914fc3128"><div class="ttname"><a href="#a39fca1837c5ce7715cbf571669660c13abf6e8954b22de38627c34cf914fc3128">RULE_TOS</a></div><div class="ttdeci">@ RULE_TOS</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00041">iprule.c:41</a></div></div>
<div class="ttc" id="aiprule_8c_html_a39fca1837c5ce7715cbf571669660c13abfc1cbaae027728ec95473abe584ce10"><div class="ttname"><a href="#a39fca1837c5ce7715cbf571669660c13abfc1cbaae027728ec95473abe584ce10">RULE_PRIORITY</a></div><div class="ttdeci">@ RULE_PRIORITY</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00040">iprule.c:40</a></div></div>
<div class="ttc" id="aiprule_8c_html_a39fca1837c5ce7715cbf571669660c13ac5c28749ad128ba2107ccf6216200e2e"><div class="ttname"><a href="#a39fca1837c5ce7715cbf571669660c13ac5c28749ad128ba2107ccf6216200e2e">__RULE_MAX</a></div><div class="ttdeci">@ __RULE_MAX</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00050">iprule.c:49</a></div></div>
<div class="ttc" id="aiprule_8c_html_a39fca1837c5ce7715cbf571669660c13ae891aceac0cf247d1da0e4e51a1bcab9"><div class="ttname"><a href="#a39fca1837c5ce7715cbf571669660c13ae891aceac0cf247d1da0e4e51a1bcab9">RULE_GOTO</a></div><div class="ttdeci">@ RULE_GOTO</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00045">iprule.c:45</a></div></div>
<div class="ttc" id="aiprule_8c_html_a39fca1837c5ce7715cbf571669660c13afe4f03c8f5aecfac704de4a684a6abcf"><div class="ttname"><a href="#a39fca1837c5ce7715cbf571669660c13afe4f03c8f5aecfac704de4a684a6abcf">RULE_LOOKUP</a></div><div class="ttdeci">@ RULE_LOOKUP</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00043">iprule.c:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a326e42044fee1f72ada45cad41e761f9" name="a326e42044fee1f72ada45cad41e761f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a326e42044fee1f72ada45cad41e761f9">&#9670;&#160;</a></span>deregister_interfaces()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void deregister_interfaces </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a> *</td>          <td class="paramname"><span class="paramname"><em>rule</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00370">370</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  371</span>{</div>
<div class="line"><span class="lineno">  372</span>    <span class="keywordflow">if</span> (rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> &amp; <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a6214e69a56829567a4d6d86065460d9b">IPRULE_IN</a> &amp;&amp; rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a19bbbbfeb0401c619905326347cbaa8a">in_iface_user</a>.<a class="code hl_variable" href="../../d4/da9/interface_8h.html#af7bad7b74a90f80f956ae4edfa9b19d8">iface</a>)</div>
<div class="line"><span class="lineno">  373</span>        <a class="code hl_function" href="../../dd/dda/interface_8c.html#a1c2694bb1c5c646ba41fed27ff7af4c6">interface_remove_user</a>(&amp;rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a19bbbbfeb0401c619905326347cbaa8a">in_iface_user</a>);</div>
<div class="line"><span class="lineno">  374</span> </div>
<div class="line"><span class="lineno">  375</span>    <span class="keywordflow">if</span> (rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> &amp; <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a33f6b55d530def41b325f5182ce8e9e1">IPRULE_OUT</a> &amp;&amp; rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a59d383d277b05e3fa325a9ddedf93a04">out_iface_user</a>.<a class="code hl_variable" href="../../d4/da9/interface_8h.html#af7bad7b74a90f80f956ae4edfa9b19d8">iface</a>)</div>
<div class="line"><span class="lineno">  376</span>        <a class="code hl_function" href="../../dd/dda/interface_8c.html#a1c2694bb1c5c646ba41fed27ff7af4c6">interface_remove_user</a>(&amp;rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a59d383d277b05e3fa325a9ddedf93a04">out_iface_user</a>);</div>
<div class="line"><span class="lineno">  377</span>}</div>
<div class="ttc" id="ainterface_8c_html_a1c2694bb1c5c646ba41fed27ff7af4c6"><div class="ttname"><a href="../../dd/dda/interface_8c.html#a1c2694bb1c5c646ba41fed27ff7af4c6">interface_remove_user</a></div><div class="ttdeci">void interface_remove_user(struct interface_user *dep)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dda/interface_8c_source.html#l00515">interface.c:515</a></div></div>
<div class="ttc" id="ainterface_8h_html_af7bad7b74a90f80f956ae4edfa9b19d8"><div class="ttname"><a href="../../d4/da9/interface_8h.html#af7bad7b74a90f80f956ae4edfa9b19d8">interface_user::iface</a></div><div class="ttdeci">struct interface * iface</div><div class="ttdef"><b>Definition</b> <a href="../../d4/da9/interface_8h_source.html#l00071">interface.h:71</a></div></div>
<div class="ttc" id="aiprule_8h_html_a0ca1194201d2ace69c4f2021b9b0d947a33f6b55d530def41b325f5182ce8e9e1"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a33f6b55d530def41b325f5182ce8e9e1">IPRULE_OUT</a></div><div class="ttdeci">@ IPRULE_OUT</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00035">iprule.h:35</a></div></div>
<div class="ttc" id="aiprule_8h_html_a0ca1194201d2ace69c4f2021b9b0d947a6214e69a56829567a4d6d86065460d9b"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a6214e69a56829567a4d6d86065460d9b">IPRULE_IN</a></div><div class="ttdeci">@ IPRULE_IN</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00032">iprule.h:32</a></div></div>
<div class="ttc" id="aiprule_8h_html_a19bbbbfeb0401c619905326347cbaa8a"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a19bbbbfeb0401c619905326347cbaa8a">iprule::in_iface_user</a></div><div class="ttdeci">struct interface_user in_iface_user</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00076">iprule.h:76</a></div></div>
<div class="ttc" id="aiprule_8h_html_a59d383d277b05e3fa325a9ddedf93a04"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a59d383d277b05e3fa325a9ddedf93a04">iprule::out_iface_user</a></div><div class="ttdeci">struct interface_user out_iface_user</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00077">iprule.h:77</a></div></div>
<div class="ttc" id="aiprule_8h_html_a9a3eeee183fdebaecbd0f4b70219f2bc"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">iprule::flags</a></div><div class="ttdeci">enum iprule_flags flags</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00090">iprule.h:90</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d40/iprule_8h_source.html#l00090">iprule::flags</a>, <a class="el" href="../../d4/da9/interface_8h_source.html#l00071">interface_user::iface</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00076">iprule::in_iface_user</a>, <a class="el" href="../../dd/dda/interface_8c_source.html#l00515">interface_remove_user()</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00032">IPRULE_IN</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00035">IPRULE_OUT</a>, and <a class="el" href="../../de/d40/iprule_8h_source.html#l00077">iprule::out_iface_user</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d27/iprule_8c_source.html#l00396">iprule_update_rule()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/d27/iprule_8c_a326e42044fee1f72ada45cad41e761f9_cgraph.png" border="0" usemap="#ad7/d27/iprule_8c_a326e42044fee1f72ada45cad41e761f9_cgraph" alt=""/></div>
<map name="ad7/d27/iprule_8c_a326e42044fee1f72ada45cad41e761f9_cgraph" id="ad7/d27/iprule_8c_a326e42044fee1f72ada45cad41e761f9_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,222,68"/>
<area shape="rect" href="../../dd/dda/interface_8c.html#a1c2694bb1c5c646ba41fed27ff7af4c6" title=" " alt="" coords="270,35,501,68"/>
<area shape="poly" title=" " alt="" coords="222,49,254,49,254,54,222,54"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae1cde0f50b85945cfff23be4fc1586f4" title=" " alt="" coords="549,35,672,68"/>
<area shape="poly" title=" " alt="" coords="501,49,534,49,534,54,501,54"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="757,5,852,39"/>
<area shape="poly" title=" " alt="" coords="672,40,742,29,743,34,673,45"/>
<area shape="rect" href="../../da/d23/list_8h.html#aea85dd50b9129ddaa3e3c67ed55804e4" title=" " alt="" coords="720,63,889,96"/>
<area shape="poly" title=" " alt="" coords="673,58,705,62,705,68,672,63"/>
</map>
</div>

</div>
</div>
<a id="a3f0f28a6bc17abaa9af5853a1a576016" name="a3f0f28a6bc17abaa9af5853a1a576016"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f0f28a6bc17abaa9af5853a1a576016">&#9670;&#160;</a></span>generic_interface_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void generic_interface_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/da9/interface_8h.html#d0/d97/structinterface__user">interface_user</a> *</td>          <td class="paramname"><span class="paramname"><em>dep</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/da9/interface_8h.html#d9/dbe/structinterface">interface</a> *</td>          <td class="paramname"><span class="paramname"><em>iface</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579">interface_event</a></td>          <td class="paramname"><span class="paramname"><em>ev</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00175">175</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  177</span>{</div>
<div class="line"><span class="lineno">  178</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a> *rule;</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordflow">if</span> (ev != <a class="code hl_enumvalue" href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579a7dfe012c317fdba185d6569cadb7f745">IFEV_CREATE</a>)</div>
<div class="line"><span class="lineno">  181</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>    <span class="comment">/* add new interfaces to rules */</span></div>
<div class="line"><span class="lineno">  184</span>    <a class="code hl_define" href="../../dd/d1d/vlist_8h.html#add31e1f4b4f9662f592e61501aaca312">vlist_for_each_element</a>(&amp;<a class="code hl_variable" href="#a2b7e163136b707246437f4aa848fd10e">iprules</a>, rule, <a class="code hl_struct" href="../../d2/d72/test-avl_8c.html#d5/da1/structnode">node</a>) {</div>
<div class="line"><span class="lineno">  185</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="#a4d0b448b056ef96781a7a739d10d0f77">rule_ready</a>(rule))</div>
<div class="line"><span class="lineno">  186</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>        <span class="keywordflow">if</span> ((rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> &amp; <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a33f6b55d530def41b325f5182ce8e9e1">IPRULE_OUT</a>) &amp;&amp; !strcmp(rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a00e83fd888bbedcf55b24cd0f9ba40fc">out_iface</a>, iface-&gt;<a class="code hl_variable" href="../../d4/da9/interface_8h.html#aee0f8e8ed8b404d358a6da91196da0d9">name</a>))</div>
<div class="line"><span class="lineno">  189</span>            <a class="code hl_function" href="../../dd/dda/interface_8c.html#a6b6109bf19780e6ed92dbef05610b262">interface_add_user</a>(&amp;rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a59d383d277b05e3fa325a9ddedf93a04">out_iface_user</a>, iface);</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>        <span class="keywordflow">if</span> ((rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> &amp; <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a6214e69a56829567a4d6d86065460d9b">IPRULE_IN</a>) &amp;&amp; !strcmp(rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a3c53a11127f452a93aa8743ccd5fdb71">in_iface</a>, iface-&gt;<a class="code hl_variable" href="../../d4/da9/interface_8h.html#aee0f8e8ed8b404d358a6da91196da0d9">name</a>))</div>
<div class="line"><span class="lineno">  192</span>            <a class="code hl_function" href="../../dd/dda/interface_8c.html#a6b6109bf19780e6ed92dbef05610b262">interface_add_user</a>(&amp;rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a19bbbbfeb0401c619905326347cbaa8a">in_iface_user</a>, iface);</div>
<div class="line"><span class="lineno">  193</span>    }</div>
<div class="line"><span class="lineno">  194</span>}</div>
<div class="ttc" id="ainterface_8c_html_a6b6109bf19780e6ed92dbef05610b262"><div class="ttname"><a href="../../dd/dda/interface_8c.html#a6b6109bf19780e6ed92dbef05610b262">interface_add_user</a></div><div class="ttdeci">void interface_add_user(struct interface_user *dep, struct interface *iface)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dda/interface_8c_source.html#l00501">interface.c:501</a></div></div>
<div class="ttc" id="ainterface_8h_html_ab8cd9b91c8d6952fa59fc48110e4a579a7dfe012c317fdba185d6569cadb7f745"><div class="ttname"><a href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579a7dfe012c317fdba185d6569cadb7f745">IFEV_CREATE</a></div><div class="ttdeci">@ IFEV_CREATE</div><div class="ttdef"><b>Definition</b> <a href="../../d4/da9/interface_8h_source.html#l00032">interface.h:32</a></div></div>
<div class="ttc" id="ainterface_8h_html_aee0f8e8ed8b404d358a6da91196da0d9"><div class="ttname"><a href="../../d4/da9/interface_8h.html#aee0f8e8ed8b404d358a6da91196da0d9">interface::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition</b> <a href="../../d4/da9/interface_8h_source.html#l00109">interface.h:109</a></div></div>
<div class="ttc" id="aiprule_8c_html_a2b7e163136b707246437f4aa848fd10e"><div class="ttname"><a href="#a2b7e163136b707246437f4aa848fd10e">iprules</a></div><div class="ttdeci">struct vlist_tree iprules</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00030">iprule.c:30</a></div></div>
<div class="ttc" id="aiprule_8c_html_a4d0b448b056ef96781a7a739d10d0f77"><div class="ttname"><a href="#a4d0b448b056ef96781a7a739d10d0f77">rule_ready</a></div><div class="ttdeci">static bool rule_ready(struct iprule *rule)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00076">iprule.c:76</a></div></div>
<div class="ttc" id="aiprule_8h_html_a00e83fd888bbedcf55b24cd0f9ba40fc"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a00e83fd888bbedcf55b24cd0f9ba40fc">iprule::out_iface</a></div><div class="ttdeci">char * out_iface</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00088">iprule.h:88</a></div></div>
<div class="ttc" id="aiprule_8h_html_a3c53a11127f452a93aa8743ccd5fdb71"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a3c53a11127f452a93aa8743ccd5fdb71">iprule::in_iface</a></div><div class="ttdeci">char * in_iface</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00087">iprule.h:87</a></div></div>
<div class="ttc" id="aiprule_8h_html_dd/d31/structiprule"><div class="ttname"><a href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a></div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00071">iprule.h:71</a></div></div>
<div class="ttc" id="atest-avl_8c_html_d5/da1/structnode"><div class="ttname"><a href="../../d2/d72/test-avl_8c.html#d5/da1/structnode">node</a></div><div class="ttdef"><b>Definition</b> <a href="../../d2/d72/test-avl_8c_source.html#l00013">test-avl.c:13</a></div></div>
<div class="ttc" id="avlist_8h_html_add31e1f4b4f9662f592e61501aaca312"><div class="ttname"><a href="../../dd/d1d/vlist_8h.html#add31e1f4b4f9662f592e61501aaca312">vlist_for_each_element</a></div><div class="ttdeci">#define vlist_for_each_element(tree, element, node_member)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d1d/vlist_8h_source.html#l00072">vlist.h:72</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d40/iprule_8h_source.html#l00090">iprule::flags</a>, <a class="el" href="../../d4/da9/interface_8h_source.html#l00032">IFEV_CREATE</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00087">iprule::in_iface</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00076">iprule::in_iface_user</a>, <a class="el" href="../../dd/dda/interface_8c_source.html#l00501">interface_add_user()</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00032">IPRULE_IN</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00035">IPRULE_OUT</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00030">iprules</a>, <a class="el" href="../../d4/da9/interface_8h_source.html#l00109">interface::name</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00088">iprule::out_iface</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00077">iprule::out_iface_user</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00076">rule_ready()</a>, and <a class="el" href="../../dd/d1d/vlist_8h_source.html#l00072">vlist_for_each_element</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/d27/iprule_8c_a3f0f28a6bc17abaa9af5853a1a576016_cgraph.png" border="0" usemap="#ad7/d27/iprule_8c_a3f0f28a6bc17abaa9af5853a1a576016_cgraph" alt=""/></div>
<map name="ad7/d27/iprule_8c_a3f0f28a6bc17abaa9af5853a1a576016_cgraph" id="ad7/d27/iprule_8c_a3f0f28a6bc17abaa9af5853a1a576016_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,218,68"/>
<area shape="rect" href="../../dd/dda/interface_8c.html#a6b6109bf19780e6ed92dbef05610b262" title=" " alt="" coords="266,5,463,39"/>
<area shape="poly" title=" " alt="" coords="218,36,250,33,251,38,219,42"/>
<area shape="rect" href="../../d7/d27/iprule_8c.html#a4d0b448b056ef96781a7a739d10d0f77" title=" " alt="" coords="305,63,424,96"/>
<area shape="poly" title=" " alt="" coords="218,61,290,69,289,74,218,66"/>
<area shape="rect" href="../../da/d23/list_8h.html#a875b53c95596d9e8df15ac54f6d24ae6" title=" " alt="" coords="511,5,603,39"/>
<area shape="poly" title=" " alt="" coords="464,20,495,20,495,25,464,25"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="651,5,753,39"/>
<area shape="poly" title=" " alt="" coords="604,20,636,20,636,25,604,25"/>
</map>
</div>

</div>
</div>
<a id="a7aeb527c6c1a5d7511594e078bf9b72a" name="a7aeb527c6c1a5d7511594e078bf9b72a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7aeb527c6c1a5d7511594e078bf9b72a">&#9670;&#160;</a></span>iprule_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iprule_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *</td>          <td class="paramname"><span class="paramname"><em>attr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>v6</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00201">201</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  202</span>{</div>
<div class="line"><span class="lineno">  203</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *tb[<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13ac5c28749ad128ba2107ccf6216200e2e">__RULE_MAX</a>], *cur;</div>
<div class="line"><span class="lineno">  204</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a> *rule;</div>
<div class="line"><span class="lineno">  205</span>    <span class="keywordtype">char</span> *iface_name;</div>
<div class="line"><span class="lineno">  206</span>    <span class="keywordtype">int</span> af = v6 ? AF_INET6 : AF_INET;</div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>    <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#aeb124dec6d59e002989d0ecf6f29a878">rule_attr</a>, <a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13ac5c28749ad128ba2107ccf6216200e2e">__RULE_MAX</a>, tb, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(attr), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052">blobmsg_data_len</a>(attr));</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>    <span class="keywordflow">if</span> ((cur = tb[<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a2ff54ab2b29ba773bba4e6b0f0ff4834">RULE_DISABLED</a>]) != NULL &amp;&amp; <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#adfbec0b532211a1442310392496a45f2">blobmsg_get_bool</a>(cur))</div>
<div class="line"><span class="lineno">  211</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>    rule = calloc(1, <span class="keyword">sizeof</span>(*rule));</div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordflow">if</span> (!rule)</div>
<div class="line"><span class="lineno">  215</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>    rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> = v6 ? <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a89be6e3a4f67564776926bda9e2e674a">IPRULE_INET6</a> : <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a47ee7f0a3b06ee3ecd954b7e56f52e74">IPRULE_INET4</a>;</div>
<div class="line"><span class="lineno">  218</span>    rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a1754c114dccad8bfca245519bfd3ce83">order</a> = <a class="code hl_variable" href="#aee12ecfbf17681c5b79e422c9fbe2843">iprules_counter</a>[rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a>]++;</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>    <span class="keywordflow">if</span> ((cur = tb[<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a8b1c0fc7b0865311fd8837f7df6b7a97">RULE_INVERT</a>]) != NULL)</div>
<div class="line"><span class="lineno">  221</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a7d2797235e780d227a1a86659df8c262">invert</a> = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#adfbec0b532211a1442310392496a45f2">blobmsg_get_bool</a>(cur);</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>    <span class="keywordflow">if</span> ((cur = tb[<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a3734c412269e1a1b059ef1e9a4801324">RULE_INTERFACE_IN</a>]) != NULL) {</div>
<div class="line"><span class="lineno">  224</span>        iface_name = calloc(1, strlen(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur)) + 1);</div>
<div class="line"><span class="lineno">  225</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a3c53a11127f452a93aa8743ccd5fdb71">in_iface</a> = strcpy(iface_name, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur));</div>
<div class="line"><span class="lineno">  226</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a19bbbbfeb0401c619905326347cbaa8a">in_iface_user</a>.<a class="code hl_variable" href="../../d4/da9/interface_8h.html#ab9f17b570f00acd8559c977b1ed9192a">cb</a> = &amp;<a class="code hl_function" href="#a90a4f46760b774e8d211619ea7a89d44">rule_in_cb</a>;</div>
<div class="line"><span class="lineno">  227</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> |= <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a6214e69a56829567a4d6d86065460d9b">IPRULE_IN</a>;</div>
<div class="line"><span class="lineno">  228</span>    }</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>    <span class="keywordflow">if</span> ((cur = tb[<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a85ed529b656cec86c741f84b15042b12">RULE_INTERFACE_OUT</a>]) != NULL) {</div>
<div class="line"><span class="lineno">  231</span>        iface_name = calloc(1, strlen(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur)) + 1);</div>
<div class="line"><span class="lineno">  232</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a00e83fd888bbedcf55b24cd0f9ba40fc">out_iface</a> = strcpy(iface_name, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur));</div>
<div class="line"><span class="lineno">  233</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a59d383d277b05e3fa325a9ddedf93a04">out_iface_user</a>.<a class="code hl_variable" href="../../d4/da9/interface_8h.html#ab9f17b570f00acd8559c977b1ed9192a">cb</a> = &amp;<a class="code hl_function" href="#a513d2c8c9c692217478aa2ba34252df1">rule_out_cb</a>;</div>
<div class="line"><span class="lineno">  234</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> |= <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a33f6b55d530def41b325f5182ce8e9e1">IPRULE_OUT</a>;</div>
<div class="line"><span class="lineno">  235</span>    }</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>    <span class="keywordflow">if</span> ((cur = tb[<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a20f430db8b13aee83375e15a12847b48">RULE_SRC</a>]) != NULL) {</div>
<div class="line"><span class="lineno">  238</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../d4/d96/netifd_2utils_8c.html#ac14f24743606fec01090abb8f4159d2d">parse_ip_and_netmask</a>(af, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur), &amp;rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a03d09dec3ed31274c6d85f4e450609b8">src_addr</a>, &amp;rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a0f2a73b39ad2f1c56b048e86f7cc421f">src_mask</a>)) {</div>
<div class="line"><span class="lineno">  239</span>            <a class="code hl_define" href="../../d3/d75/netifd_2netifd_8h.html#aca4e286dfd9f6ee7adaca201c701e924">D</a>(INTERFACE, <span class="stringliteral">&quot;Failed to parse rule source: %s&quot;</span>, (<span class="keywordtype">char</span> *) <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur));</div>
<div class="line"><span class="lineno">  240</span>            <span class="keywordflow">goto</span> error;</div>
<div class="line"><span class="lineno">  241</span>        }</div>
<div class="line"><span class="lineno">  242</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> |= <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a6c4de09e490ee496b8030d2fa5d68afa">IPRULE_SRC</a>;</div>
<div class="line"><span class="lineno">  243</span>    }</div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span>    <span class="keywordflow">if</span> ((cur = tb[<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a8e802bacb5e9abda18ee918fabff0b78">RULE_DEST</a>]) != NULL) {</div>
<div class="line"><span class="lineno">  246</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../d4/d96/netifd_2utils_8c.html#ac14f24743606fec01090abb8f4159d2d">parse_ip_and_netmask</a>(af, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur), &amp;rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a75cc151475eb8b5e4b5422e354e161b5">dest_addr</a>, &amp;rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a069c3d5b2b0f96fd052cccee6d26b186">dest_mask</a>)) {</div>
<div class="line"><span class="lineno">  247</span>            <a class="code hl_define" href="../../d3/d75/netifd_2netifd_8h.html#aca4e286dfd9f6ee7adaca201c701e924">D</a>(INTERFACE, <span class="stringliteral">&quot;Failed to parse rule destination: %s&quot;</span>, (<span class="keywordtype">char</span> *) <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur));</div>
<div class="line"><span class="lineno">  248</span>            <span class="keywordflow">goto</span> error;</div>
<div class="line"><span class="lineno">  249</span>        }</div>
<div class="line"><span class="lineno">  250</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> |= <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a82e8c2ba8a8ee54f60a1d8d58f565cc2">IPRULE_DEST</a>;</div>
<div class="line"><span class="lineno">  251</span>    }</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>    <span class="keywordflow">if</span> ((cur = tb[<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13abfc1cbaae027728ec95473abe584ce10">RULE_PRIORITY</a>]) != NULL) {</div>
<div class="line"><span class="lineno">  254</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#aea0e8f6f163baeefb72ece0723755dab">priority</a> = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(cur);</div>
<div class="line"><span class="lineno">  255</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> |= <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947aa88c09d126a17d0fd8f4a1c6c8d6c41f">IPRULE_PRIORITY</a>;</div>
<div class="line"><span class="lineno">  256</span>    }</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>    <span class="keywordflow">if</span> ((cur = tb[<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13abf6e8954b22de38627c34cf914fc3128">RULE_TOS</a>]) != NULL) {</div>
<div class="line"><span class="lineno">  259</span>        <span class="keywordflow">if</span> ((rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a10ac5b4406f0b85709168a545b5b68bf">tos</a> = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(cur)) &gt; 255) {</div>
<div class="line"><span class="lineno">  260</span>            <a class="code hl_define" href="../../d3/d75/netifd_2netifd_8h.html#aca4e286dfd9f6ee7adaca201c701e924">D</a>(INTERFACE, <span class="stringliteral">&quot;Invalid TOS value: %u&quot;</span>, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(cur));</div>
<div class="line"><span class="lineno">  261</span>            <span class="keywordflow">goto</span> error;</div>
<div class="line"><span class="lineno">  262</span>        }</div>
<div class="line"><span class="lineno">  263</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> |= <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947ab024e1fa0160a15a026a566a8529efaf">IPRULE_TOS</a>;</div>
<div class="line"><span class="lineno">  264</span>    }</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>    <span class="keywordflow">if</span> ((cur = tb[<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a1d8a34dea3d6af25048045b29f52214a">RULE_FWMARK</a>]) != NULL) {</div>
<div class="line"><span class="lineno">  267</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="#a99813a41e5341611f8950ab08efba553">iprule_parse_mark</a>(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur), rule)) {</div>
<div class="line"><span class="lineno">  268</span>            <a class="code hl_define" href="../../d3/d75/netifd_2netifd_8h.html#aca4e286dfd9f6ee7adaca201c701e924">D</a>(INTERFACE, <span class="stringliteral">&quot;Failed to parse rule fwmark: %s&quot;</span>, (<span class="keywordtype">char</span> *) <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur));</div>
<div class="line"><span class="lineno">  269</span>            <span class="keywordflow">goto</span> error;</div>
<div class="line"><span class="lineno">  270</span>        }</div>
<div class="line"><span class="lineno">  271</span>        <span class="comment">/* flags set by iprule_parse_mark() */</span></div>
<div class="line"><span class="lineno">  272</span>    }</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>    <span class="keywordflow">if</span> ((cur = tb[<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13afe4f03c8f5aecfac704de4a684a6abcf">RULE_LOOKUP</a>]) != NULL) {</div>
<div class="line"><span class="lineno">  275</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../da/d12/system-dummy_8c.html#a2b05f4e2511654c980e7694141b5017a">system_resolve_rt_table</a>(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur), &amp;rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#abdd7204f62c8d47be57538b581da40c1">lookup</a>)) {</div>
<div class="line"><span class="lineno">  276</span>            <a class="code hl_define" href="../../d3/d75/netifd_2netifd_8h.html#aca4e286dfd9f6ee7adaca201c701e924">D</a>(INTERFACE, <span class="stringliteral">&quot;Failed to parse rule lookup table: %s&quot;</span>, (<span class="keywordtype">char</span> *) <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur));</div>
<div class="line"><span class="lineno">  277</span>            <span class="keywordflow">goto</span> error;</div>
<div class="line"><span class="lineno">  278</span>        }</div>
<div class="line"><span class="lineno">  279</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> |= <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947ac820061c3c1e0b31e1f3a3a8a8bd3906">IPRULE_LOOKUP</a>;</div>
<div class="line"><span class="lineno">  280</span>    }</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>    <span class="keywordflow">if</span> ((cur = tb[<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a38ebfbf4132d1fa73eb054cabf8e5aab">RULE_SUP_PREFIXLEN</a>]) != NULL) {</div>
<div class="line"><span class="lineno">  283</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a5ae9b3805541cc2c5a61136ce3bfd5e1">sup_prefixlen</a> = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(cur);</div>
<div class="line"><span class="lineno">  284</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> |= <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a2ae9d3c9142e6b50830e349642a86b79">IPRULE_SUP_PREFIXLEN</a>;</div>
<div class="line"><span class="lineno">  285</span>    }</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>    <span class="keywordflow">if</span> ((cur = tb[<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a86412460bb1eb3257eff74f5745266c2">RULE_UIDRANGE</a>]) != NULL) {</div>
<div class="line"><span class="lineno">  288</span>        <span class="keywordtype">int</span> ret = sscanf(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(cur), <span class="stringliteral">&quot;%u-%u&quot;</span>, &amp;rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#aa4f6a2addb6dfb7f4335eedcf2685158">uidrange_start</a>, &amp;rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a2cff0b9e5cf0741d3db38a69480d3011">uidrange_end</a>);</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>        <span class="keywordflow">if</span> (ret == 1)</div>
<div class="line"><span class="lineno">  291</span>            rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a2cff0b9e5cf0741d3db38a69480d3011">uidrange_end</a> = rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#aa4f6a2addb6dfb7f4335eedcf2685158">uidrange_start</a>;</div>
<div class="line"><span class="lineno">  292</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret != 2) {</div>
<div class="line"><span class="lineno">  293</span>            <a class="code hl_define" href="../../d3/d75/netifd_2netifd_8h.html#aca4e286dfd9f6ee7adaca201c701e924">D</a>(INTERFACE, <span class="stringliteral">&quot;Failed to parse UID range: %s&quot;</span>, (<span class="keywordtype">char</span> *) <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur));</div>
<div class="line"><span class="lineno">  294</span>            <span class="keywordflow">goto</span> error;</div>
<div class="line"><span class="lineno">  295</span>        }</div>
<div class="line"><span class="lineno">  296</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> |= <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947aab1b5fc976293fabec4d23567ab678d0">IPRULE_UIDRANGE</a>;</div>
<div class="line"><span class="lineno">  297</span>    }</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>    <span class="keywordflow">if</span> ((cur = tb[<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13aabb8f0102739331bf81420db7e784b0a">RULE_ACTION</a>]) != NULL) {</div>
<div class="line"><span class="lineno">  300</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../da/d12/system-dummy_8c.html#a956997d89612ec8774b76854579547bf">system_resolve_iprule_action</a>(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur), &amp;rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a42d194461d61650ed184d44848a4af3a">action</a>)) {</div>
<div class="line"><span class="lineno">  301</span>            <a class="code hl_define" href="../../d3/d75/netifd_2netifd_8h.html#aca4e286dfd9f6ee7adaca201c701e924">D</a>(INTERFACE, <span class="stringliteral">&quot;Failed to parse rule action: %s&quot;</span>, (<span class="keywordtype">char</span> *) <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur));</div>
<div class="line"><span class="lineno">  302</span>            <span class="keywordflow">goto</span> error;</div>
<div class="line"><span class="lineno">  303</span>        }</div>
<div class="line"><span class="lineno">  304</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> |= <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947af4f3bda839ec2ad127c7c621e060e9cb">IPRULE_ACTION</a>;</div>
<div class="line"><span class="lineno">  305</span>    }</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>    <span class="keywordflow">if</span> ((cur = tb[<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13ae891aceac0cf247d1da0e4e51a1bcab9">RULE_GOTO</a>]) != NULL) {</div>
<div class="line"><span class="lineno">  308</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#af9140eb3e62ad0bb0c07e5bb2e4702a9">gotoid</a> = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(cur);</div>
<div class="line"><span class="lineno">  309</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> |= <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a1e9e4fb20b7d43ffdc0d31f6d86e954b">IPRULE_GOTO</a>;</div>
<div class="line"><span class="lineno">  310</span>    }</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>    <a class="code hl_function" href="../../d5/d9a/vlist_8c.html#ac913b1e12f698be7f0d79ed459a68cd7">vlist_add</a>(&amp;<a class="code hl_variable" href="#a2b7e163136b707246437f4aa848fd10e">iprules</a>, &amp;rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a0641b974a7b4ab2243b15eb353a88a63">node</a>, rule);</div>
<div class="line"><span class="lineno">  313</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>error:</div>
<div class="line"><span class="lineno">  316</span>    free(rule);</div>
<div class="line"><span class="lineno">  317</span>}</div>
<div class="ttc" id="ablob_8h_html_dc/dd9/structblob__attr"><div class="ttname"><a href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a></div><div class="ttdef"><b>Definition</b> <a href="../../d8/d3c/blob_8h_source.html#l00052">blob.h:52</a></div></div>
<div class="ttc" id="ablobmsg_8c_html_afb56b36905412b6618a529c171e833ed"><div class="ttname"><a href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a></div><div class="ttdeci">int blobmsg_parse(const struct blobmsg_policy *policy, int policy_len, struct blob_attr **tb, void *data, unsigned int len)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d30/blobmsg_8c_source.html#l00166">blobmsg.c:166</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a065ed993444c3173838a480ba4aac052"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052">blobmsg_data_len</a></div><div class="ttdeci">static size_t blobmsg_data_len(const struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00095">blobmsg.h:95</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a6c1cc8e52e96bf9698f6b0f65ad48603"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a></div><div class="ttdeci">static char * blobmsg_get_string(struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00348">blobmsg.h:348</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a856562b4d96007d3ce1a052998451a0f"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a></div><div class="ttdeci">static uint32_t blobmsg_get_u32(struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00293">blobmsg.h:293</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_ab788ffb2ae75d047fa39be6e79571d20"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a></div><div class="ttdeci">static void * blobmsg_data(const struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00078">blobmsg.h:78</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_adfbec0b532211a1442310392496a45f2"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#adfbec0b532211a1442310392496a45f2">blobmsg_get_bool</a></div><div class="ttdeci">static bool blobmsg_get_bool(struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00283">blobmsg.h:283</a></div></div>
<div class="ttc" id="ainterface_8h_html_ab9f17b570f00acd8559c977b1ed9192a"><div class="ttname"><a href="../../d4/da9/interface_8h.html#ab9f17b570f00acd8559c977b1ed9192a">interface_user::cb</a></div><div class="ttdeci">void(* cb)(struct interface_user *dep, struct interface *iface, enum interface_event ev)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/da9/interface_8h_source.html#l00072">interface.h:72</a></div></div>
<div class="ttc" id="aiprule_8c_html_a513d2c8c9c692217478aa2ba34252df1"><div class="ttname"><a href="#a513d2c8c9c692217478aa2ba34252df1">rule_out_cb</a></div><div class="ttdeci">static void rule_out_cb(struct interface_user *dep, struct interface *iface, enum interface_event ev)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00147">iprule.c:147</a></div></div>
<div class="ttc" id="aiprule_8c_html_a90a4f46760b774e8d211619ea7a89d44"><div class="ttname"><a href="#a90a4f46760b774e8d211619ea7a89d44">rule_in_cb</a></div><div class="ttdeci">static void rule_in_cb(struct interface_user *dep, struct interface *iface, enum interface_event ev)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00119">iprule.c:119</a></div></div>
<div class="ttc" id="aiprule_8c_html_a99813a41e5341611f8950ab08efba553"><div class="ttname"><a href="#a99813a41e5341611f8950ab08efba553">iprule_parse_mark</a></div><div class="ttdeci">static bool iprule_parse_mark(const char *mark, struct iprule *rule)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00088">iprule.c:88</a></div></div>
<div class="ttc" id="aiprule_8c_html_aeb124dec6d59e002989d0ecf6f29a878"><div class="ttname"><a href="#aeb124dec6d59e002989d0ecf6f29a878">rule_attr</a></div><div class="ttdeci">static const struct blobmsg_policy rule_attr[__RULE_MAX]</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00052">iprule.c:52</a></div></div>
<div class="ttc" id="aiprule_8c_html_aee12ecfbf17681c5b79e422c9fbe2843"><div class="ttname"><a href="#aee12ecfbf17681c5b79e422c9fbe2843">iprules_counter</a></div><div class="ttdeci">static unsigned int iprules_counter[2]</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00032">iprule.c:32</a></div></div>
<div class="ttc" id="aiprule_8h_html_a03d09dec3ed31274c6d85f4e450609b8"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a03d09dec3ed31274c6d85f4e450609b8">iprule::src_addr</a></div><div class="ttdeci">union if_addr src_addr</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00095">iprule.h:95</a></div></div>
<div class="ttc" id="aiprule_8h_html_a0641b974a7b4ab2243b15eb353a88a63"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a0641b974a7b4ab2243b15eb353a88a63">iprule::node</a></div><div class="ttdeci">struct vlist_node node</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00072">iprule.h:72</a></div></div>
<div class="ttc" id="aiprule_8h_html_a069c3d5b2b0f96fd052cccee6d26b186"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a069c3d5b2b0f96fd052cccee6d26b186">iprule::dest_mask</a></div><div class="ttdeci">unsigned int dest_mask</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00097">iprule.h:97</a></div></div>
<div class="ttc" id="aiprule_8h_html_a0ca1194201d2ace69c4f2021b9b0d947a1e9e4fb20b7d43ffdc0d31f6d86e954b"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a1e9e4fb20b7d43ffdc0d31f6d86e954b">IPRULE_GOTO</a></div><div class="ttdeci">@ IPRULE_GOTO</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00062">iprule.h:62</a></div></div>
<div class="ttc" id="aiprule_8h_html_a0ca1194201d2ace69c4f2021b9b0d947a2ae9d3c9142e6b50830e349642a86b79"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a2ae9d3c9142e6b50830e349642a86b79">IPRULE_SUP_PREFIXLEN</a></div><div class="ttdeci">@ IPRULE_SUP_PREFIXLEN</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00065">iprule.h:65</a></div></div>
<div class="ttc" id="aiprule_8h_html_a0ca1194201d2ace69c4f2021b9b0d947a47ee7f0a3b06ee3ecd954b7e56f52e74"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a47ee7f0a3b06ee3ecd954b7e56f52e74">IPRULE_INET4</a></div><div class="ttdeci">@ IPRULE_INET4</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00027">iprule.h:27</a></div></div>
<div class="ttc" id="aiprule_8h_html_a0ca1194201d2ace69c4f2021b9b0d947a6c4de09e490ee496b8030d2fa5d68afa"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a6c4de09e490ee496b8030d2fa5d68afa">IPRULE_SRC</a></div><div class="ttdeci">@ IPRULE_SRC</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00038">iprule.h:38</a></div></div>
<div class="ttc" id="aiprule_8h_html_a0ca1194201d2ace69c4f2021b9b0d947a82e8c2ba8a8ee54f60a1d8d58f565cc2"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a82e8c2ba8a8ee54f60a1d8d58f565cc2">IPRULE_DEST</a></div><div class="ttdeci">@ IPRULE_DEST</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00041">iprule.h:41</a></div></div>
<div class="ttc" id="aiprule_8h_html_a0ca1194201d2ace69c4f2021b9b0d947a89be6e3a4f67564776926bda9e2e674a"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a89be6e3a4f67564776926bda9e2e674a">IPRULE_INET6</a></div><div class="ttdeci">@ IPRULE_INET6</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00028">iprule.h:28</a></div></div>
<div class="ttc" id="aiprule_8h_html_a0ca1194201d2ace69c4f2021b9b0d947aa88c09d126a17d0fd8f4a1c6c8d6c41f"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947aa88c09d126a17d0fd8f4a1c6c8d6c41f">IPRULE_PRIORITY</a></div><div class="ttdeci">@ IPRULE_PRIORITY</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00044">iprule.h:44</a></div></div>
<div class="ttc" id="aiprule_8h_html_a0ca1194201d2ace69c4f2021b9b0d947aab1b5fc976293fabec4d23567ab678d0"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947aab1b5fc976293fabec4d23567ab678d0">IPRULE_UIDRANGE</a></div><div class="ttdeci">@ IPRULE_UIDRANGE</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00068">iprule.h:68</a></div></div>
<div class="ttc" id="aiprule_8h_html_a0ca1194201d2ace69c4f2021b9b0d947ab024e1fa0160a15a026a566a8529efaf"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947ab024e1fa0160a15a026a566a8529efaf">IPRULE_TOS</a></div><div class="ttdeci">@ IPRULE_TOS</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00047">iprule.h:47</a></div></div>
<div class="ttc" id="aiprule_8h_html_a0ca1194201d2ace69c4f2021b9b0d947ac820061c3c1e0b31e1f3a3a8a8bd3906"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947ac820061c3c1e0b31e1f3a3a8a8bd3906">IPRULE_LOOKUP</a></div><div class="ttdeci">@ IPRULE_LOOKUP</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00056">iprule.h:56</a></div></div>
<div class="ttc" id="aiprule_8h_html_a0ca1194201d2ace69c4f2021b9b0d947af4f3bda839ec2ad127c7c621e060e9cb"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947af4f3bda839ec2ad127c7c621e060e9cb">IPRULE_ACTION</a></div><div class="ttdeci">@ IPRULE_ACTION</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00059">iprule.h:59</a></div></div>
<div class="ttc" id="aiprule_8h_html_a0f2a73b39ad2f1c56b048e86f7cc421f"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a0f2a73b39ad2f1c56b048e86f7cc421f">iprule::src_mask</a></div><div class="ttdeci">unsigned int src_mask</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00094">iprule.h:94</a></div></div>
<div class="ttc" id="aiprule_8h_html_a10ac5b4406f0b85709168a545b5b68bf"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a10ac5b4406f0b85709168a545b5b68bf">iprule::tos</a></div><div class="ttdeci">unsigned int tos</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00101">iprule.h:101</a></div></div>
<div class="ttc" id="aiprule_8h_html_a1754c114dccad8bfca245519bfd3ce83"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a1754c114dccad8bfca245519bfd3ce83">iprule::order</a></div><div class="ttdeci">unsigned int order</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00073">iprule.h:73</a></div></div>
<div class="ttc" id="aiprule_8h_html_a2cff0b9e5cf0741d3db38a69480d3011"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a2cff0b9e5cf0741d3db38a69480d3011">iprule::uidrange_end</a></div><div class="ttdeci">unsigned int uidrange_end</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00109">iprule.h:109</a></div></div>
<div class="ttc" id="aiprule_8h_html_a42d194461d61650ed184d44848a4af3a"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a42d194461d61650ed184d44848a4af3a">iprule::action</a></div><div class="ttdeci">unsigned int action</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00110">iprule.h:110</a></div></div>
<div class="ttc" id="aiprule_8h_html_a5ae9b3805541cc2c5a61136ce3bfd5e1"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a5ae9b3805541cc2c5a61136ce3bfd5e1">iprule::sup_prefixlen</a></div><div class="ttdeci">unsigned int sup_prefixlen</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00107">iprule.h:107</a></div></div>
<div class="ttc" id="aiprule_8h_html_a75cc151475eb8b5e4b5422e354e161b5"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a75cc151475eb8b5e4b5422e354e161b5">iprule::dest_addr</a></div><div class="ttdeci">union if_addr dest_addr</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00098">iprule.h:98</a></div></div>
<div class="ttc" id="aiprule_8h_html_a7d2797235e780d227a1a86659df8c262"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a7d2797235e780d227a1a86659df8c262">iprule::invert</a></div><div class="ttdeci">bool invert</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00092">iprule.h:92</a></div></div>
<div class="ttc" id="aiprule_8h_html_aa4f6a2addb6dfb7f4335eedcf2685158"><div class="ttname"><a href="../../de/d40/iprule_8h.html#aa4f6a2addb6dfb7f4335eedcf2685158">iprule::uidrange_start</a></div><div class="ttdeci">unsigned int uidrange_start</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00108">iprule.h:108</a></div></div>
<div class="ttc" id="aiprule_8h_html_abdd7204f62c8d47be57538b581da40c1"><div class="ttname"><a href="../../de/d40/iprule_8h.html#abdd7204f62c8d47be57538b581da40c1">iprule::lookup</a></div><div class="ttdeci">unsigned int lookup</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00106">iprule.h:106</a></div></div>
<div class="ttc" id="aiprule_8h_html_aea0e8f6f163baeefb72ece0723755dab"><div class="ttname"><a href="../../de/d40/iprule_8h.html#aea0e8f6f163baeefb72ece0723755dab">iprule::priority</a></div><div class="ttdeci">unsigned int priority</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00100">iprule.h:100</a></div></div>
<div class="ttc" id="aiprule_8h_html_af9140eb3e62ad0bb0c07e5bb2e4702a9"><div class="ttname"><a href="../../de/d40/iprule_8h.html#af9140eb3e62ad0bb0c07e5bb2e4702a9">iprule::gotoid</a></div><div class="ttdeci">unsigned int gotoid</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00111">iprule.h:111</a></div></div>
<div class="ttc" id="anetifd_2netifd_8h_html_aca4e286dfd9f6ee7adaca201c701e924"><div class="ttname"><a href="../../d3/d75/netifd_2netifd_8h.html#aca4e286dfd9f6ee7adaca201c701e924">D</a></div><div class="ttdeci">#define D(level, format,...)</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d75/netifd_2netifd_8h_source.html#l00083">netifd.h:83</a></div></div>
<div class="ttc" id="anetifd_2utils_8c_html_ac14f24743606fec01090abb8f4159d2d"><div class="ttname"><a href="../../d4/d96/netifd_2utils_8c.html#ac14f24743606fec01090abb8f4159d2d">parse_ip_and_netmask</a></div><div class="ttdeci">int parse_ip_and_netmask(int af, const char *str, void *addr, unsigned int *netmask)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d96/netifd_2utils_8c_source.html#l00120">utils.c:120</a></div></div>
<div class="ttc" id="asystem-dummy_8c_html_a2b05f4e2511654c980e7694141b5017a"><div class="ttname"><a href="../../da/d12/system-dummy_8c.html#a2b05f4e2511654c980e7694141b5017a">system_resolve_rt_table</a></div><div class="ttdeci">bool system_resolve_rt_table(const char *name, unsigned int *id)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d12/system-dummy_8c_source.html#l00290">system-dummy.c:290</a></div></div>
<div class="ttc" id="asystem-dummy_8c_html_a956997d89612ec8774b76854579547bf"><div class="ttname"><a href="../../da/d12/system-dummy_8c.html#a956997d89612ec8774b76854579547bf">system_resolve_iprule_action</a></div><div class="ttdeci">bool system_resolve_iprule_action(const char *action, unsigned int *id)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d12/system-dummy_8c_source.html#l00322">system-dummy.c:322</a></div></div>
<div class="ttc" id="avlist_8c_html_ac913b1e12f698be7f0d79ed459a68cd7"><div class="ttname"><a href="../../d5/d9a/vlist_8c.html#ac913b1e12f698be7f0d79ed459a68cd7">vlist_add</a></div><div class="ttdeci">void vlist_add(struct vlist_tree *tree, struct vlist_node *node, const void *key)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d9a/vlist_8c_source.html#l00036">vlist.c:36</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d27/iprule_8c_source.html#l00049">__RULE_MAX</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00110">iprule::action</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00078">blobmsg_data()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00095">blobmsg_data_len()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00283">blobmsg_get_bool()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00348">blobmsg_get_string()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00293">blobmsg_get_u32()</a>, <a class="el" href="../../d1/d30/blobmsg_8c_source.html#l00166">blobmsg_parse()</a>, <a class="el" href="../../d4/da9/interface_8h_source.html#l00072">interface_user::cb</a>, <a class="el" href="../../d3/d75/netifd_2netifd_8h_source.html#l00083">D</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00098">iprule::dest_addr</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00097">iprule::dest_mask</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00090">iprule::flags</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00111">iprule::gotoid</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00087">iprule::in_iface</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00076">iprule::in_iface_user</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00092">iprule::invert</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00059">IPRULE_ACTION</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00041">IPRULE_DEST</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00062">IPRULE_GOTO</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00032">IPRULE_IN</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00027">IPRULE_INET4</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00028">IPRULE_INET6</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00056">IPRULE_LOOKUP</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00035">IPRULE_OUT</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00088">iprule_parse_mark()</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00044">IPRULE_PRIORITY</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00038">IPRULE_SRC</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00065">IPRULE_SUP_PREFIXLEN</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00047">IPRULE_TOS</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00068">IPRULE_UIDRANGE</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00030">iprules</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00032">iprules_counter</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00106">iprule::lookup</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00072">iprule::node</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00073">iprule::order</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00088">iprule::out_iface</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00077">iprule::out_iface_user</a>, <a class="el" href="../../d4/d96/netifd_2utils_8c_source.html#l00120">parse_ip_and_netmask()</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00100">iprule::priority</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00044">RULE_ACTION</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00052">rule_attr</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00039">RULE_DEST</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00048">RULE_DISABLED</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00042">RULE_FWMARK</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00045">RULE_GOTO</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00119">rule_in_cb()</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00035">RULE_INTERFACE_IN</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00036">RULE_INTERFACE_OUT</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00037">RULE_INVERT</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00043">RULE_LOOKUP</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00147">rule_out_cb()</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00040">RULE_PRIORITY</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00038">RULE_SRC</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00046">RULE_SUP_PREFIXLEN</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00041">RULE_TOS</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00047">RULE_UIDRANGE</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00095">iprule::src_addr</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00094">iprule::src_mask</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00107">iprule::sup_prefixlen</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00322">system_resolve_iprule_action()</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00290">system_resolve_rt_table()</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00101">iprule::tos</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00109">iprule::uidrange_end</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00108">iprule::uidrange_start</a>, and <a class="el" href="../../d5/d9a/vlist_8c_source.html#l00036">vlist_add()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d65/netifd_2config_8c_source.html#l00242">config_parse_rule()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/d27/iprule_8c_a7aeb527c6c1a5d7511594e078bf9b72a_cgraph.png" border="0" usemap="#ad7/d27/iprule_8c_a7aeb527c6c1a5d7511594e078bf9b72a_cgraph" alt=""/></div>
<map name="ad7/d27/iprule_8c_a7aeb527c6c1a5d7511594e078bf9b72a_cgraph" id="ad7/d27/iprule_8c_a7aeb527c6c1a5d7511594e078bf9b72a_cgraph">
<area shape="rect" title=" " alt="" coords="5,513,124,547"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="1064,172,1215,206"/>
<area shape="poly" title=" " alt="" coords="65,513,76,429,97,311,111,251,128,196,147,152,170,123,200,104,238,89,282,78,331,70,442,65,562,70,683,81,799,97,979,130,1034,145,1084,163,1082,168,1032,150,978,136,798,102,683,87,561,75,442,70,332,76,283,83,240,94,203,108,173,127,152,155,133,198,116,252,102,312,81,430,70,513"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052" title=" " alt="" coords="772,600,960,634"/>
<area shape="poly" title=" " alt="" coords="117,510,171,498,239,491,293,489,414,498,563,513,627,528,706,556,731,571,755,587,769,592,767,597,752,591,728,576,704,561,626,533,563,519,414,504,293,494,240,496,172,504,119,515"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#adfbec0b532211a1442310392496a45f2" title=" " alt="" coords="490,121,678,155"/>
<area shape="poly" title=" " alt="" coords="66,513,78,438,101,335,131,236,150,198,170,172,205,149,244,131,285,119,327,112,411,109,487,116,486,121,411,115,328,118,286,125,246,136,208,153,173,176,154,200,136,238,106,337,84,439,71,513"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603" title=" " alt="" coords="764,172,968,206"/>
<area shape="poly" title=" " alt="" coords="68,512,80,475,100,428,130,379,148,357,170,338,238,294,312,260,390,233,468,213,546,199,620,190,749,183,749,189,620,196,547,205,470,218,391,238,314,265,241,299,173,342,152,360,134,382,105,430,85,477,73,514"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f" title=" " alt="" coords="200,12,386,46"/>
<area shape="poly" title=" " alt="" coords="65,513,75,420,96,285,110,216,127,152,147,99,170,63,185,51,188,55,174,67,152,102,132,154,115,217,101,286,81,421,70,513"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed" title=" " alt="" coords="212,352,374,386"/>
<area shape="poly" title=" " alt="" coords="88,511,253,393,257,397,92,515"/>
<area shape="rect" href="../../d7/d27/iprule_8c.html#a99813a41e5341611f8950ab08efba553" title=" " alt="" coords="197,513,389,547"/>
<area shape="poly" title=" " alt="" coords="124,528,181,528,181,533,124,533"/>
<area shape="rect" href="../../d4/d96/netifd_2utils_8c.html#ac14f24743606fec01090abb8f4159d2d" title=" " alt="" coords="177,571,409,604"/>
<area shape="poly" title=" " alt="" coords="125,544,172,557,200,564,199,569,171,562,123,549"/>
<area shape="rect" href="../../d7/d27/iprule_8c.html#a90a4f46760b774e8d211619ea7a89d44" title=" " alt="" coords="236,628,350,662"/>
<area shape="poly" title=" " alt="" coords="84,546,122,581,173,615,221,631,220,637,170,619,119,585,80,550"/>
<area shape="rect" href="../../d7/d27/iprule_8c.html#a513d2c8c9c692217478aa2ba34252df1" title=" " alt="" coords="229,685,357,719"/>
<area shape="poly" title=" " alt="" coords="76,546,112,609,140,643,173,672,215,690,213,695,170,677,136,647,107,612,71,549"/>
<area shape="rect" href="../../da/d12/system-dummy_8c.html#a956997d89612ec8774b76854579547bf" title=" " alt="" coords="180,743,406,800"/>
<area shape="poly" title=" " alt="" coords="73,547,85,585,105,634,134,685,152,709,173,730,177,732,173,736,170,734,148,712,130,688,100,636,80,586,68,548"/>
<area shape="rect" href="../../da/d12/system-dummy_8c.html#a2b05f4e2511654c980e7694141b5017a" title=" " alt="" coords="172,824,414,858"/>
<area shape="poly" title=" " alt="" coords="70,547,76,599,93,670,106,708,124,745,146,780,173,810,178,813,175,817,170,814,142,783,119,748,101,710,88,672,71,600,64,548"/>
<area shape="rect" href="../../d5/d9a/vlist_8c.html#ac913b1e12f698be7f0d79ed459a68cd7" title=" " alt="" coords="241,881,345,915"/>
<area shape="poly" title=" " alt="" coords="68,547,71,608,85,695,98,742,117,789,141,831,173,868,198,884,227,893,225,898,196,889,170,872,137,834,112,791,93,744,80,697,66,609,63,548"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="1340,337,1451,371"/>
<area shape="poly" title=" " alt="" coords="1170,204,1211,232,1254,267,1268,283,1277,298,1286,311,1301,324,1326,336,1323,341,1299,329,1282,315,1272,301,1264,286,1250,271,1208,236,1167,208"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="1305,165,1486,199"/>
<area shape="poly" title=" " alt="" coords="1216,184,1289,182,1289,188,1216,190"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ac239a83ed3c7f835e2b49f785953c934" title=" " alt="" coords="1310,280,1480,314"/>
<area shape="poly" title=" " alt="" coords="1172,204,1231,235,1301,267,1317,272,1315,277,1299,271,1229,240,1170,209"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a7613e130753e766f5d381c06b1f7b86f" title=" " alt="" coords="1300,223,1490,256"/>
<area shape="poly" title=" " alt="" coords="1216,201,1292,217,1291,222,1215,207"/>
<area shape="poly" title=" " alt="" coords="959,601,977,587,1003,549,1014,511,1014,473,1008,435,1001,396,998,356,1004,313,1024,268,1052,236,1085,212,1088,216,1055,240,1029,270,1010,314,1004,356,1007,396,1013,435,1019,473,1019,512,1008,551,981,591,962,605"/>
<area shape="poly" title=" " alt="" coords="959,599,977,587,989,574,996,561,1001,532,1005,503,1013,488,1025,474,1059,447,1096,424,1176,390,1255,369,1324,358,1325,363,1256,374,1177,395,1098,429,1062,451,1029,478,1017,491,1011,505,1006,533,1001,562,993,577,980,591,962,603"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a9921d2b89577d3344abbb66f24773e32" title=" " alt="" coords="1346,488,1444,522"/>
<area shape="poly" title=" " alt="" coords="949,597,1331,516,1332,521,950,602"/>
<area shape="poly" title=" " alt="" coords="678,137,820,143,979,157,1049,168,1048,173,978,162,820,149,678,143"/>
<area shape="poly" title=" " alt="" coords="968,186,1048,186,1048,192,968,192"/>
<area shape="poly" title=" " alt="" coords="386,14,507,5,657,5,739,10,821,21,902,38,980,63,1020,82,1057,107,1114,159,1111,163,1053,111,1017,87,978,67,900,43,820,26,738,16,657,10,507,11,386,20"/>
<area shape="poly" title=" " alt="" coords="375,365,1324,353,1324,358,375,371"/>
<area shape="poly" title=" " alt="" coords="320,349,392,306,496,251,621,197,687,174,753,157,824,145,897,138,1043,136,1177,146,1289,160,1289,166,1177,151,1042,141,897,143,825,150,754,162,688,180,623,202,499,256,394,311,323,354"/>
<area shape="poly" title=" " alt="" coords="374,354,661,312,1026,266,1284,244,1284,249,1027,272,662,317,375,359"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#ac79cacbc6a47f754832dc10bafa3b761" title=" " alt="" coords="822,543,910,576"/>
<area shape="poly" title=" " alt="" coords="339,384,463,426,531,442,586,449,641,459,707,484,721,493,731,503,755,521,808,543,806,548,752,526,728,507,718,497,704,489,639,464,586,454,530,447,461,432,338,389"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5a5283071ac5677652515d9a8460e655" title=" " alt="" coords="462,383,705,416"/>
<area shape="poly" title=" " alt="" coords="375,375,447,383,446,388,374,380"/>
<area shape="poly" title=" " alt="" coords="624,380,752,327,1073,209,1075,214,754,331,626,385"/>
<area shape="poly" title=" " alt="" coords="619,415,664,444,707,485,723,513,729,540,736,564,755,587,760,591,757,595,751,591,732,566,724,541,718,515,703,488,661,448,616,419"/>
<area shape="poly" title=" " alt="" coords="674,415,707,434,725,456,732,479,739,501,755,522,780,537,808,547,806,552,778,542,752,526,734,503,727,480,720,458,704,438,671,419"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6b6c429265d86411d05951d2fae7289a" title=" " alt="" coords="779,433,953,467"/>
<area shape="poly" title=" " alt="" coords="682,414,764,429,763,435,681,420"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a2c4753820a7472bba7b999fbba79df01" title=" " alt="" coords="1069,488,1210,522"/>
<area shape="poly" title=" " alt="" coords="663,415,707,433,722,445,731,457,740,468,754,477,830,501,909,512,986,515,1053,512,1053,518,986,521,909,518,829,506,752,482,736,472,727,460,718,449,704,438,661,420"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a131936c081164c18e6241d79f3b276d1" title=" " alt="" coords="1027,281,1252,315"/>
<area shape="poly" title=" " alt="" coords="680,380,1028,316,1029,321,681,385"/>
<area shape="poly" title=" " alt="" coords="1211,502,1330,502,1330,508,1211,508"/>
<area shape="poly" title=" " alt="" coords="1220,313,1325,336,1324,342,1219,318"/>
<area shape="poly" title=" " alt="" coords="1167,279,1226,244,1299,208,1314,202,1315,207,1301,213,1229,248,1169,283"/>
<area shape="poly" title=" " alt="" coords="1252,295,1294,295,1294,300,1252,300"/>
<area shape="poly" title=" " alt="" coords="1215,278,1303,258,1304,263,1217,283"/>
<area shape="poly" title=" " alt="" coords="1164,314,1363,476,1359,480,1160,318"/>
<area shape="rect" href="../../d4/d96/netifd_2utils_8c.html#a271b944607573a5dc07a3536178d101a" title=" " alt="" coords="509,571,658,604"/>
<area shape="poly" title=" " alt="" coords="409,585,493,585,493,590,409,590"/>
<area shape="rect" href="../../d4/d96/netifd_2utils_8c.html#a5f488d16837cc56ba50561dbe1ce0200" title=" " alt="" coords="753,657,979,691"/>
<area shape="poly" title=" " alt="" coords="660,598,706,613,731,629,755,644,769,650,767,655,752,649,728,633,704,618,658,603"/>
<area shape="rect" href="../../d7/d27/iprule_8c.html#a4d0b448b056ef96781a7a739d10d0f77" title=" " alt="" coords="525,743,643,776"/>
<area shape="poly" title=" " alt="" coords="351,648,384,656,415,671,432,686,440,701,449,716,464,729,486,740,510,748,509,753,484,745,460,734,444,719,436,704,427,689,413,675,382,661,350,653"/>
<area shape="rect" href="../../da/d12/system-dummy_8c.html#aee9e4cf147264086eb292977c8df60d1" title=" " alt="" coords="487,628,681,662"/>
<area shape="poly" title=" " alt="" coords="350,642,471,642,471,648,350,648"/>
<area shape="rect" href="../../da/d12/system-dummy_8c.html#abcae62722c192dc27b24ea60cfdb3c77" title=" " alt="" coords="490,685,677,719"/>
<area shape="poly" title=" " alt="" coords="351,654,480,679,479,685,350,659"/>
<area shape="poly" title=" " alt="" coords="358,712,510,742,509,748,357,717"/>
<area shape="poly" title=" " alt="" coords="357,687,479,663,480,668,358,692"/>
<area shape="poly" title=" " alt="" coords="357,700,475,700,475,705,357,705"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#aff86971e7141b6e9af18b7601066b106" title=" " alt="" coords="527,939,641,972"/>
<area shape="poly" title=" " alt="" coords="346,906,512,939,511,944,345,911"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e08d7ee7d67ff58eeea30dd8a9356d1" title=" " alt="" coords="537,881,630,915"/>
<area shape="poly" title=" " alt="" coords="345,896,522,896,522,901,345,901"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab9041e08938920d5ae722e2d57dc20e2" title=" " alt="" coords="529,824,639,858"/>
<area shape="poly" title=" " alt="" coords="345,886,513,852,514,857,346,891"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#adcd20fb25eb25a816468018d720977e6" title=" " alt="" coords="773,951,959,984"/>
<area shape="poly" title=" " alt="" coords="641,955,758,960,758,966,641,961"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a6de877c20c7b55fa52c80e7be87715fa" title=" " alt="" coords="817,869,915,903"/>
<area shape="poly" title=" " alt="" coords="641,940,705,925,753,912,801,899,802,904,754,917,706,930,642,946"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a678c2372f389572c6513ffe9bb65d73f" title=" " alt="" coords="803,1008,929,1042"/>
<area shape="poly" title=" " alt="" coords="642,967,788,1003,787,1008,641,972"/>
<area shape="rect" href="../../da/d23/list_8h.html#abb4dd1eb7346eb35ea621351220e80ce" title=" " alt="" coords="809,812,923,846"/>
<area shape="poly" title=" " alt="" coords="641,949,673,940,704,925,719,909,727,891,735,873,752,855,772,844,793,836,795,841,774,849,755,859,739,876,732,893,724,912,707,930,675,945,642,954"/>
<area shape="poly" title=" " alt="" coords="817,952,812,942,819,932,837,926,866,924,897,927,914,933,912,938,896,932,866,929,838,931,822,936,817,942,822,949"/>
<area shape="poly" title=" " alt="" coords="640,847,802,873,801,879,639,852"/>
<area shape="poly" title=" " alt="" coords="639,836,794,829,794,835,639,841"/>
</map>
</div>

</div>
</div>
<a id="a9a87efea3fb0e71473bb237159500343" name="a9a87efea3fb0e71473bb237159500343"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a87efea3fb0e71473bb237159500343">&#9670;&#160;</a></span>iprule_init_list()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="../../d9/dd0/netifd_2utils_8h.html#aca8f1e05ca62886e6d99e8dc006e5500">__init</a> iprule_init_list </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00431">431</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  432</span>{</div>
<div class="line"><span class="lineno">  433</span>    <a class="code hl_function" href="../../d5/d9a/vlist_8c.html#ac79110e0303dfd3332b3648a921fd004">vlist_init</a>(&amp;<a class="code hl_variable" href="#a2b7e163136b707246437f4aa848fd10e">iprules</a>, <a class="code hl_function" href="#ad2a778d5100d5f7eeddcc71f7cf14b0a">rule_cmp</a>, <a class="code hl_function" href="#a1f6c0402fffb7ad118230b8d703d2588">iprule_update_rule</a>);</div>
<div class="line"><span class="lineno">  434</span>    <a class="code hl_function" href="../../dd/dda/interface_8c.html#a6b6109bf19780e6ed92dbef05610b262">interface_add_user</a>(&amp;<a class="code hl_variable" href="#a180e8ee9a1586c10d356bb4f3e1b76a1">generic_listener</a>, NULL);</div>
<div class="line"><span class="lineno">  435</span>}</div>
<div class="ttc" id="aiprule_8c_html_a180e8ee9a1586c10d356bb4f3e1b76a1"><div class="ttname"><a href="#a180e8ee9a1586c10d356bb4f3e1b76a1">generic_listener</a></div><div class="ttdeci">struct interface_user generic_listener</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00196">iprule.c:196</a></div></div>
<div class="ttc" id="aiprule_8c_html_a1f6c0402fffb7ad118230b8d703d2588"><div class="ttname"><a href="#a1f6c0402fffb7ad118230b8d703d2588">iprule_update_rule</a></div><div class="ttdeci">static void iprule_update_rule(struct vlist_tree *tree, struct vlist_node *node_new, struct vlist_node *node_old)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00396">iprule.c:396</a></div></div>
<div class="ttc" id="aiprule_8c_html_ad2a778d5100d5f7eeddcc71f7cf14b0a"><div class="ttname"><a href="#ad2a778d5100d5f7eeddcc71f7cf14b0a">rule_cmp</a></div><div class="ttdeci">static int rule_cmp(const void *k1, const void *k2, void *ptr)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00340">iprule.c:340</a></div></div>
<div class="ttc" id="avlist_8c_html_ac79110e0303dfd3332b3648a921fd004"><div class="ttname"><a href="../../d5/d9a/vlist_8c.html#ac79110e0303dfd3332b3648a921fd004">vlist_init</a></div><div class="ttdeci">void vlist_init(struct vlist_tree *tree, avl_tree_comp cmp, vlist_update_cb update)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d9a/vlist_8c_source.html#l00019">vlist.c:19</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d27/iprule_8c_source.html#l00196">generic_listener</a>, <a class="el" href="../../dd/dda/interface_8c_source.html#l00501">interface_add_user()</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00396">iprule_update_rule()</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00030">iprules</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00340">rule_cmp()</a>, and <a class="el" href="../../d5/d9a/vlist_8c_source.html#l00019">vlist_init()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/d27/iprule_8c_a9a87efea3fb0e71473bb237159500343_cgraph.png" border="0" usemap="#ad7/d27/iprule_8c_a9a87efea3fb0e71473bb237159500343_cgraph" alt=""/></div>
<map name="ad7/d27/iprule_8c_a9a87efea3fb0e71473bb237159500343_cgraph" id="ad7/d27/iprule_8c_a9a87efea3fb0e71473bb237159500343_cgraph">
<area shape="rect" title=" " alt="" coords="5,174,154,208"/>
<area shape="rect" href="../../dd/dda/interface_8c.html#a6b6109bf19780e6ed92dbef05610b262" title=" " alt="" coords="724,25,922,58"/>
<area shape="poly" title=" " alt="" coords="105,171,163,135,244,91,340,47,391,29,442,15,517,5,594,4,666,9,730,19,729,24,666,15,593,9,518,10,444,20,393,34,342,52,247,95,166,140,108,176"/>
<area shape="rect" href="../../d7/d27/iprule_8c.html#a1f6c0402fffb7ad118230b8d703d2588" title=" " alt="" coords="202,145,395,178"/>
<area shape="poly" title=" " alt="" coords="154,178,186,174,187,179,154,184"/>
<area shape="rect" href="../../d7/d27/iprule_8c.html#ad2a778d5100d5f7eeddcc71f7cf14b0a" title=" " alt="" coords="245,202,352,236"/>
<area shape="poly" title=" " alt="" coords="154,198,230,208,229,213,154,203"/>
<area shape="rect" href="../../d5/d9a/vlist_8c.html#ac79110e0303dfd3332b3648a921fd004" title=" " alt="" coords="250,286,347,320"/>
<area shape="poly" title=" " alt="" coords="116,206,252,276,249,281,113,211"/>
<area shape="rect" href="../../da/d23/list_8h.html#a875b53c95596d9e8df15ac54f6d24ae6" title=" " alt="" coords="1002,25,1095,58"/>
<area shape="poly" title=" " alt="" coords="922,39,987,39,987,44,922,44"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="1192,25,1293,58"/>
<area shape="poly" title=" " alt="" coords="1095,39,1176,39,1176,44,1095,44"/>
<area shape="rect" href="../../d7/d27/iprule_8c.html#a326e42044fee1f72ada45cad41e761f9" title=" " alt="" coords="443,87,659,121"/>
<area shape="poly" title=" " alt="" coords="375,142,458,123,459,128,376,147"/>
<area shape="rect" href="../../d7/d27/iprule_8c.html#afd45e5b26b4573116b71d9b6d52eb4ea" title=" " alt="" coords="455,30,648,64"/>
<area shape="poly" title=" " alt="" coords="322,142,375,107,442,73,457,67,459,72,444,77,378,112,325,147"/>
<area shape="rect" href="../../d7/d27/iprule_8c.html#a4d0b448b056ef96781a7a739d10d0f77" title=" " alt="" coords="492,145,610,178"/>
<area shape="poly" title=" " alt="" coords="395,159,476,159,476,164,395,164"/>
<area shape="rect" href="../../da/d12/system-dummy_8c.html#aee9e4cf147264086eb292977c8df60d1" title=" " alt="" coords="454,202,648,236"/>
<area shape="poly" title=" " alt="" coords="376,176,459,196,458,201,375,182"/>
<area shape="rect" href="../../da/d12/system-dummy_8c.html#abcae62722c192dc27b24ea60cfdb3c77" title=" " alt="" coords="458,259,645,293"/>
<area shape="poly" title=" " alt="" coords="376,177,397,187,412,202,421,218,430,232,445,246,452,250,449,255,441,250,425,236,417,220,408,206,393,192,374,181"/>
<area shape="rect" href="../../dd/dda/interface_8c.html#a1c2694bb1c5c646ba41fed27ff7af4c6" title=" " alt="" coords="707,87,939,121"/>
<area shape="poly" title=" " alt="" coords="660,102,692,102,692,107,660,107"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae1cde0f50b85945cfff23be4fc1586f4" title=" " alt="" coords="987,93,1110,126"/>
<area shape="poly" title=" " alt="" coords="939,104,972,105,971,111,939,110"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="1195,93,1289,126"/>
<area shape="poly" title=" " alt="" coords="1110,107,1180,107,1180,112,1110,112"/>
<area shape="rect" href="../../da/d23/list_8h.html#aea85dd50b9129ddaa3e3c67ed55804e4" title=" " alt="" coords="1158,171,1326,205"/>
<area shape="poly" title=" " alt="" coords="1093,125,1186,163,1184,168,1091,130"/>
<area shape="poly" title=" " alt="" coords="648,42,709,41,709,47,648,48"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#af44d4960ede7f23f071bf00e360bc23d" title=" " alt="" coords="780,298,866,332"/>
<area shape="poly" title=" " alt="" coords="347,301,764,311,764,316,347,307"/>
<area shape="poly" title=" " alt="" coords="866,300,1168,208,1170,213,867,305"/>
</map>
</div>

</div>
</div>
<a id="a99813a41e5341611f8950ab08efba553" name="a99813a41e5341611f8950ab08efba553"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99813a41e5341611f8950ab08efba553">&#9670;&#160;</a></span>iprule_parse_mark()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool iprule_parse_mark </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>mark</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a> *</td>          <td class="paramname"><span class="paramname"><em>rule</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00088">88</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   89</span>{</div>
<div class="line"><span class="lineno">   90</span>    <span class="keywordtype">char</span> *s, *e;</div>
<div class="line"><span class="lineno">   91</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n;</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    <span class="keywordflow">if</span> ((s = strchr(mark, <span class="charliteral">&#39;/&#39;</span>)) != NULL)</div>
<div class="line"><span class="lineno">   94</span>        *s++ = 0;</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>    n = strtoul(mark, &amp;e, 0);</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordflow">if</span> (e == mark || *e)</div>
<div class="line"><span class="lineno">   99</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>    rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#ad0a578d8676798d144d382ca8863df36">fwmark</a> = n;</div>
<div class="line"><span class="lineno">  102</span>    rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> |= <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a2588864696312ecb4d25915172365cb5">IPRULE_FWMARK</a>;</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>    <span class="keywordflow">if</span> (s) {</div>
<div class="line"><span class="lineno">  105</span>        n = strtoul(s, &amp;e, 0);</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>        <span class="keywordflow">if</span> (e == s || *e)</div>
<div class="line"><span class="lineno">  108</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a3264c8f34baf252c5177e25f4da863a7">fwmask</a> = n;</div>
<div class="line"><span class="lineno">  111</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> |= <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a2b07844e19192628c6af2931a7beef7e">IPRULE_FWMASK</a>;</div>
<div class="line"><span class="lineno">  112</span>    }</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  115</span>}</div>
<div class="ttc" id="aiprule_8h_html_a0ca1194201d2ace69c4f2021b9b0d947a2588864696312ecb4d25915172365cb5"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a2588864696312ecb4d25915172365cb5">IPRULE_FWMARK</a></div><div class="ttdeci">@ IPRULE_FWMARK</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00050">iprule.h:50</a></div></div>
<div class="ttc" id="aiprule_8h_html_a0ca1194201d2ace69c4f2021b9b0d947a2b07844e19192628c6af2931a7beef7e"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a2b07844e19192628c6af2931a7beef7e">IPRULE_FWMASK</a></div><div class="ttdeci">@ IPRULE_FWMASK</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00053">iprule.h:53</a></div></div>
<div class="ttc" id="aiprule_8h_html_a3264c8f34baf252c5177e25f4da863a7"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a3264c8f34baf252c5177e25f4da863a7">iprule::fwmask</a></div><div class="ttdeci">unsigned int fwmask</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00104">iprule.h:104</a></div></div>
<div class="ttc" id="aiprule_8h_html_ad0a578d8676798d144d382ca8863df36"><div class="ttname"><a href="../../de/d40/iprule_8h.html#ad0a578d8676798d144d382ca8863df36">iprule::fwmark</a></div><div class="ttdeci">unsigned int fwmark</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00103">iprule.h:103</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d40/iprule_8h_source.html#l00090">iprule::flags</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00103">iprule::fwmark</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00104">iprule::fwmask</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00050">IPRULE_FWMARK</a>, and <a class="el" href="../../de/d40/iprule_8h_source.html#l00053">IPRULE_FWMASK</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d27/iprule_8c_source.html#l00201">iprule_add()</a>.</p>

</div>
</div>
<a id="a59fa1dfb15dcb64514ef3fc697eea9bc" name="a59fa1dfb15dcb64514ef3fc697eea9bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59fa1dfb15dcb64514ef3fc697eea9bc">&#9670;&#160;</a></span>iprule_update_complete()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iprule_update_complete </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00333">333</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  334</span>{</div>
<div class="line"><span class="lineno">  335</span>    <a class="code hl_function" href="../../d5/d9a/vlist_8c.html#a62a8ae640752531c644d53311b98d53a">vlist_flush</a>(&amp;<a class="code hl_variable" href="#a2b7e163136b707246437f4aa848fd10e">iprules</a>);</div>
<div class="line"><span class="lineno">  336</span>}</div>
<div class="ttc" id="avlist_8c_html_a62a8ae640752531c644d53311b98d53a"><div class="ttname"><a href="../../d5/d9a/vlist_8c.html#a62a8ae640752531c644d53311b98d53a">vlist_flush</a></div><div class="ttdeci">void vlist_flush(struct vlist_tree *tree)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d9a/vlist_8c_source.html#l00062">vlist.c:62</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d27/iprule_8c_source.html#l00030">iprules</a>, and <a class="el" href="../../d5/d9a/vlist_8c_source.html#l00062">vlist_flush()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d65/netifd_2config_8c_source.html#l00511">config_init_rules()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/d27/iprule_8c_a59fa1dfb15dcb64514ef3fc697eea9bc_cgraph.png" border="0" usemap="#ad7/d27/iprule_8c_a59fa1dfb15dcb64514ef3fc697eea9bc_cgraph" alt=""/></div>
<map name="ad7/d27/iprule_8c_a59fa1dfb15dcb64514ef3fc697eea9bc_cgraph" id="ad7/d27/iprule_8c_a59fa1dfb15dcb64514ef3fc697eea9bc_cgraph">
<area shape="rect" title=" " alt="" coords="5,196,248,230"/>
<area shape="rect" href="../../d5/d9a/vlist_8c.html#a62a8ae640752531c644d53311b98d53a" title=" " alt="" coords="296,196,410,230"/>
<area shape="poly" title=" " alt="" coords="248,210,280,210,280,216,248,216"/>
<area shape="rect" href="../../d5/d9a/vlist_8c.html#ae3f611db174c46a1558ef07aa4df0138" title=" " alt="" coords="458,196,583,230"/>
<area shape="poly" title=" " alt="" coords="411,210,442,210,442,216,411,216"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#aff86971e7141b6e9af18b7601066b106" title=" " alt="" coords="631,196,746,230"/>
<area shape="poly" title=" " alt="" coords="584,210,616,210,616,216,584,216"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#adcd20fb25eb25a816468018d720977e6" title=" " alt="" coords="794,109,980,143"/>
<area shape="poly" title=" " alt="" coords="715,193,793,152,807,146,809,151,795,157,718,198"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a6de877c20c7b55fa52c80e7be87715fa" title=" " alt="" coords="838,167,936,200"/>
<area shape="poly" title=" " alt="" coords="746,202,822,190,823,196,746,207"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a678c2372f389572c6513ffe9bb65d73f" title=" " alt="" coords="824,224,950,258"/>
<area shape="poly" title=" " alt="" coords="746,218,809,227,808,233,746,224"/>
<area shape="rect" href="../../da/d23/list_8h.html#abb4dd1eb7346eb35ea621351220e80ce" title=" " alt="" coords="830,281,944,315"/>
<area shape="poly" title=" " alt="" coords="719,228,795,268,816,276,814,281,793,273,716,233"/>
<area shape="poly" title=" " alt="" coords="851,110,847,100,852,91,866,85,887,83,909,85,922,92,920,96,908,90,887,88,867,90,856,95,852,101,856,108"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ae64061061eff1f7635a03b09effae373" title=" " alt="" coords="1038,165,1181,199"/>
<area shape="poly" title=" " alt="" coords="957,141,1026,159,1024,164,956,146"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ac4d16f1266bb12e9bb809693b095360c" title=" " alt="" coords="1028,56,1191,90"/>
<area shape="poly" title=" " alt="" coords="960,106,1021,91,1022,96,961,111"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a67b3db37af2f8ebc4f6895202c358604" title=" " alt="" coords="1247,27,1396,60"/>
<area shape="poly" title=" " alt="" coords="901,107,953,59,988,35,1027,17,1085,5,1144,4,1200,10,1251,20,1249,25,1200,15,1144,9,1085,10,1029,22,991,40,956,64,905,111"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#ab84f86be5fe7f7abcf8ffb6fa0a38700" title=" " alt="" coords="1239,84,1404,118"/>
<area shape="poly" title=" " alt="" coords="980,118,1223,104,1224,109,980,124"/>
<area shape="poly" title=" " alt="" coords="1071,57,1067,47,1073,37,1087,32,1110,29,1134,32,1147,38,1145,43,1132,37,1110,35,1089,37,1076,42,1073,47,1076,55"/>
<area shape="poly" title=" " alt="" coords="1191,59,1231,53,1232,59,1192,64"/>
<area shape="poly" title=" " alt="" coords="1192,81,1224,85,1223,91,1192,86"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#aaf08ec177405c5e004b1ca33808f19da" title=" " alt="" coords="1452,27,1549,60"/>
<area shape="poly" title=" " alt="" coords="1397,41,1436,41,1436,46,1397,46"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e2d83bace7533ed4cc93bdf2a94ad95" title=" " alt="" coords="1454,84,1547,118"/>
<area shape="poly" title=" " alt="" coords="1377,58,1440,79,1438,84,1375,64"/>
<area shape="poly" title=" " alt="" coords="1375,81,1436,61,1438,66,1377,86"/>
<area shape="poly" title=" " alt="" coords="1404,98,1438,98,1438,104,1404,104"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="1067,224,1152,258"/>
<area shape="poly" title=" " alt="" coords="950,238,1051,238,1051,244,950,244"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="1274,224,1369,258"/>
<area shape="poly" title=" " alt="" coords="1153,238,1259,238,1259,244,1153,244"/>
</map>
</div>

</div>
</div>
<a id="a1f6c0402fffb7ad118230b8d703d2588" name="a1f6c0402fffb7ad118230b8d703d2588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f6c0402fffb7ad118230b8d703d2588">&#9670;&#160;</a></span>iprule_update_rule()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void iprule_update_rule </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/d1d/vlist_8h.html#d0/ddc/structvlist__tree">vlist_tree</a> *</td>          <td class="paramname"><span class="paramname"><em>tree</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d1d/vlist_8h.html#d9/d32/structvlist__node">vlist_node</a> *</td>          <td class="paramname"><span class="paramname"><em>node_new</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d1d/vlist_8h.html#d9/d32/structvlist__node">vlist_node</a> *</td>          <td class="paramname"><span class="paramname"><em>node_old</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00396">396</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  398</span>{</div>
<div class="line"><span class="lineno">  399</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a> *rule_old, *rule_new;</div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>    rule_old = <a class="code hl_define" href="../../da/d23/list_8h.html#af8c317a42292b61c93aae91e59118a46">container_of</a>(node_old, <span class="keyword">struct</span> <a class="code hl_struct" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a>, <a class="code hl_struct" href="../../d2/d72/test-avl_8c.html#d5/da1/structnode">node</a>);</div>
<div class="line"><span class="lineno">  402</span>    rule_new = <a class="code hl_define" href="../../da/d23/list_8h.html#af8c317a42292b61c93aae91e59118a46">container_of</a>(node_new, <span class="keyword">struct</span> <a class="code hl_struct" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a>, <a class="code hl_struct" href="../../d2/d72/test-avl_8c.html#d5/da1/structnode">node</a>);</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>    <span class="keywordflow">if</span> (node_old) {</div>
<div class="line"><span class="lineno">  405</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="#a4d0b448b056ef96781a7a739d10d0f77">rule_ready</a>(rule_old))</div>
<div class="line"><span class="lineno">  406</span>            <a class="code hl_function" href="../../da/d12/system-dummy_8c.html#abcae62722c192dc27b24ea60cfdb3c77">system_del_iprule</a>(rule_old);</div>
<div class="line"><span class="lineno">  407</span> </div>
<div class="line"><span class="lineno">  408</span>        <span class="keywordflow">if</span> (rule_old-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> &amp; (<a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a6214e69a56829567a4d6d86065460d9b">IPRULE_IN</a> | <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a33f6b55d530def41b325f5182ce8e9e1">IPRULE_OUT</a>))</div>
<div class="line"><span class="lineno">  409</span>            <a class="code hl_function" href="#a326e42044fee1f72ada45cad41e761f9">deregister_interfaces</a>(rule_old);</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>        <span class="keywordflow">if</span> (rule_old-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a3c53a11127f452a93aa8743ccd5fdb71">in_iface</a>)</div>
<div class="line"><span class="lineno">  412</span>            free(rule_old-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a3c53a11127f452a93aa8743ccd5fdb71">in_iface</a>);</div>
<div class="line"><span class="lineno">  413</span> </div>
<div class="line"><span class="lineno">  414</span>        <span class="keywordflow">if</span> (rule_old-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a00e83fd888bbedcf55b24cd0f9ba40fc">out_iface</a>)</div>
<div class="line"><span class="lineno">  415</span>            free(rule_old-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a00e83fd888bbedcf55b24cd0f9ba40fc">out_iface</a>);</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>        free(rule_old);</div>
<div class="line"><span class="lineno">  418</span>    }</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span>    <span class="keywordflow">if</span> (node_new) {</div>
<div class="line"><span class="lineno">  421</span>        <span class="comment">/* interface based rules calls system_add_iprule over the event cb */</span></div>
<div class="line"><span class="lineno">  422</span>        <span class="keywordflow">if</span> (rule_new-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> &amp; (<a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a6214e69a56829567a4d6d86065460d9b">IPRULE_IN</a> | <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a33f6b55d530def41b325f5182ce8e9e1">IPRULE_OUT</a>)) {</div>
<div class="line"><span class="lineno">  423</span>            <a class="code hl_function" href="#afd45e5b26b4573116b71d9b6d52eb4ea">register_interfaces</a>(rule_new);</div>
<div class="line"><span class="lineno">  424</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  425</span>            <a class="code hl_function" href="../../da/d12/system-dummy_8c.html#aee9e4cf147264086eb292977c8df60d1">system_add_iprule</a>(rule_new);</div>
<div class="line"><span class="lineno">  426</span>        }</div>
<div class="line"><span class="lineno">  427</span>    }</div>
<div class="line"><span class="lineno">  428</span>}</div>
<div class="ttc" id="aiprule_8c_html_a326e42044fee1f72ada45cad41e761f9"><div class="ttname"><a href="#a326e42044fee1f72ada45cad41e761f9">deregister_interfaces</a></div><div class="ttdeci">static void deregister_interfaces(struct iprule *rule)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00370">iprule.c:370</a></div></div>
<div class="ttc" id="aiprule_8c_html_afd45e5b26b4573116b71d9b6d52eb4ea"><div class="ttname"><a href="#afd45e5b26b4573116b71d9b6d52eb4ea">register_interfaces</a></div><div class="ttdeci">static void register_interfaces(struct iprule *rule)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00379">iprule.c:379</a></div></div>
<div class="ttc" id="alist_8h_html_af8c317a42292b61c93aae91e59118a46"><div class="ttname"><a href="../../da/d23/list_8h.html#af8c317a42292b61c93aae91e59118a46">container_of</a></div><div class="ttdeci">#define container_of(ptr, type, member)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d23/list_8h_source.html#l00038">list.h:38</a></div></div>
<div class="ttc" id="asystem-dummy_8c_html_abcae62722c192dc27b24ea60cfdb3c77"><div class="ttname"><a href="../../da/d12/system-dummy_8c.html#abcae62722c192dc27b24ea60cfdb3c77">system_del_iprule</a></div><div class="ttdeci">int system_del_iprule(struct iprule *rule)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d12/system-dummy_8c_source.html#l00312">system-dummy.c:312</a></div></div>
<div class="ttc" id="asystem-dummy_8c_html_aee9e4cf147264086eb292977c8df60d1"><div class="ttname"><a href="../../da/d12/system-dummy_8c.html#aee9e4cf147264086eb292977c8df60d1">system_add_iprule</a></div><div class="ttdeci">int system_add_iprule(struct iprule *rule)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d12/system-dummy_8c_source.html#l00307">system-dummy.c:307</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d23/list_8h_source.html#l00038">container_of</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00370">deregister_interfaces()</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00090">iprule::flags</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00087">iprule::in_iface</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00032">IPRULE_IN</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00035">IPRULE_OUT</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00088">iprule::out_iface</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00379">register_interfaces()</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00076">rule_ready()</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00307">system_add_iprule()</a>, and <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00312">system_del_iprule()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d27/iprule_8c_source.html#l00431">iprule_init_list()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/d27/iprule_8c_a1f6c0402fffb7ad118230b8d703d2588_cgraph.png" border="0" usemap="#ad7/d27/iprule_8c_a1f6c0402fffb7ad118230b8d703d2588_cgraph" alt=""/></div>
<map name="ad7/d27/iprule_8c_a1f6c0402fffb7ad118230b8d703d2588_cgraph" id="ad7/d27/iprule_8c_a1f6c0402fffb7ad118230b8d703d2588_cgraph">
<area shape="rect" title=" " alt="" coords="5,177,199,211"/>
<area shape="rect" href="../../d7/d27/iprule_8c.html#a326e42044fee1f72ada45cad41e761f9" title=" " alt="" coords="247,63,463,96"/>
<area shape="poly" title=" " alt="" coords="126,175,179,140,246,105,261,99,263,104,248,110,182,144,128,179"/>
<area shape="rect" href="../../d7/d27/iprule_8c.html#afd45e5b26b4573116b71d9b6d52eb4ea" title=" " alt="" coords="258,120,452,154"/>
<area shape="poly" title=" " alt="" coords="179,174,262,155,263,160,180,179"/>
<area shape="rect" href="../../d7/d27/iprule_8c.html#a4d0b448b056ef96781a7a739d10d0f77" title=" " alt="" coords="296,177,414,211"/>
<area shape="poly" title=" " alt="" coords="199,192,280,192,280,197,199,197"/>
<area shape="rect" href="../../da/d12/system-dummy_8c.html#aee9e4cf147264086eb292977c8df60d1" title=" " alt="" coords="258,235,452,268"/>
<area shape="poly" title=" " alt="" coords="180,209,263,228,262,233,179,214"/>
<area shape="rect" href="../../da/d12/system-dummy_8c.html#abcae62722c192dc27b24ea60cfdb3c77" title=" " alt="" coords="261,292,449,326"/>
<area shape="poly" title=" " alt="" coords="128,209,182,244,248,278,263,284,261,289,246,283,179,249,126,214"/>
<area shape="rect" href="../../dd/dda/interface_8c.html#a1c2694bb1c5c646ba41fed27ff7af4c6" title=" " alt="" coords="511,63,742,96"/>
<area shape="poly" title=" " alt="" coords="463,77,495,77,495,82,463,82"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae1cde0f50b85945cfff23be4fc1586f4" title=" " alt="" coords="790,63,914,96"/>
<area shape="poly" title=" " alt="" coords="743,77,775,77,775,82,743,82"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="999,5,1093,39"/>
<area shape="poly" title=" " alt="" coords="910,60,984,38,985,43,912,65"/>
<area shape="rect" href="../../da/d23/list_8h.html#aea85dd50b9129ddaa3e3c67ed55804e4" title=" " alt="" coords="962,63,1130,96"/>
<area shape="poly" title=" " alt="" coords="914,77,946,77,946,82,914,82"/>
<area shape="rect" href="../../dd/dda/interface_8c.html#a6b6109bf19780e6ed92dbef05610b262" title=" " alt="" coords="528,120,725,154"/>
<area shape="poly" title=" " alt="" coords="452,134,512,134,512,140,452,140"/>
<area shape="rect" href="../../da/d23/list_8h.html#a875b53c95596d9e8df15ac54f6d24ae6" title=" " alt="" coords="806,120,898,154"/>
<area shape="poly" title=" " alt="" coords="726,134,790,134,790,140,726,140"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="995,120,1097,154"/>
<area shape="poly" title=" " alt="" coords="899,134,980,134,980,140,899,140"/>
</map>
</div>

</div>
</div>
<a id="a4efb717e4ff73b537528d9d4b423d1aa" name="a4efb717e4ff73b537528d9d4b423d1aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4efb717e4ff73b537528d9d4b423d1aa">&#9670;&#160;</a></span>iprule_update_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iprule_update_start </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00320">320</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  321</span>{</div>
<div class="line"><span class="lineno">  322</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#adf39fc0b9549ad16045996ee7e5a62d6">iprules_flushed</a>) {</div>
<div class="line"><span class="lineno">  323</span>        <a class="code hl_function" href="../../da/d12/system-dummy_8c.html#a367e266c70dc83a9fc7489d72e41412c">system_flush_iprules</a>();</div>
<div class="line"><span class="lineno">  324</span>        <a class="code hl_variable" href="#adf39fc0b9549ad16045996ee7e5a62d6">iprules_flushed</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  325</span>    }</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>    <a class="code hl_variable" href="#aee12ecfbf17681c5b79e422c9fbe2843">iprules_counter</a>[0] = 1;</div>
<div class="line"><span class="lineno">  328</span>    <a class="code hl_variable" href="#aee12ecfbf17681c5b79e422c9fbe2843">iprules_counter</a>[1] = 1;</div>
<div class="line"><span class="lineno">  329</span>    <a class="code hl_function" href="../../dd/d1d/vlist_8h.html#ac66f6ee1f1beb49157d2e737c68713ba">vlist_update</a>(&amp;<a class="code hl_variable" href="#a2b7e163136b707246437f4aa848fd10e">iprules</a>);</div>
<div class="line"><span class="lineno">  330</span>}</div>
<div class="ttc" id="aiprule_8c_html_adf39fc0b9549ad16045996ee7e5a62d6"><div class="ttname"><a href="#adf39fc0b9549ad16045996ee7e5a62d6">iprules_flushed</a></div><div class="ttdeci">static bool iprules_flushed</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00031">iprule.c:31</a></div></div>
<div class="ttc" id="asystem-dummy_8c_html_a367e266c70dc83a9fc7489d72e41412c"><div class="ttname"><a href="../../da/d12/system-dummy_8c.html#a367e266c70dc83a9fc7489d72e41412c">system_flush_iprules</a></div><div class="ttdeci">int system_flush_iprules(void)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d12/system-dummy_8c_source.html#l00317">system-dummy.c:317</a></div></div>
<div class="ttc" id="avlist_8h_html_ac66f6ee1f1beb49157d2e737c68713ba"><div class="ttname"><a href="../../dd/d1d/vlist_8h.html#ac66f6ee1f1beb49157d2e737c68713ba">vlist_update</a></div><div class="ttdeci">static void vlist_update(struct vlist_tree *tree)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d1d/vlist_8h_source.html#l00062">vlist.h:62</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d27/iprule_8c_source.html#l00030">iprules</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00032">iprules_counter</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00031">iprules_flushed</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00317">system_flush_iprules()</a>, and <a class="el" href="../../dd/d1d/vlist_8h_source.html#l00062">vlist_update()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d65/netifd_2config_8c_source.html#l00511">config_init_rules()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/d27/iprule_8c_a4efb717e4ff73b537528d9d4b423d1aa_cgraph.png" border="0" usemap="#ad7/d27/iprule_8c_a4efb717e4ff73b537528d9d4b423d1aa_cgraph" alt=""/></div>
<map name="ad7/d27/iprule_8c_a4efb717e4ff73b537528d9d4b423d1aa_cgraph" id="ad7/d27/iprule_8c_a4efb717e4ff73b537528d9d4b423d1aa_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,206,68"/>
<area shape="rect" href="../../da/d12/system-dummy_8c.html#a367e266c70dc83a9fc7489d72e41412c" title=" " alt="" coords="254,5,469,39"/>
<area shape="poly" title=" " alt="" coords="206,37,238,34,238,39,206,43"/>
<area shape="rect" href="../../dd/d1d/vlist_8h.html#ac66f6ee1f1beb49157d2e737c68713ba" title=" " alt="" coords="295,63,428,96"/>
<area shape="poly" title=" " alt="" coords="206,60,279,68,279,73,206,65"/>
</map>
</div>

</div>
</div>
<a id="afd45e5b26b4573116b71d9b6d52eb4ea" name="afd45e5b26b4573116b71d9b6d52eb4ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd45e5b26b4573116b71d9b6d52eb4ea">&#9670;&#160;</a></span>register_interfaces()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void register_interfaces </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a> *</td>          <td class="paramname"><span class="paramname"><em>rule</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00379">379</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  380</span>{</div>
<div class="line"><span class="lineno">  381</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d4/da9/interface_8h.html#d9/dbe/structinterface">interface</a> *iface, *tmp;</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>    <span class="keywordflow">if</span> (rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> &amp; <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a6214e69a56829567a4d6d86065460d9b">IPRULE_IN</a>) {</div>
<div class="line"><span class="lineno">  384</span>        tmp = <a class="code hl_define" href="../../dd/d1d/vlist_8h.html#a891d2ceff87e91d9befdedd7142434cc">vlist_find</a>(&amp;<a class="code hl_variable" href="../../dd/dda/interface_8c.html#aa5c5af6c1895c4bf768815c8c5715bf2">interfaces</a>, rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a3c53a11127f452a93aa8743ccd5fdb71">in_iface</a>, iface, <a class="code hl_struct" href="../../d2/d72/test-avl_8c.html#d5/da1/structnode">node</a>);</div>
<div class="line"><span class="lineno">  385</span>        <span class="keywordflow">if</span> (tmp)</div>
<div class="line"><span class="lineno">  386</span>            <a class="code hl_function" href="../../dd/dda/interface_8c.html#a6b6109bf19780e6ed92dbef05610b262">interface_add_user</a>(&amp;rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a19bbbbfeb0401c619905326347cbaa8a">in_iface_user</a>, tmp);</div>
<div class="line"><span class="lineno">  387</span>    }</div>
<div class="line"><span class="lineno">  388</span>    <span class="keywordflow">if</span> (rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> &amp; <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a33f6b55d530def41b325f5182ce8e9e1">IPRULE_OUT</a>) {</div>
<div class="line"><span class="lineno">  389</span>        tmp = <a class="code hl_define" href="../../dd/d1d/vlist_8h.html#a891d2ceff87e91d9befdedd7142434cc">vlist_find</a>(&amp;<a class="code hl_variable" href="../../dd/dda/interface_8c.html#aa5c5af6c1895c4bf768815c8c5715bf2">interfaces</a>, rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a00e83fd888bbedcf55b24cd0f9ba40fc">out_iface</a>, iface, <a class="code hl_struct" href="../../d2/d72/test-avl_8c.html#d5/da1/structnode">node</a>);</div>
<div class="line"><span class="lineno">  390</span>        <span class="keywordflow">if</span> (tmp)</div>
<div class="line"><span class="lineno">  391</span>            <a class="code hl_function" href="../../dd/dda/interface_8c.html#a6b6109bf19780e6ed92dbef05610b262">interface_add_user</a>(&amp;rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a59d383d277b05e3fa325a9ddedf93a04">out_iface_user</a>, tmp);</div>
<div class="line"><span class="lineno">  392</span>    }</div>
<div class="line"><span class="lineno">  393</span>}</div>
<div class="ttc" id="ainterface_8c_html_aa5c5af6c1895c4bf768815c8c5715bf2"><div class="ttname"><a href="../../dd/dda/interface_8c.html#aa5c5af6c1895c4bf768815c8c5715bf2">interfaces</a></div><div class="ttdeci">struct vlist_tree interfaces</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dda/interface_8c_source.html#l00030">interface.c:30</a></div></div>
<div class="ttc" id="ainterface_8h_html_d9/dbe/structinterface"><div class="ttname"><a href="../../d4/da9/interface_8h.html#d9/dbe/structinterface">interface</a></div><div class="ttdef"><b>Definition</b> <a href="../../d4/da9/interface_8h_source.html#l00104">interface.h:104</a></div></div>
<div class="ttc" id="avlist_8h_html_a891d2ceff87e91d9befdedd7142434cc"><div class="ttname"><a href="../../dd/d1d/vlist_8h.html#a891d2ceff87e91d9befdedd7142434cc">vlist_find</a></div><div class="ttdeci">#define vlist_find(tree, name, element, node_member)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d1d/vlist_8h_source.html#l00059">vlist.h:59</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d40/iprule_8h_source.html#l00090">iprule::flags</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00087">iprule::in_iface</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00076">iprule::in_iface_user</a>, <a class="el" href="../../dd/dda/interface_8c_source.html#l00501">interface_add_user()</a>, <a class="el" href="../../dd/dda/interface_8c_source.html#l00030">interfaces</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00032">IPRULE_IN</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00035">IPRULE_OUT</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00088">iprule::out_iface</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00077">iprule::out_iface_user</a>, and <a class="el" href="../../dd/d1d/vlist_8h_source.html#l00059">vlist_find</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d27/iprule_8c_source.html#l00396">iprule_update_rule()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/d27/iprule_8c_afd45e5b26b4573116b71d9b6d52eb4ea_cgraph.png" border="0" usemap="#ad7/d27/iprule_8c_afd45e5b26b4573116b71d9b6d52eb4ea_cgraph" alt=""/></div>
<map name="ad7/d27/iprule_8c_afd45e5b26b4573116b71d9b6d52eb4ea_cgraph" id="ad7/d27/iprule_8c_afd45e5b26b4573116b71d9b6d52eb4ea_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,199,39"/>
<area shape="rect" href="../../dd/dda/interface_8c.html#a6b6109bf19780e6ed92dbef05610b262" title=" " alt="" coords="247,5,444,39"/>
<area shape="poly" title=" " alt="" coords="199,20,231,20,231,25,199,25"/>
<area shape="rect" href="../../da/d23/list_8h.html#a875b53c95596d9e8df15ac54f6d24ae6" title=" " alt="" coords="492,5,584,39"/>
<area shape="poly" title=" " alt="" coords="445,20,476,20,476,25,445,25"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="632,5,734,39"/>
<area shape="poly" title=" " alt="" coords="585,20,617,20,617,25,585,25"/>
</map>
</div>

</div>
</div>
<a id="ad2a778d5100d5f7eeddcc71f7cf14b0a" name="ad2a778d5100d5f7eeddcc71f7cf14b0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2a778d5100d5f7eeddcc71f7cf14b0a">&#9670;&#160;</a></span>rule_cmp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int rule_cmp </td>
          <td>(</td>
          <td class="paramtype">const void *</td>          <td class="paramname"><span class="paramname"><em>k1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *</td>          <td class="paramname"><span class="paramname"><em>k2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>ptr</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00340">340</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  341</span>{</div>
<div class="line"><span class="lineno">  342</span>    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code hl_struct" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a> *r1 = k1, *r2 = k2;</div>
<div class="line"><span class="lineno">  343</span>    <span class="keywordtype">int</span> ret;</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>    <span class="comment">/* First compare the interface names */</span></div>
<div class="line"><span class="lineno">  346</span>    <span class="keywordflow">if</span> (r1-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> &amp; <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a6214e69a56829567a4d6d86065460d9b">IPRULE_IN</a> || r2-&gt;flags &amp; <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a6214e69a56829567a4d6d86065460d9b">IPRULE_IN</a>) {</div>
<div class="line"><span class="lineno">  347</span>        <span class="keywordtype">char</span> *str1 = r1-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> &amp; <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a6214e69a56829567a4d6d86065460d9b">IPRULE_IN</a> ? r1-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a3c53a11127f452a93aa8743ccd5fdb71">in_iface</a> : <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  348</span>        <span class="keywordtype">char</span> *str2 = r2-&gt;flags &amp; <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a6214e69a56829567a4d6d86065460d9b">IPRULE_IN</a> ? r2-&gt;in_iface : <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>        ret = strcmp(str1, str2);</div>
<div class="line"><span class="lineno">  351</span>        <span class="keywordflow">if</span> (ret)</div>
<div class="line"><span class="lineno">  352</span>            <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno">  353</span>    }</div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>    <span class="keywordflow">if</span> (r1-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> &amp; <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a33f6b55d530def41b325f5182ce8e9e1">IPRULE_OUT</a> || r2-&gt;flags &amp; <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a33f6b55d530def41b325f5182ce8e9e1">IPRULE_OUT</a>) {</div>
<div class="line"><span class="lineno">  356</span>        <span class="keywordtype">char</span> *str1 = r1-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> &amp; <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a33f6b55d530def41b325f5182ce8e9e1">IPRULE_OUT</a> ? r1-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a00e83fd888bbedcf55b24cd0f9ba40fc">out_iface</a> : <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  357</span>        <span class="keywordtype">char</span> *str2 = r2-&gt;flags &amp; <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a33f6b55d530def41b325f5182ce8e9e1">IPRULE_OUT</a> ? r2-&gt;out_iface : <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>        ret = strcmp(str1, str2);</div>
<div class="line"><span class="lineno">  360</span>        <span class="keywordflow">if</span> (ret)</div>
<div class="line"><span class="lineno">  361</span>            <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno">  362</span>    }</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>    <span class="comment">/* Next compare everything after the flags field */</span></div>
<div class="line"><span class="lineno">  365</span>    <span class="keywordflow">return</span> memcmp(k1 + offsetof(<span class="keyword">struct</span> <a class="code hl_struct" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a>, <a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a>),</div>
<div class="line"><span class="lineno">  366</span>              k2 + offsetof(<span class="keyword">struct</span> <a class="code hl_struct" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a>, <a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a>),</div>
<div class="line"><span class="lineno">  367</span>              <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a>) - offsetof(<span class="keyword">struct</span> <a class="code hl_struct" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a>, <a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a>));</div>
<div class="line"><span class="lineno">  368</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d40/iprule_8h_source.html#l00090">iprule::flags</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00087">iprule::in_iface</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00032">IPRULE_IN</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00035">IPRULE_OUT</a>, and <a class="el" href="../../de/d40/iprule_8h_source.html#l00088">iprule::out_iface</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d27/iprule_8c_source.html#l00431">iprule_init_list()</a>.</p>

</div>
</div>
<a id="a90a4f46760b774e8d211619ea7a89d44" name="a90a4f46760b774e8d211619ea7a89d44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90a4f46760b774e8d211619ea7a89d44">&#9670;&#160;</a></span>rule_in_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void rule_in_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/da9/interface_8h.html#d0/d97/structinterface__user">interface_user</a> *</td>          <td class="paramname"><span class="paramname"><em>dep</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/da9/interface_8h.html#d9/dbe/structinterface">interface</a> *</td>          <td class="paramname"><span class="paramname"><em>iface</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579">interface_event</a></td>          <td class="paramname"><span class="paramname"><em>ev</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00119">119</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  120</span>{</div>
<div class="line"><span class="lineno">  121</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a> *rule = <a class="code hl_define" href="../../da/d23/list_8h.html#af8c317a42292b61c93aae91e59118a46">container_of</a>(dep, <span class="keyword">struct</span> <a class="code hl_struct" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a>, <a class="code hl_variable" href="../../de/d40/iprule_8h.html#a19bbbbfeb0401c619905326347cbaa8a">in_iface_user</a>);</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>    <span class="keywordflow">switch</span> (ev) {</div>
<div class="line"><span class="lineno">  124</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579a08e7d752e3bddb04d365c4c3db888127">IFEV_UP</a>:</div>
<div class="line"><span class="lineno">  125</span>        <span class="keywordflow">if</span> (!iface-&gt;<a class="code hl_variable" href="../../d4/da9/interface_8h.html#a3b038a7f07556d316ad753778e74620b">l3_dev</a>.<a class="code hl_variable" href="../../db/de9/device_8h.html#a57556a6e1911613138f56f50aad072e1">dev</a>)</div>
<div class="line"><span class="lineno">  126</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>        strcpy(rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a552a0607818383f54c5c661cfc238797">in_dev</a>, iface-&gt;<a class="code hl_variable" href="../../d4/da9/interface_8h.html#a3b038a7f07556d316ad753778e74620b">l3_dev</a>.<a class="code hl_variable" href="../../db/de9/device_8h.html#a57556a6e1911613138f56f50aad072e1">dev</a>-&gt;<a class="code hl_variable" href="../../db/de9/device_8h.html#ad329bef51f22d352e19d30c41dc89b25">ifname</a>);</div>
<div class="line"><span class="lineno">  129</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="#a4d0b448b056ef96781a7a739d10d0f77">rule_ready</a>(rule))</div>
<div class="line"><span class="lineno">  130</span>            <a class="code hl_function" href="../../da/d12/system-dummy_8c.html#aee9e4cf147264086eb292977c8df60d1">system_add_iprule</a>(rule);</div>
<div class="line"><span class="lineno">  131</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579a2646cee1ab0ccdfd8004300641dd7c17">IFEV_DOWN</a>:</div>
<div class="line"><span class="lineno">  133</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579a4d84be74f03da5556a8bec2c2318a6c3">IFEV_UP_FAILED</a>:</div>
<div class="line"><span class="lineno">  134</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579af0c115d8306d80eb144fb5a85ead8a54">IFEV_FREE</a>:</div>
<div class="line"><span class="lineno">  135</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="#a4d0b448b056ef96781a7a739d10d0f77">rule_ready</a>(rule))</div>
<div class="line"><span class="lineno">  136</span>            <a class="code hl_function" href="../../da/d12/system-dummy_8c.html#abcae62722c192dc27b24ea60cfdb3c77">system_del_iprule</a>(rule);</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a552a0607818383f54c5c661cfc238797">in_dev</a>[0] = 0;</div>
<div class="line"><span class="lineno">  139</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  140</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  141</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  142</span>    }</div>
<div class="line"><span class="lineno">  143</span>}</div>
<div class="ttc" id="adevice_8h_html_a57556a6e1911613138f56f50aad072e1"><div class="ttname"><a href="../../db/de9/device_8h.html#a57556a6e1911613138f56f50aad072e1">device_user::dev</a></div><div class="ttdeci">struct device * dev</div><div class="ttdef"><b>Definition</b> <a href="../../db/de9/device_8h_source.html#l00184">device.h:184</a></div></div>
<div class="ttc" id="adevice_8h_html_ad329bef51f22d352e19d30c41dc89b25"><div class="ttname"><a href="../../db/de9/device_8h.html#ad329bef51f22d352e19d30c41dc89b25">device::ifname</a></div><div class="ttdeci">char ifname[IFNAMSIZ]</div><div class="ttdef"><b>Definition</b> <a href="../../db/de9/device_8h_source.html#l00254">device.h:254</a></div></div>
<div class="ttc" id="ainterface_8h_html_a3b038a7f07556d316ad753778e74620b"><div class="ttname"><a href="../../d4/da9/interface_8h.html#a3b038a7f07556d316ad753778e74620b">interface::l3_dev</a></div><div class="ttdeci">struct device_user l3_dev</div><div class="ttdef"><b>Definition</b> <a href="../../d4/da9/interface_8h_source.html#l00145">interface.h:145</a></div></div>
<div class="ttc" id="ainterface_8h_html_ab8cd9b91c8d6952fa59fc48110e4a579a08e7d752e3bddb04d365c4c3db888127"><div class="ttname"><a href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579a08e7d752e3bddb04d365c4c3db888127">IFEV_UP</a></div><div class="ttdeci">@ IFEV_UP</div><div class="ttdef"><b>Definition</b> <a href="../../d4/da9/interface_8h_source.html#l00025">interface.h:25</a></div></div>
<div class="ttc" id="ainterface_8h_html_ab8cd9b91c8d6952fa59fc48110e4a579a2646cee1ab0ccdfd8004300641dd7c17"><div class="ttname"><a href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579a2646cee1ab0ccdfd8004300641dd7c17">IFEV_DOWN</a></div><div class="ttdeci">@ IFEV_DOWN</div><div class="ttdef"><b>Definition</b> <a href="../../d4/da9/interface_8h_source.html#l00024">interface.h:24</a></div></div>
<div class="ttc" id="ainterface_8h_html_ab8cd9b91c8d6952fa59fc48110e4a579a4d84be74f03da5556a8bec2c2318a6c3"><div class="ttname"><a href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579a4d84be74f03da5556a8bec2c2318a6c3">IFEV_UP_FAILED</a></div><div class="ttdeci">@ IFEV_UP_FAILED</div><div class="ttdef"><b>Definition</b> <a href="../../d4/da9/interface_8h_source.html#l00026">interface.h:26</a></div></div>
<div class="ttc" id="ainterface_8h_html_ab8cd9b91c8d6952fa59fc48110e4a579af0c115d8306d80eb144fb5a85ead8a54"><div class="ttname"><a href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579af0c115d8306d80eb144fb5a85ead8a54">IFEV_FREE</a></div><div class="ttdeci">@ IFEV_FREE</div><div class="ttdef"><b>Definition</b> <a href="../../d4/da9/interface_8h_source.html#l00028">interface.h:28</a></div></div>
<div class="ttc" id="aiprule_8h_html_a552a0607818383f54c5c661cfc238797"><div class="ttname"><a href="../../de/d40/iprule_8h.html#a552a0607818383f54c5c661cfc238797">iprule::in_dev</a></div><div class="ttdeci">char in_dev[IFNAMSIZ]</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00080">iprule.h:80</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d23/list_8h_source.html#l00038">container_of</a>, <a class="el" href="../../db/de9/device_8h_source.html#l00184">device_user::dev</a>, <a class="el" href="../../d4/da9/interface_8h_source.html#l00024">IFEV_DOWN</a>, <a class="el" href="../../d4/da9/interface_8h_source.html#l00028">IFEV_FREE</a>, <a class="el" href="../../d4/da9/interface_8h_source.html#l00025">IFEV_UP</a>, <a class="el" href="../../d4/da9/interface_8h_source.html#l00026">IFEV_UP_FAILED</a>, <a class="el" href="../../db/de9/device_8h_source.html#l00254">device::ifname</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00080">iprule::in_dev</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00076">iprule::in_iface_user</a>, <a class="el" href="../../d4/da9/interface_8h_source.html#l00145">interface::l3_dev</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00076">rule_ready()</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00307">system_add_iprule()</a>, and <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00312">system_del_iprule()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d27/iprule_8c_source.html#l00201">iprule_add()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/d27/iprule_8c_a90a4f46760b774e8d211619ea7a89d44_cgraph.png" border="0" usemap="#ad7/d27/iprule_8c_a90a4f46760b774e8d211619ea7a89d44_cgraph" alt=""/></div>
<map name="ad7/d27/iprule_8c_a90a4f46760b774e8d211619ea7a89d44_cgraph" id="ad7/d27/iprule_8c_a90a4f46760b774e8d211619ea7a89d44_cgraph">
<area shape="rect" title=" " alt="" coords="5,63,120,96"/>
<area shape="rect" href="../../d7/d27/iprule_8c.html#a4d0b448b056ef96781a7a739d10d0f77" title=" " alt="" coords="206,5,324,39"/>
<area shape="poly" title=" " alt="" coords="119,61,190,40,192,46,121,66"/>
<area shape="rect" href="../../da/d12/system-dummy_8c.html#aee9e4cf147264086eb292977c8df60d1" title=" " alt="" coords="168,63,362,96"/>
<area shape="poly" title=" " alt="" coords="120,77,152,77,152,82,120,82"/>
<area shape="rect" href="../../da/d12/system-dummy_8c.html#abcae62722c192dc27b24ea60cfdb3c77" title=" " alt="" coords="171,120,359,154"/>
<area shape="poly" title=" " alt="" coords="121,93,189,113,188,118,119,98"/>
</map>
</div>

</div>
</div>
<a id="a513d2c8c9c692217478aa2ba34252df1" name="a513d2c8c9c692217478aa2ba34252df1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a513d2c8c9c692217478aa2ba34252df1">&#9670;&#160;</a></span>rule_out_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void rule_out_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/da9/interface_8h.html#d0/d97/structinterface__user">interface_user</a> *</td>          <td class="paramname"><span class="paramname"><em>dep</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/da9/interface_8h.html#d9/dbe/structinterface">interface</a> *</td>          <td class="paramname"><span class="paramname"><em>iface</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579">interface_event</a></td>          <td class="paramname"><span class="paramname"><em>ev</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00147">147</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  148</span>{</div>
<div class="line"><span class="lineno">  149</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a> *rule = <a class="code hl_define" href="../../da/d23/list_8h.html#af8c317a42292b61c93aae91e59118a46">container_of</a>(dep, <span class="keyword">struct</span> <a class="code hl_struct" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a>, <a class="code hl_variable" href="../../de/d40/iprule_8h.html#a59d383d277b05e3fa325a9ddedf93a04">out_iface_user</a>);</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>    <span class="keywordflow">switch</span> (ev) {</div>
<div class="line"><span class="lineno">  152</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579a08e7d752e3bddb04d365c4c3db888127">IFEV_UP</a>:</div>
<div class="line"><span class="lineno">  153</span>        <span class="keywordflow">if</span> (!iface-&gt;<a class="code hl_variable" href="../../d4/da9/interface_8h.html#a3b038a7f07556d316ad753778e74620b">l3_dev</a>.<a class="code hl_variable" href="../../db/de9/device_8h.html#a57556a6e1911613138f56f50aad072e1">dev</a>)</div>
<div class="line"><span class="lineno">  154</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>        strcpy(rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#af7d9ea749b3029262effdadb7cfcdee4">out_dev</a>, iface-&gt;<a class="code hl_variable" href="../../d4/da9/interface_8h.html#a3b038a7f07556d316ad753778e74620b">l3_dev</a>.<a class="code hl_variable" href="../../db/de9/device_8h.html#a57556a6e1911613138f56f50aad072e1">dev</a>-&gt;<a class="code hl_variable" href="../../db/de9/device_8h.html#ad329bef51f22d352e19d30c41dc89b25">ifname</a>);</div>
<div class="line"><span class="lineno">  157</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="#a4d0b448b056ef96781a7a739d10d0f77">rule_ready</a>(rule))</div>
<div class="line"><span class="lineno">  158</span>            <a class="code hl_function" href="../../da/d12/system-dummy_8c.html#aee9e4cf147264086eb292977c8df60d1">system_add_iprule</a>(rule);</div>
<div class="line"><span class="lineno">  159</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579a2646cee1ab0ccdfd8004300641dd7c17">IFEV_DOWN</a>:</div>
<div class="line"><span class="lineno">  161</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579a4d84be74f03da5556a8bec2c2318a6c3">IFEV_UP_FAILED</a>:</div>
<div class="line"><span class="lineno">  162</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d4/da9/interface_8h.html#ab8cd9b91c8d6952fa59fc48110e4a579af0c115d8306d80eb144fb5a85ead8a54">IFEV_FREE</a>:</div>
<div class="line"><span class="lineno">  163</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="#a4d0b448b056ef96781a7a739d10d0f77">rule_ready</a>(rule))</div>
<div class="line"><span class="lineno">  164</span>            <a class="code hl_function" href="../../da/d12/system-dummy_8c.html#abcae62722c192dc27b24ea60cfdb3c77">system_del_iprule</a>(rule);</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span>        rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#af7d9ea749b3029262effdadb7cfcdee4">out_dev</a>[0] = 0;</div>
<div class="line"><span class="lineno">  167</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  169</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  170</span>    }</div>
<div class="line"><span class="lineno">  171</span>}</div>
<div class="ttc" id="aiprule_8h_html_af7d9ea749b3029262effdadb7cfcdee4"><div class="ttname"><a href="../../de/d40/iprule_8h.html#af7d9ea749b3029262effdadb7cfcdee4">iprule::out_dev</a></div><div class="ttdeci">char out_dev[IFNAMSIZ]</div><div class="ttdef"><b>Definition</b> <a href="../../de/d40/iprule_8h_source.html#l00081">iprule.h:81</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d23/list_8h_source.html#l00038">container_of</a>, <a class="el" href="../../db/de9/device_8h_source.html#l00184">device_user::dev</a>, <a class="el" href="../../d4/da9/interface_8h_source.html#l00024">IFEV_DOWN</a>, <a class="el" href="../../d4/da9/interface_8h_source.html#l00028">IFEV_FREE</a>, <a class="el" href="../../d4/da9/interface_8h_source.html#l00025">IFEV_UP</a>, <a class="el" href="../../d4/da9/interface_8h_source.html#l00026">IFEV_UP_FAILED</a>, <a class="el" href="../../db/de9/device_8h_source.html#l00254">device::ifname</a>, <a class="el" href="../../d4/da9/interface_8h_source.html#l00145">interface::l3_dev</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00081">iprule::out_dev</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00077">iprule::out_iface_user</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00076">rule_ready()</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00307">system_add_iprule()</a>, and <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00312">system_del_iprule()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d27/iprule_8c_source.html#l00201">iprule_add()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/d27/iprule_8c_a513d2c8c9c692217478aa2ba34252df1_cgraph.png" border="0" usemap="#ad7/d27/iprule_8c_a513d2c8c9c692217478aa2ba34252df1_cgraph" alt=""/></div>
<map name="ad7/d27/iprule_8c_a513d2c8c9c692217478aa2ba34252df1_cgraph" id="ad7/d27/iprule_8c_a513d2c8c9c692217478aa2ba34252df1_cgraph">
<area shape="rect" title=" " alt="" coords="5,63,133,96"/>
<area shape="rect" href="../../d7/d27/iprule_8c.html#a4d0b448b056ef96781a7a739d10d0f77" title=" " alt="" coords="219,5,337,39"/>
<area shape="poly" title=" " alt="" coords="132,60,203,40,205,45,133,65"/>
<area shape="rect" href="../../da/d12/system-dummy_8c.html#aee9e4cf147264086eb292977c8df60d1" title=" " alt="" coords="181,63,375,96"/>
<area shape="poly" title=" " alt="" coords="133,77,165,77,165,82,133,82"/>
<area shape="rect" href="../../da/d12/system-dummy_8c.html#abcae62722c192dc27b24ea60cfdb3c77" title=" " alt="" coords="184,120,372,154"/>
<area shape="poly" title=" " alt="" coords="133,94,200,113,199,118,132,99"/>
</map>
</div>

</div>
</div>
<a id="a4d0b448b056ef96781a7a739d10d0f77" name="a4d0b448b056ef96781a7a739d10d0f77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d0b448b056ef96781a7a739d10d0f77">&#9670;&#160;</a></span>rule_ready()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool rule_ready </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d40/iprule_8h.html#dd/d31/structiprule">iprule</a> *</td>          <td class="paramname"><span class="paramname"><em>rule</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00076">76</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   77</span>{</div>
<div class="line"><span class="lineno">   78</span>    <span class="keywordflow">if</span> (rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> &amp; <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a33f6b55d530def41b325f5182ce8e9e1">IPRULE_OUT</a> &amp;&amp; !rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#af7d9ea749b3029262effdadb7cfcdee4">out_dev</a>[0])</div>
<div class="line"><span class="lineno">   79</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>    <span class="keywordflow">if</span> (rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a9a3eeee183fdebaecbd0f4b70219f2bc">flags</a> &amp; <a class="code hl_enumvalue" href="../../de/d40/iprule_8h.html#a0ca1194201d2ace69c4f2021b9b0d947a6214e69a56829567a4d6d86065460d9b">IPRULE_IN</a> &amp;&amp; !rule-&gt;<a class="code hl_variable" href="../../de/d40/iprule_8h.html#a552a0607818383f54c5c661cfc238797">in_dev</a>[0])</div>
<div class="line"><span class="lineno">   82</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   85</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d40/iprule_8h_source.html#l00090">iprule::flags</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00080">iprule::in_dev</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00032">IPRULE_IN</a>, <a class="el" href="../../de/d40/iprule_8h_source.html#l00035">IPRULE_OUT</a>, and <a class="el" href="../../de/d40/iprule_8h_source.html#l00081">iprule::out_dev</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d27/iprule_8c_source.html#l00175">generic_interface_cb()</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00396">iprule_update_rule()</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00119">rule_in_cb()</a>, and <a class="el" href="../../d7/d27/iprule_8c_source.html#l00147">rule_out_cb()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a180e8ee9a1586c10d356bb4f3e1b76a1" name="a180e8ee9a1586c10d356bb4f3e1b76a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a180e8ee9a1586c10d356bb4f3e1b76a1">&#9670;&#160;</a></span>generic_listener</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/da9/interface_8h.html#d0/d97/structinterface__user">interface_user</a> generic_listener</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .cb = <a class="code hl_function" href="#a3f0f28a6bc17abaa9af5853a1a576016">generic_interface_cb</a></div>
<div class="line">}</div>
<div class="ttc" id="aiprule_8c_html_a3f0f28a6bc17abaa9af5853a1a576016"><div class="ttname"><a href="#a3f0f28a6bc17abaa9af5853a1a576016">generic_interface_cb</a></div><div class="ttdeci">static void generic_interface_cb(struct interface_user *dep, struct interface *iface, enum interface_event ev)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d27/iprule_8c_source.html#l00175">iprule.c:175</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00196">196</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  196</span>                                         {</div>
<div class="line"><span class="lineno">  197</span>    .cb = <a class="code hl_function" href="#a3f0f28a6bc17abaa9af5853a1a576016">generic_interface_cb</a></div>
<div class="line"><span class="lineno">  198</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d7/d27/iprule_8c_source.html#l00431">iprule_init_list()</a>.</p>

</div>
</div>
<a id="a2b7e163136b707246437f4aa848fd10e" name="a2b7e163136b707246437f4aa848fd10e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b7e163136b707246437f4aa848fd10e">&#9670;&#160;</a></span>iprules</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d1d/vlist_8h.html#d0/ddc/structvlist__tree">vlist_tree</a> iprules</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00030">30</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d27/iprule_8c_source.html#l00175">generic_interface_cb()</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00201">iprule_add()</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00431">iprule_init_list()</a>, <a class="el" href="../../d7/d27/iprule_8c_source.html#l00333">iprule_update_complete()</a>, and <a class="el" href="../../d7/d27/iprule_8c_source.html#l00320">iprule_update_start()</a>.</p>

</div>
</div>
<a id="aee12ecfbf17681c5b79e422c9fbe2843" name="aee12ecfbf17681c5b79e422c9fbe2843"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee12ecfbf17681c5b79e422c9fbe2843">&#9670;&#160;</a></span>iprules_counter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int iprules_counter[2]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00032">32</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d27/iprule_8c_source.html#l00201">iprule_add()</a>, and <a class="el" href="../../d7/d27/iprule_8c_source.html#l00320">iprule_update_start()</a>.</p>

</div>
</div>
<a id="adf39fc0b9549ad16045996ee7e5a62d6" name="adf39fc0b9549ad16045996ee7e5a62d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf39fc0b9549ad16045996ee7e5a62d6">&#9670;&#160;</a></span>iprules_flushed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool iprules_flushed = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00031">31</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d27/iprule_8c_source.html#l00320">iprule_update_start()</a>.</p>

</div>
</div>
<a id="aeb124dec6d59e002989d0ecf6f29a878" name="aeb124dec6d59e002989d0ecf6f29a878"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb124dec6d59e002989d0ecf6f29a878">&#9670;&#160;</a></span>rule_attr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a> rule_attr[<a class="el" href="#a39fca1837c5ce7715cbf571669660c13ac5c28749ad128ba2107ccf6216200e2e">__RULE_MAX</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a3734c412269e1a1b059ef1e9a4801324">RULE_INTERFACE_IN</a>] = { .name = <span class="stringliteral">&quot;in&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a85ed529b656cec86c741f84b15042b12">RULE_INTERFACE_OUT</a>] = { .name = <span class="stringliteral">&quot;out&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a8b1c0fc7b0865311fd8837f7df6b7a97">RULE_INVERT</a>] = { .name = <span class="stringliteral">&quot;invert&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a65f050be4633329d0af340d88e209df6">BLOBMSG_TYPE_BOOL</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a20f430db8b13aee83375e15a12847b48">RULE_SRC</a>] = { .name = <span class="stringliteral">&quot;src&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a8e802bacb5e9abda18ee918fabff0b78">RULE_DEST</a>] = { .name = <span class="stringliteral">&quot;dest&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13abfc1cbaae027728ec95473abe584ce10">RULE_PRIORITY</a>] = { .name = <span class="stringliteral">&quot;priority&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13abf6e8954b22de38627c34cf914fc3128">RULE_TOS</a>] = { .name = <span class="stringliteral">&quot;tos&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a1d8a34dea3d6af25048045b29f52214a">RULE_FWMARK</a>] = { .name = <span class="stringliteral">&quot;mark&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13afe4f03c8f5aecfac704de4a684a6abcf">RULE_LOOKUP</a>] = { .name = <span class="stringliteral">&quot;lookup&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a38ebfbf4132d1fa73eb054cabf8e5aab">RULE_SUP_PREFIXLEN</a>] = { .name = <span class="stringliteral">&quot;suppress_prefixlength&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a86412460bb1eb3257eff74f5745266c2">RULE_UIDRANGE</a>] = { .name = <span class="stringliteral">&quot;uidrange&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13aabb8f0102739331bf81420db7e784b0a">RULE_ACTION</a>] = { .name = <span class="stringliteral">&quot;action&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13ae891aceac0cf247d1da0e4e51a1bcab9">RULE_GOTO</a>]   = { .name = <span class="stringliteral">&quot;goto&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a2ff54ab2b29ba773bba4e6b0f0ff4834">RULE_DISABLED</a>] = { .name = <span class="stringliteral">&quot;disabled&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a65f050be4633329d0af340d88e209df6">BLOBMSG_TYPE_BOOL</a> },</div>
<div class="line">}</div>
<div class="ttc" id="ablobmsg_8h_html_a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a></div><div class="ttdeci">@ BLOBMSG_TYPE_STRING</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00029">blobmsg.h:29</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a9e3efca3093410d90ef04154aefde2c9a65f050be4633329d0af340d88e209df6"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a65f050be4633329d0af340d88e209df6">BLOBMSG_TYPE_BOOL</a></div><div class="ttdeci">@ BLOBMSG_TYPE_BOOL</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00034">blobmsg.h:34</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a></div><div class="ttdeci">@ BLOBMSG_TYPE_INT32</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00031">blobmsg.h:31</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00052">52</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   52</span>                                                           {</div>
<div class="line"><span class="lineno">   53</span>    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a3734c412269e1a1b059ef1e9a4801324">RULE_INTERFACE_IN</a>] = { .name = <span class="stringliteral">&quot;in&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno">   54</span>    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a85ed529b656cec86c741f84b15042b12">RULE_INTERFACE_OUT</a>] = { .name = <span class="stringliteral">&quot;out&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno">   55</span>    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a8b1c0fc7b0865311fd8837f7df6b7a97">RULE_INVERT</a>] = { .name = <span class="stringliteral">&quot;invert&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a65f050be4633329d0af340d88e209df6">BLOBMSG_TYPE_BOOL</a> },</div>
<div class="line"><span class="lineno">   56</span>    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a20f430db8b13aee83375e15a12847b48">RULE_SRC</a>] = { .name = <span class="stringliteral">&quot;src&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno">   57</span>    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a8e802bacb5e9abda18ee918fabff0b78">RULE_DEST</a>] = { .name = <span class="stringliteral">&quot;dest&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno">   58</span>    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13abfc1cbaae027728ec95473abe584ce10">RULE_PRIORITY</a>] = { .name = <span class="stringliteral">&quot;priority&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno">   59</span>    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13abf6e8954b22de38627c34cf914fc3128">RULE_TOS</a>] = { .name = <span class="stringliteral">&quot;tos&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno">   60</span>    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a1d8a34dea3d6af25048045b29f52214a">RULE_FWMARK</a>] = { .name = <span class="stringliteral">&quot;mark&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno">   61</span>    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13afe4f03c8f5aecfac704de4a684a6abcf">RULE_LOOKUP</a>] = { .name = <span class="stringliteral">&quot;lookup&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno">   62</span>    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a38ebfbf4132d1fa73eb054cabf8e5aab">RULE_SUP_PREFIXLEN</a>] = { .name = <span class="stringliteral">&quot;suppress_prefixlength&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno">   63</span>    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a86412460bb1eb3257eff74f5745266c2">RULE_UIDRANGE</a>] = { .name = <span class="stringliteral">&quot;uidrange&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno">   64</span>    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13aabb8f0102739331bf81420db7e784b0a">RULE_ACTION</a>] = { .name = <span class="stringliteral">&quot;action&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno">   65</span>    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13ae891aceac0cf247d1da0e4e51a1bcab9">RULE_GOTO</a>]   = { .name = <span class="stringliteral">&quot;goto&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno">   66</span>    [<a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13a2ff54ab2b29ba773bba4e6b0f0ff4834">RULE_DISABLED</a>] = { .name = <span class="stringliteral">&quot;disabled&quot;</span>, .type = <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a65f050be4633329d0af340d88e209df6">BLOBMSG_TYPE_BOOL</a> },</div>
<div class="line"><span class="lineno">   67</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d7/d27/iprule_8c_source.html#l00201">iprule_add()</a>.</p>

</div>
</div>
<a id="a51b20390e0610b4fab3918c2965d5b2c" name="a51b20390e0610b4fab3918c2965d5b2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51b20390e0610b4fab3918c2965d5b2c">&#9670;&#160;</a></span>rule_attr_list</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const struct uci_blob_param_list rule_attr_list</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .n_params = <a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13ac5c28749ad128ba2107ccf6216200e2e">__RULE_MAX</a>,</div>
<div class="line">    .params = <a class="code hl_variable" href="#aeb124dec6d59e002989d0ecf6f29a878">rule_attr</a>,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d7/d27/iprule_8c_source.html#l00069">69</a> of file <a class="el" href="../../d7/d27/iprule_8c_source.html">iprule.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   69</span>                                                  {</div>
<div class="line"><span class="lineno">   70</span>    .n_params = <a class="code hl_enumvalue" href="#a39fca1837c5ce7715cbf571669660c13ac5c28749ad128ba2107ccf6216200e2e">__RULE_MAX</a>,</div>
<div class="line"><span class="lineno">   71</span>    .params = <a class="code hl_variable" href="#aeb124dec6d59e002989d0ecf6f29a878">rule_attr</a>,</div>
<div class="line"><span class="lineno">   72</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d5/d65/netifd_2config_8c_source.html#l00242">config_parse_rule()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
