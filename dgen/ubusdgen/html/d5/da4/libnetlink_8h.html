<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>zbus: /home/g41797/CLionProjects/github.com/g41797/zbus/src/libs/ustp/libnetlink.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">zbus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_87a455bccb09a92130c26a11a880c98a.html">libs</a></li><li class="navelem"><a class="el" href="../../dir_dce3ccdac7694adc3671ba6ea4820239.html">ustp</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">libnetlink.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;asm/types.h&gt;</code><br />
<code>#include &lt;linux/netlink.h&gt;</code><br />
<code>#include &lt;linux/rtnetlink.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for libnetlink.h:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d08/libnetlink_8h__incl.png" border="0" usemap="#a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2ustp_2libnetlink_8h" alt=""/></div>
<map name="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2ustp_2libnetlink_8h" id="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2ustp_2libnetlink_8h">
<area shape="rect" title=" " alt="" coords="206,5,492,85"/>
<area shape="rect" title=" " alt="" coords="5,133,90,167"/>
<area shape="poly" title=" " alt="" coords="234,88,105,132,104,127,232,83"/>
<area shape="rect" title=" " alt="" coords="113,133,249,167"/>
<area shape="poly" title=" " alt="" coords="286,88,222,127,219,122,283,83"/>
<area shape="rect" title=" " alt="" coords="272,133,426,167"/>
<area shape="poly" title=" " alt="" coords="352,86,352,118,346,118,346,86"/>
<area shape="rect" title=" " alt="" coords="450,133,618,167"/>
<area shape="poly" title=" " alt="" coords="421,83,493,123,491,128,419,88"/>
<area shape="rect" title=" " alt="" coords="643,133,770,167"/>
<area shape="poly" title=" " alt="" coords="487,83,636,126,634,131,485,88"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/db4/libnetlink_8h__dep__incl.png" border="0" usemap="#a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2ustp_2libnetlink_8hdep" alt=""/></div>
<map name="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2ustp_2libnetlink_8hdep" id="a_2home_2g41797_2CLionProjects_2github_8com_2g41797_2zbus_2src_2libs_2ustp_2libnetlink_8hdep">
<area shape="rect" title=" " alt="" coords="316,5,602,85"/>
<area shape="rect" href="../../d7/d10/bridge__track_8c.html" title=" " alt="" coords="5,133,292,213"/>
<area shape="poly" title=" " alt="" coords="349,94,246,135,244,130,347,89"/>
<area shape="rect" href="../../d1/db2/brmon_8c.html" title=" " alt="" coords="316,133,602,213"/>
<area shape="poly" title=" " alt="" coords="462,100,462,133,457,133,457,100"/>
<area shape="rect" href="../../d4/dab/libnetlink_8c.html" title=" " alt="" coords="627,133,913,213"/>
<area shape="poly" title=" " alt="" coords="571,89,674,130,672,135,569,94"/>
</map>
</div>
</div>
<p><a href="../../d5/da4/libnetlink_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:d2/dee/structrtnl__handle" id="r_d2/dee/structrtnl__handle"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#d2/dee/structrtnl__handle">rtnl_handle</a></td></tr>
<tr class="separator:d2/dee/structrtnl__handle"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a2264115cccd1ed57a207ac14721e8878" id="r_a2264115cccd1ed57a207ac14721e8878"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2264115cccd1ed57a207ac14721e8878">RTA_TAIL</a>(rta)</td></tr>
<tr class="separator:a2264115cccd1ed57a207ac14721e8878"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5023eccbd007fd6eb91c1be028e974b" id="r_ab5023eccbd007fd6eb91c1be028e974b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab5023eccbd007fd6eb91c1be028e974b">parse_rtattr_nested</a>(tb,  max,  rta)</td></tr>
<tr class="separator:ab5023eccbd007fd6eb91c1be028e974b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65c9772da492944cb5c8785c8a6ed3a5" id="r_a65c9772da492944cb5c8785c8a6ed3a5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a65c9772da492944cb5c8785c8a6ed3a5">NLMSG_TAIL</a>(nmsg)</td></tr>
<tr class="separator:a65c9772da492944cb5c8785c8a6ed3a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:abd296aab2acd141c9136440967baddbd" id="r_abd296aab2acd141c9136440967baddbd"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abd296aab2acd141c9136440967baddbd">rtnl_filter_t</a>) (const struct sockaddr_nl *, struct nlmsghdr *n, void *)</td></tr>
<tr class="separator:abd296aab2acd141c9136440967baddbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af6a834b458ad515cfe591cd720b5a3fd" id="r_af6a834b458ad515cfe591cd720b5a3fd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af6a834b458ad515cfe591cd720b5a3fd">rtnl_open</a> (struct <a class="el" href="#d2/dee/structrtnl__handle">rtnl_handle</a> *<a class="el" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>, unsigned subscriptions)</td></tr>
<tr class="separator:af6a834b458ad515cfe591cd720b5a3fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcef0338bcf67064f61e984ea6542a4f" id="r_adcef0338bcf67064f61e984ea6542a4f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adcef0338bcf67064f61e984ea6542a4f">rtnl_open_byproto</a> (struct <a class="el" href="#d2/dee/structrtnl__handle">rtnl_handle</a> *<a class="el" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>, unsigned subscriptions, int protocol)</td></tr>
<tr class="separator:adcef0338bcf67064f61e984ea6542a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe941df1a4b224511e5aba5fbeda5373" id="r_abe941df1a4b224511e5aba5fbeda5373"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abe941df1a4b224511e5aba5fbeda5373">rtnl_close</a> (struct <a class="el" href="#d2/dee/structrtnl__handle">rtnl_handle</a> *<a class="el" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>)</td></tr>
<tr class="separator:abe941df1a4b224511e5aba5fbeda5373"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d89c9b26f1bf5a091e6296298df671e" id="r_a5d89c9b26f1bf5a091e6296298df671e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5d89c9b26f1bf5a091e6296298df671e">rtnl_wilddump_request</a> (struct <a class="el" href="#d2/dee/structrtnl__handle">rtnl_handle</a> *<a class="el" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>, int fam, int <a class="el" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>)</td></tr>
<tr class="separator:a5d89c9b26f1bf5a091e6296298df671e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27afc1b9833591d8deca9c2ad4fedd8f" id="r_a27afc1b9833591d8deca9c2ad4fedd8f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a27afc1b9833591d8deca9c2ad4fedd8f">rtnl_dump_request</a> (struct <a class="el" href="#d2/dee/structrtnl__handle">rtnl_handle</a> *<a class="el" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>, int <a class="el" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, void *req, int len)</td></tr>
<tr class="separator:a27afc1b9833591d8deca9c2ad4fedd8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c981a8de14fd51a25027ef407e799ca" id="r_a0c981a8de14fd51a25027ef407e799ca"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0c981a8de14fd51a25027ef407e799ca">rtnl_dump_filter</a> (struct <a class="el" href="#d2/dee/structrtnl__handle">rtnl_handle</a> *<a class="el" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>, <a class="el" href="#abd296aab2acd141c9136440967baddbd">rtnl_filter_t</a> filter, void *arg1, <a class="el" href="#abd296aab2acd141c9136440967baddbd">rtnl_filter_t</a> junk, void *arg2)</td></tr>
<tr class="separator:a0c981a8de14fd51a25027ef407e799ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e674ac9211ad8a2bd6200b04860b203" id="r_a1e674ac9211ad8a2bd6200b04860b203"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1e674ac9211ad8a2bd6200b04860b203">rtnl_talk</a> (struct <a class="el" href="#d2/dee/structrtnl__handle">rtnl_handle</a> *rtnl, struct nlmsghdr *n, pid_t peer, unsigned groups, struct nlmsghdr *answer, <a class="el" href="#abd296aab2acd141c9136440967baddbd">rtnl_filter_t</a> junk, void *jarg)</td></tr>
<tr class="separator:a1e674ac9211ad8a2bd6200b04860b203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15300d60c5f8921ca1fb0b807404f18f" id="r_a15300d60c5f8921ca1fb0b807404f18f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a15300d60c5f8921ca1fb0b807404f18f">rtnl_send</a> (struct <a class="el" href="#d2/dee/structrtnl__handle">rtnl_handle</a> *<a class="el" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>, const char *<a class="el" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, int)</td></tr>
<tr class="separator:a15300d60c5f8921ca1fb0b807404f18f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae641e5c751064db5da164e5d8fe0b529" id="r_ae641e5c751064db5da164e5d8fe0b529"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae641e5c751064db5da164e5d8fe0b529">addattr8</a> (struct nlmsghdr *n, int maxlen, int <a class="el" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, __u8 data)</td></tr>
<tr class="separator:ae641e5c751064db5da164e5d8fe0b529"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0077ba8ce749a916a3205eeb443a7a89" id="r_a0077ba8ce749a916a3205eeb443a7a89"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0077ba8ce749a916a3205eeb443a7a89">addattr32</a> (struct nlmsghdr *n, int maxlen, int <a class="el" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, __u32 data)</td></tr>
<tr class="separator:a0077ba8ce749a916a3205eeb443a7a89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a308c9418a2d83e4e9ba8d8ed0b7bbe28" id="r_a308c9418a2d83e4e9ba8d8ed0b7bbe28"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a308c9418a2d83e4e9ba8d8ed0b7bbe28">addattr_l</a> (struct nlmsghdr *n, int maxlen, int <a class="el" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, const void *data, int alen)</td></tr>
<tr class="separator:a308c9418a2d83e4e9ba8d8ed0b7bbe28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca2eef9dc434268904e814449a6f5191" id="r_aca2eef9dc434268904e814449a6f5191"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aca2eef9dc434268904e814449a6f5191">addraw_l</a> (struct nlmsghdr *n, int maxlen, const void *data, int len)</td></tr>
<tr class="separator:aca2eef9dc434268904e814449a6f5191"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ab52a0d368a7522a3e7bf98bd99235e" id="r_a6ab52a0d368a7522a3e7bf98bd99235e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ab52a0d368a7522a3e7bf98bd99235e">rta_addattr8</a> (struct rtattr *rta, int maxlen, int <a class="el" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, __u8 data)</td></tr>
<tr class="separator:a6ab52a0d368a7522a3e7bf98bd99235e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ecbea96fb090bffd6762808126c6f54" id="r_a2ecbea96fb090bffd6762808126c6f54"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2ecbea96fb090bffd6762808126c6f54">rta_addattr16</a> (struct rtattr *rta, int maxlen, int <a class="el" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, __u16 data)</td></tr>
<tr class="separator:a2ecbea96fb090bffd6762808126c6f54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a989741a127101171b87f58bb234761b2" id="r_a989741a127101171b87f58bb234761b2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a989741a127101171b87f58bb234761b2">rta_addattr32</a> (struct rtattr *rta, int maxlen, int <a class="el" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, __u32 data)</td></tr>
<tr class="separator:a989741a127101171b87f58bb234761b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c9bd7b7f03651d62a48d4895d9df4c0" id="r_a8c9bd7b7f03651d62a48d4895d9df4c0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8c9bd7b7f03651d62a48d4895d9df4c0">rta_addattr64</a> (struct rtattr *rta, int maxlen, int <a class="el" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, __u64 data)</td></tr>
<tr class="separator:a8c9bd7b7f03651d62a48d4895d9df4c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9788836cab7c0fa68a06532af4c91e19" id="r_a9788836cab7c0fa68a06532af4c91e19"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9788836cab7c0fa68a06532af4c91e19">rta_addattr_l</a> (struct rtattr *rta, int maxlen, int <a class="el" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, const void *data, int alen)</td></tr>
<tr class="separator:a9788836cab7c0fa68a06532af4c91e19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed575cd447219f8c2f67e2011aaee4d8" id="r_aed575cd447219f8c2f67e2011aaee4d8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aed575cd447219f8c2f67e2011aaee4d8">parse_rtattr</a> (struct rtattr *tb[], int max, struct rtattr *rta, int len)</td></tr>
<tr class="separator:aed575cd447219f8c2f67e2011aaee4d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e26de787132f3b007987969b9828b62" id="r_a4e26de787132f3b007987969b9828b62"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4e26de787132f3b007987969b9828b62">parse_rtattr_byindex</a> (struct rtattr *tb[], int max, struct rtattr *rta, int len)</td></tr>
<tr class="separator:a4e26de787132f3b007987969b9828b62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4d5f2195e6d7fbe3562657f2172fcfb" id="r_ae4d5f2195e6d7fbe3562657f2172fcfb"><td class="memItemLeft" align="right" valign="top">struct rtattr *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae4d5f2195e6d7fbe3562657f2172fcfb">rta_nest</a> (struct rtattr *rta, int maxlen, int <a class="el" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>)</td></tr>
<tr class="separator:ae4d5f2195e6d7fbe3562657f2172fcfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a6f122f09883f5879cdbf562b209021" id="r_a0a6f122f09883f5879cdbf562b209021"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0a6f122f09883f5879cdbf562b209021">rta_nest_end</a> (struct rtattr *rta, struct rtattr *nest)</td></tr>
<tr class="separator:a0a6f122f09883f5879cdbf562b209021"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacc7a3663568d47caf34665e570d28f0" id="r_aacc7a3663568d47caf34665e570d28f0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aacc7a3663568d47caf34665e570d28f0">rtnl_listen</a> (struct <a class="el" href="#d2/dee/structrtnl__handle">rtnl_handle</a> *, <a class="el" href="#abd296aab2acd141c9136440967baddbd">rtnl_filter_t</a> handler, void *jarg)</td></tr>
<tr class="separator:aacc7a3663568d47caf34665e570d28f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed667520bef1b7d60686a3c61e3cf038" id="r_aed667520bef1b7d60686a3c61e3cf038"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aed667520bef1b7d60686a3c61e3cf038">rtnl_from_file</a> (FILE *, <a class="el" href="#abd296aab2acd141c9136440967baddbd">rtnl_filter_t</a> handler, void *jarg)</td></tr>
<tr class="separator:aed667520bef1b7d60686a3c61e3cf038"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<hr/><h2 class="groupheader">Class Documentation</h2>
<a name="d2/dee/structrtnl__handle" id="d2/dee/structrtnl__handle"></a>
<h2 class="memtitle"><span class="permalink"><a href="#d2/dee/structrtnl__handle">&#9670;&#160;</a></span>rtnl_handle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct rtnl_handle</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00010">10</a> of file <a class="el" href="../../d5/da4/libnetlink_8h_source.html">libnetlink.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for rtnl_handle:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/d70/structrtnl__handle__coll__graph.png" border="0" usemap="#artnl__handle_coll__map" alt="Collaboration graph"/></div>
<map name="artnl__handle_coll__map" id="artnl__handle_coll__map">
<area shape="rect" title=" " alt="" coords="108,133,233,167"/>
<area shape="rect" title=" " alt="" coords="5,5,51,39"/>
<area shape="poly" title=" " alt="" coords="59,47,154,130,151,134,56,51"/>
<area shape="rect" title=" " alt="" coords="75,5,266,39"/>
<area shape="poly" title=" " alt="" coords="173,54,173,132,168,132,168,54"/>
<area shape="rect" title=" " alt="" coords="290,5,366,39"/>
<area shape="poly" title=" " alt="" coords="300,51,226,111,194,135,191,130,222,107,296,47"/>
</map>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Class Members</th></tr>
<tr><td class="fieldtype">
<a id="a3e5b07ef999b7a331f91ae5065886871" name="a3e5b07ef999b7a331f91ae5065886871"></a>__u32</td>
<td class="fieldname">
dump</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a58397dc05569f5250b2bde1e40d2ddd2" name="a58397dc05569f5250b2bde1e40d2ddd2"></a>int</td>
<td class="fieldname">
fd</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a81dab3b60ac522e1b1809c4992288683" name="a81dab3b60ac522e1b1809c4992288683"></a>struct sockaddr_nl</td>
<td class="fieldname">
local</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a49058d3b4fe126767d4de747980588a1" name="a49058d3b4fe126767d4de747980588a1"></a>struct sockaddr_nl</td>
<td class="fieldname">
peer</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3b423eb6125d051d774c8d8303b08cf9" name="a3b423eb6125d051d774c8d8303b08cf9"></a>__u32</td>
<td class="fieldname">
seq</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a65c9772da492944cb5c8785c8a6ed3a5" name="a65c9772da492944cb5c8785c8a6ed3a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65c9772da492944cb5c8785c8a6ed3a5">&#9670;&#160;</a></span>NLMSG_TAIL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NLMSG_TAIL</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>nmsg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    ((<span class="keyword">struct </span>rtattr *) (((<span class="keywordtype">void</span> *) (nmsg)) + NLMSG_ALIGN((nmsg)-&gt;nlmsg_len)))</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00064">64</a> of file <a class="el" href="../../d5/da4/libnetlink_8h_source.html">libnetlink.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   64</span><span class="preprocessor">#define NLMSG_TAIL(nmsg) \</span></div>
<div class="line"><span class="lineno">   65</span><span class="preprocessor">    ((struct rtattr *) (((void *) (nmsg)) + NLMSG_ALIGN((nmsg)-&gt;nlmsg_len)))</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00508">addattr32()</a>, <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00526">addattr8()</a>, <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00544">addattr_l()</a>, and <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00564">addraw_l()</a>.</p>

</div>
</div>
<a id="ab5023eccbd007fd6eb91c1be028e974b" name="ab5023eccbd007fd6eb91c1be028e974b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5023eccbd007fd6eb91c1be028e974b">&#9670;&#160;</a></span>parse_rtattr_nested</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define parse_rtattr_nested</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>tb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>max</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>rta</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    (<a class="code hl_function" href="#aed575cd447219f8c2f67e2011aaee4d8">parse_rtattr</a>((tb), (max), RTA_DATA(rta), RTA_PAYLOAD(rta)))</div>
<div class="ttc" id="alibnetlink_8h_html_aed575cd447219f8c2f67e2011aaee4d8"><div class="ttname"><a href="#aed575cd447219f8c2f67e2011aaee4d8">parse_rtattr</a></div><div class="ttdeci">int parse_rtattr(struct rtattr *tb[], int max, struct rtattr *rta, int len)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dab/libnetlink_8c_source.html#l00650">libnetlink.c:650</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00058">58</a> of file <a class="el" href="../../d5/da4/libnetlink_8h_source.html">libnetlink.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   58</span><span class="preprocessor">#define parse_rtattr_nested(tb, max, rta) \</span></div>
<div class="line"><span class="lineno">   59</span><span class="preprocessor">    (parse_rtattr((tb), (max), RTA_DATA(rta), RTA_PAYLOAD(rta)))</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2264115cccd1ed57a207ac14721e8878" name="a2264115cccd1ed57a207ac14721e8878"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2264115cccd1ed57a207ac14721e8878">&#9670;&#160;</a></span>RTA_TAIL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RTA_TAIL</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>rta</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">        ((<span class="keyword">struct </span>rtattr *) (((<span class="keywordtype">void</span> *) (rta)) + \</div>
<div class="line">                    RTA_ALIGN((rta)-&gt;rta_len)))</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00054">54</a> of file <a class="el" href="../../d5/da4/libnetlink_8h_source.html">libnetlink.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   54</span><span class="preprocessor">#define RTA_TAIL(rta) \</span></div>
<div class="line"><span class="lineno">   55</span><span class="preprocessor">        ((struct rtattr *) (((void *) (rta)) + \</span></div>
<div class="line"><span class="lineno">   56</span><span class="preprocessor">                    RTA_ALIGN((rta)-&gt;rta_len)))</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00633">rta_nest()</a>, and <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00643">rta_nest_end()</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="abd296aab2acd141c9136440967baddbd" name="abd296aab2acd141c9136440967baddbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd296aab2acd141c9136440967baddbd">&#9670;&#160;</a></span>rtnl_filter_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* rtnl_filter_t) (const struct sockaddr_nl *, struct nlmsghdr *n, void *)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00026">26</a> of file <a class="el" href="../../d5/da4/libnetlink_8h_source.html">libnetlink.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0077ba8ce749a916a3205eeb443a7a89" name="a0077ba8ce749a916a3205eeb443a7a89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0077ba8ce749a916a3205eeb443a7a89">&#9670;&#160;</a></span>addattr32()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int addattr32 </td>
          <td>(</td>
          <td class="paramtype">struct nlmsghdr *</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>maxlen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32</td>          <td class="paramname"><span class="paramname"><em>data</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00508">508</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  509</span>{</div>
<div class="line"><span class="lineno">  510</span>    <span class="keywordtype">int</span> len = RTA_LENGTH(4);</div>
<div class="line"><span class="lineno">  511</span>    <span class="keyword">struct </span>rtattr *rta;</div>
<div class="line"><span class="lineno">  512</span>    <span class="keywordflow">if</span> (NLMSG_ALIGN(n-&gt;nlmsg_len) + len &gt; maxlen) {</div>
<div class="line"><span class="lineno">  513</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(</div>
<div class="line"><span class="lineno">  514</span>            <span class="stringliteral">&quot;addattr32: Error! max allowed bound %d exceeded\n&quot;</span>,</div>
<div class="line"><span class="lineno">  515</span>            maxlen);</div>
<div class="line"><span class="lineno">  516</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  517</span>    }</div>
<div class="line"><span class="lineno">  518</span>    rta = <a class="code hl_define" href="#a65c9772da492944cb5c8785c8a6ed3a5">NLMSG_TAIL</a>(n);</div>
<div class="line"><span class="lineno">  519</span>    rta-&gt;rta_type = <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;</div>
<div class="line"><span class="lineno">  520</span>    rta-&gt;rta_len = len;</div>
<div class="line"><span class="lineno">  521</span>    memcpy(RTA_DATA(rta), &amp;data, 4);</div>
<div class="line"><span class="lineno">  522</span>    n-&gt;nlmsg_len = NLMSG_ALIGN(n-&gt;nlmsg_len) + len;</div>
<div class="line"><span class="lineno">  523</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  524</span>}</div>
<div class="ttc" id="alibnetlink_8h_html_a65c9772da492944cb5c8785c8a6ed3a5"><div class="ttname"><a href="#a65c9772da492944cb5c8785c8a6ed3a5">NLMSG_TAIL</a></div><div class="ttdeci">#define NLMSG_TAIL(nmsg)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/da4/libnetlink_8h_source.html#l00064">libnetlink.h:64</a></div></div>
<div class="ttc" id="aprocd_2jail_2log_8h_html_a15378cd15bafb3a79061424b452497aa"><div class="ttname"><a href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a></div><div class="ttdeci">#define ERROR(fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">log.h:27</a></div></div>
<div class="ttc" id="audebug-proto_8h_html_a1d127017fb298b889f4ba24752d08b8e"><div class="ttname"><a href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a></div><div class="ttdeci">uint8_t type</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d8f/udebug-proto_8h_source.html#l00000">udebug-proto.h:0</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00064">NLMSG_TAIL</a>, and <a class="el" href="../../dd/d8f/udebug-proto_8h_source.html#l00000">type</a>.</p>

</div>
</div>
<a id="ae641e5c751064db5da164e5d8fe0b529" name="ae641e5c751064db5da164e5d8fe0b529"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae641e5c751064db5da164e5d8fe0b529">&#9670;&#160;</a></span>addattr8()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int addattr8 </td>
          <td>(</td>
          <td class="paramtype">struct nlmsghdr *</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>maxlen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u8</td>          <td class="paramname"><span class="paramname"><em>data</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00526">526</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  527</span>{</div>
<div class="line"><span class="lineno">  528</span>    <span class="keywordtype">int</span> len = RTA_LENGTH(1);</div>
<div class="line"><span class="lineno">  529</span>    <span class="keyword">struct </span>rtattr *rta;</div>
<div class="line"><span class="lineno">  530</span>    <span class="keywordflow">if</span> (NLMSG_ALIGN(n-&gt;nlmsg_len) + len &gt; maxlen) {</div>
<div class="line"><span class="lineno">  531</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(</div>
<div class="line"><span class="lineno">  532</span>            <span class="stringliteral">&quot;addattr8: Error! max allowed bound %d exceeded\n&quot;</span>,</div>
<div class="line"><span class="lineno">  533</span>            maxlen);</div>
<div class="line"><span class="lineno">  534</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  535</span>    }</div>
<div class="line"><span class="lineno">  536</span>    rta = <a class="code hl_define" href="#a65c9772da492944cb5c8785c8a6ed3a5">NLMSG_TAIL</a>(n);</div>
<div class="line"><span class="lineno">  537</span>    rta-&gt;rta_type = <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;</div>
<div class="line"><span class="lineno">  538</span>    rta-&gt;rta_len = len;</div>
<div class="line"><span class="lineno">  539</span>    memcpy(RTA_DATA(rta), &amp;data, 1);</div>
<div class="line"><span class="lineno">  540</span>    n-&gt;nlmsg_len = NLMSG_ALIGN(n-&gt;nlmsg_len) + len;</div>
<div class="line"><span class="lineno">  541</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  542</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00064">NLMSG_TAIL</a>, and <a class="el" href="../../dd/d8f/udebug-proto_8h_source.html#l00000">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d10/bridge__track_8c_source.html#l00428">br_set_state()</a>.</p>

</div>
</div>
<a id="a308c9418a2d83e4e9ba8d8ed0b7bbe28" name="a308c9418a2d83e4e9ba8d8ed0b7bbe28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a308c9418a2d83e4e9ba8d8ed0b7bbe28">&#9670;&#160;</a></span>addattr_l()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int addattr_l </td>
          <td>(</td>
          <td class="paramtype">struct nlmsghdr *</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>maxlen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>alen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00544">544</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  546</span>{</div>
<div class="line"><span class="lineno">  547</span>    <span class="keywordtype">int</span> len = RTA_LENGTH(alen);</div>
<div class="line"><span class="lineno">  548</span>    <span class="keyword">struct </span>rtattr *rta;</div>
<div class="line"><span class="lineno">  549</span> </div>
<div class="line"><span class="lineno">  550</span>    <span class="keywordflow">if</span> (NLMSG_ALIGN(n-&gt;nlmsg_len) + RTA_ALIGN(len) &gt; maxlen) {</div>
<div class="line"><span class="lineno">  551</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(</div>
<div class="line"><span class="lineno">  552</span>            <span class="stringliteral">&quot;addattr_l ERROR: message exceeded bound of %d\n&quot;</span>,</div>
<div class="line"><span class="lineno">  553</span>            maxlen);</div>
<div class="line"><span class="lineno">  554</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  555</span>    }</div>
<div class="line"><span class="lineno">  556</span>    rta = <a class="code hl_define" href="#a65c9772da492944cb5c8785c8a6ed3a5">NLMSG_TAIL</a>(n);</div>
<div class="line"><span class="lineno">  557</span>    rta-&gt;rta_type = <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;</div>
<div class="line"><span class="lineno">  558</span>    rta-&gt;rta_len = len;</div>
<div class="line"><span class="lineno">  559</span>    memcpy(RTA_DATA(rta), data, alen);</div>
<div class="line"><span class="lineno">  560</span>    n-&gt;nlmsg_len = NLMSG_ALIGN(n-&gt;nlmsg_len) + RTA_ALIGN(len);</div>
<div class="line"><span class="lineno">  561</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  562</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00064">NLMSG_TAIL</a>, and <a class="el" href="../../dd/d8f/udebug-proto_8h_source.html#l00000">type</a>.</p>

</div>
</div>
<a id="aca2eef9dc434268904e814449a6f5191" name="aca2eef9dc434268904e814449a6f5191"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca2eef9dc434268904e814449a6f5191">&#9670;&#160;</a></span>addraw_l()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int addraw_l </td>
          <td>(</td>
          <td class="paramtype">struct nlmsghdr *</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>maxlen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00564">564</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  565</span>{</div>
<div class="line"><span class="lineno">  566</span>    <span class="keywordflow">if</span> (NLMSG_ALIGN(n-&gt;nlmsg_len) + NLMSG_ALIGN(len) &gt; maxlen) {</div>
<div class="line"><span class="lineno">  567</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(</div>
<div class="line"><span class="lineno">  568</span>            <span class="stringliteral">&quot;addraw_l ERROR: message exceeded bound of %d\n&quot;</span>,</div>
<div class="line"><span class="lineno">  569</span>            maxlen);</div>
<div class="line"><span class="lineno">  570</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  571</span>    }</div>
<div class="line"><span class="lineno">  572</span> </div>
<div class="line"><span class="lineno">  573</span>    memcpy(<a class="code hl_define" href="#a65c9772da492944cb5c8785c8a6ed3a5">NLMSG_TAIL</a>(n), data, len);</div>
<div class="line"><span class="lineno">  574</span>    memset((<span class="keywordtype">void</span> *)<a class="code hl_define" href="#a65c9772da492944cb5c8785c8a6ed3a5">NLMSG_TAIL</a>(n) + len, 0, NLMSG_ALIGN(len) - len);</div>
<div class="line"><span class="lineno">  575</span>    n-&gt;nlmsg_len = NLMSG_ALIGN(n-&gt;nlmsg_len) + NLMSG_ALIGN(len);</div>
<div class="line"><span class="lineno">  576</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  577</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, and <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00064">NLMSG_TAIL</a>.</p>

</div>
</div>
<a id="aed575cd447219f8c2f67e2011aaee4d8" name="aed575cd447219f8c2f67e2011aaee4d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed575cd447219f8c2f67e2011aaee4d8">&#9670;&#160;</a></span>parse_rtattr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int parse_rtattr </td>
          <td>(</td>
          <td class="paramtype">struct rtattr *</td>          <td class="paramname"><span class="paramname"><em>tb</em></span>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>max</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct rtattr *</td>          <td class="paramname"><span class="paramname"><em>rta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00650">650</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  651</span>{</div>
<div class="line"><span class="lineno">  652</span>    memset(tb, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> rtattr *) * (max + 1));</div>
<div class="line"><span class="lineno">  653</span>    <span class="keywordflow">while</span> (RTA_OK(rta, len)) {</div>
<div class="line"><span class="lineno">  654</span>        <span class="keywordflow">if</span> (rta-&gt;rta_type &lt;= max)</div>
<div class="line"><span class="lineno">  655</span>            tb[rta-&gt;rta_type] = rta;</div>
<div class="line"><span class="lineno">  656</span>        rta = RTA_NEXT(rta, len);</div>
<div class="line"><span class="lineno">  657</span>    }</div>
<div class="line"><span class="lineno">  658</span>    <span class="keywordflow">if</span> (len)</div>
<div class="line"><span class="lineno">  659</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;!!!Deficit %d, rta_len=%d\n&quot;</span>, len,</div>
<div class="line"><span class="lineno">  660</span>            rta-&gt;rta_len);</div>
<div class="line"><span class="lineno">  661</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  662</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/db2/brmon_8c_source.html#l00062">dump_msg()</a>.</p>

</div>
</div>
<a id="a4e26de787132f3b007987969b9828b62" name="a4e26de787132f3b007987969b9828b62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e26de787132f3b007987969b9828b62">&#9670;&#160;</a></span>parse_rtattr_byindex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int parse_rtattr_byindex </td>
          <td>(</td>
          <td class="paramtype">struct rtattr *</td>          <td class="paramname"><span class="paramname"><em>tb</em></span>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>max</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct rtattr *</td>          <td class="paramname"><span class="paramname"><em>rta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00664">664</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  666</span>{</div>
<div class="line"><span class="lineno">  667</span>    <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>    memset(tb, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> rtattr *) * max);</div>
<div class="line"><span class="lineno">  670</span>    <span class="keywordflow">while</span> (RTA_OK(rta, len)) {</div>
<div class="line"><span class="lineno">  671</span>        <span class="keywordflow">if</span> (rta-&gt;rta_type &lt;= max &amp;&amp; i &lt; max)</div>
<div class="line"><span class="lineno">  672</span>            tb[i++] = rta;</div>
<div class="line"><span class="lineno">  673</span>        rta = RTA_NEXT(rta, len);</div>
<div class="line"><span class="lineno">  674</span>    }</div>
<div class="line"><span class="lineno">  675</span>    <span class="keywordflow">if</span> (len)</div>
<div class="line"><span class="lineno">  676</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;!!!Deficit %d, rta_len=%d\n&quot;</span>, len,</div>
<div class="line"><span class="lineno">  677</span>            rta-&gt;rta_len);</div>
<div class="line"><span class="lineno">  678</span>    <span class="keywordflow">return</span> i;</div>
<div class="line"><span class="lineno">  679</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>.</p>

</div>
</div>
<a id="a2ecbea96fb090bffd6762808126c6f54" name="a2ecbea96fb090bffd6762808126c6f54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ecbea96fb090bffd6762808126c6f54">&#9670;&#160;</a></span>rta_addattr16()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rta_addattr16 </td>
          <td>(</td>
          <td class="paramtype">struct rtattr *</td>          <td class="paramname"><span class="paramname"><em>rta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>maxlen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u16</td>          <td class="paramname"><span class="paramname"><em>data</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00623">623</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  624</span>{</div>
<div class="line"><span class="lineno">  625</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../d4/dab/libnetlink_8c.html#a9788836cab7c0fa68a06532af4c91e19">rta_addattr_l</a>(rta, maxlen, <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, &amp;data, <span class="keyword">sizeof</span>(__u16));</div>
<div class="line"><span class="lineno">  626</span>}</div>
<div class="ttc" id="alibnetlink_8c_html_a9788836cab7c0fa68a06532af4c91e19"><div class="ttname"><a href="../../d4/dab/libnetlink_8c.html#a9788836cab7c0fa68a06532af4c91e19">rta_addattr_l</a></div><div class="ttdeci">int rta_addattr_l(struct rtattr *rta, int maxlen, int type, const void *data, int alen)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dab/libnetlink_8c_source.html#l00598">libnetlink.c:598</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00598">rta_addattr_l()</a>, and <a class="el" href="../../dd/d8f/udebug-proto_8h_source.html#l00000">type</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/da4/libnetlink_8h_a2ecbea96fb090bffd6762808126c6f54_cgraph.png" border="0" usemap="#ad5/da4/libnetlink_8h_a2ecbea96fb090bffd6762808126c6f54_cgraph" alt=""/></div>
<map name="ad5/da4/libnetlink_8h_a2ecbea96fb090bffd6762808126c6f54_cgraph" id="ad5/da4/libnetlink_8h_a2ecbea96fb090bffd6762808126c6f54_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,154,39"/>
<area shape="rect" href="../../d4/dab/libnetlink_8c.html#a9788836cab7c0fa68a06532af4c91e19" title=" " alt="" coords="202,5,340,39"/>
<area shape="poly" title=" " alt="" coords="154,20,186,20,186,25,154,25"/>
</map>
</div>

</div>
</div>
<a id="a989741a127101171b87f58bb234761b2" name="a989741a127101171b87f58bb234761b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a989741a127101171b87f58bb234761b2">&#9670;&#160;</a></span>rta_addattr32()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rta_addattr32 </td>
          <td>(</td>
          <td class="paramtype">struct rtattr *</td>          <td class="paramname"><span class="paramname"><em>rta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>maxlen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32</td>          <td class="paramname"><span class="paramname"><em>data</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00579">579</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  580</span>{</div>
<div class="line"><span class="lineno">  581</span>    <span class="keywordtype">int</span> len = RTA_LENGTH(4);</div>
<div class="line"><span class="lineno">  582</span>    <span class="keyword">struct </span>rtattr *subrta;</div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span>    <span class="keywordflow">if</span> (RTA_ALIGN(rta-&gt;rta_len) + len &gt; maxlen) {</div>
<div class="line"><span class="lineno">  585</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(</div>
<div class="line"><span class="lineno">  586</span>            <span class="stringliteral">&quot;rta_addattr32: Error! max allowed bound %d exceeded\n&quot;</span>,</div>
<div class="line"><span class="lineno">  587</span>            maxlen);</div>
<div class="line"><span class="lineno">  588</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  589</span>    }</div>
<div class="line"><span class="lineno">  590</span>    subrta = (<span class="keyword">struct </span>rtattr *)(((<span class="keywordtype">char</span> *)rta) + RTA_ALIGN(rta-&gt;rta_len));</div>
<div class="line"><span class="lineno">  591</span>    subrta-&gt;rta_type = <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;</div>
<div class="line"><span class="lineno">  592</span>    subrta-&gt;rta_len = len;</div>
<div class="line"><span class="lineno">  593</span>    memcpy(RTA_DATA(subrta), &amp;data, 4);</div>
<div class="line"><span class="lineno">  594</span>    rta-&gt;rta_len = NLMSG_ALIGN(rta-&gt;rta_len) + len;</div>
<div class="line"><span class="lineno">  595</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  596</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, and <a class="el" href="../../dd/d8f/udebug-proto_8h_source.html#l00000">type</a>.</p>

</div>
</div>
<a id="a8c9bd7b7f03651d62a48d4895d9df4c0" name="a8c9bd7b7f03651d62a48d4895d9df4c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c9bd7b7f03651d62a48d4895d9df4c0">&#9670;&#160;</a></span>rta_addattr64()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rta_addattr64 </td>
          <td>(</td>
          <td class="paramtype">struct rtattr *</td>          <td class="paramname"><span class="paramname"><em>rta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>maxlen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u64</td>          <td class="paramname"><span class="paramname"><em>data</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00628">628</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  629</span>{</div>
<div class="line"><span class="lineno">  630</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../d4/dab/libnetlink_8c.html#a9788836cab7c0fa68a06532af4c91e19">rta_addattr_l</a>(rta, maxlen, <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, &amp;data, <span class="keyword">sizeof</span>(__u64));</div>
<div class="line"><span class="lineno">  631</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00598">rta_addattr_l()</a>, and <a class="el" href="../../dd/d8f/udebug-proto_8h_source.html#l00000">type</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/da4/libnetlink_8h_a8c9bd7b7f03651d62a48d4895d9df4c0_cgraph.png" border="0" usemap="#ad5/da4/libnetlink_8h_a8c9bd7b7f03651d62a48d4895d9df4c0_cgraph" alt=""/></div>
<map name="ad5/da4/libnetlink_8h_a8c9bd7b7f03651d62a48d4895d9df4c0_cgraph" id="ad5/da4/libnetlink_8h_a8c9bd7b7f03651d62a48d4895d9df4c0_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,154,39"/>
<area shape="rect" href="../../d4/dab/libnetlink_8c.html#a9788836cab7c0fa68a06532af4c91e19" title=" " alt="" coords="202,5,340,39"/>
<area shape="poly" title=" " alt="" coords="154,20,186,20,186,25,154,25"/>
</map>
</div>

</div>
</div>
<a id="a6ab52a0d368a7522a3e7bf98bd99235e" name="a6ab52a0d368a7522a3e7bf98bd99235e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ab52a0d368a7522a3e7bf98bd99235e">&#9670;&#160;</a></span>rta_addattr8()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rta_addattr8 </td>
          <td>(</td>
          <td class="paramtype">struct rtattr *</td>          <td class="paramname"><span class="paramname"><em>rta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>maxlen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u8</td>          <td class="paramname"><span class="paramname"><em>data</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00618">618</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  619</span>{</div>
<div class="line"><span class="lineno">  620</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../d4/dab/libnetlink_8c.html#a9788836cab7c0fa68a06532af4c91e19">rta_addattr_l</a>(rta, maxlen, <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, &amp;data, <span class="keyword">sizeof</span>(__u8));</div>
<div class="line"><span class="lineno">  621</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00598">rta_addattr_l()</a>, and <a class="el" href="../../dd/d8f/udebug-proto_8h_source.html#l00000">type</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/da4/libnetlink_8h_a6ab52a0d368a7522a3e7bf98bd99235e_cgraph.png" border="0" usemap="#ad5/da4/libnetlink_8h_a6ab52a0d368a7522a3e7bf98bd99235e_cgraph" alt=""/></div>
<map name="ad5/da4/libnetlink_8h_a6ab52a0d368a7522a3e7bf98bd99235e_cgraph" id="ad5/da4/libnetlink_8h_a6ab52a0d368a7522a3e7bf98bd99235e_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,142,39"/>
<area shape="rect" href="../../d4/dab/libnetlink_8c.html#a9788836cab7c0fa68a06532af4c91e19" title=" " alt="" coords="190,5,328,39"/>
<area shape="poly" title=" " alt="" coords="142,20,174,20,174,25,142,25"/>
</map>
</div>

</div>
</div>
<a id="a9788836cab7c0fa68a06532af4c91e19" name="a9788836cab7c0fa68a06532af4c91e19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9788836cab7c0fa68a06532af4c91e19">&#9670;&#160;</a></span>rta_addattr_l()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rta_addattr_l </td>
          <td>(</td>
          <td class="paramtype">struct rtattr *</td>          <td class="paramname"><span class="paramname"><em>rta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>maxlen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>alen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00598">598</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  600</span>{</div>
<div class="line"><span class="lineno">  601</span>    <span class="keyword">struct </span>rtattr *subrta;</div>
<div class="line"><span class="lineno">  602</span>    <span class="keywordtype">int</span> len = RTA_LENGTH(alen);</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span>    <span class="keywordflow">if</span> (RTA_ALIGN(rta-&gt;rta_len) + RTA_ALIGN(len) &gt; maxlen) {</div>
<div class="line"><span class="lineno">  605</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(</div>
<div class="line"><span class="lineno">  606</span>            <span class="stringliteral">&quot;rta_addattr_l: Error! max allowed bound %d exceeded\n&quot;</span>,</div>
<div class="line"><span class="lineno">  607</span>            maxlen);</div>
<div class="line"><span class="lineno">  608</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  609</span>    }</div>
<div class="line"><span class="lineno">  610</span>    subrta = (<span class="keyword">struct </span>rtattr *)(((<span class="keywordtype">char</span> *)rta) + RTA_ALIGN(rta-&gt;rta_len));</div>
<div class="line"><span class="lineno">  611</span>    subrta-&gt;rta_type = <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;</div>
<div class="line"><span class="lineno">  612</span>    subrta-&gt;rta_len = len;</div>
<div class="line"><span class="lineno">  613</span>    memcpy(RTA_DATA(subrta), data, alen);</div>
<div class="line"><span class="lineno">  614</span>    rta-&gt;rta_len = NLMSG_ALIGN(rta-&gt;rta_len) + RTA_ALIGN(len);</div>
<div class="line"><span class="lineno">  615</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  616</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, and <a class="el" href="../../dd/d8f/udebug-proto_8h_source.html#l00000">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00623">rta_addattr16()</a>, <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00628">rta_addattr64()</a>, <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00618">rta_addattr8()</a>, and <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00633">rta_nest()</a>.</p>

</div>
</div>
<a id="ae4d5f2195e6d7fbe3562657f2172fcfb" name="ae4d5f2195e6d7fbe3562657f2172fcfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4d5f2195e6d7fbe3562657f2172fcfb">&#9670;&#160;</a></span>rta_nest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct rtattr * rta_nest </td>
          <td>(</td>
          <td class="paramtype">struct rtattr *</td>          <td class="paramname"><span class="paramname"><em>rta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>maxlen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00633">633</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  634</span>{</div>
<div class="line"><span class="lineno">  635</span>    <span class="keyword">struct </span>rtattr *nest = <a class="code hl_define" href="#a2264115cccd1ed57a207ac14721e8878">RTA_TAIL</a>(rta);</div>
<div class="line"><span class="lineno">  636</span> </div>
<div class="line"><span class="lineno">  637</span>    <a class="code hl_function" href="../../d4/dab/libnetlink_8c.html#a9788836cab7c0fa68a06532af4c91e19">rta_addattr_l</a>(rta, maxlen, <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, NULL, 0);</div>
<div class="line"><span class="lineno">  638</span>    nest-&gt;rta_type |= NLA_F_NESTED;</div>
<div class="line"><span class="lineno">  639</span> </div>
<div class="line"><span class="lineno">  640</span>    <span class="keywordflow">return</span> nest;</div>
<div class="line"><span class="lineno">  641</span>}</div>
<div class="ttc" id="alibnetlink_8h_html_a2264115cccd1ed57a207ac14721e8878"><div class="ttname"><a href="#a2264115cccd1ed57a207ac14721e8878">RTA_TAIL</a></div><div class="ttdeci">#define RTA_TAIL(rta)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/da4/libnetlink_8h_source.html#l00054">libnetlink.h:54</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00598">rta_addattr_l()</a>, <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00054">RTA_TAIL</a>, and <a class="el" href="../../dd/d8f/udebug-proto_8h_source.html#l00000">type</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/da4/libnetlink_8h_ae4d5f2195e6d7fbe3562657f2172fcfb_cgraph.png" border="0" usemap="#ad5/da4/libnetlink_8h_ae4d5f2195e6d7fbe3562657f2172fcfb_cgraph" alt=""/></div>
<map name="ad5/da4/libnetlink_8h_ae4d5f2195e6d7fbe3562657f2172fcfb_cgraph" id="ad5/da4/libnetlink_8h_ae4d5f2195e6d7fbe3562657f2172fcfb_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,102,39"/>
<area shape="rect" href="../../d4/dab/libnetlink_8c.html#a9788836cab7c0fa68a06532af4c91e19" title=" " alt="" coords="150,5,288,39"/>
<area shape="poly" title=" " alt="" coords="102,20,134,20,134,25,102,25"/>
</map>
</div>

</div>
</div>
<a id="a0a6f122f09883f5879cdbf562b209021" name="a0a6f122f09883f5879cdbf562b209021"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a6f122f09883f5879cdbf562b209021">&#9670;&#160;</a></span>rta_nest_end()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rta_nest_end </td>
          <td>(</td>
          <td class="paramtype">struct rtattr *</td>          <td class="paramname"><span class="paramname"><em>rta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct rtattr *</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00643">643</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  644</span>{</div>
<div class="line"><span class="lineno">  645</span>    nest-&gt;rta_len = (<span class="keywordtype">void</span> *)<a class="code hl_define" href="#a2264115cccd1ed57a207ac14721e8878">RTA_TAIL</a>(rta) - (<span class="keywordtype">void</span> *)nest;</div>
<div class="line"><span class="lineno">  646</span> </div>
<div class="line"><span class="lineno">  647</span>    <span class="keywordflow">return</span> rta-&gt;rta_len;</div>
<div class="line"><span class="lineno">  648</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00054">RTA_TAIL</a>.</p>

</div>
</div>
<a id="abe941df1a4b224511e5aba5fbeda5373" name="abe941df1a4b224511e5aba5fbeda5373"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe941df1a4b224511e5aba5fbeda5373">&#9670;&#160;</a></span>rtnl_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rtnl_close </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="#d2/dee/structrtnl__handle">rtnl_handle</a> *</td>          <td class="paramname"><span class="paramname"><em>rth</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00040">40</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   41</span>{</div>
<div class="line"><span class="lineno">   42</span>    close(<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>);</div>
<div class="line"><span class="lineno">   43</span>}</div>
<div class="ttc" id="abrmon_8c_html_a052e2f2ddaba32f35e414adab16b5fb4"><div class="ttname"><a href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a></div><div class="ttdeci">static struct rtnl_handle rth</div><div class="ttdef"><b>Definition</b> <a href="../../d1/db2/brmon_8c_source.html#l00057">brmon.c:57</a></div></div>
<div class="ttc" id="alibnetlink_8h_html_a58397dc05569f5250b2bde1e40d2ddd2"><div class="ttname"><a href="#a58397dc05569f5250b2bde1e40d2ddd2">rtnl_handle::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition</b> <a href="../../d5/da4/libnetlink_8h_source.html#l00012">libnetlink.h:12</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00012">rtnl_handle::fd</a>, and <a class="el" href="../../d1/db2/brmon_8c_source.html#l00057">rth</a>.</p>

</div>
</div>
<a id="a0c981a8de14fd51a25027ef407e799ca" name="a0c981a8de14fd51a25027ef407e799ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c981a8de14fd51a25027ef407e799ca">&#9670;&#160;</a></span>rtnl_dump_filter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_dump_filter </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="#d2/dee/structrtnl__handle">rtnl_handle</a> *</td>          <td class="paramname"><span class="paramname"><em>rth</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#abd296aab2acd141c9136440967baddbd">rtnl_filter_t</a></td>          <td class="paramname"><span class="paramname"><em>filter</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>arg1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#abd296aab2acd141c9136440967baddbd">rtnl_filter_t</a></td>          <td class="paramname"><span class="paramname"><em>junk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>arg2</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00170">170</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  173</span>{</div>
<div class="line"><span class="lineno">  174</span>    <span class="keyword">struct </span>sockaddr_nl nladdr;</div>
<div class="line"><span class="lineno">  175</span>    <span class="keyword">struct </span>iovec iov;</div>
<div class="line"><span class="lineno">  176</span>    <span class="keyword">struct </span>msghdr msg = {</div>
<div class="line"><span class="lineno">  177</span>        .msg_name = &amp;nladdr,</div>
<div class="line"><span class="lineno">  178</span>        .msg_namelen = <span class="keyword">sizeof</span>(nladdr),</div>
<div class="line"><span class="lineno">  179</span>        .msg_iov = &amp;iov,</div>
<div class="line"><span class="lineno">  180</span>        .msg_iovlen = 1,</div>
<div class="line"><span class="lineno">  181</span>    };</div>
<div class="line"><span class="lineno">  182</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>[16384];</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>    iov.iov_base = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>;</div>
<div class="line"><span class="lineno">  185</span>    <span class="keywordflow">while</span> (1) {</div>
<div class="line"><span class="lineno">  186</span>        <span class="keywordtype">int</span> status;</div>
<div class="line"><span class="lineno">  187</span>        <span class="keyword">struct </span>nlmsghdr *h;</div>
<div class="line"><span class="lineno">  188</span> </div>
<div class="line"><span class="lineno">  189</span>        iov.iov_len = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>);</div>
<div class="line"><span class="lineno">  190</span>        status = recvmsg(<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, &amp;msg, 0);</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>        <span class="keywordflow">if</span> (status &lt; 0) {</div>
<div class="line"><span class="lineno">  193</span>            <span class="keywordflow">if</span> (errno == EINTR)</div>
<div class="line"><span class="lineno">  194</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  195</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;OVERRUN&quot;</span>);</div>
<div class="line"><span class="lineno">  196</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  197</span>        }</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>        <span class="keywordflow">if</span> (status == 0) {</div>
<div class="line"><span class="lineno">  200</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;EOF on netlink\n&quot;</span>);</div>
<div class="line"><span class="lineno">  201</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  202</span>        }</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>        h = (<span class="keyword">struct </span>nlmsghdr *)<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>;</div>
<div class="line"><span class="lineno">  205</span>        <span class="keywordflow">while</span> (NLMSG_OK(h, status)) {</div>
<div class="line"><span class="lineno">  206</span>            <span class="keywordtype">int</span> <a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a>;</div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>            <span class="keywordflow">if</span> (nladdr.nl_pid != 0 ||</div>
<div class="line"><span class="lineno">  209</span>                h-&gt;nlmsg_pid != <a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a81dab3b60ac522e1b1809c4992288683">local</a>.nl_pid ||</div>
<div class="line"><span class="lineno">  210</span>                h-&gt;nlmsg_seq != <a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a3e5b07ef999b7a331f91ae5065886871">dump</a>) {</div>
<div class="line"><span class="lineno">  211</span>                <span class="keywordflow">if</span> (junk) {</div>
<div class="line"><span class="lineno">  212</span>                    <a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a> = junk(&amp;nladdr, h, arg2);</div>
<div class="line"><span class="lineno">  213</span>                    <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a> &lt; 0)</div>
<div class="line"><span class="lineno">  214</span>                        <span class="keywordflow">return</span> <a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a>;</div>
<div class="line"><span class="lineno">  215</span>                }</div>
<div class="line"><span class="lineno">  216</span>                <span class="keywordflow">goto</span> skip_it;</div>
<div class="line"><span class="lineno">  217</span>            }</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>            <span class="keywordflow">if</span> (h-&gt;nlmsg_type == NLMSG_DONE)</div>
<div class="line"><span class="lineno">  220</span>                <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  221</span>            <span class="keywordflow">if</span> (h-&gt;nlmsg_type == NLMSG_ERROR) {</div>
<div class="line"><span class="lineno">  222</span>                <span class="keyword">struct </span>nlmsgerr *<a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a> =</div>
<div class="line"><span class="lineno">  223</span>                    (<span class="keyword">struct </span>nlmsgerr *)NLMSG_DATA(h);</div>
<div class="line"><span class="lineno">  224</span>                <span class="keywordflow">if</span> (h-&gt;nlmsg_len &lt;</div>
<div class="line"><span class="lineno">  225</span>                    NLMSG_LENGTH(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> nlmsgerr))) {</div>
<div class="line"><span class="lineno">  226</span>                    <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;ERROR truncated\n&quot;</span>);</div>
<div class="line"><span class="lineno">  227</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  228</span>                    errno = -<a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a>-&gt;error;</div>
<div class="line"><span class="lineno">  229</span>                    <a class="code hl_define" href="../../d9/d1e/procd_2log_8h.html#a159ca84d25a5487d8e81e4438725df19">LOG</a>(<span class="stringliteral">&quot;RTNETLINK answers&quot;</span>);</div>
<div class="line"><span class="lineno">  230</span>                }</div>
<div class="line"><span class="lineno">  231</span>                <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  232</span>            }</div>
<div class="line"><span class="lineno">  233</span>            <a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a> = filter(&amp;nladdr, h, arg1);</div>
<div class="line"><span class="lineno">  234</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a> &lt; 0)</div>
<div class="line"><span class="lineno">  235</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a>;</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>              skip_it:</div>
<div class="line"><span class="lineno">  238</span>            h = NLMSG_NEXT(h, status);</div>
<div class="line"><span class="lineno">  239</span>        }</div>
<div class="line"><span class="lineno">  240</span>        <span class="keywordflow">if</span> (msg.msg_flags &amp; MSG_TRUNC) {</div>
<div class="line"><span class="lineno">  241</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Message truncated\n&quot;</span>);</div>
<div class="line"><span class="lineno">  242</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  243</span>        }</div>
<div class="line"><span class="lineno">  244</span>        <span class="keywordflow">if</span> (status) {</div>
<div class="line"><span class="lineno">  245</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;!!!Remnant of size %d\n&quot;</span>, status);</div>
<div class="line"><span class="lineno">  246</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  247</span>        }</div>
<div class="line"><span class="lineno">  248</span>    }</div>
<div class="line"><span class="lineno">  249</span>}</div>
<div class="ttc" id="alibnetlink_8h_html_a3e5b07ef999b7a331f91ae5065886871"><div class="ttname"><a href="#a3e5b07ef999b7a331f91ae5065886871">rtnl_handle::dump</a></div><div class="ttdeci">__u32 dump</div><div class="ttdef"><b>Definition</b> <a href="../../d5/da4/libnetlink_8h_source.html#l00016">libnetlink.h:16</a></div></div>
<div class="ttc" id="alibnetlink_8h_html_a81dab3b60ac522e1b1809c4992288683"><div class="ttname"><a href="#a81dab3b60ac522e1b1809c4992288683">rtnl_handle::local</a></div><div class="ttdeci">struct sockaddr_nl local</div><div class="ttdef"><b>Definition</b> <a href="../../d5/da4/libnetlink_8h_source.html#l00013">libnetlink.h:13</a></div></div>
<div class="ttc" id="amkdev_8c_html_a024e65f7d9664cdc767f51c283fd8353"><div class="ttname"><a href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a></div><div class="ttdeci">static char buf[PATH_MAX]</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d9a/mkdev_8c_source.html#l00034">mkdev.c:34</a></div></div>
<div class="ttc" id="aprocd_2log_8h_html_a159ca84d25a5487d8e81e4438725df19"><div class="ttname"><a href="../../d9/d1e/procd_2log_8h.html#a159ca84d25a5487d8e81e4438725df19">LOG</a></div><div class="ttdeci">#define LOG</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d1e/procd_2log_8h_source.html#l00032">log.h:32</a></div></div>
<div class="ttc" id="audevtrigger_8c_html_abdc0ddb6c825c951cdc8e45b53459445"><div class="ttname"><a href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a></div><div class="ttdeci">#define err(format, arg...)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d62/udevtrigger_8c_source.html#l00058">udevtrigger.c:58</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00016">rtnl_handle::dump</a>, <a class="el" href="../../d2/d62/udevtrigger_8c_source.html#l00058">err</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00012">rtnl_handle::fd</a>, <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00013">rtnl_handle::local</a>, <a class="el" href="../../d9/d1e/procd_2log_8h_source.html#l00032">LOG</a>, and <a class="el" href="../../d1/db2/brmon_8c_source.html#l00057">rth</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/db2/brmon_8c_source.html#l00187">init_bridge_ops()</a>.</p>

</div>
</div>
<a id="a27afc1b9833591d8deca9c2ad4fedd8f" name="a27afc1b9833591d8deca9c2ad4fedd8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27afc1b9833591d8deca9c2ad4fedd8f">&#9670;&#160;</a></span>rtnl_dump_request()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_dump_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="#d2/dee/structrtnl__handle">rtnl_handle</a> *</td>          <td class="paramname"><span class="paramname"><em>rth</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>req</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00142">142</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  143</span>{</div>
<div class="line"><span class="lineno">  144</span>    <span class="keyword">struct </span>nlmsghdr nlh;</div>
<div class="line"><span class="lineno">  145</span>    <span class="keyword">struct </span>sockaddr_nl nladdr;</div>
<div class="line"><span class="lineno">  146</span>    <span class="keyword">struct </span>iovec iov[2] = {</div>
<div class="line"><span class="lineno">  147</span>        {.iov_base = &amp;nlh,.iov_len = <span class="keyword">sizeof</span>(nlh)}</div>
<div class="line"><span class="lineno">  148</span>        ,</div>
<div class="line"><span class="lineno">  149</span>        {.iov_base = req,.iov_len = len}</div>
<div class="line"><span class="lineno">  150</span>    };</div>
<div class="line"><span class="lineno">  151</span>    <span class="keyword">struct </span>msghdr msg = {</div>
<div class="line"><span class="lineno">  152</span>        .msg_name = &amp;nladdr,</div>
<div class="line"><span class="lineno">  153</span>        .msg_namelen = <span class="keyword">sizeof</span>(nladdr),</div>
<div class="line"><span class="lineno">  154</span>        .msg_iov = iov,</div>
<div class="line"><span class="lineno">  155</span>        .msg_iovlen = 2,</div>
<div class="line"><span class="lineno">  156</span>    };</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>    memset(&amp;nladdr, 0, <span class="keyword">sizeof</span>(nladdr));</div>
<div class="line"><span class="lineno">  159</span>    nladdr.nl_family = AF_NETLINK;</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>    nlh.nlmsg_len = NLMSG_LENGTH(len);</div>
<div class="line"><span class="lineno">  162</span>    nlh.nlmsg_type = <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;</div>
<div class="line"><span class="lineno">  163</span>    nlh.nlmsg_flags = NLM_F_ROOT | NLM_F_MATCH | NLM_F_REQUEST;</div>
<div class="line"><span class="lineno">  164</span>    nlh.nlmsg_pid = 0;</div>
<div class="line"><span class="lineno">  165</span>    nlh.nlmsg_seq = <a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a3e5b07ef999b7a331f91ae5065886871">dump</a> = ++<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a3b423eb6125d051d774c8d8303b08cf9">seq</a>;</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>    <span class="keywordflow">return</span> sendmsg(<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, &amp;msg, 0);</div>
<div class="line"><span class="lineno">  168</span>}</div>
<div class="ttc" id="alibnetlink_8h_html_a3b423eb6125d051d774c8d8303b08cf9"><div class="ttname"><a href="#a3b423eb6125d051d774c8d8303b08cf9">rtnl_handle::seq</a></div><div class="ttdeci">__u32 seq</div><div class="ttdef"><b>Definition</b> <a href="../../d5/da4/libnetlink_8h_source.html#l00015">libnetlink.h:15</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00016">rtnl_handle::dump</a>, <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00012">rtnl_handle::fd</a>, <a class="el" href="../../d1/db2/brmon_8c_source.html#l00057">rth</a>, <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00015">rtnl_handle::seq</a>, and <a class="el" href="../../dd/d8f/udebug-proto_8h_source.html#l00000">type</a>.</p>

</div>
</div>
<a id="aed667520bef1b7d60686a3c61e3cf038" name="aed667520bef1b7d60686a3c61e3cf038"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed667520bef1b7d60686a3c61e3cf038">&#9670;&#160;</a></span>rtnl_from_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_from_file </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>rtnl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#abd296aab2acd141c9136440967baddbd">rtnl_filter_t</a></td>          <td class="paramname"><span class="paramname"><em>handler</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>jarg</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00455">455</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  456</span>{</div>
<div class="line"><span class="lineno">  457</span>    <span class="keywordtype">int</span> status;</div>
<div class="line"><span class="lineno">  458</span>    <span class="keyword">struct </span>sockaddr_nl nladdr;</div>
<div class="line"><span class="lineno">  459</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>[8192];</div>
<div class="line"><span class="lineno">  460</span>    <span class="keyword">struct </span>nlmsghdr *h = (<span class="keywordtype">void</span> *)<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>;</div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span>    memset(&amp;nladdr, 0, <span class="keyword">sizeof</span>(nladdr));</div>
<div class="line"><span class="lineno">  463</span>    nladdr.nl_family = AF_NETLINK;</div>
<div class="line"><span class="lineno">  464</span>    nladdr.nl_pid = 0;</div>
<div class="line"><span class="lineno">  465</span>    nladdr.nl_groups = 0;</div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span>    <span class="keywordflow">while</span> (1) {</div>
<div class="line"><span class="lineno">  468</span>        <span class="keywordtype">int</span> <a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a>, len;</div>
<div class="line"><span class="lineno">  469</span>        <span class="keywordtype">int</span> l;</div>
<div class="line"><span class="lineno">  470</span> </div>
<div class="line"><span class="lineno">  471</span>        status = fread(&amp;<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, 1, <span class="keyword">sizeof</span>(*h), rtnl);</div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span>        <span class="keywordflow">if</span> (status &lt; 0) {</div>
<div class="line"><span class="lineno">  474</span>            <span class="keywordflow">if</span> (errno == EINTR)</div>
<div class="line"><span class="lineno">  475</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  476</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;rtnl_from_file: fread&quot;</span>);</div>
<div class="line"><span class="lineno">  477</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  478</span>        }</div>
<div class="line"><span class="lineno">  479</span>        <span class="keywordflow">if</span> (status == 0)</div>
<div class="line"><span class="lineno">  480</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>        len = h-&gt;nlmsg_len;</div>
<div class="line"><span class="lineno">  483</span>        l = len - <span class="keyword">sizeof</span>(*h);</div>
<div class="line"><span class="lineno">  484</span> </div>
<div class="line"><span class="lineno">  485</span>        <span class="keywordflow">if</span> (l &lt; 0 || len &gt; <span class="keyword">sizeof</span>(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>)) {</div>
<div class="line"><span class="lineno">  486</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;!!!malformed message: len=%d @%lu\n&quot;</span>,</div>
<div class="line"><span class="lineno">  487</span>                len, ftell(rtnl));</div>
<div class="line"><span class="lineno">  488</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  489</span>        }</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>        status = fread(NLMSG_DATA(h), 1, NLMSG_ALIGN(l), rtnl);</div>
<div class="line"><span class="lineno">  492</span> </div>
<div class="line"><span class="lineno">  493</span>        <span class="keywordflow">if</span> (status &lt; 0) {</div>
<div class="line"><span class="lineno">  494</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;rtnl_from_file: fread&quot;</span>);</div>
<div class="line"><span class="lineno">  495</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  496</span>        }</div>
<div class="line"><span class="lineno">  497</span>        <span class="keywordflow">if</span> (status &lt; l) {</div>
<div class="line"><span class="lineno">  498</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;rtnl-from_file: truncated message\n&quot;</span>);</div>
<div class="line"><span class="lineno">  499</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  500</span>        }</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>        <a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a> = handler(&amp;nladdr, h, jarg);</div>
<div class="line"><span class="lineno">  503</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a> &lt; 0)</div>
<div class="line"><span class="lineno">  504</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a>;</div>
<div class="line"><span class="lineno">  505</span>    }</div>
<div class="line"><span class="lineno">  506</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../d2/d62/udevtrigger_8c_source.html#l00058">err</a>, and <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>.</p>

</div>
</div>
<a id="aacc7a3663568d47caf34665e570d28f0" name="aacc7a3663568d47caf34665e570d28f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacc7a3663568d47caf34665e570d28f0">&#9670;&#160;</a></span>rtnl_listen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_listen </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="#d2/dee/structrtnl__handle">rtnl_handle</a> *</td>          <td class="paramname"><span class="paramname"><em>rtnl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#abd296aab2acd141c9136440967baddbd">rtnl_filter_t</a></td>          <td class="paramname"><span class="paramname"><em>handler</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>jarg</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00379">379</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  380</span>{</div>
<div class="line"><span class="lineno">  381</span>    <span class="keywordtype">int</span> status;</div>
<div class="line"><span class="lineno">  382</span>    <span class="keyword">struct </span>nlmsghdr *h;</div>
<div class="line"><span class="lineno">  383</span>    <span class="keyword">struct </span>sockaddr_nl nladdr;</div>
<div class="line"><span class="lineno">  384</span>    <span class="keyword">struct </span>iovec iov;</div>
<div class="line"><span class="lineno">  385</span>    <span class="keyword">struct </span>msghdr msg = {</div>
<div class="line"><span class="lineno">  386</span>        .msg_name = &amp;nladdr,</div>
<div class="line"><span class="lineno">  387</span>        .msg_namelen = <span class="keyword">sizeof</span>(nladdr),</div>
<div class="line"><span class="lineno">  388</span>        .msg_iov = &amp;iov,</div>
<div class="line"><span class="lineno">  389</span>        .msg_iovlen = 1,</div>
<div class="line"><span class="lineno">  390</span>    };</div>
<div class="line"><span class="lineno">  391</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>[8192];</div>
<div class="line"><span class="lineno">  392</span> </div>
<div class="line"><span class="lineno">  393</span>    memset(&amp;nladdr, 0, <span class="keyword">sizeof</span>(nladdr));</div>
<div class="line"><span class="lineno">  394</span>    nladdr.nl_family = AF_NETLINK;</div>
<div class="line"><span class="lineno">  395</span>    nladdr.nl_pid = 0;</div>
<div class="line"><span class="lineno">  396</span>    nladdr.nl_groups = 0;</div>
<div class="line"><span class="lineno">  397</span> </div>
<div class="line"><span class="lineno">  398</span>    iov.iov_base = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>;</div>
<div class="line"><span class="lineno">  399</span>    <span class="keywordflow">while</span> (1) {</div>
<div class="line"><span class="lineno">  400</span>        iov.iov_len = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>);</div>
<div class="line"><span class="lineno">  401</span>        status = recvmsg(rtnl-&gt;<a class="code hl_variable" href="#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, &amp;msg, 0);</div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span>        <span class="keywordflow">if</span> (status &lt; 0) {</div>
<div class="line"><span class="lineno">  404</span>            <span class="keywordflow">if</span> (errno == EINTR)</div>
<div class="line"><span class="lineno">  405</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  406</span>            <span class="keywordflow">if</span> (errno == EAGAIN)</div>
<div class="line"><span class="lineno">  407</span>                <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  408</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;OVERRUN: recvmsg(): error %d : %s\n&quot;</span>, errno, strerror(errno));</div>
<div class="line"><span class="lineno">  409</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  410</span>        }</div>
<div class="line"><span class="lineno">  411</span>        <span class="keywordflow">if</span> (status == 0) {</div>
<div class="line"><span class="lineno">  412</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;EOF on netlink\n&quot;</span>);</div>
<div class="line"><span class="lineno">  413</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  414</span>        }</div>
<div class="line"><span class="lineno">  415</span>        <span class="keywordflow">if</span> (msg.msg_namelen != <span class="keyword">sizeof</span>(nladdr)) {</div>
<div class="line"><span class="lineno">  416</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Sender address length == %d\n&quot;</span>,</div>
<div class="line"><span class="lineno">  417</span>                msg.msg_namelen);</div>
<div class="line"><span class="lineno">  418</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  419</span>        }</div>
<div class="line"><span class="lineno">  420</span>        <span class="keywordflow">for</span> (h = (<span class="keyword">struct</span> nlmsghdr *)<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>; status &gt;= <span class="keyword">sizeof</span>(*h);) {</div>
<div class="line"><span class="lineno">  421</span>            <span class="keywordtype">int</span> <a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a>;</div>
<div class="line"><span class="lineno">  422</span>            <span class="keywordtype">int</span> len = h-&gt;nlmsg_len;</div>
<div class="line"><span class="lineno">  423</span>            <span class="keywordtype">int</span> l = len - <span class="keyword">sizeof</span>(*h);</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>            <span class="keywordflow">if</span> (l &lt; 0 || len &gt; status) {</div>
<div class="line"><span class="lineno">  426</span>                <span class="keywordflow">if</span> (msg.msg_flags &amp; MSG_TRUNC) {</div>
<div class="line"><span class="lineno">  427</span>                    <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Truncated message\n&quot;</span>);</div>
<div class="line"><span class="lineno">  428</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  429</span>                }</div>
<div class="line"><span class="lineno">  430</span>                <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(</div>
<div class="line"><span class="lineno">  431</span>                    <span class="stringliteral">&quot;!!!malformed message: len=%d\n&quot;</span>, len);</div>
<div class="line"><span class="lineno">  432</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  433</span>            }</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>            <a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a> = handler(&amp;nladdr, h, jarg);</div>
<div class="line"><span class="lineno">  436</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a> &lt; 0) {</div>
<div class="line"><span class="lineno">  437</span>                <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Handler returned %d\n&quot;</span>, <a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a>);</div>
<div class="line"><span class="lineno">  438</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  439</span>            }</div>
<div class="line"><span class="lineno">  440</span> </div>
<div class="line"><span class="lineno">  441</span>            status -= NLMSG_ALIGN(len);</div>
<div class="line"><span class="lineno">  442</span>            h = (<span class="keyword">struct </span>nlmsghdr *)((<span class="keywordtype">char</span> *)h + NLMSG_ALIGN(len));</div>
<div class="line"><span class="lineno">  443</span>        }</div>
<div class="line"><span class="lineno">  444</span>        <span class="keywordflow">if</span> (msg.msg_flags &amp; MSG_TRUNC) {</div>
<div class="line"><span class="lineno">  445</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Message truncated\n&quot;</span>);</div>
<div class="line"><span class="lineno">  446</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  447</span>        }</div>
<div class="line"><span class="lineno">  448</span>        <span class="keywordflow">if</span> (status) {</div>
<div class="line"><span class="lineno">  449</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;!!!Remnant of size %d\n&quot;</span>, status);</div>
<div class="line"><span class="lineno">  450</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  451</span>        }</div>
<div class="line"><span class="lineno">  452</span>    }</div>
<div class="line"><span class="lineno">  453</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../d2/d62/udevtrigger_8c_source.html#l00058">err</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, and <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00012">rtnl_handle::fd</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/db2/brmon_8c_source.html#l00170">bridge_event_handler()</a>.</p>

</div>
</div>
<a id="af6a834b458ad515cfe591cd720b5a3fd" name="af6a834b458ad515cfe591cd720b5a3fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6a834b458ad515cfe591cd720b5a3fd">&#9670;&#160;</a></span>rtnl_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_open </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="#d2/dee/structrtnl__handle">rtnl_handle</a> *</td>          <td class="paramname"><span class="paramname"><em>rth</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned</td>          <td class="paramname"><span class="paramname"><em>subscriptions</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00103">103</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  104</span>{</div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../d4/dab/libnetlink_8c.html#adcef0338bcf67064f61e984ea6542a4f">rtnl_open_byproto</a>(<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>, subscriptions, NETLINK_ROUTE);</div>
<div class="line"><span class="lineno">  106</span>}</div>
<div class="ttc" id="alibnetlink_8c_html_adcef0338bcf67064f61e984ea6542a4f"><div class="ttname"><a href="../../d4/dab/libnetlink_8c.html#adcef0338bcf67064f61e984ea6542a4f">rtnl_open_byproto</a></div><div class="ttdeci">int rtnl_open_byproto(struct rtnl_handle *rth, unsigned subscriptions, int protocol)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dab/libnetlink_8c_source.html#l00045">libnetlink.c:45</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/db2/brmon_8c_source.html#l00057">rth</a>, and <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00045">rtnl_open_byproto()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/db2/brmon_8c_source.html#l00187">init_bridge_ops()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/da4/libnetlink_8h_af6a834b458ad515cfe591cd720b5a3fd_cgraph.png" border="0" usemap="#ad5/da4/libnetlink_8h_af6a834b458ad515cfe591cd720b5a3fd_cgraph" alt=""/></div>
<map name="ad5/da4/libnetlink_8h_af6a834b458ad515cfe591cd720b5a3fd_cgraph" id="ad5/da4/libnetlink_8h_af6a834b458ad515cfe591cd720b5a3fd_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,114,39"/>
<area shape="rect" href="../../d4/dab/libnetlink_8c.html#adcef0338bcf67064f61e984ea6542a4f" title=" " alt="" coords="162,5,350,39"/>
<area shape="poly" title=" " alt="" coords="114,20,146,20,146,25,114,25"/>
</map>
</div>

</div>
</div>
<a id="adcef0338bcf67064f61e984ea6542a4f" name="adcef0338bcf67064f61e984ea6542a4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcef0338bcf67064f61e984ea6542a4f">&#9670;&#160;</a></span>rtnl_open_byproto()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_open_byproto </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="#d2/dee/structrtnl__handle">rtnl_handle</a> *</td>          <td class="paramname"><span class="paramname"><em>rth</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned</td>          <td class="paramname"><span class="paramname"><em>subscriptions</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>protocol</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00045">45</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   47</span>{</div>
<div class="line"><span class="lineno">   48</span>    socklen_t addr_len;</div>
<div class="line"><span class="lineno">   49</span>    <span class="keywordtype">int</span> sndbuf = <a class="code hl_define" href="../../d4/dab/libnetlink_8c.html#af5a4b9cbd0a18da4f92c83734069b7ac">RTNL_SND_BUFSIZE</a>;</div>
<div class="line"><span class="lineno">   50</span>    <span class="keywordtype">int</span> rcvbuf = <a class="code hl_define" href="../../d4/dab/libnetlink_8c.html#a5ba7d254c8ee5e0273fa553bea4db77f">RTNL_RCV_BUFSIZE</a>;</div>
<div class="line"><span class="lineno">   51</span>    <span class="keywordtype">int</span> yes = 1;</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span>    memset(<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>, 0, <span class="keyword">sizeof</span>(*<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>));</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>    <a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a58397dc05569f5250b2bde1e40d2ddd2">fd</a> = socket(AF_NETLINK, SOCK_RAW, protocol);</div>
<div class="line"><span class="lineno">   56</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a58397dc05569f5250b2bde1e40d2ddd2">fd</a> &lt; 0) {</div>
<div class="line"><span class="lineno">   57</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Cannot open netlink socket&quot;</span>);</div>
<div class="line"><span class="lineno">   58</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">   59</span>    }</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>    <span class="keywordflow">if</span> (setsockopt(<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, SOL_SOCKET, SO_SNDBUF, &amp;sndbuf, <span class="keyword">sizeof</span>(sndbuf))</div>
<div class="line"><span class="lineno">   62</span>        &lt; 0) {</div>
<div class="line"><span class="lineno">   63</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;SO_SNDBUF&quot;</span>);</div>
<div class="line"><span class="lineno">   64</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">   65</span>    }</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>    <span class="keywordflow">if</span> (setsockopt(<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, SOL_SOCKET, SO_RCVBUF, &amp;rcvbuf, <span class="keyword">sizeof</span>(rcvbuf))</div>
<div class="line"><span class="lineno">   68</span>        &lt; 0) {</div>
<div class="line"><span class="lineno">   69</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;SO_RCVBUF&quot;</span>);</div>
<div class="line"><span class="lineno">   70</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">   71</span>    }</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>    <span class="keywordflow">if</span> (setsockopt(<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, SOL_NETLINK, NETLINK_NO_ENOBUFS, &amp;yes, <span class="keyword">sizeof</span>(yes)) &lt; 0)</div>
<div class="line"><span class="lineno">   74</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;NETLINK_NO_EBUFS&quot;</span>);</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>    memset(&amp;<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a81dab3b60ac522e1b1809c4992288683">local</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a81dab3b60ac522e1b1809c4992288683">local</a>));</div>
<div class="line"><span class="lineno">   77</span>    <a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a81dab3b60ac522e1b1809c4992288683">local</a>.nl_family = AF_NETLINK;</div>
<div class="line"><span class="lineno">   78</span>    <a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a81dab3b60ac522e1b1809c4992288683">local</a>.nl_groups = subscriptions;</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>    <span class="keywordflow">if</span> (bind(<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, (<span class="keyword">struct</span> sockaddr *)&amp;<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a81dab3b60ac522e1b1809c4992288683">local</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a81dab3b60ac522e1b1809c4992288683">local</a>)) &lt;</div>
<div class="line"><span class="lineno">   81</span>        0) {</div>
<div class="line"><span class="lineno">   82</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Cannot bind netlink socket&quot;</span>);</div>
<div class="line"><span class="lineno">   83</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">   84</span>    }</div>
<div class="line"><span class="lineno">   85</span>    addr_len = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a81dab3b60ac522e1b1809c4992288683">local</a>);</div>
<div class="line"><span class="lineno">   86</span>    <span class="keywordflow">if</span> (getsockname(<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, (<span class="keyword">struct</span> sockaddr *)&amp;<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a81dab3b60ac522e1b1809c4992288683">local</a>, &amp;addr_len) &lt; 0) {</div>
<div class="line"><span class="lineno">   87</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Cannot getsockname&quot;</span>);</div>
<div class="line"><span class="lineno">   88</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">   89</span>    }</div>
<div class="line"><span class="lineno">   90</span>    <span class="keywordflow">if</span> (addr_len != <span class="keyword">sizeof</span>(<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a81dab3b60ac522e1b1809c4992288683">local</a>)) {</div>
<div class="line"><span class="lineno">   91</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Wrong address length %d\n&quot;</span>, addr_len);</div>
<div class="line"><span class="lineno">   92</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">   93</span>    }</div>
<div class="line"><span class="lineno">   94</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a81dab3b60ac522e1b1809c4992288683">local</a>.nl_family != AF_NETLINK) {</div>
<div class="line"><span class="lineno">   95</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Wrong address family %d\n&quot;</span>,</div>
<div class="line"><span class="lineno">   96</span>            <a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a81dab3b60ac522e1b1809c4992288683">local</a>.nl_family);</div>
<div class="line"><span class="lineno">   97</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">   98</span>    }</div>
<div class="line"><span class="lineno">   99</span>    <a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a3b423eb6125d051d774c8d8303b08cf9">seq</a> = time(NULL);</div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  101</span>}</div>
<div class="ttc" id="alibnetlink_8c_html_a5ba7d254c8ee5e0273fa553bea4db77f"><div class="ttname"><a href="../../d4/dab/libnetlink_8c.html#a5ba7d254c8ee5e0273fa553bea4db77f">RTNL_RCV_BUFSIZE</a></div><div class="ttdeci">#define RTNL_RCV_BUFSIZE</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dab/libnetlink_8c_source.html#l00037">libnetlink.c:37</a></div></div>
<div class="ttc" id="alibnetlink_8c_html_af5a4b9cbd0a18da4f92c83734069b7ac"><div class="ttname"><a href="../../d4/dab/libnetlink_8c.html#af5a4b9cbd0a18da4f92c83734069b7ac">RTNL_SND_BUFSIZE</a></div><div class="ttdeci">#define RTNL_SND_BUFSIZE</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dab/libnetlink_8c_source.html#l00034">libnetlink.c:34</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00012">rtnl_handle::fd</a>, <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00013">rtnl_handle::local</a>, <a class="el" href="../../d1/db2/brmon_8c_source.html#l00057">rth</a>, <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00037">RTNL_RCV_BUFSIZE</a>, <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00034">RTNL_SND_BUFSIZE</a>, and <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00015">rtnl_handle::seq</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00103">rtnl_open()</a>.</p>

</div>
</div>
<a id="a15300d60c5f8921ca1fb0b807404f18f" name="a15300d60c5f8921ca1fb0b807404f18f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15300d60c5f8921ca1fb0b807404f18f">&#9670;&#160;</a></span>rtnl_send()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="#d2/dee/structrtnl__handle">rtnl_handle</a> *</td>          <td class="paramname"><span class="paramname"><em>rth</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00131">131</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  132</span>{</div>
<div class="line"><span class="lineno">  133</span>    <span class="keyword">struct </span>sockaddr_nl nladdr;</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>    memset(&amp;nladdr, 0, <span class="keyword">sizeof</span>(nladdr));</div>
<div class="line"><span class="lineno">  136</span>    nladdr.nl_family = AF_NETLINK;</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>    <span class="keywordflow">return</span> sendto(<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, len, 0, (<span class="keyword">struct</span> sockaddr *)&amp;nladdr,</div>
<div class="line"><span class="lineno">  139</span>              <span class="keyword">sizeof</span>(nladdr));</div>
<div class="line"><span class="lineno">  140</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00012">rtnl_handle::fd</a>, and <a class="el" href="../../d1/db2/brmon_8c_source.html#l00057">rth</a>.</p>

</div>
</div>
<a id="a1e674ac9211ad8a2bd6200b04860b203" name="a1e674ac9211ad8a2bd6200b04860b203"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e674ac9211ad8a2bd6200b04860b203">&#9670;&#160;</a></span>rtnl_talk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_talk </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="#d2/dee/structrtnl__handle">rtnl_handle</a> *</td>          <td class="paramname"><span class="paramname"><em>rtnl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct nlmsghdr *</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pid_t</td>          <td class="paramname"><span class="paramname"><em>peer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned</td>          <td class="paramname"><span class="paramname"><em>groups</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct nlmsghdr *</td>          <td class="paramname"><span class="paramname"><em>answer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#abd296aab2acd141c9136440967baddbd">rtnl_filter_t</a></td>          <td class="paramname"><span class="paramname"><em>junk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>jarg</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00251">251</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  254</span>{</div>
<div class="line"><span class="lineno">  255</span>    <span class="keywordtype">int</span> status;</div>
<div class="line"><span class="lineno">  256</span>    <span class="keywordtype">unsigned</span> seq;</div>
<div class="line"><span class="lineno">  257</span>    <span class="keyword">struct </span>nlmsghdr *h;</div>
<div class="line"><span class="lineno">  258</span>    <span class="keyword">struct </span>sockaddr_nl nladdr;</div>
<div class="line"><span class="lineno">  259</span>    <span class="keyword">struct </span>iovec iov = {</div>
<div class="line"><span class="lineno">  260</span>        .iov_base = (<span class="keywordtype">void</span> *)n,</div>
<div class="line"><span class="lineno">  261</span>        .iov_len = n-&gt;nlmsg_len</div>
<div class="line"><span class="lineno">  262</span>    };</div>
<div class="line"><span class="lineno">  263</span>    <span class="keyword">struct </span>msghdr msg = {</div>
<div class="line"><span class="lineno">  264</span>        .msg_name = &amp;nladdr,</div>
<div class="line"><span class="lineno">  265</span>        .msg_namelen = <span class="keyword">sizeof</span>(nladdr),</div>
<div class="line"><span class="lineno">  266</span>        .msg_iov = &amp;iov,</div>
<div class="line"><span class="lineno">  267</span>        .msg_iovlen = 1,</div>
<div class="line"><span class="lineno">  268</span>    };</div>
<div class="line"><span class="lineno">  269</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>[16384];</div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>    memset(&amp;nladdr, 0, <span class="keyword">sizeof</span>(nladdr));</div>
<div class="line"><span class="lineno">  272</span>    nladdr.nl_family = AF_NETLINK;</div>
<div class="line"><span class="lineno">  273</span>    nladdr.nl_pid = peer;</div>
<div class="line"><span class="lineno">  274</span>    nladdr.nl_groups = groups;</div>
<div class="line"><span class="lineno">  275</span> </div>
<div class="line"><span class="lineno">  276</span>    n-&gt;nlmsg_seq = seq = ++rtnl-&gt;<a class="code hl_variable" href="#a3b423eb6125d051d774c8d8303b08cf9">seq</a>;</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span>    <span class="keywordflow">if</span> (answer == NULL)</div>
<div class="line"><span class="lineno">  279</span>        n-&gt;nlmsg_flags |= NLM_F_ACK;</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>    status = sendmsg(rtnl-&gt;<a class="code hl_variable" href="#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, &amp;msg, 0);</div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>    <span class="keywordflow">if</span> (status &lt; 0) {</div>
<div class="line"><span class="lineno">  284</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Cannot talk to rtnetlink&quot;</span>);</div>
<div class="line"><span class="lineno">  285</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  286</span>    }</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    memset(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>));</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>    iov.iov_base = <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>;</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>    <span class="keywordflow">while</span> (1) {</div>
<div class="line"><span class="lineno">  293</span>        iov.iov_len = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>);</div>
<div class="line"><span class="lineno">  294</span>        status = recvmsg(rtnl-&gt;<a class="code hl_variable" href="#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, &amp;msg, 0);</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>        <span class="keywordflow">if</span> (status &lt; 0) {</div>
<div class="line"><span class="lineno">  297</span>            <span class="keywordflow">if</span> (errno == EINTR)</div>
<div class="line"><span class="lineno">  298</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  299</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;OVERRUN&quot;</span>);</div>
<div class="line"><span class="lineno">  300</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  301</span>        }</div>
<div class="line"><span class="lineno">  302</span>        <span class="keywordflow">if</span> (status == 0) {</div>
<div class="line"><span class="lineno">  303</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;EOF on netlink\n&quot;</span>);</div>
<div class="line"><span class="lineno">  304</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  305</span>        }</div>
<div class="line"><span class="lineno">  306</span>        <span class="keywordflow">if</span> (msg.msg_namelen != <span class="keyword">sizeof</span>(nladdr)) {</div>
<div class="line"><span class="lineno">  307</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;sender address length == %d\n&quot;</span>,</div>
<div class="line"><span class="lineno">  308</span>                msg.msg_namelen);</div>
<div class="line"><span class="lineno">  309</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  310</span>        }</div>
<div class="line"><span class="lineno">  311</span>        <span class="keywordflow">for</span> (h = (<span class="keyword">struct</span> nlmsghdr *)<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>; status &gt;= <span class="keyword">sizeof</span>(*h);) {</div>
<div class="line"><span class="lineno">  312</span>            <span class="keywordtype">int</span> <a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a>;</div>
<div class="line"><span class="lineno">  313</span>            <span class="keywordtype">int</span> len = h-&gt;nlmsg_len;</div>
<div class="line"><span class="lineno">  314</span>            <span class="keywordtype">int</span> l = len - <span class="keyword">sizeof</span>(*h);</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>            <span class="keywordflow">if</span> (l &lt; 0 || len &gt; status) {</div>
<div class="line"><span class="lineno">  317</span>                <span class="keywordflow">if</span> (msg.msg_flags &amp; MSG_TRUNC) {</div>
<div class="line"><span class="lineno">  318</span>                    <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Truncated message\n&quot;</span>);</div>
<div class="line"><span class="lineno">  319</span>                    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  320</span>                }</div>
<div class="line"><span class="lineno">  321</span>                <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(</div>
<div class="line"><span class="lineno">  322</span>                    <span class="stringliteral">&quot;!!!malformed message: len=%d\n&quot;</span>, len);</div>
<div class="line"><span class="lineno">  323</span>                <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  324</span>            }</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>            <span class="keywordflow">if</span> (nladdr.nl_pid != peer ||</div>
<div class="line"><span class="lineno">  327</span>                h-&gt;nlmsg_pid != rtnl-&gt;<a class="code hl_variable" href="#a81dab3b60ac522e1b1809c4992288683">local</a>.nl_pid ||</div>
<div class="line"><span class="lineno">  328</span>                h-&gt;nlmsg_seq != seq) {</div>
<div class="line"><span class="lineno">  329</span>                <span class="keywordflow">if</span> (junk) {</div>
<div class="line"><span class="lineno">  330</span>                    <a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a> = junk(&amp;nladdr, h, jarg);</div>
<div class="line"><span class="lineno">  331</span>                    <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a> &lt; 0)</div>
<div class="line"><span class="lineno">  332</span>                        <span class="keywordflow">return</span> <a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a>;</div>
<div class="line"><span class="lineno">  333</span>                }</div>
<div class="line"><span class="lineno">  334</span>                <span class="comment">/* Don&#39;t forget to skip that message. */</span></div>
<div class="line"><span class="lineno">  335</span>                status -= NLMSG_ALIGN(len);</div>
<div class="line"><span class="lineno">  336</span>                h = (<span class="keyword">struct </span>nlmsghdr *)((<span class="keywordtype">char</span> *)h +</div>
<div class="line"><span class="lineno">  337</span>                            NLMSG_ALIGN(len));</div>
<div class="line"><span class="lineno">  338</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  339</span>            }</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>            <span class="keywordflow">if</span> (h-&gt;nlmsg_type == NLMSG_ERROR) {</div>
<div class="line"><span class="lineno">  342</span>                <span class="keyword">struct </span>nlmsgerr *<a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a> =</div>
<div class="line"><span class="lineno">  343</span>                    (<span class="keyword">struct </span>nlmsgerr *)NLMSG_DATA(h);</div>
<div class="line"><span class="lineno">  344</span>                <span class="keywordflow">if</span> (l &lt; <span class="keyword">sizeof</span>(<span class="keyword">struct</span> nlmsgerr)) {</div>
<div class="line"><span class="lineno">  345</span>                    <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;ERROR truncated\n&quot;</span>);</div>
<div class="line"><span class="lineno">  346</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  347</span>                    errno = -<a class="code hl_define" href="../../d2/d62/udevtrigger_8c.html#abdc0ddb6c825c951cdc8e45b53459445">err</a>-&gt;error;</div>
<div class="line"><span class="lineno">  348</span>                    <span class="keywordflow">if</span> (errno == 0) {</div>
<div class="line"><span class="lineno">  349</span>                        <span class="keywordflow">if</span> (answer)</div>
<div class="line"><span class="lineno">  350</span>                            memcpy(answer, h,</div>
<div class="line"><span class="lineno">  351</span>                                   h-&gt;nlmsg_len);</div>
<div class="line"><span class="lineno">  352</span>                        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  353</span>                    }</div>
<div class="line"><span class="lineno">  354</span>                    <a class="code hl_define" href="../../d9/d1e/procd_2log_8h.html#a159ca84d25a5487d8e81e4438725df19">LOG</a>(<span class="stringliteral">&quot;RTNETLINK answers&quot;</span>);</div>
<div class="line"><span class="lineno">  355</span>                }</div>
<div class="line"><span class="lineno">  356</span>                <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  357</span>            }</div>
<div class="line"><span class="lineno">  358</span>            <span class="keywordflow">if</span> (answer) {</div>
<div class="line"><span class="lineno">  359</span>                memcpy(answer, h, h-&gt;nlmsg_len);</div>
<div class="line"><span class="lineno">  360</span>                <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  361</span>            }</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Unexpected reply!!!\n&quot;</span>);</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>            status -= NLMSG_ALIGN(len);</div>
<div class="line"><span class="lineno">  366</span>            h = (<span class="keyword">struct </span>nlmsghdr *)((<span class="keywordtype">char</span> *)h + NLMSG_ALIGN(len));</div>
<div class="line"><span class="lineno">  367</span>        }</div>
<div class="line"><span class="lineno">  368</span>        <span class="keywordflow">if</span> (msg.msg_flags &amp; MSG_TRUNC) {</div>
<div class="line"><span class="lineno">  369</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Message truncated\n&quot;</span>);</div>
<div class="line"><span class="lineno">  370</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  371</span>        }</div>
<div class="line"><span class="lineno">  372</span>        <span class="keywordflow">if</span> (status) {</div>
<div class="line"><span class="lineno">  373</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;!!!Remnant of size %d\n&quot;</span>, status);</div>
<div class="line"><span class="lineno">  374</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  375</span>        }</div>
<div class="line"><span class="lineno">  376</span>    }</div>
<div class="line"><span class="lineno">  377</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../d2/d62/udevtrigger_8c_source.html#l00058">err</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00012">rtnl_handle::fd</a>, <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00013">rtnl_handle::local</a>, <a class="el" href="../../d9/d1e/procd_2log_8h_source.html#l00032">LOG</a>, and <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00015">rtnl_handle::seq</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d10/bridge__track_8c_source.html#l00428">br_set_state()</a>.</p>

</div>
</div>
<a id="a5d89c9b26f1bf5a091e6296298df671e" name="a5d89c9b26f1bf5a091e6296298df671e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d89c9b26f1bf5a091e6296298df671e">&#9670;&#160;</a></span>rtnl_wilddump_request()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_wilddump_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="#d2/dee/structrtnl__handle">rtnl_handle</a> *</td>          <td class="paramname"><span class="paramname"><em>rth</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>fam</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/dab/libnetlink_8c_source.html#l00108">108</a> of file <a class="el" href="../../d4/dab/libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  109</span>{</div>
<div class="line"><span class="lineno">  110</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno">  111</span>        <span class="keyword">struct </span>nlmsghdr nlh;</div>
<div class="line"><span class="lineno">  112</span>        <span class="keyword">struct </span>rtgenmsg g;</div>
<div class="line"><span class="lineno">  113</span>    } req;</div>
<div class="line"><span class="lineno">  114</span>    <span class="keyword">struct </span>sockaddr_nl nladdr;</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>    memset(&amp;nladdr, 0, <span class="keyword">sizeof</span>(nladdr));</div>
<div class="line"><span class="lineno">  117</span>    nladdr.nl_family = AF_NETLINK;</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>    memset(&amp;req, 0, <span class="keyword">sizeof</span>(req));</div>
<div class="line"><span class="lineno">  120</span>    req.nlh.nlmsg_len = <span class="keyword">sizeof</span>(req);</div>
<div class="line"><span class="lineno">  121</span>    req.nlh.nlmsg_type = <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;</div>
<div class="line"><span class="lineno">  122</span>    req.nlh.nlmsg_flags = NLM_F_ROOT | NLM_F_MATCH | NLM_F_REQUEST;</div>
<div class="line"><span class="lineno">  123</span>    req.nlh.nlmsg_pid = 0;</div>
<div class="line"><span class="lineno">  124</span>    req.nlh.nlmsg_seq = <a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a3e5b07ef999b7a331f91ae5065886871">dump</a> = ++<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a3b423eb6125d051d774c8d8303b08cf9">seq</a>;</div>
<div class="line"><span class="lineno">  125</span>    req.g.rtgen_family = family;</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>    <span class="keywordflow">return</span> sendto(<a class="code hl_variable" href="../../d1/db2/brmon_8c.html#a052e2f2ddaba32f35e414adab16b5fb4">rth</a>-&gt;<a class="code hl_variable" href="#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, (<span class="keywordtype">void</span> *)&amp;req, <span class="keyword">sizeof</span>(req), 0,</div>
<div class="line"><span class="lineno">  128</span>              (<span class="keyword">struct</span> sockaddr *)&amp;nladdr, <span class="keyword">sizeof</span>(nladdr));</div>
<div class="line"><span class="lineno">  129</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00016">rtnl_handle::dump</a>, <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00012">rtnl_handle::fd</a>, <a class="el" href="../../d1/db2/brmon_8c_source.html#l00057">rth</a>, <a class="el" href="../../d5/da4/libnetlink_8h_source.html#l00015">rtnl_handle::seq</a>, and <a class="el" href="../../dd/d8f/udebug-proto_8h_source.html#l00000">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/db2/brmon_8c_source.html#l00187">init_bridge_ops()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
