<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>zbus: /home/g41797/CLionProjects/github.com/g41797/zbus/src/libs/procd/jail/jail.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">zbus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_87a455bccb09a92130c26a11a880c98a.html">libs</a></li><li class="navelem"><a class="el" href="../../dir_63350b749fcf74007a53c7c917c10773.html">procd</a></li><li class="navelem"><a class="el" href="../../dir_332eccd3a674db599d080e188d7046bc.html">jail</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">jail.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;sys/mount.h&gt;</code><br />
<code>#include &lt;sys/prctl.h&gt;</code><br />
<code>#include &lt;sys/wait.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;sys/time.h&gt;</code><br />
<code>#include &lt;sys/resource.h&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;sys/sysmacros.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;pwd.h&gt;</code><br />
<code>#include &lt;grp.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;sched.h&gt;</code><br />
<code>#include &lt;linux/filter.h&gt;</code><br />
<code>#include &lt;linux/limits.h&gt;</code><br />
<code>#include &lt;linux/nsfs.h&gt;</code><br />
<code>#include &lt;linux/securebits.h&gt;</code><br />
<code>#include &lt;signal.h&gt;</code><br />
<code>#include &lt;inttypes.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d8/d14/capabilities_8h_source.html">capabilities.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d1/d9e/elf_8h_source.html">elf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../df/d26/fs_8h_source.html">fs.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/d88/jail_8h_source.html">jail.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html">log.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/dbb/seccomp-oci_8h_source.html">seccomp-oci.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/d82/cgroups_8h_source.html">cgroups.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../df/d26/procd_2jail_2netifd_8h_source.html">netifd.h</a>&quot;</code><br />
<code>#include &lt;<a class="el" href="../../dd/dad/blobmsg_8h_source.html">libubox/blobmsg.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d5/dea/blobmsg__json_8h_source.html">libubox/blobmsg_json.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../da/d23/list_8h_source.html">libubox/list.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../dd/d1d/vlist_8h_source.html">libubox/vlist.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../dc/d56/uloop_8h_source.html">libubox/uloop.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d5/d1d/libubox_2utils_8h_source.html">libubox/utils.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../db/d55/libubus_8h_source.html">libubus.h</a>&gt;</code><br />
</div>
<p><a href="../../dd/d26/jail_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:da/d60/structhook__execvpe" id="r_da/d60/structhook__execvpe"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#da/d60/structhook__execvpe">hook_execvpe</a></td></tr>
<tr class="separator:da/d60/structhook__execvpe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:de/d02/structsysctl__val" id="r_de/d02/structsysctl__val"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#de/d02/structsysctl__val">sysctl_val</a></td></tr>
<tr class="separator:de/d02/structsysctl__val"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d5/db5/structmknod__args" id="r_d5/db5/structmknod__args"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#d5/db5/structmknod__args">mknod_args</a></td></tr>
<tr class="separator:d5/db5/structmknod__args"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d3/d32/structenv__e" id="r_d3/d32/structenv__e"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#d3/d32/structenv__e">env_e</a></td></tr>
<tr class="separator:d3/d32/structenv__e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d0/dfd/struct_8setns" id="r_d0/dfd/struct_8setns"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#d0/dfd/struct_8setns">.setns</a></td></tr>
<tr class="separator:d0/dfd/struct_8setns"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d9/df6/struct_8hooks" id="r_d9/df6/struct_8hooks"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#d9/df6/struct_8hooks">.hooks</a></td></tr>
<tr class="separator:d9/df6/struct_8hooks"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a369266c24eacffb87046522897a570d5" id="r_a369266c24eacffb87046522897a570d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a369266c24eacffb87046522897a570d5">_GNU_SOURCE</a></td></tr>
<tr class="separator:a369266c24eacffb87046522897a570d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d5d88148a26086567c3731e2e5e110a" id="r_a9d5d88148a26086567c3731e2e5e110a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9d5d88148a26086567c3731e2e5e110a">CLONE_NEWCGROUP</a>&#160;&#160;&#160;0x02000000</td></tr>
<tr class="separator:a9d5d88148a26086567c3731e2e5e110a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6423a880df59733d2d9b509c7718d3a9" id="r_a6423a880df59733d2d9b509c7718d3a9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6423a880df59733d2d9b509c7718d3a9">STACK_SIZE</a>&#160;&#160;&#160;(1024 * 1024)</td></tr>
<tr class="separator:a6423a880df59733d2d9b509c7718d3a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f7f8ba02a5383b3b7f9dd28f8c5e8b8" id="r_a5f7f8ba02a5383b3b7f9dd28f8c5e8b8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5f7f8ba02a5383b3b7f9dd28f8c5e8b8">OPT_ARGS</a>&#160;&#160;&#160;&quot;cC:d:e:EfFG:h:ij:J:ln:NoO:pP:r:R:sS:uU:w:t:T:y&quot;</td></tr>
<tr class="separator:a5f7f8ba02a5383b3b7f9dd28f8c5e8b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ee05432b602a194c5a7cfb5043a5824" id="r_a1ee05432b602a194c5a7cfb5043a5824"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1ee05432b602a194c5a7cfb5043a5824">OCI_VERSION_STRING</a>&#160;&#160;&#160;&quot;1.0.2&quot;</td></tr>
<tr class="separator:a1ee05432b602a194c5a7cfb5043a5824"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa031dc6712613a6c64f5d8b26eb1baae" id="r_aa031dc6712613a6c64f5d8b26eb1baae"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa031dc6712613a6c64f5d8b26eb1baae">makedev</a>(x,  y)</td></tr>
<tr class="separator:aa031dc6712613a6c64f5d8b26eb1baae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99f47b784bea630430c5e178a336daa4" id="r_a99f47b784bea630430c5e178a336daa4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a99f47b784bea630430c5e178a336daa4">MAX_ENVP</a>&#160;&#160;&#160;64</td></tr>
<tr class="separator:a99f47b784bea630430c5e178a336daa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a32654766df20ade7d77949ecf91a601e" id="r_a32654766df20ade7d77949ecf91a601e"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a32654766df20ade7d77949ecf91a601e">hook_return_handler</a>) (void)</td></tr>
<tr class="separator:a32654766df20ade7d77949ecf91a601e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:afeaa6456e370d2eb59f5e139d9f8b00c" id="r_afeaa6456e370d2eb59f5e139d9f8b00c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="#afeaa6456e370d2eb59f5e139d9f8b00ca19d90db86bae071a8aa290b4aa7bbb1a">OCI_ROOT_PATH</a>
, <a class="el" href="#afeaa6456e370d2eb59f5e139d9f8b00ca5de1f8b436ee1fcb78d7aa9a8e2c5990">OCI_ROOT_READONLY</a>
, <a class="el" href="#afeaa6456e370d2eb59f5e139d9f8b00ca1736cc68a5a38e1186ffbffd828bb798">__OCI_ROOT_MAX</a>
 }</td></tr>
<tr class="separator:afeaa6456e370d2eb59f5e139d9f8b00c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26c0312ac66c00f31cf886616c48afa2" id="r_a26c0312ac66c00f31cf886616c48afa2"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="#a26c0312ac66c00f31cf886616c48afa2ab8282160b544f18b6b51d625957979a5">OCI_HOOK_PATH</a>
, <a class="el" href="#a26c0312ac66c00f31cf886616c48afa2a95599181fee35581a14f13681c2cf66b">OCI_HOOK_ARGS</a>
, <a class="el" href="#a26c0312ac66c00f31cf886616c48afa2a36845abacde1267489e7ef578cee4460">OCI_HOOK_ENV</a>
, <a class="el" href="#a26c0312ac66c00f31cf886616c48afa2abb5b45a58a6262ff75e12bd0fe9d888d">OCI_HOOK_TIMEOUT</a>
, <br />
&#160;&#160;<a class="el" href="#a26c0312ac66c00f31cf886616c48afa2a54921720b398badc128a50954e58f14b">__OCI_HOOK_MAX</a>
<br />
 }</td></tr>
<tr class="separator:a26c0312ac66c00f31cf886616c48afa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecd12a18eeb0ee701fc7b0efd5068266" id="r_aecd12a18eeb0ee701fc7b0efd5068266"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="#aecd12a18eeb0ee701fc7b0efd5068266af862a8090db6d0f4c881c11e44f62f5c">OCI_HOOKS_PRESTART</a>
, <a class="el" href="#aecd12a18eeb0ee701fc7b0efd5068266a7cbf2aaa3aff3ed3c5619f1586102654">OCI_HOOKS_CREATERUNTIME</a>
, <a class="el" href="#aecd12a18eeb0ee701fc7b0efd5068266a81b8b437bed6d97716be572758d636f7">OCI_HOOKS_CREATECONTAINER</a>
, <a class="el" href="#aecd12a18eeb0ee701fc7b0efd5068266a19b67b62f1e805e385a650b7a667ab2f">OCI_HOOKS_STARTCONTAINER</a>
, <br />
&#160;&#160;<a class="el" href="#aecd12a18eeb0ee701fc7b0efd5068266a81b23e202b544376a4150805e7032081">OCI_HOOKS_POSTSTART</a>
, <a class="el" href="#aecd12a18eeb0ee701fc7b0efd5068266a038ea885ca857034d8682acb2ef0aa74">OCI_HOOKS_POSTSTOP</a>
, <a class="el" href="#aecd12a18eeb0ee701fc7b0efd5068266a0bdad5a576873f1be7eab59337d40892">__OCI_HOOKS_MAX</a>
<br />
 }</td></tr>
<tr class="separator:aecd12a18eeb0ee701fc7b0efd5068266"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8420dba71b9cc240cf981b0bef892004" id="r_a8420dba71b9cc240cf981b0bef892004"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="#a8420dba71b9cc240cf981b0bef892004a727b3caff3f4f9c0226fde9a4add449b">OCI_PROCESS_USER_UID</a>
, <a class="el" href="#a8420dba71b9cc240cf981b0bef892004aaa9867bd15bf6df72a6afbbca29bb0ea">OCI_PROCESS_USER_GID</a>
, <a class="el" href="#a8420dba71b9cc240cf981b0bef892004abebde02748010be1f45e9986546d7d0c">OCI_PROCESS_USER_UMASK</a>
, <a class="el" href="#a8420dba71b9cc240cf981b0bef892004a65c968275ec1a7c4233995f829810b73">OCI_PROCESS_USER_ADDITIONALGIDS</a>
, <br />
&#160;&#160;<a class="el" href="#a8420dba71b9cc240cf981b0bef892004a9b36524395a911eb0d37dfbf132f5f10">__OCI_PROCESS_USER_MAX</a>
<br />
 }</td></tr>
<tr class="separator:a8420dba71b9cc240cf981b0bef892004"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb24d298ddd4bc4ff61aa333f07a574a" id="r_afb24d298ddd4bc4ff61aa333f07a574a"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="#afb24d298ddd4bc4ff61aa333f07a574aa82cefaa500e6667fae114a7a427a70e8">OCI_PROCESS_RLIMIT_TYPE</a>
, <a class="el" href="#afb24d298ddd4bc4ff61aa333f07a574aa54aef840a8921bd694bd098d26909f5b">OCI_PROCESS_RLIMIT_SOFT</a>
, <a class="el" href="#afb24d298ddd4bc4ff61aa333f07a574aa7c4a1dc8832ab814f8153330af5c53c0">OCI_PROCESS_RLIMIT_HARD</a>
, <a class="el" href="#afb24d298ddd4bc4ff61aa333f07a574aa14fdf8fb6dafa566ba443a7c41296bab">__OCI_PROCESS_RLIMIT_MAX</a>
 }</td></tr>
<tr class="separator:afb24d298ddd4bc4ff61aa333f07a574a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39b4e25c4e8f5fed29720be17a532fa8" id="r_a39b4e25c4e8f5fed29720be17a532fa8"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="#a39b4e25c4e8f5fed29720be17a532fa8a9d41d59732df8b5db30de6d8b498664c">OCI_PROCESS_ARGS</a>
, <a class="el" href="#a39b4e25c4e8f5fed29720be17a532fa8a71f60125a3d09ac0376911a3e0b0a6a4">OCI_PROCESS_CAPABILITIES</a>
, <a class="el" href="#a39b4e25c4e8f5fed29720be17a532fa8a841ee5b5a8bc29fc281504adf23332a5">OCI_PROCESS_CWD</a>
, <a class="el" href="#a39b4e25c4e8f5fed29720be17a532fa8a1be2ada84df5442b9f201c6dc52b3068">OCI_PROCESS_ENV</a>
, <br />
&#160;&#160;<a class="el" href="#a39b4e25c4e8f5fed29720be17a532fa8ac9d842b5fe7888be2ebaa9505332f6df">OCI_PROCESS_OOMSCOREADJ</a>
, <a class="el" href="#a39b4e25c4e8f5fed29720be17a532fa8a7c18000948947c83ebfd4fab57779357">OCI_PROCESS_NONEWPRIVILEGES</a>
, <a class="el" href="#a39b4e25c4e8f5fed29720be17a532fa8a43e16b4cc6c2d437a14b0bc14554127e">OCI_PROCESS_RLIMITS</a>
, <a class="el" href="#a39b4e25c4e8f5fed29720be17a532fa8ab48a2bacf241c851a118f8282a271e4d">OCI_PROCESS_TERMINAL</a>
, <br />
&#160;&#160;<a class="el" href="#a39b4e25c4e8f5fed29720be17a532fa8ac638d97c005c1bae4270639b35443a6b">OCI_PROCESS_USER</a>
, <a class="el" href="#a39b4e25c4e8f5fed29720be17a532fa8aa1cab4d55ca40e13a53fba6cd6925491">__OCI_PROCESS_MAX</a>
<br />
 }</td></tr>
<tr class="separator:a39b4e25c4e8f5fed29720be17a532fa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4efaf4e07364d6302f598569aa7e55dc" id="r_a4efaf4e07364d6302f598569aa7e55dc"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="#a4efaf4e07364d6302f598569aa7e55dca3c772ed4692c1a6ee8cfd749e8f288b6">OCI_LINUX_NAMESPACE_TYPE</a>
, <a class="el" href="#a4efaf4e07364d6302f598569aa7e55dca9f981c7082417182bd81726ea9348830">OCI_LINUX_NAMESPACE_PATH</a>
, <a class="el" href="#a4efaf4e07364d6302f598569aa7e55dcab6f129898be13c23b13a69ca66e29d04">__OCI_LINUX_NAMESPACE_MAX</a>
 }</td></tr>
<tr class="separator:a4efaf4e07364d6302f598569aa7e55dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34df7cc7f69a8ec535eec8a524dcbaf9" id="r_a34df7cc7f69a8ec535eec8a524dcbaf9"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a7be3c350b969aa7e666feec5231a0619">OCI_LINUX_UIDGIDMAP_CONTAINERID</a>
, <a class="el" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a9d04002b30779f94d79d2998244f6ff2">OCI_LINUX_UIDGIDMAP_HOSTID</a>
, <a class="el" href="#a34df7cc7f69a8ec535eec8a524dcbaf9af62eeb729d82816dca12d392f7c0242c">OCI_LINUX_UIDGIDMAP_SIZE</a>
, <a class="el" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a95e8d0d6c43c4f8cdf24c665d45834a1">__OCI_LINUX_UIDGIDMAP_MAX</a>
 }</td></tr>
<tr class="separator:a34df7cc7f69a8ec535eec8a524dcbaf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81929fb3d21206b62f55bcb744f71d5d" id="r_a81929fb3d21206b62f55bcb744f71d5d"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="#a81929fb3d21206b62f55bcb744f71d5da7552d79964c15ae667f2506ef74f8201">OCI_DEVICES_TYPE</a>
, <a class="el" href="#a81929fb3d21206b62f55bcb744f71d5dabaa93214e7a6d28b48d2196358fd1123">OCI_DEVICES_PATH</a>
, <a class="el" href="#a81929fb3d21206b62f55bcb744f71d5dadf9c76ed009a9d7998f869ddf0371767">OCI_DEVICES_MAJOR</a>
, <a class="el" href="#a81929fb3d21206b62f55bcb744f71d5da1841510f8919dcaed8f7e150611e6acf">OCI_DEVICES_MINOR</a>
, <br />
&#160;&#160;<a class="el" href="#a81929fb3d21206b62f55bcb744f71d5da726450a129ef116d29282fe043688c00">OCI_DEVICES_FILEMODE</a>
, <a class="el" href="#a81929fb3d21206b62f55bcb744f71d5da5b0d2d05d0ce566724d25dc7e751899d">OCI_DEVICES_UID</a>
, <a class="el" href="#a81929fb3d21206b62f55bcb744f71d5da1201076fb774af33b8c73c518dcc1dfb">OCI_DEVICES_GID</a>
, <a class="el" href="#a81929fb3d21206b62f55bcb744f71d5da147df77312a8c562a8d21b33365448ee">__OCI_DEVICES_MAX</a>
<br />
 }</td></tr>
<tr class="separator:a81929fb3d21206b62f55bcb744f71d5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ada2556f3c386db5f31969fb6d4d002" id="r_a7ada2556f3c386db5f31969fb6d4d002"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="#a7ada2556f3c386db5f31969fb6d4d002a4c337c6cf54ff1755a2cc9145bcb29ba">OCI_LINUX_CGROUPSPATH</a>
, <a class="el" href="#a7ada2556f3c386db5f31969fb6d4d002a6ed87e24d333274bcf07394e12eb0334">OCI_LINUX_RESOURCES</a>
, <a class="el" href="#a7ada2556f3c386db5f31969fb6d4d002abaa0938b58a04b3660a37c8708610f7f">OCI_LINUX_SECCOMP</a>
, <a class="el" href="#a7ada2556f3c386db5f31969fb6d4d002ad9d5c35f112531b3441718b70580ad3b">OCI_LINUX_SYSCTL</a>
, <br />
&#160;&#160;<a class="el" href="#a7ada2556f3c386db5f31969fb6d4d002a8a3a158fe5d2f0a652ef86cda72ab655">OCI_LINUX_NAMESPACES</a>
, <a class="el" href="#a7ada2556f3c386db5f31969fb6d4d002a1307500651c21f2451f25555fe3f45c9">OCI_LINUX_DEVICES</a>
, <a class="el" href="#a7ada2556f3c386db5f31969fb6d4d002a9d6ef21b01ed6532bff2ac2c28c5a075">OCI_LINUX_UIDMAPPINGS</a>
, <a class="el" href="#a7ada2556f3c386db5f31969fb6d4d002afd9a8d6225d58630adfdd9b127bd2b75">OCI_LINUX_GIDMAPPINGS</a>
, <br />
&#160;&#160;<a class="el" href="#a7ada2556f3c386db5f31969fb6d4d002af04b23cc25d65aa924674451e37742b5">OCI_LINUX_MASKEDPATHS</a>
, <a class="el" href="#a7ada2556f3c386db5f31969fb6d4d002a99685949d7e12300cde9533b69faec9d">OCI_LINUX_READONLYPATHS</a>
, <a class="el" href="#a7ada2556f3c386db5f31969fb6d4d002a609592d1ea33a112dfe8ff3e6545d6c0">OCI_LINUX_ROOTFSPROPAGATION</a>
, <a class="el" href="#a7ada2556f3c386db5f31969fb6d4d002aa8e03afa65029fb9a01906fe0a12fb79">__OCI_LINUX_MAX</a>
<br />
 }</td></tr>
<tr class="separator:a7ada2556f3c386db5f31969fb6d4d002"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25e50be5c73e0b2fab54944e68dd48c2" id="r_a25e50be5c73e0b2fab54944e68dd48c2"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="#a25e50be5c73e0b2fab54944e68dd48c2a1fe8c34674764c6ec2f2d1984072c62d">OCI_VERSION</a>
, <a class="el" href="#a25e50be5c73e0b2fab54944e68dd48c2ac4dfa375741e7a69482e70cd6895ee0b">OCI_HOSTNAME</a>
, <a class="el" href="#a25e50be5c73e0b2fab54944e68dd48c2aeefd9fc5dfb29881871de9083a277396">OCI_PROCESS</a>
, <a class="el" href="#a25e50be5c73e0b2fab54944e68dd48c2af6442ef34bfc169790d9429b2fd4e732">OCI_ROOT</a>
, <br />
&#160;&#160;<a class="el" href="#a25e50be5c73e0b2fab54944e68dd48c2a138e90c68b0f6df726b8169e93b96d08">OCI_MOUNTS</a>
, <a class="el" href="#a25e50be5c73e0b2fab54944e68dd48c2ae5b76fcf322dc75c322e5ce6db99448d">OCI_HOOKS</a>
, <a class="el" href="#a25e50be5c73e0b2fab54944e68dd48c2a7dbca8874590bfff6d39937b3fa80dce">OCI_LINUX</a>
, <a class="el" href="#a25e50be5c73e0b2fab54944e68dd48c2a13a552ae7da72cf7868d1e286ffc0921">OCI_ANNOTATIONS</a>
, <br />
&#160;&#160;<a class="el" href="#a25e50be5c73e0b2fab54944e68dd48c2a158774e5aaadcff6bcf7daf6db2ea105">__OCI_MAX</a>
<br />
 }</td></tr>
<tr class="separator:a25e50be5c73e0b2fab54944e68dd48c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97f905ac94bfebd46e50e32c7389e6eb" id="r_a97f905ac94bfebd46e50e32c7389e6eb"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="#a97f905ac94bfebd46e50e32c7389e6eba13f094d14b519859226de69d2baca06d">OCI_STATE_CREATING</a>
, <a class="el" href="#a97f905ac94bfebd46e50e32c7389e6eba7d55a02065f2ef38d43d0c0858bee940">OCI_STATE_CREATED</a>
, <a class="el" href="#a97f905ac94bfebd46e50e32c7389e6eba9c098b9727e0c4f5a1c90b249cd4aacc">OCI_STATE_RUNNING</a>
, <a class="el" href="#a97f905ac94bfebd46e50e32c7389e6eba8c03b9e1abf979c0ec7b1900c86b60f1">OCI_STATE_STOPPED</a>
 }</td></tr>
<tr class="separator:a97f905ac94bfebd46e50e32c7389e6eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b29769343da78881f442e657eb62b6e" id="r_a9b29769343da78881f442e657eb62b6e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="#a9b29769343da78881f442e657eb62b6eaf6c2e8ccd2ffe9d627f296e938428c0b">CONTAINER_KILL_ATTR_SIGNAL</a>
, <a class="el" href="#a9b29769343da78881f442e657eb62b6eaa656c9648d631f597fe6ab93da6c8420">__CONTAINER_KILL_ATTR_MAX</a>
 }</td></tr>
<tr class="separator:a9b29769343da78881f442e657eb62b6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a607ba83d17934834c11576f3761ac577" id="r_a607ba83d17934834c11576f3761ac577"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a607ba83d17934834c11576f3761ac577">pivot_root</a> (const char *new_root, const char *put_old)</td></tr>
<tr class="separator:a607ba83d17934834c11576f3761ac577"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0015ee3272db94af6db03ff79d543794" id="r_a0015ee3272db94af6db03ff79d543794"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0015ee3272db94af6db03ff79d543794">has_namespaces</a> (void)</td></tr>
<tr class="separator:a0015ee3272db94af6db03ff79d543794"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a766dbc37dd9f160e1a3b8a9f19651b38" id="r_a766dbc37dd9f160e1a3b8a9f19651b38"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a766dbc37dd9f160e1a3b8a9f19651b38">free_oci_envp</a> (char **p)</td></tr>
<tr class="separator:a766dbc37dd9f160e1a3b8a9f19651b38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5127f557f43086299c2bf291618dcef5" id="r_a5127f557f43086299c2bf291618dcef5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5127f557f43086299c2bf291618dcef5">free_hooklist</a> (struct <a class="el" href="#da/d60/structhook__execvpe">hook_execvpe</a> **hooklist)</td></tr>
<tr class="separator:a5127f557f43086299c2bf291618dcef5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5064c6dcd09eae061c30cba4146bee18" id="r_a5064c6dcd09eae061c30cba4146bee18"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5064c6dcd09eae061c30cba4146bee18">free_sysctl</a> (void)</td></tr>
<tr class="separator:a5064c6dcd09eae061c30cba4146bee18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cdfa1304cca32224a444b6e84fac194" id="r_a7cdfa1304cca32224a444b6e84fac194"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7cdfa1304cca32224a444b6e84fac194">free_devices</a> (void)</td></tr>
<tr class="separator:a7cdfa1304cca32224a444b6e84fac194"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a2acf003db67e7475dcb66937cc12bb" id="r_a5a2acf003db67e7475dcb66937cc12bb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5a2acf003db67e7475dcb66937cc12bb">free_rlimits</a> (void)</td></tr>
<tr class="separator:a5a2acf003db67e7475dcb66937cc12bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61855620d1a0683f786486b1722d7dfa" id="r_a61855620d1a0683f786486b1722d7dfa"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a61855620d1a0683f786486b1722d7dfa">free_opts</a> (bool parent)</td></tr>
<tr class="separator:a61855620d1a0683f786486b1722d7dfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af49948409c11b79dd0b28ce038cdd592" id="r_af49948409c11b79dd0b28ce038cdd592"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af49948409c11b79dd0b28ce038cdd592">mount_overlay</a> (char *<a class="el" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>, char *overlaydir)</td></tr>
<tr class="separator:af49948409c11b79dd0b28ce038cdd592"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8805304877ae73abf20f1016d21de70" id="r_ab8805304877ae73abf20f1016d21de70"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab8805304877ae73abf20f1016d21de70">pass_console</a> (int <a class="el" href="#a9942f1401f46e915dbfecc403324f562">console_fd</a>)</td></tr>
<tr class="separator:ab8805304877ae73abf20f1016d21de70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08d9992cf8eb531a1783fd80c2af7630" id="r_a08d9992cf8eb531a1783fd80c2af7630"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a08d9992cf8eb531a1783fd80c2af7630">create_dev_console</a> (const char *<a class="el" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>)</td></tr>
<tr class="separator:a08d9992cf8eb531a1783fd80c2af7630"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c2afa94c622fb838442b3f2b631f7c0" id="r_a4c2afa94c622fb838442b3f2b631f7c0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4c2afa94c622fb838442b3f2b631f7c0">hook_process_timeout_cb</a> (struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a> *t)</td></tr>
<tr class="separator:a4c2afa94c622fb838442b3f2b631f7c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88ee3d42d3e892d3b5dd714d89b49505" id="r_a88ee3d42d3e892d3b5dd714d89b49505"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a88ee3d42d3e892d3b5dd714d89b49505">run_hooklist</a> (void)</td></tr>
<tr class="separator:a88ee3d42d3e892d3b5dd714d89b49505"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71525bf218f3fe2889a36b88e7b9964d" id="r_a71525bf218f3fe2889a36b88e7b9964d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a71525bf218f3fe2889a36b88e7b9964d">hook_process_handler</a> (struct <a class="el" href="../../dc/d56/uloop_8h.html#da/d43/structuloop__process">uloop_process</a> *c, int ret)</td></tr>
<tr class="separator:a71525bf218f3fe2889a36b88e7b9964d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1756d87ceab7e1c79fe7caf453cb102a" id="r_a1756d87ceab7e1c79fe7caf453cb102a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1756d87ceab7e1c79fe7caf453cb102a">run_hooks</a> (struct <a class="el" href="#da/d60/structhook__execvpe">hook_execvpe</a> **hooklist, <a class="el" href="#a32654766df20ade7d77949ecf91a601e">hook_return_handler</a> return_cb)</td></tr>
<tr class="separator:a1756d87ceab7e1c79fe7caf453cb102a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76506091a3ac45cc3ce7bdf1c3c279c9" id="r_a76506091a3ac45cc3ce7bdf1c3c279c9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a76506091a3ac45cc3ce7bdf1c3c279c9">apply_sysctl</a> (const char *<a class="el" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>)</td></tr>
<tr class="separator:a76506091a3ac45cc3ce7bdf1c3c279c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4fee5cb798e92300377ba06fda39a5b" id="r_af4fee5cb798e92300377ba06fda39a5b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af4fee5cb798e92300377ba06fda39a5b">create_devices</a> (void)</td></tr>
<tr class="separator:af4fee5cb798e92300377ba06fda39a5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b82670b51026fbff91952438dd301ac" id="r_a3b82670b51026fbff91952438dd301ac"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3b82670b51026fbff91952438dd301ac">enter_jail_fs</a> (void)</td></tr>
<tr class="separator:a3b82670b51026fbff91952438dd301ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f273b0b45f3de3b40e828800395c913" id="r_a2f273b0b45f3de3b40e828800395c913"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2f273b0b45f3de3b40e828800395c913">build_jail_fs</a> (void)</td></tr>
<tr class="separator:a2f273b0b45f3de3b40e828800395c913"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d1316d1e009899e8b8b735bb6ba70e3" id="r_a0d1316d1e009899e8b8b735bb6ba70e3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a> (int ret)</td></tr>
<tr class="separator:a0d1316d1e009899e8b8b735bb6ba70e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab88c4a768e1c297fb6b3757942876398" id="r_ab88c4a768e1c297fb6b3757942876398"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab88c4a768e1c297fb6b3757942876398">post_jail_fs</a> (void)</td></tr>
<tr class="separator:ab88c4a768e1c297fb6b3757942876398"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03b42a6e644fea8b163b6b51e0fd4a99" id="r_a03b42a6e644fea8b163b6b51e0fd4a99"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a03b42a6e644fea8b163b6b51e0fd4a99">write_uid_gid_map</a> (pid_t child_pid, bool gidmap, char *mapstr)</td></tr>
<tr class="separator:a03b42a6e644fea8b163b6b51e0fd4a99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca23e4e8fd88ec02ca43121879a36702" id="r_aca23e4e8fd88ec02ca43121879a36702"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aca23e4e8fd88ec02ca43121879a36702">write_single_uid_gid_map</a> (pid_t child_pid, bool gidmap, int <a class="el" href="../../dd/d8f/udebug-proto_8h.html#abaabdc509cdaba7df9f56c6c76f3ae19">id</a>)</td></tr>
<tr class="separator:aca23e4e8fd88ec02ca43121879a36702"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e111fe85d16008f130c765e511d670c" id="r_a5e111fe85d16008f130c765e511d670c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5e111fe85d16008f130c765e511d670c">write_setgroups</a> (pid_t child_pid, bool allow)</td></tr>
<tr class="separator:a5e111fe85d16008f130c765e511d670c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f77c1e493a8d84fc93bec1de3f871de" id="r_a6f77c1e493a8d84fc93bec1de3f871de"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6f77c1e493a8d84fc93bec1de3f871de">get_jail_user</a> (int *user, int *user_gid, int *gr_gid)</td></tr>
<tr class="separator:a6f77c1e493a8d84fc93bec1de3f871de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff8b6e0b00af342a873f29ed0161479d" id="r_aff8b6e0b00af342a873f29ed0161479d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aff8b6e0b00af342a873f29ed0161479d">set_jail_user</a> (int pw_uid, int user_gid, int gr_gid)</td></tr>
<tr class="separator:aff8b6e0b00af342a873f29ed0161479d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae076946d2fc6067e05a7851cad082a4a" id="r_ae076946d2fc6067e05a7851cad082a4a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae076946d2fc6067e05a7851cad082a4a">apply_rlimits</a> (void)</td></tr>
<tr class="separator:ae076946d2fc6067e05a7851cad082a4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c0f3a1b16c319c90fadb78ad09a5336" id="r_a6c0f3a1b16c319c90fadb78ad09a5336"><td class="memItemLeft" align="right" valign="top">static char **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6c0f3a1b16c319c90fadb78ad09a5336">build_envp</a> (const char *seccomp, char **ocienvp)</td></tr>
<tr class="separator:a6c0f3a1b16c319c90fadb78ad09a5336"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad96d407a911fbb914fa8e4cfbf2faf0f" id="r_ad96d407a911fbb914fa8e4cfbf2faf0f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad96d407a911fbb914fa8e4cfbf2faf0f">usage</a> (void)</td></tr>
<tr class="separator:ad96d407a911fbb914fa8e4cfbf2faf0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3aa34193a0ba95da6ede6aa8e16d726f" id="r_a3aa34193a0ba95da6ede6aa8e16d726f"><td class="memItemLeft" align="right" valign="top">static int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3aa34193a0ba95da6ede6aa8e16d726f">get_namespace_fd</a> (const unsigned int nstype)</td></tr>
<tr class="separator:a3aa34193a0ba95da6ede6aa8e16d726f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad16db5f10de76210ae8d78de47da352e" id="r_ad16db5f10de76210ae8d78de47da352e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad16db5f10de76210ae8d78de47da352e">setns_open</a> (unsigned long nstype)</td></tr>
<tr class="separator:ad16db5f10de76210ae8d78de47da352e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5594c6291500b798715b5e124af342f" id="r_ab5594c6291500b798715b5e124af342f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab5594c6291500b798715b5e124af342f">jail_process_timeout_cb</a> (struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a> *t)</td></tr>
<tr class="separator:ab5594c6291500b798715b5e124af342f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75a14e1ea35414c049cd975fb3e3f99c" id="r_a75a14e1ea35414c049cd975fb3e3f99c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a75a14e1ea35414c049cd975fb3e3f99c">poststop</a> (void)</td></tr>
<tr class="separator:a75a14e1ea35414c049cd975fb3e3f99c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a152810934f1ea2bc2a73144a121e3b27" id="r_a152810934f1ea2bc2a73144a121e3b27"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a152810934f1ea2bc2a73144a121e3b27">jail_process_handler</a> (struct <a class="el" href="../../dc/d56/uloop_8h.html#da/d43/structuloop__process">uloop_process</a> *c, int ret)</td></tr>
<tr class="separator:a152810934f1ea2bc2a73144a121e3b27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d20901cfe9adbe227505e368612346d" id="r_a4d20901cfe9adbe227505e368612346d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4d20901cfe9adbe227505e368612346d">jail_handle_signal</a> (int signo)</td></tr>
<tr class="separator:a4d20901cfe9adbe227505e368612346d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab97dc72992426f87762ca05057c651b3" id="r_ab97dc72992426f87762ca05057c651b3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab97dc72992426f87762ca05057c651b3">signals_init</a> (void)</td></tr>
<tr class="separator:ab97dc72992426f87762ca05057c651b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15ffedabb70c5663ccda778a58da4f87" id="r_a15ffedabb70c5663ccda778a58da4f87"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a15ffedabb70c5663ccda778a58da4f87">pre_exec_jail</a> (struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a> *t)</td></tr>
<tr class="separator:a15ffedabb70c5663ccda778a58da4f87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ec0440bd3676ab8e8d63f8ca3660b3a" id="r_a0ec0440bd3676ab8e8d63f8ca3660b3a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ec0440bd3676ab8e8d63f8ca3660b3a">exec_jail</a> (void *arg)</td></tr>
<tr class="separator:a0ec0440bd3676ab8e8d63f8ca3660b3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a292407d99b98bbc178b7760e2107725d" id="r_a292407d99b98bbc178b7760e2107725d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a292407d99b98bbc178b7760e2107725d">post_start_hook</a> (void)</td></tr>
<tr class="separator:a292407d99b98bbc178b7760e2107725d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3f4a6a40d174160d8d1fcd78515e4ea" id="r_ae3f4a6a40d174160d8d1fcd78515e4ea"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae3f4a6a40d174160d8d1fcd78515e4ea">ns_open_pid</a> (const char *nstype, const pid_t target_ns)</td></tr>
<tr class="separator:ae3f4a6a40d174160d8d1fcd78515e4ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adddfc616a062dd8a8ba8d4fbd3929cbe" id="r_adddfc616a062dd8a8ba8d4fbd3929cbe"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adddfc616a062dd8a8ba8d4fbd3929cbe">parseOCIenvarray</a> (struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *msg, char ***envp)</td></tr>
<tr class="separator:adddfc616a062dd8a8ba8d4fbd3929cbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f891a6707cacaa8e89f16ac600cf5d2" id="r_a9f891a6707cacaa8e89f16ac600cf5d2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9f891a6707cacaa8e89f16ac600cf5d2">parseOCIroot</a> (const char *jsonfile, struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *msg)</td></tr>
<tr class="separator:a9f891a6707cacaa8e89f16ac600cf5d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75b0745dc9e409dbd1fd5a222db877ea" id="r_a75b0745dc9e409dbd1fd5a222db877ea"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a75b0745dc9e409dbd1fd5a222db877ea">parseOCIhook</a> (struct <a class="el" href="#da/d60/structhook__execvpe">hook_execvpe</a> ***hooklist, struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *msg)</td></tr>
<tr class="separator:a75b0745dc9e409dbd1fd5a222db877ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8633a124e3a74b3317a273e2aaa6c207" id="r_a8633a124e3a74b3317a273e2aaa6c207"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8633a124e3a74b3317a273e2aaa6c207">parseOCIhooks</a> (struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *msg)</td></tr>
<tr class="separator:a8633a124e3a74b3317a273e2aaa6c207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43c8017e92544b5ba06a553fd5c9b8b6" id="r_a43c8017e92544b5ba06a553fd5c9b8b6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a43c8017e92544b5ba06a553fd5c9b8b6">parseOCIprocessuser</a> (struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *msg)</td></tr>
<tr class="separator:a43c8017e92544b5ba06a553fd5c9b8b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a403387af16adfc17ce1cb6f14b82afb1" id="r_a403387af16adfc17ce1cb6f14b82afb1"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a403387af16adfc17ce1cb6f14b82afb1">resolve_rlimit</a> (char *<a class="el" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>)</td></tr>
<tr class="separator:a403387af16adfc17ce1cb6f14b82afb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e7ceb5ee690aa943096b3398fe195f9" id="r_a7e7ceb5ee690aa943096b3398fe195f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7e7ceb5ee690aa943096b3398fe195f9">parseOCIrlimit</a> (struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *msg)</td></tr>
<tr class="separator:a7e7ceb5ee690aa943096b3398fe195f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c2ec1493bdd9d650372134c0bdad679" id="r_a5c2ec1493bdd9d650372134c0bdad679"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5c2ec1493bdd9d650372134c0bdad679">parseOCIprocess</a> (struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *msg)</td></tr>
<tr class="separator:a5c2ec1493bdd9d650372134c0bdad679"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a259f820c79f4b101ce41e26167ace63f" id="r_a259f820c79f4b101ce41e26167ace63f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a259f820c79f4b101ce41e26167ace63f">resolve_nstype</a> (char *<a class="el" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>)</td></tr>
<tr class="separator:a259f820c79f4b101ce41e26167ace63f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78940dcf91ed274ccd9183c4ac526998" id="r_a78940dcf91ed274ccd9183c4ac526998"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a78940dcf91ed274ccd9183c4ac526998">parseOCIlinuxns</a> (struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *msg)</td></tr>
<tr class="separator:a78940dcf91ed274ccd9183c4ac526998"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a871481dd00dcac30989df45c68b2e27a" id="r_a871481dd00dcac30989df45c68b2e27a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a871481dd00dcac30989df45c68b2e27a">jail_join_ns</a> (char *arg)</td></tr>
<tr class="separator:a871481dd00dcac30989df45c68b2e27a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39b7846b508242141ff2f681fb681fdc" id="r_a39b7846b508242141ff2f681fb681fdc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a39b7846b508242141ff2f681fb681fdc">get_jail_root_user</a> (bool is_gidmap, uint32_t container_id, uint32_t host_id, uint32_t size)</td></tr>
<tr class="separator:a39b7846b508242141ff2f681fb681fdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ba489d2464ce8b1fb4a3ba5df1e22dc" id="r_a8ba489d2464ce8b1fb4a3ba5df1e22dc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8ba489d2464ce8b1fb4a3ba5df1e22dc">parseOCIuidgidmappings</a> (struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *msg, bool is_gidmap)</td></tr>
<tr class="separator:a8ba489d2464ce8b1fb4a3ba5df1e22dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbfe748be98e9279f2002f167442f9b2" id="r_abbfe748be98e9279f2002f167442f9b2"><td class="memItemLeft" align="right" valign="top">static mode_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abbfe748be98e9279f2002f167442f9b2">resolve_devtype</a> (char *tstr)</td></tr>
<tr class="separator:abbfe748be98e9279f2002f167442f9b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba4a3f4d1a6a966987122b98d06e256f" id="r_aba4a3f4d1a6a966987122b98d06e256f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aba4a3f4d1a6a966987122b98d06e256f">parseOCIdevices</a> (struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *msg)</td></tr>
<tr class="separator:aba4a3f4d1a6a966987122b98d06e256f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a553876759c42a12a39f61a93d27b27ef" id="r_a553876759c42a12a39f61a93d27b27ef"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a553876759c42a12a39f61a93d27b27ef">parseOCIsysctl</a> (struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *msg)</td></tr>
<tr class="separator:a553876759c42a12a39f61a93d27b27ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c489687a19450a8f1a90ec2263c7a11" id="r_a2c489687a19450a8f1a90ec2263c7a11"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2c489687a19450a8f1a90ec2263c7a11">parseOCIlinux</a> (struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *msg)</td></tr>
<tr class="separator:a2c489687a19450a8f1a90ec2263c7a11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d6b15fa5d3ae9b608587bd11cbda9cf" id="r_a4d6b15fa5d3ae9b608587bd11cbda9cf"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4d6b15fa5d3ae9b608587bd11cbda9cf">parseOCI</a> (const char *jsonfile)</td></tr>
<tr class="separator:a4d6b15fa5d3ae9b608587bd11cbda9cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab22dc7688d950fcf927c8cbcfcdb15cd" id="r_ab22dc7688d950fcf927c8cbcfcdb15cd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab22dc7688d950fcf927c8cbcfcdb15cd">set_oom_score_adj</a> (void)</td></tr>
<tr class="separator:ab22dc7688d950fcf927c8cbcfcdb15cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44e8c7d9c78045cd28f81b95fb3f2cf3" id="r_a44e8c7d9c78045cd28f81b95fb3f2cf3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a44e8c7d9c78045cd28f81b95fb3f2cf3">pipe_send_start_container</a> (struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a> *t)</td></tr>
<tr class="separator:a44e8c7d9c78045cd28f81b95fb3f2cf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d6c7c9ff5f0dc0ecd5af7f8c8ff2856" id="r_a2d6c7c9ff5f0dc0ecd5af7f8c8ff2856"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2d6c7c9ff5f0dc0ecd5af7f8c8ff2856">handle_start</a> (struct <a class="el" href="../../db/d55/libubus_8h.html#df/d18/structubus__context">ubus_context</a> *<a class="el" href="../../d5/dd5/hotplug-dispatch_8c.html#a7c00b3b8999b2056f226d3cc35a83845">ctx</a>, struct <a class="el" href="../../d9/d00/ubusd__obj_8h.html#d6/d75/structubus__object">ubus_object</a> *obj, struct <a class="el" href="../../db/d55/libubus_8h.html#d5/d2a/structubus__request__data">ubus_request_data</a> *req, const char *method, struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *msg)</td></tr>
<tr class="separator:a2d6c7c9ff5f0dc0ecd5af7f8c8ff2856"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6e6d6350c1d8807003c0cbc0bab22ba" id="r_ac6e6d6350c1d8807003c0cbc0bab22ba"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac6e6d6350c1d8807003c0cbc0bab22ba">handle_state</a> (struct <a class="el" href="../../db/d55/libubus_8h.html#df/d18/structubus__context">ubus_context</a> *<a class="el" href="../../d5/dd5/hotplug-dispatch_8c.html#a7c00b3b8999b2056f226d3cc35a83845">ctx</a>, struct <a class="el" href="../../d9/d00/ubusd__obj_8h.html#d6/d75/structubus__object">ubus_object</a> *obj, struct <a class="el" href="../../db/d55/libubus_8h.html#d5/d2a/structubus__request__data">ubus_request_data</a> *req, const char *method, struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *msg)</td></tr>
<tr class="separator:ac6e6d6350c1d8807003c0cbc0bab22ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3670ecb9a71cd74f8a871ca3ff6f091" id="r_ae3670ecb9a71cd74f8a871ca3ff6f091"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae3670ecb9a71cd74f8a871ca3ff6f091">container_handle_kill</a> (struct <a class="el" href="../../db/d55/libubus_8h.html#df/d18/structubus__context">ubus_context</a> *<a class="el" href="../../d5/dd5/hotplug-dispatch_8c.html#a7c00b3b8999b2056f226d3cc35a83845">ctx</a>, struct <a class="el" href="../../d9/d00/ubusd__obj_8h.html#d6/d75/structubus__object">ubus_object</a> *obj, struct <a class="el" href="../../db/d55/libubus_8h.html#d5/d2a/structubus__request__data">ubus_request_data</a> *req, const char *method, struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *msg)</td></tr>
<tr class="separator:ae3670ecb9a71cd74f8a871ca3ff6f091"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67a452007801b15d82d00079f8e344f5" id="r_a67a452007801b15d82d00079f8e344f5"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a67a452007801b15d82d00079f8e344f5">jail_writepid</a> (pid_t pid)</td></tr>
<tr class="separator:a67a452007801b15d82d00079f8e344f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31575d38ed43b739ca94e78c23e5b1e0" id="r_a31575d38ed43b739ca94e78c23e5b1e0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a31575d38ed43b739ca94e78c23e5b1e0">checkpath</a> (const char *<a class="el" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>)</td></tr>
<tr class="separator:a31575d38ed43b739ca94e78c23e5b1e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a752afff1e548707b0cbec92c8e7512" id="r_a2a752afff1e548707b0cbec92c8e7512"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2a752afff1e548707b0cbec92c8e7512">post_main</a> (struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a> *t)</td></tr>
<tr class="separator:a2a752afff1e548707b0cbec92c8e7512"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67b89ffa3ccdcc917716e1c48ed5d90c" id="r_a67b89ffa3ccdcc917716e1c48ed5d90c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a67b89ffa3ccdcc917716e1c48ed5d90c">post_create_runtime</a> (void)</td></tr>
<tr class="separator:a67b89ffa3ccdcc917716e1c48ed5d90c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627" id="r_a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab539f0664e4eb2dda9be701742add492" id="r_ab539f0664e4eb2dda9be701742add492"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab539f0664e4eb2dda9be701742add492">post_poststart</a> (void)</td></tr>
<tr class="separator:ab539f0664e4eb2dda9be701742add492"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3360eb012491304d4630403c5dc33ec9" id="r_a3360eb012491304d4630403c5dc33ec9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3360eb012491304d4630403c5dc33ec9">post_poststop</a> (void)</td></tr>
<tr class="separator:a3360eb012491304d4630403c5dc33ec9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab6fdb9300031a4ac782a6a3a7ec742cd" id="r_ab6fdb9300031a4ac782a6a3a7ec742cd"><td class="memItemLeft" >struct {&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabae104045a5217e5090fa5994a4b321" id="r_aabae104045a5217e5090fa5994a4b321"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aabae104045a5217e5090fa5994a4b321">name</a></td></tr>
<tr class="separator:aabae104045a5217e5090fa5994a4b321"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4c11e1afe83ce8bbcf0322b7fcc7eb2" id="r_ad4c11e1afe83ce8bbcf0322b7fcc7eb2"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad4c11e1afe83ce8bbcf0322b7fcc7eb2">hostname</a></td></tr>
<tr class="separator:ad4c11e1afe83ce8bbcf0322b7fcc7eb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ccbffc4f1ad955b3c9ae2bee1be19d1" id="r_a0ccbffc4f1ad955b3c9ae2bee1be19d1"><td class="memItemLeft" align="right" valign="top">char **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ccbffc4f1ad955b3c9ae2bee1be19d1">jail_argv</a></td></tr>
<tr class="separator:a0ccbffc4f1ad955b3c9ae2bee1be19d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a393ed49d10c2a4b8b3620c605e952511" id="r_a393ed49d10c2a4b8b3620c605e952511"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a393ed49d10c2a4b8b3620c605e952511">cwd</a></td></tr>
<tr class="separator:a393ed49d10c2a4b8b3620c605e952511"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7f4d3a8b5839f54c879a1e8f697f29b" id="r_ab7f4d3a8b5839f54c879a1e8f697f29b"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab7f4d3a8b5839f54c879a1e8f697f29b">seccomp</a></td></tr>
<tr class="separator:ab7f4d3a8b5839f54c879a1e8f697f29b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb8047d76487f0e5eb6fd10e1dc92677" id="r_acb8047d76487f0e5eb6fd10e1dc92677"><td class="memItemLeft" align="right" valign="top">struct sock_fprog *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acb8047d76487f0e5eb6fd10e1dc92677">ociseccomp</a></td></tr>
<tr class="separator:acb8047d76487f0e5eb6fd10e1dc92677"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab85f7994c3d3fe7c10b0653d07bc7fbb" id="r_ab85f7994c3d3fe7c10b0653d07bc7fbb"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab85f7994c3d3fe7c10b0653d07bc7fbb">capabilities</a></td></tr>
<tr class="separator:ab85f7994c3d3fe7c10b0653d07bc7fbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace70b8198b74c7e0db8ed269ddb34979" id="r_ace70b8198b74c7e0db8ed269ddb34979"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d8/d14/capabilities_8h.html#dd/d59/structjail__capset">jail_capset</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ace70b8198b74c7e0db8ed269ddb34979">capset</a></td></tr>
<tr class="separator:ace70b8198b74c7e0db8ed269ddb34979"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ba9177bf5c30bc1ade3893870e2ecc6" id="r_a3ba9177bf5c30bc1ade3893870e2ecc6"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3ba9177bf5c30bc1ade3893870e2ecc6">user</a></td></tr>
<tr class="separator:a3ba9177bf5c30bc1ade3893870e2ecc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c3187dad2f4c32a7a85ad03108c68ef" id="r_a9c3187dad2f4c32a7a85ad03108c68ef"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9c3187dad2f4c32a7a85ad03108c68ef">group</a></td></tr>
<tr class="separator:a9c3187dad2f4c32a7a85ad03108c68ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd9a5ae78606234fa063beff1b35b49d" id="r_abd9a5ae78606234fa063beff1b35b49d"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abd9a5ae78606234fa063beff1b35b49d">extroot</a></td></tr>
<tr class="separator:abd9a5ae78606234fa063beff1b35b49d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92fe25312f0a9a1114d4187e8e3db11f" id="r_a92fe25312f0a9a1114d4187e8e3db11f"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a92fe25312f0a9a1114d4187e8e3db11f">overlaydir</a></td></tr>
<tr class="separator:a92fe25312f0a9a1114d4187e8e3db11f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13f64a68f09304d2124e2aed6837074b" id="r_a13f64a68f09304d2124e2aed6837074b"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a13f64a68f09304d2124e2aed6837074b">tmpoverlaysize</a></td></tr>
<tr class="separator:a13f64a68f09304d2124e2aed6837074b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03389bfd4cad456e0886fd941d6d5e02" id="r_a03389bfd4cad456e0886fd941d6d5e02"><td class="memItemLeft" align="right" valign="top">char **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a03389bfd4cad456e0886fd941d6d5e02">envp</a></td></tr>
<tr class="separator:a03389bfd4cad456e0886fd941d6d5e02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9646f76a511a606bf7540730d3032fea" id="r_a9646f76a511a606bf7540730d3032fea"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9646f76a511a606bf7540730d3032fea">uidmap</a></td></tr>
<tr class="separator:a9646f76a511a606bf7540730d3032fea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b7318e4c487e6bc72485384f881ea12" id="r_a6b7318e4c487e6bc72485384f881ea12"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6b7318e4c487e6bc72485384f881ea12">gidmap</a></td></tr>
<tr class="separator:a6b7318e4c487e6bc72485384f881ea12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab399248b9208c3c877ce404211cce8a" id="r_aab399248b9208c3c877ce404211cce8a"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aab399248b9208c3c877ce404211cce8a">pidfile</a></td></tr>
<tr class="separator:aab399248b9208c3c877ce404211cce8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cff231f5223257f3d1740938ffbea07" id="r_a2cff231f5223257f3d1740938ffbea07"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="#de/d02/structsysctl__val">sysctl_val</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2cff231f5223257f3d1740938ffbea07">sysctl</a></td></tr>
<tr class="separator:a2cff231f5223257f3d1740938ffbea07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcbf3c14e0db16a4cb44ccf34ba0050c" id="r_afcbf3c14e0db16a4cb44ccf34ba0050c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afcbf3c14e0db16a4cb44ccf34ba0050c">no_new_privs</a></td></tr>
<tr class="separator:afcbf3c14e0db16a4cb44ccf34ba0050c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac345db79d97a3c6df531fb82f582bcdb" id="r_ac345db79d97a3c6df531fb82f582bcdb"><td class="memItemLeft" >&#160;&#160;&#160;struct {&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41bb7c8646f2d3e85cfb73b9956a18a1" id="r_a41bb7c8646f2d3e85cfb73b9956a18a1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d8a/struct_0d121_1_1_0d135.html#a41bb7c8646f2d3e85cfb73b9956a18a1">pid</a></td></tr>
<tr class="separator:a41bb7c8646f2d3e85cfb73b9956a18a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62b76409b21c46dfa2cf764a4d58f7a7" id="r_a62b76409b21c46dfa2cf764a4d58f7a7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d8a/struct_0d121_1_1_0d135.html#a62b76409b21c46dfa2cf764a4d58f7a7">net</a></td></tr>
<tr class="separator:a62b76409b21c46dfa2cf764a4d58f7a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9dc809389e6c49290606eb04787c405" id="r_af9dc809389e6c49290606eb04787c405"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d8a/struct_0d121_1_1_0d135.html#af9dc809389e6c49290606eb04787c405">ns</a></td></tr>
<tr class="separator:af9dc809389e6c49290606eb04787c405"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1174001d6f698da0c1e3c39b091f9301" id="r_a1174001d6f698da0c1e3c39b091f9301"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d8a/struct_0d121_1_1_0d135.html#a1174001d6f698da0c1e3c39b091f9301">ipc</a></td></tr>
<tr class="separator:a1174001d6f698da0c1e3c39b091f9301"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c410f4858bf474556ea9fe546b6ae7d" id="r_a6c410f4858bf474556ea9fe546b6ae7d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d8a/struct_0d121_1_1_0d135.html#a6c410f4858bf474556ea9fe546b6ae7d">uts</a></td></tr>
<tr class="separator:a6c410f4858bf474556ea9fe546b6ae7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbdd682f21f60fd8c86ece33dcc90dce" id="r_adbdd682f21f60fd8c86ece33dcc90dce"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d8a/struct_0d121_1_1_0d135.html#adbdd682f21f60fd8c86ece33dcc90dce">user</a></td></tr>
<tr class="separator:adbdd682f21f60fd8c86ece33dcc90dce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f3cc6c845bc42e2fcefcce5a7876104" id="r_a2f3cc6c845bc42e2fcefcce5a7876104"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d8a/struct_0d121_1_1_0d135.html#a2f3cc6c845bc42e2fcefcce5a7876104">cgroup</a></td></tr>
<tr class="separator:a2f3cc6c845bc42e2fcefcce5a7876104"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac345db79d97a3c6df531fb82f582bcdb" id="r_ac345db79d97a3c6df531fb82f582bcdb"><td class="memItemLeft" valign="top">&#160;&#160;&#160;}&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac345db79d97a3c6df531fb82f582bcdb">setns</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:ac345db79d97a3c6df531fb82f582bcdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1677d82ad393299a7f77508c88599ea2" id="r_a1677d82ad393299a7f77508c88599ea2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1677d82ad393299a7f77508c88599ea2">procfs</a></td></tr>
<tr class="separator:a1677d82ad393299a7f77508c88599ea2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b4938a0f36a15f56b5593d0680414f6" id="r_a3b4938a0f36a15f56b5593d0680414f6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3b4938a0f36a15f56b5593d0680414f6">ronly</a></td></tr>
<tr class="separator:a3b4938a0f36a15f56b5593d0680414f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07fc9d35e532b787180cadfd4d5d584a" id="r_a07fc9d35e532b787180cadfd4d5d584a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a07fc9d35e532b787180cadfd4d5d584a">sysfs</a></td></tr>
<tr class="separator:a07fc9d35e532b787180cadfd4d5d584a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7567aaee7df5084e9d5bf0c3e67578ce" id="r_a7567aaee7df5084e9d5bf0c3e67578ce"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7567aaee7df5084e9d5bf0c3e67578ce">console</a></td></tr>
<tr class="separator:a7567aaee7df5084e9d5bf0c3e67578ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add777cbed4a1c6f8f316cae770ea2f98" id="r_add777cbed4a1c6f8f316cae770ea2f98"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#add777cbed4a1c6f8f316cae770ea2f98">pw_uid</a></td></tr>
<tr class="separator:add777cbed4a1c6f8f316cae770ea2f98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3278f27ba27dca87c247adf4d29caa0c" id="r_a3278f27ba27dca87c247adf4d29caa0c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3278f27ba27dca87c247adf4d29caa0c">pw_gid</a></td></tr>
<tr class="separator:a3278f27ba27dca87c247adf4d29caa0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a156960a1c6ab9a51c37dac4ff76c5fff" id="r_a156960a1c6ab9a51c37dac4ff76c5fff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a156960a1c6ab9a51c37dac4ff76c5fff">gr_gid</a></td></tr>
<tr class="separator:a156960a1c6ab9a51c37dac4ff76c5fff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6905286cbef8d4dc9aafcf075ea20b8" id="r_ab6905286cbef8d4dc9aafcf075ea20b8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab6905286cbef8d4dc9aafcf075ea20b8">root_map_uid</a></td></tr>
<tr class="separator:ab6905286cbef8d4dc9aafcf075ea20b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79e7f3201eb1099d75175a4324d133a4" id="r_a79e7f3201eb1099d75175a4324d133a4"><td class="memItemLeft" align="right" valign="top">gid_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a79e7f3201eb1099d75175a4324d133a4">additional_gids</a></td></tr>
<tr class="separator:a79e7f3201eb1099d75175a4324d133a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1930672e306d496e91b6474a07285e5" id="r_ac1930672e306d496e91b6474a07285e5"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac1930672e306d496e91b6474a07285e5">num_additional_gids</a></td></tr>
<tr class="separator:ac1930672e306d496e91b6474a07285e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cdeb3f7e7dd388d2edd4ea8b02e5059" id="r_a1cdeb3f7e7dd388d2edd4ea8b02e5059"><td class="memItemLeft" align="right" valign="top">mode_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1cdeb3f7e7dd388d2edd4ea8b02e5059">umask</a></td></tr>
<tr class="separator:a1cdeb3f7e7dd388d2edd4ea8b02e5059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5a39cf9697d15fe830ac9ac87079d9f" id="r_ae5a39cf9697d15fe830ac9ac87079d9f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae5a39cf9697d15fe830ac9ac87079d9f">set_umask</a></td></tr>
<tr class="separator:ae5a39cf9697d15fe830ac9ac87079d9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a689f6b97c6a8d42c607232b4e3bedfdb" id="r_a689f6b97c6a8d42c607232b4e3bedfdb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a689f6b97c6a8d42c607232b4e3bedfdb">require_jail</a></td></tr>
<tr class="separator:a689f6b97c6a8d42c607232b4e3bedfdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa235d7ddba4aba5a361fac179d0f88bd" id="r_aa235d7ddba4aba5a361fac179d0f88bd"><td class="memItemLeft" >&#160;&#160;&#160;struct {&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae92d47a8388bf54cc61d00c3d724c069" id="r_ae92d47a8388bf54cc61d00c3d724c069"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="#da/d60/structhook__execvpe">hook_execvpe</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d43/struct_0d121_1_1_0d136.html#ae92d47a8388bf54cc61d00c3d724c069">createRuntime</a></td></tr>
<tr class="separator:ae92d47a8388bf54cc61d00c3d724c069"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0161a9346ab3c7dfbbe05e09eca8709" id="r_aa0161a9346ab3c7dfbbe05e09eca8709"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="#da/d60/structhook__execvpe">hook_execvpe</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d43/struct_0d121_1_1_0d136.html#aa0161a9346ab3c7dfbbe05e09eca8709">createContainer</a></td></tr>
<tr class="separator:aa0161a9346ab3c7dfbbe05e09eca8709"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2839ce64c6817385b2513b5949c46ee7" id="r_a2839ce64c6817385b2513b5949c46ee7"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="#da/d60/structhook__execvpe">hook_execvpe</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d43/struct_0d121_1_1_0d136.html#a2839ce64c6817385b2513b5949c46ee7">startContainer</a></td></tr>
<tr class="separator:a2839ce64c6817385b2513b5949c46ee7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36a62aea309303a7b910c2de3cfd72f0" id="r_a36a62aea309303a7b910c2de3cfd72f0"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="#da/d60/structhook__execvpe">hook_execvpe</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d43/struct_0d121_1_1_0d136.html#a36a62aea309303a7b910c2de3cfd72f0">poststart</a></td></tr>
<tr class="separator:a36a62aea309303a7b910c2de3cfd72f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa829c975e5c2c9f95f95630598f8640d" id="r_aa829c975e5c2c9f95f95630598f8640d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="#da/d60/structhook__execvpe">hook_execvpe</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d43/struct_0d121_1_1_0d136.html#aa829c975e5c2c9f95f95630598f8640d">poststop</a></td></tr>
<tr class="separator:aa829c975e5c2c9f95f95630598f8640d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa235d7ddba4aba5a361fac179d0f88bd" id="r_aa235d7ddba4aba5a361fac179d0f88bd"><td class="memItemLeft" valign="top">&#160;&#160;&#160;}&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa235d7ddba4aba5a361fac179d0f88bd">hooks</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:aa235d7ddba4aba5a361fac179d0f88bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae11bb5cbd634e731d6a8658c4c1beb74" id="r_ae11bb5cbd634e731d6a8658c4c1beb74"><td class="memItemLeft" align="right" valign="top">struct rlimit *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae11bb5cbd634e731d6a8658c4c1beb74">rlimits</a> [RLIM_NLIMITS]</td></tr>
<tr class="separator:ae11bb5cbd634e731d6a8658c4c1beb74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48ddf406f5f380c838ea4630c3e01bb4" id="r_a48ddf406f5f380c838ea4630c3e01bb4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a48ddf406f5f380c838ea4630c3e01bb4">oom_score_adj</a></td></tr>
<tr class="separator:a48ddf406f5f380c838ea4630c3e01bb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac55763e1c8fb4b79c663b10042083831" id="r_ac55763e1c8fb4b79c663b10042083831"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac55763e1c8fb4b79c663b10042083831">set_oom_score_adj</a></td></tr>
<tr class="separator:ac55763e1c8fb4b79c663b10042083831"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a1e1c8c3ebbf3f09979212cbf11a1c0" id="r_a0a1e1c8c3ebbf3f09979212cbf11a1c0"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="#d5/db5/structmknod__args">mknod_args</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0a1e1c8c3ebbf3f09979212cbf11a1c0">devices</a></td></tr>
<tr class="separator:a0a1e1c8c3ebbf3f09979212cbf11a1c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a403a4a15e3c98537ea0ffe4368bc4624" id="r_a403a4a15e3c98537ea0ffe4368bc4624"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a403a4a15e3c98537ea0ffe4368bc4624">ocibundle</a></td></tr>
<tr class="separator:a403a4a15e3c98537ea0ffe4368bc4624"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeab303db4e60b96ace3ceb37cdc9ce60" id="r_aeab303db4e60b96ace3ceb37cdc9ce60"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeab303db4e60b96ace3ceb37cdc9ce60">immediately</a></td></tr>
<tr class="separator:aeab303db4e60b96ace3ceb37cdc9ce60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02c7b329fea6bf3c0201e66b29eb6058" id="r_a02c7b329fea6bf3c0201e66b29eb6058"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a02c7b329fea6bf3c0201e66b29eb6058">annotations</a></td></tr>
<tr class="separator:a02c7b329fea6bf3c0201e66b29eb6058"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0bceb11045f8532c7202d4589b728df" id="r_ab0bceb11045f8532c7202d4589b728df"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab0bceb11045f8532c7202d4589b728df">term_timeout</a></td></tr>
<tr class="separator:ab0bceb11045f8532c7202d4589b728df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6fdb9300031a4ac782a6a3a7ec742cd" id="r_ab6fdb9300031a4ac782a6a3a7ec742cd"><td class="memItemLeft" valign="top">}&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:ab6fdb9300031a4ac782a6a3a7ec742cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa04cdf4d9bc5ac87bf39574fc9845918" id="r_aa04cdf4d9bc5ac87bf39574fc9845918"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d8/d3c/blob_8h.html#d3/dcb/structblob__buf">blob_buf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa04cdf4d9bc5ac87bf39574fc9845918">ocibuf</a></td></tr>
<tr class="separator:aa04cdf4d9bc5ac87bf39574fc9845918"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3e1795766a80ec63b157951b4b9a7d4" id="r_ac3e1795766a80ec63b157951b4b9a7d4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac3e1795766a80ec63b157951b4b9a7d4">debug</a> = 0</td></tr>
<tr class="separator:ac3e1795766a80ec63b157951b4b9a7d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad410c04420d9661f33117e672aee307" id="r_aad410c04420d9661f33117e672aee307"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aad410c04420d9661f33117e672aee307">child_stack</a> [<a class="el" href="#a6423a880df59733d2d9b509c7718d3a9">STACK_SIZE</a>]</td></tr>
<tr class="separator:aad410c04420d9661f33117e672aee307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00f1e87fefda65b43a661aefc6f16566" id="r_a00f1e87fefda65b43a661aefc6f16566"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../db/d55/libubus_8h.html#df/d18/structubus__context">ubus_context</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a00f1e87fefda65b43a661aefc6f16566">parent_ctx</a></td></tr>
<tr class="separator:a00f1e87fefda65b43a661aefc6f16566"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9942f1401f46e915dbfecc403324f562" id="r_a9942f1401f46e915dbfecc403324f562"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9942f1401f46e915dbfecc403324f562">console_fd</a></td></tr>
<tr class="separator:a9942f1401f46e915dbfecc403324f562"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f85aa468b522508531e8c0bece6552c" id="r_a7f85aa468b522508531e8c0bece6552c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7f85aa468b522508531e8c0bece6552c">hook_running</a> = 0</td></tr>
<tr class="separator:a7f85aa468b522508531e8c0bece6552c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1fb066316f676461bbd8e92a073b26c" id="r_af1fb066316f676461bbd8e92a073b26c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af1fb066316f676461bbd8e92a073b26c">hook_return_code</a> = 0</td></tr>
<tr class="separator:af1fb066316f676461bbd8e92a073b26c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3d0fc71d58968708478752881b119c0" id="r_aa3d0fc71d58968708478752881b119c0"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="#da/d60/structhook__execvpe">hook_execvpe</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa3d0fc71d58968708478752881b119c0">current_hook</a> = NULL</td></tr>
<tr class="separator:aa3d0fc71d58968708478752881b119c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3acf3f6a478abce6022fca033743eb37" id="r_a3acf3f6a478abce6022fca033743eb37"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="#a32654766df20ade7d77949ecf91a601e">hook_return_handler</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3acf3f6a478abce6022fca033743eb37">hook_return_cb</a> = NULL</td></tr>
<tr class="separator:a3acf3f6a478abce6022fca033743eb37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78ac6aa6bcda14a353a7bbc5d31f7d59" id="r_a78ac6aa6bcda14a353a7bbc5d31f7d59"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a78ac6aa6bcda14a353a7bbc5d31f7d59">hook_process_timeout</a></td></tr>
<tr class="separator:a78ac6aa6bcda14a353a7bbc5d31f7d59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86b744573f5030d3689a980f0006e23a" id="r_a86b744573f5030d3689a980f0006e23a"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dc/d56/uloop_8h.html#da/d43/structuloop__process">uloop_process</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a86b744573f5030d3689a980f0006e23a">hook_process</a></td></tr>
<tr class="separator:a86b744573f5030d3689a980f0006e23a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac967e6b320d955511a5e66e36f579622" id="r_ac967e6b320d955511a5e66e36f579622"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="#d5/db5/structmknod__args">mknod_args</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac967e6b320d955511a5e66e36f579622">default_devices</a> []</td></tr>
<tr class="separator:ac967e6b320d955511a5e66e36f579622"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45c79303cad1e1847d711c3946e93e85" id="r_a45c79303cad1e1847d711c3946e93e85"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a> [] = &quot;/tmp/ujail-XXXXXX&quot;</td></tr>
<tr class="separator:a45c79303cad1e1847d711c3946e93e85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ff424f2e02a1e7f39fc184b68114655" id="r_a3ff424f2e02a1e7f39fc184b68114655"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3ff424f2e02a1e7f39fc184b68114655">tmpovdir</a> [] = &quot;/tmp/ujail-overlay-XXXXXX&quot;</td></tr>
<tr class="separator:a3ff424f2e02a1e7f39fc184b68114655"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af71983723dc8d0eeea681bdda36ef470" id="r_af71983723dc8d0eeea681bdda36ef470"><td class="memItemLeft" align="right" valign="top">static mode_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af71983723dc8d0eeea681bdda36ef470">old_umask</a></td></tr>
<tr class="separator:af71983723dc8d0eeea681bdda36ef470"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49b89154fcd9cd0089f8c4d9df354d1a" id="r_a49b89154fcd9cd0089f8c4d9df354d1a"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a49b89154fcd9cd0089f8c4d9df354d1a">exit_from_child</a></td></tr>
<tr class="separator:a49b89154fcd9cd0089f8c4d9df354d1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a056d6abff975f4167ecd49617b5261ee" id="r_a056d6abff975f4167ecd49617b5261ee"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a056d6abff975f4167ecd49617b5261ee">jail_running</a> = 0</td></tr>
<tr class="separator:a056d6abff975f4167ecd49617b5261ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a176df615ae45a155128a6cc7ce716db8" id="r_a176df615ae45a155128a6cc7ce716db8"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a176df615ae45a155128a6cc7ce716db8">jail_return_code</a> = 0</td></tr>
<tr class="separator:a176df615ae45a155128a6cc7ce716db8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacb1a5c0057b0c69933163312d70e8fd" id="r_aacb1a5c0057b0c69933163312d70e8fd"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aacb1a5c0057b0c69933163312d70e8fd">jail_process_timeout</a></td></tr>
<tr class="separator:aacb1a5c0057b0c69933163312d70e8fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02d170ed9179a61ee4049ed3ec9eadf1" id="r_a02d170ed9179a61ee4049ed3ec9eadf1"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dc/d56/uloop_8h.html#da/d43/structuloop__process">uloop_process</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a></td></tr>
<tr class="separator:a02d170ed9179a61ee4049ed3ec9eadf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d6a59324899212d8504b098b976c894" id="r_a8d6a59324899212d8504b098b976c894"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8d6a59324899212d8504b098b976c894">pre_exec_timeout</a></td></tr>
<tr class="separator:a8d6a59324899212d8504b098b976c894"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a541f86a9c230bc87b5e7e2c83e2a6d34" id="r_a541f86a9c230bc87b5e7e2c83e2a6d34"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a541f86a9c230bc87b5e7e2c83e2a6d34">pipes</a> [4]</td></tr>
<tr class="separator:a541f86a9c230bc87b5e7e2c83e2a6d34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d120785be2672cecbeb820a30617ca3" id="r_a6d120785be2672cecbeb820a30617ca3"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6d120785be2672cecbeb820a30617ca3">oci_root_policy</a> []</td></tr>
<tr class="separator:a6d120785be2672cecbeb820a30617ca3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af55a6af095425b7521be3888c90b3e21" id="r_af55a6af095425b7521be3888c90b3e21"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af55a6af095425b7521be3888c90b3e21">oci_hook_policy</a> []</td></tr>
<tr class="separator:af55a6af095425b7521be3888c90b3e21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb41c6cf00c1c377b5cfbad669347e5f" id="r_afb41c6cf00c1c377b5cfbad669347e5f"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afb41c6cf00c1c377b5cfbad669347e5f">oci_hooks_policy</a> []</td></tr>
<tr class="separator:afb41c6cf00c1c377b5cfbad669347e5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a196324f45ead47d07841d5d61cae0d86" id="r_a196324f45ead47d07841d5d61cae0d86"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a196324f45ead47d07841d5d61cae0d86">oci_process_user_policy</a> []</td></tr>
<tr class="separator:a196324f45ead47d07841d5d61cae0d86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2016d906e4123e8386859e6fca23ce6" id="r_ab2016d906e4123e8386859e6fca23ce6"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab2016d906e4123e8386859e6fca23ce6">oci_process_rlimit_policy</a> []</td></tr>
<tr class="separator:ab2016d906e4123e8386859e6fca23ce6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd454d571192cedd0f8f512149290772" id="r_acd454d571192cedd0f8f512149290772"><td class="memItemLeft" align="right" valign="top">static const char *const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acd454d571192cedd0f8f512149290772">rlimit_names</a> [RLIM_NLIMITS]</td></tr>
<tr class="separator:acd454d571192cedd0f8f512149290772"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b6d333d023b819f033d8012b14a51b2" id="r_a1b6d333d023b819f033d8012b14a51b2"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1b6d333d023b819f033d8012b14a51b2">oci_process_policy</a> []</td></tr>
<tr class="separator:a1b6d333d023b819f033d8012b14a51b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14e8ea04063c41eec6c731c6db2f83ea" id="r_a14e8ea04063c41eec6c731c6db2f83ea"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a14e8ea04063c41eec6c731c6db2f83ea">oci_linux_namespace_policy</a> []</td></tr>
<tr class="separator:a14e8ea04063c41eec6c731c6db2f83ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a387d39c38022d5a883597493a72e4dc6" id="r_a387d39c38022d5a883597493a72e4dc6"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a387d39c38022d5a883597493a72e4dc6">oci_linux_uidgidmap_policy</a> []</td></tr>
<tr class="separator:a387d39c38022d5a883597493a72e4dc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20d3f1675d8e9e1f654efa2c1f974a91" id="r_a20d3f1675d8e9e1f654efa2c1f974a91"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a20d3f1675d8e9e1f654efa2c1f974a91">oci_devices_policy</a> []</td></tr>
<tr class="separator:a20d3f1675d8e9e1f654efa2c1f974a91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa2a41087e75522879f336667608dcf2" id="r_aaa2a41087e75522879f336667608dcf2"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaa2a41087e75522879f336667608dcf2">oci_linux_policy</a> []</td></tr>
<tr class="separator:aaa2a41087e75522879f336667608dcf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad03397b5f24381749f1fbc6509cf6425" id="r_ad03397b5f24381749f1fbc6509cf6425"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad03397b5f24381749f1fbc6509cf6425">oci_policy</a> []</td></tr>
<tr class="separator:ad03397b5f24381749f1fbc6509cf6425"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5e3a2bd12c4c9ed553bdacc21e97b65" id="r_af5e3a2bd12c4c9ed553bdacc21e97b65"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af5e3a2bd12c4c9ed553bdacc21e97b65">jail_oci_state</a> = <a class="el" href="#a97f905ac94bfebd46e50e32c7389e6eba7d55a02065f2ef38d43d0c0858bee940">OCI_STATE_CREATED</a></td></tr>
<tr class="separator:af5e3a2bd12c4c9ed553bdacc21e97b65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed82975b7037d5fcacde3c08e54189c1" id="r_aed82975b7037d5fcacde3c08e54189c1"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aed82975b7037d5fcacde3c08e54189c1">start_container_timeout</a></td></tr>
<tr class="separator:aed82975b7037d5fcacde3c08e54189c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cb0fbfbe5b1abc05003e2609fb7bc8c" id="r_a6cb0fbfbe5b1abc05003e2609fb7bc8c"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d8/d3c/blob_8h.html#d3/dcb/structblob__buf">blob_buf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6cb0fbfbe5b1abc05003e2609fb7bc8c">bb</a></td></tr>
<tr class="separator:a6cb0fbfbe5b1abc05003e2609fb7bc8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8acd133e16a1d2f660965034ad651713" id="r_a8acd133e16a1d2f660965034ad651713"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8acd133e16a1d2f660965034ad651713">container_kill_attrs</a> [<a class="el" href="#a9b29769343da78881f442e657eb62b6eaa656c9648d631f597fe6ab93da6c8420">__CONTAINER_KILL_ATTR_MAX</a>]</td></tr>
<tr class="separator:a8acd133e16a1d2f660965034ad651713"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af721c4badea07940f26ef4e8efa88e51" id="r_af721c4badea07940f26ef4e8efa88e51"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d9/d00/ubusd__obj_8h.html#d9/d8b/structubus__method">ubus_method</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af721c4badea07940f26ef4e8efa88e51">container_methods</a> []</td></tr>
<tr class="separator:af721c4badea07940f26ef4e8efa88e51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b008aad908bf79f765da1b5d056324e" id="r_a1b008aad908bf79f765da1b5d056324e"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d9/d00/ubusd__obj_8h.html#d4/d66/structubus__object__type">ubus_object_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1b008aad908bf79f765da1b5d056324e">container_object_type</a></td></tr>
<tr class="separator:a1b008aad908bf79f765da1b5d056324e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a450e41d3094b10b8997ca48a290d437f" id="r_a450e41d3094b10b8997ca48a290d437f"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d9/d00/ubusd__obj_8h.html#d6/d75/structubus__object">ubus_object</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a450e41d3094b10b8997ca48a290d437f">container_object</a></td></tr>
<tr class="separator:a450e41d3094b10b8997ca48a290d437f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6910512e7075298176a67f026d6c25e8" id="r_a6910512e7075298176a67f026d6c25e8"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6910512e7075298176a67f026d6c25e8">post_main_timeout</a></td></tr>
<tr class="separator:a6910512e7075298176a67f026d6c25e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac256367002c667bedef320ba8eff2aa0" id="r_ac256367002c667bedef320ba8eff2aa0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac256367002c667bedef320ba8eff2aa0">netns_fd</a></td></tr>
<tr class="separator:ac256367002c667bedef320ba8eff2aa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c32db21b181d5c2e2bc3b98674bd8cf" id="r_a3c32db21b181d5c2e2bc3b98674bd8cf"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3c32db21b181d5c2e2bc3b98674bd8cf">pidns_fd</a></td></tr>
<tr class="separator:a3c32db21b181d5c2e2bc3b98674bd8cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<hr/><h2 class="groupheader">Class Documentation</h2>
<a name="da/d60/structhook__execvpe" id="da/d60/structhook__execvpe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#da/d60/structhook__execvpe">&#9670;&#160;</a></span>hook_execvpe</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct hook_execvpe</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00076">76</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
</div><div class="dynheader">
Collaboration diagram for hook_execvpe:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de3/structhook__execvpe__coll__graph.png" border="0" usemap="#ahook__execvpe_coll__map" alt="Collaboration graph"/></div>
<map name="ahook__execvpe_coll__map" id="ahook__execvpe_coll__map">
<area shape="rect" title=" " alt="" coords="5,156,157,190"/>
<area shape="rect" title=" " alt="" coords="11,5,74,39"/>
<area shape="poly" title=" " alt="" coords="39,54,38,92,46,131,63,154,58,157,41,133,33,92,34,54"/>
<area shape="rect" title=" " alt="" coords="97,5,142,39"/>
<area shape="poly" title=" " alt="" coords="114,55,88,156,83,155,109,53"/>
</map>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Class Members</th></tr>
<tr><td class="fieldtype">
<a id="acff24ad419db504adfdff5c62987cd41" name="acff24ad419db504adfdff5c62987cd41"></a>char **</td>
<td class="fieldname">
argv</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a644aeb00b6756f5c6d4e3fdcc8263405" name="a644aeb00b6756f5c6d4e3fdcc8263405"></a>char **</td>
<td class="fieldname">
envp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac39f04640b0f1f1967ffcd5aa5f158ae" name="ac39f04640b0f1f1967ffcd5aa5f158ae"></a>char *</td>
<td class="fieldname">
file</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a37421f3b655c25324cfed6f8c5f23476" name="a37421f3b655c25324cfed6f8c5f23476"></a>int</td>
<td class="fieldname">
timeout</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="de/d02/structsysctl__val" id="de/d02/structsysctl__val"></a>
<h2 class="memtitle"><span class="permalink"><a href="#de/d02/structsysctl__val">&#9670;&#160;</a></span>sysctl_val</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct sysctl_val</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00083">83</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
</div><div class="dynheader">
Collaboration diagram for sysctl_val:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d77/structsysctl__val__coll__graph.png" border="0" usemap="#asysctl__val_coll__map" alt="Collaboration graph"/></div>
<map name="asysctl__val_coll__map" id="asysctl__val_coll__map">
<area shape="rect" title=" " alt="" coords="5,133,116,167"/>
<area shape="rect" title=" " alt="" coords="29,5,92,39"/>
<area shape="poly" title=" " alt="" coords="63,54,63,132,58,132,58,54"/>
</map>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Class Members</th></tr>
<tr><td class="fieldtype">
<a id="a1452a5b73690d8d43630e382be5c6157" name="a1452a5b73690d8d43630e382be5c6157"></a>char *</td>
<td class="fieldname">
entry</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0850680760799cb6d01d7051e98ae933" name="a0850680760799cb6d01d7051e98ae933"></a>char *</td>
<td class="fieldname">
value</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="d5/db5/structmknod__args" id="d5/db5/structmknod__args"></a>
<h2 class="memtitle"><span class="permalink"><a href="#d5/db5/structmknod__args">&#9670;&#160;</a></span>mknod_args</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct mknod_args</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00088">88</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
</div><div class="dynheader">
Collaboration diagram for mknod_args:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d10/structmknod__args__coll__graph.png" border="0" usemap="#amknod__args_coll__map" alt="Collaboration graph"/></div>
<map name="amknod__args_coll__map" id="amknod__args_coll__map">
<area shape="rect" title=" " alt="" coords="173,110,308,144"/>
<area shape="rect" title=" " alt="" coords="5,5,68,39"/>
<area shape="poly" title=" " alt="" coords="62,49,83,67,106,84,139,99,173,110,172,115,137,104,103,88,79,72,59,53"/>
<area shape="rect" title=" " alt="" coords="92,5,181,39"/>
<area shape="poly" title=" " alt="" coords="154,51,179,84,210,107,207,112,175,88,150,54"/>
<area shape="rect" title=" " alt="" coords="205,5,276,39"/>
<area shape="poly" title=" " alt="" coords="243,55,243,109,238,109,238,55"/>
<area shape="rect" title=" " alt="" coords="301,5,367,39"/>
<area shape="poly" title=" " alt="" coords="316,53,288,88,263,111,259,107,284,84,312,50"/>
<area shape="rect" title=" " alt="" coords="391,5,458,39"/>
<area shape="poly" title=" " alt="" coords="397,51,344,88,292,112,290,107,342,84,394,47"/>
</map>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Class Members</th></tr>
<tr><td class="fieldtype">
<a id="a1e856bfa3ae2ac3a7c555a66140bea42" name="a1e856bfa3ae2ac3a7c555a66140bea42"></a>dev_t</td>
<td class="fieldname">
dev</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a5d2aa9579d69f85c4762141947bdb3e1" name="a5d2aa9579d69f85c4762141947bdb3e1"></a>gid_t</td>
<td class="fieldname">
gid</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3b9b0f5b6acc5a3df5e4c7eb0f686ef6" name="a3b9b0f5b6acc5a3df5e4c7eb0f686ef6"></a>mode_t</td>
<td class="fieldname">
mode</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad0d8de31878303df1c911492dfade935" name="ad0d8de31878303df1c911492dfade935"></a>char *</td>
<td class="fieldname">
path</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a12ad74a7a8c429f2cbd4341dbc0fcea7" name="a12ad74a7a8c429f2cbd4341dbc0fcea7"></a>uid_t</td>
<td class="fieldname">
uid</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="d3/d32/structenv__e" id="d3/d32/structenv__e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#d3/d32/structenv__e">&#9670;&#160;</a></span>env_e</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct env_e</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02578">2578</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
</div><div class="dynheader">
Collaboration diagram for env_e:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d54/structenv__e__coll__graph.png" border="0" usemap="#aenv__e_coll__map" alt="Collaboration graph"/></div>
<map name="aenv__e_coll__map" id="aenv__e_coll__map">
<area shape="rect" title=" " alt="" coords="109,122,184,156"/>
<area shape="rect" href="../../da/d23/list_8h.html#d9/d93/structlist__head" title=" " alt="" coords="5,12,109,45"/>
<area shape="poly" title=" " alt="" coords="82,56,135,120,131,124,78,59"/>
<area shape="poly" title=" " alt="" coords="125,18,132,22,135,29,127,38,109,42,108,37,125,34,130,28,128,25,123,22"/>
<area shape="rect" title=" " alt="" coords="203,12,266,45"/>
<area shape="poly" title=" " alt="" coords="214,59,161,123,157,120,210,56"/>
</map>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Class Members</th></tr>
<tr><td class="fieldtype">
<a id="a080368a08334825ac605d93aa717b4dc" name="a080368a08334825ac605d93aa717b4dc"></a>char *</td>
<td class="fieldname">
envarg</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a4bdac4524a242f6347c1bfe0cd88e3b4" name="a4bdac4524a242f6347c1bfe0cd88e3b4"></a>struct <a class="el" href="../../da/d23/list_8h.html#d9/d93/structlist__head">list_head</a></td>
<td class="fieldname">
list</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="d0/dfd/struct_8setns" id="d0/dfd/struct_8setns"></a>
<h2 class="memtitle"><span class="permalink"><a href="#d0/dfd/struct_8setns">&#9670;&#160;</a></span>.setns</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct .setns</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00117">117</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Class Members</th></tr>
<tr><td class="fieldtype">
<a id="a773614bc6776c03c0f89e62b76a3b22b" name="a773614bc6776c03c0f89e62b76a3b22b"></a>int</td>
<td class="fieldname">
cgroup</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a5ac8bf6fc7652745573f0ef24a8ab513" name="a5ac8bf6fc7652745573f0ef24a8ab513"></a>int</td>
<td class="fieldname">
ipc</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a40fa73c9d0083043c6576dd2b40511e4" name="a40fa73c9d0083043c6576dd2b40511e4"></a>int</td>
<td class="fieldname">
net</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af01a37d157918910f2035b2af81ea4e1" name="af01a37d157918910f2035b2af81ea4e1"></a>int</td>
<td class="fieldname">
ns</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0db3209e1adc6d67be435a81baf9a66e" name="a0db3209e1adc6d67be435a81baf9a66e"></a>int</td>
<td class="fieldname">
pid</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aee11cbb19052e40b07aac0ca060c23ee" name="aee11cbb19052e40b07aac0ca060c23ee"></a>int</td>
<td class="fieldname">
user</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a695d878bda76c75ee101da0497b7ad93" name="a695d878bda76c75ee101da0497b7ad93"></a>int</td>
<td class="fieldname">
uts</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="d9/df6/struct_8hooks" id="d9/df6/struct_8hooks"></a>
<h2 class="memtitle"><span class="permalink"><a href="#d9/df6/struct_8hooks">&#9670;&#160;</a></span>.hooks</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct .hooks</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00142">142</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Class Members</th></tr>
<tr><td class="fieldtype">
<a id="a05d62d9ed199c16a86d4e8e4bec47e5c" name="a05d62d9ed199c16a86d4e8e4bec47e5c"></a>struct <a class="el" href="#da/d60/structhook__execvpe">hook_execvpe</a> **</td>
<td class="fieldname">
createContainer</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a64cb78b1b4ac7d9afa400e1be3f42937" name="a64cb78b1b4ac7d9afa400e1be3f42937"></a>struct <a class="el" href="#da/d60/structhook__execvpe">hook_execvpe</a> **</td>
<td class="fieldname">
createRuntime</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a44ea3e34bb19c3fa9f2454a76acbd0bb" name="a44ea3e34bb19c3fa9f2454a76acbd0bb"></a>struct <a class="el" href="#da/d60/structhook__execvpe">hook_execvpe</a> **</td>
<td class="fieldname">
poststart</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7fc5e4103e6942ab502a0ecd1ae7fd13" name="a7fc5e4103e6942ab502a0ecd1ae7fd13"></a>struct <a class="el" href="#da/d60/structhook__execvpe">hook_execvpe</a> **</td>
<td class="fieldname">
poststop</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0093b53d565c2a6af89c20b13affebed" name="a0093b53d565c2a6af89c20b13affebed"></a>struct <a class="el" href="#da/d60/structhook__execvpe">hook_execvpe</a> **</td>
<td class="fieldname">
startContainer</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a369266c24eacffb87046522897a570d5" name="a369266c24eacffb87046522897a570d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a369266c24eacffb87046522897a570d5">&#9670;&#160;</a></span>_GNU_SOURCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _GNU_SOURCE</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00015">15</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

</div>
</div>
<a id="a9d5d88148a26086567c3731e2e5e110a" name="a9d5d88148a26086567c3731e2e5e110a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d5d88148a26086567c3731e2e5e110a">&#9670;&#160;</a></span>CLONE_NEWCGROUP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CLONE_NEWCGROUP&#160;&#160;&#160;0x02000000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00068">68</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01161">exec_jail()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01041">get_namespace_fd()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02583">main()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l01805">resolve_nstype()</a>.</p>

</div>
</div>
<a id="aa031dc6712613a6c64f5d8b26eb1baae" name="aa031dc6712613a6c64f5d8b26eb1baae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa031dc6712613a6c64f5d8b26eb1baae">&#9670;&#160;</a></span>makedev</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define makedev</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>y</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    ( \</div>
<div class="line">    (((x)&amp;0xfffff000ULL) &lt;&lt; 32) | \</div>
<div class="line">    (((x)&amp;0x00000fffULL) &lt;&lt; 8) | \</div>
<div class="line">    (((y)&amp;0xffffff00ULL) &lt;&lt; 12) | \</div>
<div class="line">    (((y)&amp;0x000000ffULL)) )</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00575">575</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  575</span><span class="preprocessor">#define makedev(x,y) ( \</span></div>
<div class="line"><span class="lineno">  576</span><span class="preprocessor">    (((x)&amp;0xfffff000ULL) &lt;&lt; 32) | \</span></div>
<div class="line"><span class="lineno">  577</span><span class="preprocessor">    (((x)&amp;0x00000fffULL) &lt;&lt; 8) | \</span></div>
<div class="line"><span class="lineno">  578</span><span class="preprocessor">    (((y)&amp;0xffffff00ULL) &lt;&lt; 12) | \</span></div>
<div class="line"><span class="lineno">  579</span><span class="preprocessor">    (((y)&amp;0x000000ffULL)) )</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d5/db1/early_8c_source.html#l00031">early_dev()</a>, <a class="el" href="../../da/d37/hotplug_8c_source.html#l00136">handle_makedev()</a>, <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00049">make_dev()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l02053">parseOCIdevices()</a>.</p>

</div>
</div>
<a id="a99f47b784bea630430c5e178a336daa4" name="a99f47b784bea630430c5e178a336daa4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99f47b784bea630430c5e178a336daa4">&#9670;&#160;</a></span>MAX_ENVP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_ENVP&#160;&#160;&#160;64</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00958">958</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00959">build_envp()</a>.</p>

</div>
</div>
<a id="a1ee05432b602a194c5a7cfb5043a5824" name="a1ee05432b602a194c5a7cfb5043a5824"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ee05432b602a194c5a7cfb5043a5824">&#9670;&#160;</a></span>OCI_VERSION_STRING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OCI_VERSION_STRING&#160;&#160;&#160;&quot;1.0.2&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00074">74</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02438">handle_state()</a>.</p>

</div>
</div>
<a id="a5f7f8ba02a5383b3b7f9dd28f8c5e8b8" name="a5f7f8ba02a5383b3b7f9dd28f8c5e8b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f7f8ba02a5383b3b7f9dd28f8c5e8b8">&#9670;&#160;</a></span>OPT_ARGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OPT_ARGS&#160;&#160;&#160;&quot;cC:d:e:EfFG:h:ij:J:ln:NoO:pP:r:R:sS:uU:w:t:T:y&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00072">72</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02583">main()</a>.</p>

</div>
</div>
<a id="a6423a880df59733d2d9b509c7718d3a9" name="a6423a880df59733d2d9b509c7718d3a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6423a880df59733d2d9b509c7718d3a9">&#9670;&#160;</a></span>STACK_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STACK_SIZE&#160;&#160;&#160;(1024 * 1024)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00071">71</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a32654766df20ade7d77949ecf91a601e" name="a32654766df20ade7d77949ecf91a601e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32654766df20ade7d77949ecf91a601e">&#9670;&#160;</a></span>hook_return_handler</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* hook_return_handler) (void)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00428">428</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="afeaa6456e370d2eb59f5e139d9f8b00c" name="afeaa6456e370d2eb59f5e139d9f8b00c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeaa6456e370d2eb59f5e139d9f8b00c">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="afeaa6456e370d2eb59f5e139d9f8b00ca19d90db86bae071a8aa290b4aa7bbb1a" name="afeaa6456e370d2eb59f5e139d9f8b00ca19d90db86bae071a8aa290b4aa7bbb1a"></a>OCI_ROOT_PATH&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afeaa6456e370d2eb59f5e139d9f8b00ca5de1f8b436ee1fcb78d7aa9a8e2c5990" name="afeaa6456e370d2eb59f5e139d9f8b00ca5de1f8b436ee1fcb78d7aa9a8e2c5990"></a>OCI_ROOT_READONLY&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afeaa6456e370d2eb59f5e139d9f8b00ca1736cc68a5a38e1186ffbffd828bb798" name="afeaa6456e370d2eb59f5e139d9f8b00ca1736cc68a5a38e1186ffbffd828bb798"></a>__OCI_ROOT_MAX&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01365">1365</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1365</span>     {</div>
<div class="line"><span class="lineno"> 1366</span>    <a class="code hl_enumvalue" href="#afeaa6456e370d2eb59f5e139d9f8b00ca19d90db86bae071a8aa290b4aa7bbb1a">OCI_ROOT_PATH</a>,</div>
<div class="line"><span class="lineno"> 1367</span>    <a class="code hl_enumvalue" href="#afeaa6456e370d2eb59f5e139d9f8b00ca5de1f8b436ee1fcb78d7aa9a8e2c5990">OCI_ROOT_READONLY</a>,</div>
<div class="line"><span class="lineno"> 1368</span>    <a class="code hl_enumvalue" href="#afeaa6456e370d2eb59f5e139d9f8b00ca1736cc68a5a38e1186ffbffd828bb798">__OCI_ROOT_MAX</a>,</div>
<div class="line"><span class="lineno"> 1369</span>};</div>
<div class="ttc" id="ajail_8c_html_afeaa6456e370d2eb59f5e139d9f8b00ca1736cc68a5a38e1186ffbffd828bb798"><div class="ttname"><a href="#afeaa6456e370d2eb59f5e139d9f8b00ca1736cc68a5a38e1186ffbffd828bb798">__OCI_ROOT_MAX</a></div><div class="ttdeci">@ __OCI_ROOT_MAX</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01368">jail.c:1368</a></div></div>
<div class="ttc" id="ajail_8c_html_afeaa6456e370d2eb59f5e139d9f8b00ca19d90db86bae071a8aa290b4aa7bbb1a"><div class="ttname"><a href="#afeaa6456e370d2eb59f5e139d9f8b00ca19d90db86bae071a8aa290b4aa7bbb1a">OCI_ROOT_PATH</a></div><div class="ttdeci">@ OCI_ROOT_PATH</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01366">jail.c:1366</a></div></div>
<div class="ttc" id="ajail_8c_html_afeaa6456e370d2eb59f5e139d9f8b00ca5de1f8b436ee1fcb78d7aa9a8e2c5990"><div class="ttname"><a href="#afeaa6456e370d2eb59f5e139d9f8b00ca5de1f8b436ee1fcb78d7aa9a8e2c5990">OCI_ROOT_READONLY</a></div><div class="ttdeci">@ OCI_ROOT_READONLY</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01367">jail.c:1367</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a26c0312ac66c00f31cf886616c48afa2" name="a26c0312ac66c00f31cf886616c48afa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26c0312ac66c00f31cf886616c48afa2">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a26c0312ac66c00f31cf886616c48afa2ab8282160b544f18b6b51d625957979a5" name="a26c0312ac66c00f31cf886616c48afa2ab8282160b544f18b6b51d625957979a5"></a>OCI_HOOK_PATH&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a26c0312ac66c00f31cf886616c48afa2a95599181fee35581a14f13681c2cf66b" name="a26c0312ac66c00f31cf886616c48afa2a95599181fee35581a14f13681c2cf66b"></a>OCI_HOOK_ARGS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a26c0312ac66c00f31cf886616c48afa2a36845abacde1267489e7ef578cee4460" name="a26c0312ac66c00f31cf886616c48afa2a36845abacde1267489e7ef578cee4460"></a>OCI_HOOK_ENV&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a26c0312ac66c00f31cf886616c48afa2abb5b45a58a6262ff75e12bd0fe9d888d" name="a26c0312ac66c00f31cf886616c48afa2abb5b45a58a6262ff75e12bd0fe9d888d"></a>OCI_HOOK_TIMEOUT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a26c0312ac66c00f31cf886616c48afa2a54921720b398badc128a50954e58f14b" name="a26c0312ac66c00f31cf886616c48afa2a54921720b398badc128a50954e58f14b"></a>__OCI_HOOK_MAX&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01416">1416</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1416</span>     {</div>
<div class="line"><span class="lineno"> 1417</span>    <a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2ab8282160b544f18b6b51d625957979a5">OCI_HOOK_PATH</a>,</div>
<div class="line"><span class="lineno"> 1418</span>    <a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2a95599181fee35581a14f13681c2cf66b">OCI_HOOK_ARGS</a>,</div>
<div class="line"><span class="lineno"> 1419</span>    <a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2a36845abacde1267489e7ef578cee4460">OCI_HOOK_ENV</a>,</div>
<div class="line"><span class="lineno"> 1420</span>    <a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2abb5b45a58a6262ff75e12bd0fe9d888d">OCI_HOOK_TIMEOUT</a>,</div>
<div class="line"><span class="lineno"> 1421</span>    <a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2a54921720b398badc128a50954e58f14b">__OCI_HOOK_MAX</a>,</div>
<div class="line"><span class="lineno"> 1422</span>};</div>
<div class="ttc" id="ajail_8c_html_a26c0312ac66c00f31cf886616c48afa2a36845abacde1267489e7ef578cee4460"><div class="ttname"><a href="#a26c0312ac66c00f31cf886616c48afa2a36845abacde1267489e7ef578cee4460">OCI_HOOK_ENV</a></div><div class="ttdeci">@ OCI_HOOK_ENV</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01419">jail.c:1419</a></div></div>
<div class="ttc" id="ajail_8c_html_a26c0312ac66c00f31cf886616c48afa2a54921720b398badc128a50954e58f14b"><div class="ttname"><a href="#a26c0312ac66c00f31cf886616c48afa2a54921720b398badc128a50954e58f14b">__OCI_HOOK_MAX</a></div><div class="ttdeci">@ __OCI_HOOK_MAX</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01421">jail.c:1421</a></div></div>
<div class="ttc" id="ajail_8c_html_a26c0312ac66c00f31cf886616c48afa2a95599181fee35581a14f13681c2cf66b"><div class="ttname"><a href="#a26c0312ac66c00f31cf886616c48afa2a95599181fee35581a14f13681c2cf66b">OCI_HOOK_ARGS</a></div><div class="ttdeci">@ OCI_HOOK_ARGS</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01418">jail.c:1418</a></div></div>
<div class="ttc" id="ajail_8c_html_a26c0312ac66c00f31cf886616c48afa2ab8282160b544f18b6b51d625957979a5"><div class="ttname"><a href="#a26c0312ac66c00f31cf886616c48afa2ab8282160b544f18b6b51d625957979a5">OCI_HOOK_PATH</a></div><div class="ttdeci">@ OCI_HOOK_PATH</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01417">jail.c:1417</a></div></div>
<div class="ttc" id="ajail_8c_html_a26c0312ac66c00f31cf886616c48afa2abb5b45a58a6262ff75e12bd0fe9d888d"><div class="ttname"><a href="#a26c0312ac66c00f31cf886616c48afa2abb5b45a58a6262ff75e12bd0fe9d888d">OCI_HOOK_TIMEOUT</a></div><div class="ttdeci">@ OCI_HOOK_TIMEOUT</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01420">jail.c:1420</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aecd12a18eeb0ee701fc7b0efd5068266" name="aecd12a18eeb0ee701fc7b0efd5068266"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecd12a18eeb0ee701fc7b0efd5068266">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aecd12a18eeb0ee701fc7b0efd5068266af862a8090db6d0f4c881c11e44f62f5c" name="aecd12a18eeb0ee701fc7b0efd5068266af862a8090db6d0f4c881c11e44f62f5c"></a>OCI_HOOKS_PRESTART&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aecd12a18eeb0ee701fc7b0efd5068266a7cbf2aaa3aff3ed3c5619f1586102654" name="aecd12a18eeb0ee701fc7b0efd5068266a7cbf2aaa3aff3ed3c5619f1586102654"></a>OCI_HOOKS_CREATERUNTIME&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aecd12a18eeb0ee701fc7b0efd5068266a81b8b437bed6d97716be572758d636f7" name="aecd12a18eeb0ee701fc7b0efd5068266a81b8b437bed6d97716be572758d636f7"></a>OCI_HOOKS_CREATECONTAINER&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aecd12a18eeb0ee701fc7b0efd5068266a19b67b62f1e805e385a650b7a667ab2f" name="aecd12a18eeb0ee701fc7b0efd5068266a19b67b62f1e805e385a650b7a667ab2f"></a>OCI_HOOKS_STARTCONTAINER&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aecd12a18eeb0ee701fc7b0efd5068266a81b23e202b544376a4150805e7032081" name="aecd12a18eeb0ee701fc7b0efd5068266a81b23e202b544376a4150805e7032081"></a>OCI_HOOKS_POSTSTART&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aecd12a18eeb0ee701fc7b0efd5068266a038ea885ca857034d8682acb2ef0aa74" name="aecd12a18eeb0ee701fc7b0efd5068266a038ea885ca857034d8682acb2ef0aa74"></a>OCI_HOOKS_POSTSTOP&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aecd12a18eeb0ee701fc7b0efd5068266a0bdad5a576873f1be7eab59337d40892" name="aecd12a18eeb0ee701fc7b0efd5068266a0bdad5a576873f1be7eab59337d40892"></a>__OCI_HOOKS_MAX&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01499">1499</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1499</span>     {</div>
<div class="line"><span class="lineno"> 1500</span>    <a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266af862a8090db6d0f4c881c11e44f62f5c">OCI_HOOKS_PRESTART</a>,</div>
<div class="line"><span class="lineno"> 1501</span>    <a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a7cbf2aaa3aff3ed3c5619f1586102654">OCI_HOOKS_CREATERUNTIME</a>,</div>
<div class="line"><span class="lineno"> 1502</span>    <a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a81b8b437bed6d97716be572758d636f7">OCI_HOOKS_CREATECONTAINER</a>,</div>
<div class="line"><span class="lineno"> 1503</span>    <a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a19b67b62f1e805e385a650b7a667ab2f">OCI_HOOKS_STARTCONTAINER</a>,</div>
<div class="line"><span class="lineno"> 1504</span>    <a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a81b23e202b544376a4150805e7032081">OCI_HOOKS_POSTSTART</a>,</div>
<div class="line"><span class="lineno"> 1505</span>    <a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a038ea885ca857034d8682acb2ef0aa74">OCI_HOOKS_POSTSTOP</a>,</div>
<div class="line"><span class="lineno"> 1506</span>    <a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a0bdad5a576873f1be7eab59337d40892">__OCI_HOOKS_MAX</a>,</div>
<div class="line"><span class="lineno"> 1507</span>};</div>
<div class="ttc" id="ajail_8c_html_aecd12a18eeb0ee701fc7b0efd5068266a038ea885ca857034d8682acb2ef0aa74"><div class="ttname"><a href="#aecd12a18eeb0ee701fc7b0efd5068266a038ea885ca857034d8682acb2ef0aa74">OCI_HOOKS_POSTSTOP</a></div><div class="ttdeci">@ OCI_HOOKS_POSTSTOP</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01505">jail.c:1505</a></div></div>
<div class="ttc" id="ajail_8c_html_aecd12a18eeb0ee701fc7b0efd5068266a0bdad5a576873f1be7eab59337d40892"><div class="ttname"><a href="#aecd12a18eeb0ee701fc7b0efd5068266a0bdad5a576873f1be7eab59337d40892">__OCI_HOOKS_MAX</a></div><div class="ttdeci">@ __OCI_HOOKS_MAX</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01506">jail.c:1506</a></div></div>
<div class="ttc" id="ajail_8c_html_aecd12a18eeb0ee701fc7b0efd5068266a19b67b62f1e805e385a650b7a667ab2f"><div class="ttname"><a href="#aecd12a18eeb0ee701fc7b0efd5068266a19b67b62f1e805e385a650b7a667ab2f">OCI_HOOKS_STARTCONTAINER</a></div><div class="ttdeci">@ OCI_HOOKS_STARTCONTAINER</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01503">jail.c:1503</a></div></div>
<div class="ttc" id="ajail_8c_html_aecd12a18eeb0ee701fc7b0efd5068266a7cbf2aaa3aff3ed3c5619f1586102654"><div class="ttname"><a href="#aecd12a18eeb0ee701fc7b0efd5068266a7cbf2aaa3aff3ed3c5619f1586102654">OCI_HOOKS_CREATERUNTIME</a></div><div class="ttdeci">@ OCI_HOOKS_CREATERUNTIME</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01501">jail.c:1501</a></div></div>
<div class="ttc" id="ajail_8c_html_aecd12a18eeb0ee701fc7b0efd5068266a81b23e202b544376a4150805e7032081"><div class="ttname"><a href="#aecd12a18eeb0ee701fc7b0efd5068266a81b23e202b544376a4150805e7032081">OCI_HOOKS_POSTSTART</a></div><div class="ttdeci">@ OCI_HOOKS_POSTSTART</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01504">jail.c:1504</a></div></div>
<div class="ttc" id="ajail_8c_html_aecd12a18eeb0ee701fc7b0efd5068266a81b8b437bed6d97716be572758d636f7"><div class="ttname"><a href="#aecd12a18eeb0ee701fc7b0efd5068266a81b8b437bed6d97716be572758d636f7">OCI_HOOKS_CREATECONTAINER</a></div><div class="ttdeci">@ OCI_HOOKS_CREATECONTAINER</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01502">jail.c:1502</a></div></div>
<div class="ttc" id="ajail_8c_html_aecd12a18eeb0ee701fc7b0efd5068266af862a8090db6d0f4c881c11e44f62f5c"><div class="ttname"><a href="#aecd12a18eeb0ee701fc7b0efd5068266af862a8090db6d0f4c881c11e44f62f5c">OCI_HOOKS_PRESTART</a></div><div class="ttdeci">@ OCI_HOOKS_PRESTART</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01500">jail.c:1500</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8420dba71b9cc240cf981b0bef892004" name="a8420dba71b9cc240cf981b0bef892004"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8420dba71b9cc240cf981b0bef892004">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a8420dba71b9cc240cf981b0bef892004a727b3caff3f4f9c0226fde9a4add449b" name="a8420dba71b9cc240cf981b0bef892004a727b3caff3f4f9c0226fde9a4add449b"></a>OCI_PROCESS_USER_UID&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8420dba71b9cc240cf981b0bef892004aaa9867bd15bf6df72a6afbbca29bb0ea" name="a8420dba71b9cc240cf981b0bef892004aaa9867bd15bf6df72a6afbbca29bb0ea"></a>OCI_PROCESS_USER_GID&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8420dba71b9cc240cf981b0bef892004abebde02748010be1f45e9986546d7d0c" name="a8420dba71b9cc240cf981b0bef892004abebde02748010be1f45e9986546d7d0c"></a>OCI_PROCESS_USER_UMASK&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8420dba71b9cc240cf981b0bef892004a65c968275ec1a7c4233995f829810b73" name="a8420dba71b9cc240cf981b0bef892004a65c968275ec1a7c4233995f829810b73"></a>OCI_PROCESS_USER_ADDITIONALGIDS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8420dba71b9cc240cf981b0bef892004a9b36524395a911eb0d37dfbf132f5f10" name="a8420dba71b9cc240cf981b0bef892004a9b36524395a911eb0d37dfbf132f5f10"></a>__OCI_PROCESS_USER_MAX&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01573">1573</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1573</span>     {</div>
<div class="line"><span class="lineno"> 1574</span>    <a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004a727b3caff3f4f9c0226fde9a4add449b">OCI_PROCESS_USER_UID</a>,</div>
<div class="line"><span class="lineno"> 1575</span>    <a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004aaa9867bd15bf6df72a6afbbca29bb0ea">OCI_PROCESS_USER_GID</a>,</div>
<div class="line"><span class="lineno"> 1576</span>    <a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004abebde02748010be1f45e9986546d7d0c">OCI_PROCESS_USER_UMASK</a>,</div>
<div class="line"><span class="lineno"> 1577</span>    <a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004a65c968275ec1a7c4233995f829810b73">OCI_PROCESS_USER_ADDITIONALGIDS</a>,</div>
<div class="line"><span class="lineno"> 1578</span>    <a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004a9b36524395a911eb0d37dfbf132f5f10">__OCI_PROCESS_USER_MAX</a>,</div>
<div class="line"><span class="lineno"> 1579</span>};</div>
<div class="ttc" id="ajail_8c_html_a8420dba71b9cc240cf981b0bef892004a65c968275ec1a7c4233995f829810b73"><div class="ttname"><a href="#a8420dba71b9cc240cf981b0bef892004a65c968275ec1a7c4233995f829810b73">OCI_PROCESS_USER_ADDITIONALGIDS</a></div><div class="ttdeci">@ OCI_PROCESS_USER_ADDITIONALGIDS</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01577">jail.c:1577</a></div></div>
<div class="ttc" id="ajail_8c_html_a8420dba71b9cc240cf981b0bef892004a727b3caff3f4f9c0226fde9a4add449b"><div class="ttname"><a href="#a8420dba71b9cc240cf981b0bef892004a727b3caff3f4f9c0226fde9a4add449b">OCI_PROCESS_USER_UID</a></div><div class="ttdeci">@ OCI_PROCESS_USER_UID</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01574">jail.c:1574</a></div></div>
<div class="ttc" id="ajail_8c_html_a8420dba71b9cc240cf981b0bef892004a9b36524395a911eb0d37dfbf132f5f10"><div class="ttname"><a href="#a8420dba71b9cc240cf981b0bef892004a9b36524395a911eb0d37dfbf132f5f10">__OCI_PROCESS_USER_MAX</a></div><div class="ttdeci">@ __OCI_PROCESS_USER_MAX</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01578">jail.c:1578</a></div></div>
<div class="ttc" id="ajail_8c_html_a8420dba71b9cc240cf981b0bef892004aaa9867bd15bf6df72a6afbbca29bb0ea"><div class="ttname"><a href="#a8420dba71b9cc240cf981b0bef892004aaa9867bd15bf6df72a6afbbca29bb0ea">OCI_PROCESS_USER_GID</a></div><div class="ttdeci">@ OCI_PROCESS_USER_GID</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01575">jail.c:1575</a></div></div>
<div class="ttc" id="ajail_8c_html_a8420dba71b9cc240cf981b0bef892004abebde02748010be1f45e9986546d7d0c"><div class="ttname"><a href="#a8420dba71b9cc240cf981b0bef892004abebde02748010be1f45e9986546d7d0c">OCI_PROCESS_USER_UMASK</a></div><div class="ttdeci">@ OCI_PROCESS_USER_UMASK</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01576">jail.c:1576</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afb24d298ddd4bc4ff61aa333f07a574a" name="afb24d298ddd4bc4ff61aa333f07a574a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb24d298ddd4bc4ff61aa333f07a574a">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="afb24d298ddd4bc4ff61aa333f07a574aa82cefaa500e6667fae114a7a427a70e8" name="afb24d298ddd4bc4ff61aa333f07a574aa82cefaa500e6667fae114a7a427a70e8"></a>OCI_PROCESS_RLIMIT_TYPE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afb24d298ddd4bc4ff61aa333f07a574aa54aef840a8921bd694bd098d26909f5b" name="afb24d298ddd4bc4ff61aa333f07a574aa54aef840a8921bd694bd098d26909f5b"></a>OCI_PROCESS_RLIMIT_SOFT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afb24d298ddd4bc4ff61aa333f07a574aa7c4a1dc8832ab814f8153330af5c53c0" name="afb24d298ddd4bc4ff61aa333f07a574aa7c4a1dc8832ab814f8153330af5c53c0"></a>OCI_PROCESS_RLIMIT_HARD&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afb24d298ddd4bc4ff61aa333f07a574aa14fdf8fb6dafa566ba443a7c41296bab" name="afb24d298ddd4bc4ff61aa333f07a574aa14fdf8fb6dafa566ba443a7c41296bab"></a>__OCI_PROCESS_RLIMIT_MAX&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01640">1640</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1640</span>     {</div>
<div class="line"><span class="lineno"> 1641</span>    <a class="code hl_enumvalue" href="#afb24d298ddd4bc4ff61aa333f07a574aa82cefaa500e6667fae114a7a427a70e8">OCI_PROCESS_RLIMIT_TYPE</a>,</div>
<div class="line"><span class="lineno"> 1642</span>    <a class="code hl_enumvalue" href="#afb24d298ddd4bc4ff61aa333f07a574aa54aef840a8921bd694bd098d26909f5b">OCI_PROCESS_RLIMIT_SOFT</a>,</div>
<div class="line"><span class="lineno"> 1643</span>    <a class="code hl_enumvalue" href="#afb24d298ddd4bc4ff61aa333f07a574aa7c4a1dc8832ab814f8153330af5c53c0">OCI_PROCESS_RLIMIT_HARD</a>,</div>
<div class="line"><span class="lineno"> 1644</span>    <a class="code hl_enumvalue" href="#afb24d298ddd4bc4ff61aa333f07a574aa14fdf8fb6dafa566ba443a7c41296bab">__OCI_PROCESS_RLIMIT_MAX</a>,</div>
<div class="line"><span class="lineno"> 1645</span>};</div>
<div class="ttc" id="ajail_8c_html_afb24d298ddd4bc4ff61aa333f07a574aa14fdf8fb6dafa566ba443a7c41296bab"><div class="ttname"><a href="#afb24d298ddd4bc4ff61aa333f07a574aa14fdf8fb6dafa566ba443a7c41296bab">__OCI_PROCESS_RLIMIT_MAX</a></div><div class="ttdeci">@ __OCI_PROCESS_RLIMIT_MAX</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01644">jail.c:1644</a></div></div>
<div class="ttc" id="ajail_8c_html_afb24d298ddd4bc4ff61aa333f07a574aa54aef840a8921bd694bd098d26909f5b"><div class="ttname"><a href="#afb24d298ddd4bc4ff61aa333f07a574aa54aef840a8921bd694bd098d26909f5b">OCI_PROCESS_RLIMIT_SOFT</a></div><div class="ttdeci">@ OCI_PROCESS_RLIMIT_SOFT</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01642">jail.c:1642</a></div></div>
<div class="ttc" id="ajail_8c_html_afb24d298ddd4bc4ff61aa333f07a574aa7c4a1dc8832ab814f8153330af5c53c0"><div class="ttname"><a href="#afb24d298ddd4bc4ff61aa333f07a574aa7c4a1dc8832ab814f8153330af5c53c0">OCI_PROCESS_RLIMIT_HARD</a></div><div class="ttdeci">@ OCI_PROCESS_RLIMIT_HARD</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01643">jail.c:1643</a></div></div>
<div class="ttc" id="ajail_8c_html_afb24d298ddd4bc4ff61aa333f07a574aa82cefaa500e6667fae114a7a427a70e8"><div class="ttname"><a href="#afb24d298ddd4bc4ff61aa333f07a574aa82cefaa500e6667fae114a7a427a70e8">OCI_PROCESS_RLIMIT_TYPE</a></div><div class="ttdeci">@ OCI_PROCESS_RLIMIT_TYPE</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01641">jail.c:1641</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a39b4e25c4e8f5fed29720be17a532fa8" name="a39b4e25c4e8f5fed29720be17a532fa8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39b4e25c4e8f5fed29720be17a532fa8">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a39b4e25c4e8f5fed29720be17a532fa8a9d41d59732df8b5db30de6d8b498664c" name="a39b4e25c4e8f5fed29720be17a532fa8a9d41d59732df8b5db30de6d8b498664c"></a>OCI_PROCESS_ARGS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39b4e25c4e8f5fed29720be17a532fa8a71f60125a3d09ac0376911a3e0b0a6a4" name="a39b4e25c4e8f5fed29720be17a532fa8a71f60125a3d09ac0376911a3e0b0a6a4"></a>OCI_PROCESS_CAPABILITIES&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39b4e25c4e8f5fed29720be17a532fa8a841ee5b5a8bc29fc281504adf23332a5" name="a39b4e25c4e8f5fed29720be17a532fa8a841ee5b5a8bc29fc281504adf23332a5"></a>OCI_PROCESS_CWD&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39b4e25c4e8f5fed29720be17a532fa8a1be2ada84df5442b9f201c6dc52b3068" name="a39b4e25c4e8f5fed29720be17a532fa8a1be2ada84df5442b9f201c6dc52b3068"></a>OCI_PROCESS_ENV&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39b4e25c4e8f5fed29720be17a532fa8ac9d842b5fe7888be2ebaa9505332f6df" name="a39b4e25c4e8f5fed29720be17a532fa8ac9d842b5fe7888be2ebaa9505332f6df"></a>OCI_PROCESS_OOMSCOREADJ&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39b4e25c4e8f5fed29720be17a532fa8a7c18000948947c83ebfd4fab57779357" name="a39b4e25c4e8f5fed29720be17a532fa8a7c18000948947c83ebfd4fab57779357"></a>OCI_PROCESS_NONEWPRIVILEGES&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39b4e25c4e8f5fed29720be17a532fa8a43e16b4cc6c2d437a14b0bc14554127e" name="a39b4e25c4e8f5fed29720be17a532fa8a43e16b4cc6c2d437a14b0bc14554127e"></a>OCI_PROCESS_RLIMITS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39b4e25c4e8f5fed29720be17a532fa8ab48a2bacf241c851a118f8282a271e4d" name="a39b4e25c4e8f5fed29720be17a532fa8ab48a2bacf241c851a118f8282a271e4d"></a>OCI_PROCESS_TERMINAL&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39b4e25c4e8f5fed29720be17a532fa8ac638d97c005c1bae4270639b35443a6b" name="a39b4e25c4e8f5fed29720be17a532fa8ac638d97c005c1bae4270639b35443a6b"></a>OCI_PROCESS_USER&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a39b4e25c4e8f5fed29720be17a532fa8aa1cab4d55ca40e13a53fba6cd6925491" name="a39b4e25c4e8f5fed29720be17a532fa8aa1cab4d55ca40e13a53fba6cd6925491"></a>__OCI_PROCESS_MAX&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01716">1716</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1716</span>     {</div>
<div class="line"><span class="lineno"> 1717</span>    <a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a9d41d59732df8b5db30de6d8b498664c">OCI_PROCESS_ARGS</a>,</div>
<div class="line"><span class="lineno"> 1718</span>    <a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a71f60125a3d09ac0376911a3e0b0a6a4">OCI_PROCESS_CAPABILITIES</a>,</div>
<div class="line"><span class="lineno"> 1719</span>    <a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a841ee5b5a8bc29fc281504adf23332a5">OCI_PROCESS_CWD</a>,</div>
<div class="line"><span class="lineno"> 1720</span>    <a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a1be2ada84df5442b9f201c6dc52b3068">OCI_PROCESS_ENV</a>,</div>
<div class="line"><span class="lineno"> 1721</span>    <a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8ac9d842b5fe7888be2ebaa9505332f6df">OCI_PROCESS_OOMSCOREADJ</a>,</div>
<div class="line"><span class="lineno"> 1722</span>    <a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a7c18000948947c83ebfd4fab57779357">OCI_PROCESS_NONEWPRIVILEGES</a>,</div>
<div class="line"><span class="lineno"> 1723</span>    <a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a43e16b4cc6c2d437a14b0bc14554127e">OCI_PROCESS_RLIMITS</a>,</div>
<div class="line"><span class="lineno"> 1724</span>    <a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8ab48a2bacf241c851a118f8282a271e4d">OCI_PROCESS_TERMINAL</a>,</div>
<div class="line"><span class="lineno"> 1725</span>    <a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8ac638d97c005c1bae4270639b35443a6b">OCI_PROCESS_USER</a>,</div>
<div class="line"><span class="lineno"> 1726</span>    <a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8aa1cab4d55ca40e13a53fba6cd6925491">__OCI_PROCESS_MAX</a>,</div>
<div class="line"><span class="lineno"> 1727</span>};</div>
<div class="ttc" id="ajail_8c_html_a39b4e25c4e8f5fed29720be17a532fa8a1be2ada84df5442b9f201c6dc52b3068"><div class="ttname"><a href="#a39b4e25c4e8f5fed29720be17a532fa8a1be2ada84df5442b9f201c6dc52b3068">OCI_PROCESS_ENV</a></div><div class="ttdeci">@ OCI_PROCESS_ENV</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01720">jail.c:1720</a></div></div>
<div class="ttc" id="ajail_8c_html_a39b4e25c4e8f5fed29720be17a532fa8a43e16b4cc6c2d437a14b0bc14554127e"><div class="ttname"><a href="#a39b4e25c4e8f5fed29720be17a532fa8a43e16b4cc6c2d437a14b0bc14554127e">OCI_PROCESS_RLIMITS</a></div><div class="ttdeci">@ OCI_PROCESS_RLIMITS</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01723">jail.c:1723</a></div></div>
<div class="ttc" id="ajail_8c_html_a39b4e25c4e8f5fed29720be17a532fa8a71f60125a3d09ac0376911a3e0b0a6a4"><div class="ttname"><a href="#a39b4e25c4e8f5fed29720be17a532fa8a71f60125a3d09ac0376911a3e0b0a6a4">OCI_PROCESS_CAPABILITIES</a></div><div class="ttdeci">@ OCI_PROCESS_CAPABILITIES</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01718">jail.c:1718</a></div></div>
<div class="ttc" id="ajail_8c_html_a39b4e25c4e8f5fed29720be17a532fa8a7c18000948947c83ebfd4fab57779357"><div class="ttname"><a href="#a39b4e25c4e8f5fed29720be17a532fa8a7c18000948947c83ebfd4fab57779357">OCI_PROCESS_NONEWPRIVILEGES</a></div><div class="ttdeci">@ OCI_PROCESS_NONEWPRIVILEGES</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01722">jail.c:1722</a></div></div>
<div class="ttc" id="ajail_8c_html_a39b4e25c4e8f5fed29720be17a532fa8a841ee5b5a8bc29fc281504adf23332a5"><div class="ttname"><a href="#a39b4e25c4e8f5fed29720be17a532fa8a841ee5b5a8bc29fc281504adf23332a5">OCI_PROCESS_CWD</a></div><div class="ttdeci">@ OCI_PROCESS_CWD</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01719">jail.c:1719</a></div></div>
<div class="ttc" id="ajail_8c_html_a39b4e25c4e8f5fed29720be17a532fa8a9d41d59732df8b5db30de6d8b498664c"><div class="ttname"><a href="#a39b4e25c4e8f5fed29720be17a532fa8a9d41d59732df8b5db30de6d8b498664c">OCI_PROCESS_ARGS</a></div><div class="ttdeci">@ OCI_PROCESS_ARGS</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01717">jail.c:1717</a></div></div>
<div class="ttc" id="ajail_8c_html_a39b4e25c4e8f5fed29720be17a532fa8aa1cab4d55ca40e13a53fba6cd6925491"><div class="ttname"><a href="#a39b4e25c4e8f5fed29720be17a532fa8aa1cab4d55ca40e13a53fba6cd6925491">__OCI_PROCESS_MAX</a></div><div class="ttdeci">@ __OCI_PROCESS_MAX</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01726">jail.c:1726</a></div></div>
<div class="ttc" id="ajail_8c_html_a39b4e25c4e8f5fed29720be17a532fa8ab48a2bacf241c851a118f8282a271e4d"><div class="ttname"><a href="#a39b4e25c4e8f5fed29720be17a532fa8ab48a2bacf241c851a118f8282a271e4d">OCI_PROCESS_TERMINAL</a></div><div class="ttdeci">@ OCI_PROCESS_TERMINAL</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01724">jail.c:1724</a></div></div>
<div class="ttc" id="ajail_8c_html_a39b4e25c4e8f5fed29720be17a532fa8ac638d97c005c1bae4270639b35443a6b"><div class="ttname"><a href="#a39b4e25c4e8f5fed29720be17a532fa8ac638d97c005c1bae4270639b35443a6b">OCI_PROCESS_USER</a></div><div class="ttdeci">@ OCI_PROCESS_USER</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01725">jail.c:1725</a></div></div>
<div class="ttc" id="ajail_8c_html_a39b4e25c4e8f5fed29720be17a532fa8ac9d842b5fe7888be2ebaa9505332f6df"><div class="ttname"><a href="#a39b4e25c4e8f5fed29720be17a532fa8ac9d842b5fe7888be2ebaa9505332f6df">OCI_PROCESS_OOMSCOREADJ</a></div><div class="ttdeci">@ OCI_PROCESS_OOMSCOREADJ</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01721">jail.c:1721</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4efaf4e07364d6302f598569aa7e55dc" name="a4efaf4e07364d6302f598569aa7e55dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4efaf4e07364d6302f598569aa7e55dc">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a4efaf4e07364d6302f598569aa7e55dca3c772ed4692c1a6ee8cfd749e8f288b6" name="a4efaf4e07364d6302f598569aa7e55dca3c772ed4692c1a6ee8cfd749e8f288b6"></a>OCI_LINUX_NAMESPACE_TYPE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4efaf4e07364d6302f598569aa7e55dca9f981c7082417182bd81726ea9348830" name="a4efaf4e07364d6302f598569aa7e55dca9f981c7082417182bd81726ea9348830"></a>OCI_LINUX_NAMESPACE_PATH&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4efaf4e07364d6302f598569aa7e55dcab6f129898be13c23b13a69ca66e29d04" name="a4efaf4e07364d6302f598569aa7e55dcab6f129898be13c23b13a69ca66e29d04"></a>__OCI_LINUX_NAMESPACE_MAX&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01794">1794</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1794</span>     {</div>
<div class="line"><span class="lineno"> 1795</span>    <a class="code hl_enumvalue" href="#a4efaf4e07364d6302f598569aa7e55dca3c772ed4692c1a6ee8cfd749e8f288b6">OCI_LINUX_NAMESPACE_TYPE</a>,</div>
<div class="line"><span class="lineno"> 1796</span>    <a class="code hl_enumvalue" href="#a4efaf4e07364d6302f598569aa7e55dca9f981c7082417182bd81726ea9348830">OCI_LINUX_NAMESPACE_PATH</a>,</div>
<div class="line"><span class="lineno"> 1797</span>    <a class="code hl_enumvalue" href="#a4efaf4e07364d6302f598569aa7e55dcab6f129898be13c23b13a69ca66e29d04">__OCI_LINUX_NAMESPACE_MAX</a>,</div>
<div class="line"><span class="lineno"> 1798</span>};</div>
<div class="ttc" id="ajail_8c_html_a4efaf4e07364d6302f598569aa7e55dca3c772ed4692c1a6ee8cfd749e8f288b6"><div class="ttname"><a href="#a4efaf4e07364d6302f598569aa7e55dca3c772ed4692c1a6ee8cfd749e8f288b6">OCI_LINUX_NAMESPACE_TYPE</a></div><div class="ttdeci">@ OCI_LINUX_NAMESPACE_TYPE</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01795">jail.c:1795</a></div></div>
<div class="ttc" id="ajail_8c_html_a4efaf4e07364d6302f598569aa7e55dca9f981c7082417182bd81726ea9348830"><div class="ttname"><a href="#a4efaf4e07364d6302f598569aa7e55dca9f981c7082417182bd81726ea9348830">OCI_LINUX_NAMESPACE_PATH</a></div><div class="ttdeci">@ OCI_LINUX_NAMESPACE_PATH</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01796">jail.c:1796</a></div></div>
<div class="ttc" id="ajail_8c_html_a4efaf4e07364d6302f598569aa7e55dcab6f129898be13c23b13a69ca66e29d04"><div class="ttname"><a href="#a4efaf4e07364d6302f598569aa7e55dcab6f129898be13c23b13a69ca66e29d04">__OCI_LINUX_NAMESPACE_MAX</a></div><div class="ttdeci">@ __OCI_LINUX_NAMESPACE_MAX</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01797">jail.c:1797</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a34df7cc7f69a8ec535eec8a524dcbaf9" name="a34df7cc7f69a8ec535eec8a524dcbaf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34df7cc7f69a8ec535eec8a524dcbaf9">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a34df7cc7f69a8ec535eec8a524dcbaf9a7be3c350b969aa7e666feec5231a0619" name="a34df7cc7f69a8ec535eec8a524dcbaf9a7be3c350b969aa7e666feec5231a0619"></a>OCI_LINUX_UIDGIDMAP_CONTAINERID&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a34df7cc7f69a8ec535eec8a524dcbaf9a9d04002b30779f94d79d2998244f6ff2" name="a34df7cc7f69a8ec535eec8a524dcbaf9a9d04002b30779f94d79d2998244f6ff2"></a>OCI_LINUX_UIDGIDMAP_HOSTID&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a34df7cc7f69a8ec535eec8a524dcbaf9af62eeb729d82816dca12d392f7c0242c" name="a34df7cc7f69a8ec535eec8a524dcbaf9af62eeb729d82816dca12d392f7c0242c"></a>OCI_LINUX_UIDGIDMAP_SIZE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a34df7cc7f69a8ec535eec8a524dcbaf9a95e8d0d6c43c4f8cdf24c665d45834a1" name="a34df7cc7f69a8ec535eec8a524dcbaf9a95e8d0d6c43c4f8cdf24c665d45834a1"></a>__OCI_LINUX_UIDGIDMAP_MAX&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01951">1951</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1951</span>     {</div>
<div class="line"><span class="lineno"> 1952</span>    <a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a7be3c350b969aa7e666feec5231a0619">OCI_LINUX_UIDGIDMAP_CONTAINERID</a>,</div>
<div class="line"><span class="lineno"> 1953</span>    <a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a9d04002b30779f94d79d2998244f6ff2">OCI_LINUX_UIDGIDMAP_HOSTID</a>,</div>
<div class="line"><span class="lineno"> 1954</span>    <a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9af62eeb729d82816dca12d392f7c0242c">OCI_LINUX_UIDGIDMAP_SIZE</a>,</div>
<div class="line"><span class="lineno"> 1955</span>    <a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a95e8d0d6c43c4f8cdf24c665d45834a1">__OCI_LINUX_UIDGIDMAP_MAX</a>,</div>
<div class="line"><span class="lineno"> 1956</span>};</div>
<div class="ttc" id="ajail_8c_html_a34df7cc7f69a8ec535eec8a524dcbaf9a7be3c350b969aa7e666feec5231a0619"><div class="ttname"><a href="#a34df7cc7f69a8ec535eec8a524dcbaf9a7be3c350b969aa7e666feec5231a0619">OCI_LINUX_UIDGIDMAP_CONTAINERID</a></div><div class="ttdeci">@ OCI_LINUX_UIDGIDMAP_CONTAINERID</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01952">jail.c:1952</a></div></div>
<div class="ttc" id="ajail_8c_html_a34df7cc7f69a8ec535eec8a524dcbaf9a95e8d0d6c43c4f8cdf24c665d45834a1"><div class="ttname"><a href="#a34df7cc7f69a8ec535eec8a524dcbaf9a95e8d0d6c43c4f8cdf24c665d45834a1">__OCI_LINUX_UIDGIDMAP_MAX</a></div><div class="ttdeci">@ __OCI_LINUX_UIDGIDMAP_MAX</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01955">jail.c:1955</a></div></div>
<div class="ttc" id="ajail_8c_html_a34df7cc7f69a8ec535eec8a524dcbaf9a9d04002b30779f94d79d2998244f6ff2"><div class="ttname"><a href="#a34df7cc7f69a8ec535eec8a524dcbaf9a9d04002b30779f94d79d2998244f6ff2">OCI_LINUX_UIDGIDMAP_HOSTID</a></div><div class="ttdeci">@ OCI_LINUX_UIDGIDMAP_HOSTID</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01953">jail.c:1953</a></div></div>
<div class="ttc" id="ajail_8c_html_a34df7cc7f69a8ec535eec8a524dcbaf9af62eeb729d82816dca12d392f7c0242c"><div class="ttname"><a href="#a34df7cc7f69a8ec535eec8a524dcbaf9af62eeb729d82816dca12d392f7c0242c">OCI_LINUX_UIDGIDMAP_SIZE</a></div><div class="ttdeci">@ OCI_LINUX_UIDGIDMAP_SIZE</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01954">jail.c:1954</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a81929fb3d21206b62f55bcb744f71d5d" name="a81929fb3d21206b62f55bcb744f71d5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81929fb3d21206b62f55bcb744f71d5d">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a81929fb3d21206b62f55bcb744f71d5da7552d79964c15ae667f2506ef74f8201" name="a81929fb3d21206b62f55bcb744f71d5da7552d79964c15ae667f2506ef74f8201"></a>OCI_DEVICES_TYPE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a81929fb3d21206b62f55bcb744f71d5dabaa93214e7a6d28b48d2196358fd1123" name="a81929fb3d21206b62f55bcb744f71d5dabaa93214e7a6d28b48d2196358fd1123"></a>OCI_DEVICES_PATH&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a81929fb3d21206b62f55bcb744f71d5dadf9c76ed009a9d7998f869ddf0371767" name="a81929fb3d21206b62f55bcb744f71d5dadf9c76ed009a9d7998f869ddf0371767"></a>OCI_DEVICES_MAJOR&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a81929fb3d21206b62f55bcb744f71d5da1841510f8919dcaed8f7e150611e6acf" name="a81929fb3d21206b62f55bcb744f71d5da1841510f8919dcaed8f7e150611e6acf"></a>OCI_DEVICES_MINOR&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a81929fb3d21206b62f55bcb744f71d5da726450a129ef116d29282fe043688c00" name="a81929fb3d21206b62f55bcb744f71d5da726450a129ef116d29282fe043688c00"></a>OCI_DEVICES_FILEMODE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a81929fb3d21206b62f55bcb744f71d5da5b0d2d05d0ce566724d25dc7e751899d" name="a81929fb3d21206b62f55bcb744f71d5da5b0d2d05d0ce566724d25dc7e751899d"></a>OCI_DEVICES_UID&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a81929fb3d21206b62f55bcb744f71d5da1201076fb774af33b8c73c518dcc1dfb" name="a81929fb3d21206b62f55bcb744f71d5da1201076fb774af33b8c73c518dcc1dfb"></a>OCI_DEVICES_GID&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a81929fb3d21206b62f55bcb744f71d5da147df77312a8c562a8d21b33365448ee" name="a81929fb3d21206b62f55bcb744f71d5da147df77312a8c562a8d21b33365448ee"></a>__OCI_DEVICES_MAX&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02019">2019</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2019</span>     {</div>
<div class="line"><span class="lineno"> 2020</span>    <a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da7552d79964c15ae667f2506ef74f8201">OCI_DEVICES_TYPE</a>,</div>
<div class="line"><span class="lineno"> 2021</span>    <a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5dabaa93214e7a6d28b48d2196358fd1123">OCI_DEVICES_PATH</a>,</div>
<div class="line"><span class="lineno"> 2022</span>    <a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5dadf9c76ed009a9d7998f869ddf0371767">OCI_DEVICES_MAJOR</a>,</div>
<div class="line"><span class="lineno"> 2023</span>    <a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da1841510f8919dcaed8f7e150611e6acf">OCI_DEVICES_MINOR</a>,</div>
<div class="line"><span class="lineno"> 2024</span>    <a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da726450a129ef116d29282fe043688c00">OCI_DEVICES_FILEMODE</a>,</div>
<div class="line"><span class="lineno"> 2025</span>    <a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da5b0d2d05d0ce566724d25dc7e751899d">OCI_DEVICES_UID</a>,</div>
<div class="line"><span class="lineno"> 2026</span>    <a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da1201076fb774af33b8c73c518dcc1dfb">OCI_DEVICES_GID</a>,</div>
<div class="line"><span class="lineno"> 2027</span>    <a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da147df77312a8c562a8d21b33365448ee">__OCI_DEVICES_MAX</a>,</div>
<div class="line"><span class="lineno"> 2028</span>};</div>
<div class="ttc" id="ajail_8c_html_a81929fb3d21206b62f55bcb744f71d5da1201076fb774af33b8c73c518dcc1dfb"><div class="ttname"><a href="#a81929fb3d21206b62f55bcb744f71d5da1201076fb774af33b8c73c518dcc1dfb">OCI_DEVICES_GID</a></div><div class="ttdeci">@ OCI_DEVICES_GID</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02026">jail.c:2026</a></div></div>
<div class="ttc" id="ajail_8c_html_a81929fb3d21206b62f55bcb744f71d5da147df77312a8c562a8d21b33365448ee"><div class="ttname"><a href="#a81929fb3d21206b62f55bcb744f71d5da147df77312a8c562a8d21b33365448ee">__OCI_DEVICES_MAX</a></div><div class="ttdeci">@ __OCI_DEVICES_MAX</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02027">jail.c:2027</a></div></div>
<div class="ttc" id="ajail_8c_html_a81929fb3d21206b62f55bcb744f71d5da1841510f8919dcaed8f7e150611e6acf"><div class="ttname"><a href="#a81929fb3d21206b62f55bcb744f71d5da1841510f8919dcaed8f7e150611e6acf">OCI_DEVICES_MINOR</a></div><div class="ttdeci">@ OCI_DEVICES_MINOR</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02023">jail.c:2023</a></div></div>
<div class="ttc" id="ajail_8c_html_a81929fb3d21206b62f55bcb744f71d5da5b0d2d05d0ce566724d25dc7e751899d"><div class="ttname"><a href="#a81929fb3d21206b62f55bcb744f71d5da5b0d2d05d0ce566724d25dc7e751899d">OCI_DEVICES_UID</a></div><div class="ttdeci">@ OCI_DEVICES_UID</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02025">jail.c:2025</a></div></div>
<div class="ttc" id="ajail_8c_html_a81929fb3d21206b62f55bcb744f71d5da726450a129ef116d29282fe043688c00"><div class="ttname"><a href="#a81929fb3d21206b62f55bcb744f71d5da726450a129ef116d29282fe043688c00">OCI_DEVICES_FILEMODE</a></div><div class="ttdeci">@ OCI_DEVICES_FILEMODE</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02024">jail.c:2024</a></div></div>
<div class="ttc" id="ajail_8c_html_a81929fb3d21206b62f55bcb744f71d5da7552d79964c15ae667f2506ef74f8201"><div class="ttname"><a href="#a81929fb3d21206b62f55bcb744f71d5da7552d79964c15ae667f2506ef74f8201">OCI_DEVICES_TYPE</a></div><div class="ttdeci">@ OCI_DEVICES_TYPE</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02020">jail.c:2020</a></div></div>
<div class="ttc" id="ajail_8c_html_a81929fb3d21206b62f55bcb744f71d5dabaa93214e7a6d28b48d2196358fd1123"><div class="ttname"><a href="#a81929fb3d21206b62f55bcb744f71d5dabaa93214e7a6d28b48d2196358fd1123">OCI_DEVICES_PATH</a></div><div class="ttdeci">@ OCI_DEVICES_PATH</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02021">jail.c:2021</a></div></div>
<div class="ttc" id="ajail_8c_html_a81929fb3d21206b62f55bcb744f71d5dadf9c76ed009a9d7998f869ddf0371767"><div class="ttname"><a href="#a81929fb3d21206b62f55bcb744f71d5dadf9c76ed009a9d7998f869ddf0371767">OCI_DEVICES_MAJOR</a></div><div class="ttdeci">@ OCI_DEVICES_MAJOR</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02022">jail.c:2022</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7ada2556f3c386db5f31969fb6d4d002" name="a7ada2556f3c386db5f31969fb6d4d002"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ada2556f3c386db5f31969fb6d4d002">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a7ada2556f3c386db5f31969fb6d4d002a4c337c6cf54ff1755a2cc9145bcb29ba" name="a7ada2556f3c386db5f31969fb6d4d002a4c337c6cf54ff1755a2cc9145bcb29ba"></a>OCI_LINUX_CGROUPSPATH&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a7ada2556f3c386db5f31969fb6d4d002a6ed87e24d333274bcf07394e12eb0334" name="a7ada2556f3c386db5f31969fb6d4d002a6ed87e24d333274bcf07394e12eb0334"></a>OCI_LINUX_RESOURCES&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a7ada2556f3c386db5f31969fb6d4d002abaa0938b58a04b3660a37c8708610f7f" name="a7ada2556f3c386db5f31969fb6d4d002abaa0938b58a04b3660a37c8708610f7f"></a>OCI_LINUX_SECCOMP&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a7ada2556f3c386db5f31969fb6d4d002ad9d5c35f112531b3441718b70580ad3b" name="a7ada2556f3c386db5f31969fb6d4d002ad9d5c35f112531b3441718b70580ad3b"></a>OCI_LINUX_SYSCTL&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a7ada2556f3c386db5f31969fb6d4d002a8a3a158fe5d2f0a652ef86cda72ab655" name="a7ada2556f3c386db5f31969fb6d4d002a8a3a158fe5d2f0a652ef86cda72ab655"></a>OCI_LINUX_NAMESPACES&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a7ada2556f3c386db5f31969fb6d4d002a1307500651c21f2451f25555fe3f45c9" name="a7ada2556f3c386db5f31969fb6d4d002a1307500651c21f2451f25555fe3f45c9"></a>OCI_LINUX_DEVICES&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a7ada2556f3c386db5f31969fb6d4d002a9d6ef21b01ed6532bff2ac2c28c5a075" name="a7ada2556f3c386db5f31969fb6d4d002a9d6ef21b01ed6532bff2ac2c28c5a075"></a>OCI_LINUX_UIDMAPPINGS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a7ada2556f3c386db5f31969fb6d4d002afd9a8d6225d58630adfdd9b127bd2b75" name="a7ada2556f3c386db5f31969fb6d4d002afd9a8d6225d58630adfdd9b127bd2b75"></a>OCI_LINUX_GIDMAPPINGS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a7ada2556f3c386db5f31969fb6d4d002af04b23cc25d65aa924674451e37742b5" name="a7ada2556f3c386db5f31969fb6d4d002af04b23cc25d65aa924674451e37742b5"></a>OCI_LINUX_MASKEDPATHS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a7ada2556f3c386db5f31969fb6d4d002a99685949d7e12300cde9533b69faec9d" name="a7ada2556f3c386db5f31969fb6d4d002a99685949d7e12300cde9533b69faec9d"></a>OCI_LINUX_READONLYPATHS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a7ada2556f3c386db5f31969fb6d4d002a609592d1ea33a112dfe8ff3e6545d6c0" name="a7ada2556f3c386db5f31969fb6d4d002a609592d1ea33a112dfe8ff3e6545d6c0"></a>OCI_LINUX_ROOTFSPROPAGATION&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a7ada2556f3c386db5f31969fb6d4d002aa8e03afa65029fb9a01906fe0a12fb79" name="a7ada2556f3c386db5f31969fb6d4d002aa8e03afa65029fb9a01906fe0a12fb79"></a>__OCI_LINUX_MAX&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02169">2169</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2169</span>     {</div>
<div class="line"><span class="lineno"> 2170</span>    <a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a4c337c6cf54ff1755a2cc9145bcb29ba">OCI_LINUX_CGROUPSPATH</a>,</div>
<div class="line"><span class="lineno"> 2171</span>    <a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a6ed87e24d333274bcf07394e12eb0334">OCI_LINUX_RESOURCES</a>,</div>
<div class="line"><span class="lineno"> 2172</span>    <a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002abaa0938b58a04b3660a37c8708610f7f">OCI_LINUX_SECCOMP</a>,</div>
<div class="line"><span class="lineno"> 2173</span>    <a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002ad9d5c35f112531b3441718b70580ad3b">OCI_LINUX_SYSCTL</a>,</div>
<div class="line"><span class="lineno"> 2174</span>    <a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a8a3a158fe5d2f0a652ef86cda72ab655">OCI_LINUX_NAMESPACES</a>,</div>
<div class="line"><span class="lineno"> 2175</span>    <a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a1307500651c21f2451f25555fe3f45c9">OCI_LINUX_DEVICES</a>,</div>
<div class="line"><span class="lineno"> 2176</span>    <a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a9d6ef21b01ed6532bff2ac2c28c5a075">OCI_LINUX_UIDMAPPINGS</a>,</div>
<div class="line"><span class="lineno"> 2177</span>    <a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002afd9a8d6225d58630adfdd9b127bd2b75">OCI_LINUX_GIDMAPPINGS</a>,</div>
<div class="line"><span class="lineno"> 2178</span>    <a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002af04b23cc25d65aa924674451e37742b5">OCI_LINUX_MASKEDPATHS</a>,</div>
<div class="line"><span class="lineno"> 2179</span>    <a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a99685949d7e12300cde9533b69faec9d">OCI_LINUX_READONLYPATHS</a>,</div>
<div class="line"><span class="lineno"> 2180</span>    <a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a609592d1ea33a112dfe8ff3e6545d6c0">OCI_LINUX_ROOTFSPROPAGATION</a>,</div>
<div class="line"><span class="lineno"> 2181</span>    <a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002aa8e03afa65029fb9a01906fe0a12fb79">__OCI_LINUX_MAX</a>,</div>
<div class="line"><span class="lineno"> 2182</span>};</div>
<div class="ttc" id="ajail_8c_html_a7ada2556f3c386db5f31969fb6d4d002a1307500651c21f2451f25555fe3f45c9"><div class="ttname"><a href="#a7ada2556f3c386db5f31969fb6d4d002a1307500651c21f2451f25555fe3f45c9">OCI_LINUX_DEVICES</a></div><div class="ttdeci">@ OCI_LINUX_DEVICES</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02175">jail.c:2175</a></div></div>
<div class="ttc" id="ajail_8c_html_a7ada2556f3c386db5f31969fb6d4d002a4c337c6cf54ff1755a2cc9145bcb29ba"><div class="ttname"><a href="#a7ada2556f3c386db5f31969fb6d4d002a4c337c6cf54ff1755a2cc9145bcb29ba">OCI_LINUX_CGROUPSPATH</a></div><div class="ttdeci">@ OCI_LINUX_CGROUPSPATH</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02170">jail.c:2170</a></div></div>
<div class="ttc" id="ajail_8c_html_a7ada2556f3c386db5f31969fb6d4d002a609592d1ea33a112dfe8ff3e6545d6c0"><div class="ttname"><a href="#a7ada2556f3c386db5f31969fb6d4d002a609592d1ea33a112dfe8ff3e6545d6c0">OCI_LINUX_ROOTFSPROPAGATION</a></div><div class="ttdeci">@ OCI_LINUX_ROOTFSPROPAGATION</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02180">jail.c:2180</a></div></div>
<div class="ttc" id="ajail_8c_html_a7ada2556f3c386db5f31969fb6d4d002a6ed87e24d333274bcf07394e12eb0334"><div class="ttname"><a href="#a7ada2556f3c386db5f31969fb6d4d002a6ed87e24d333274bcf07394e12eb0334">OCI_LINUX_RESOURCES</a></div><div class="ttdeci">@ OCI_LINUX_RESOURCES</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02171">jail.c:2171</a></div></div>
<div class="ttc" id="ajail_8c_html_a7ada2556f3c386db5f31969fb6d4d002a8a3a158fe5d2f0a652ef86cda72ab655"><div class="ttname"><a href="#a7ada2556f3c386db5f31969fb6d4d002a8a3a158fe5d2f0a652ef86cda72ab655">OCI_LINUX_NAMESPACES</a></div><div class="ttdeci">@ OCI_LINUX_NAMESPACES</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02174">jail.c:2174</a></div></div>
<div class="ttc" id="ajail_8c_html_a7ada2556f3c386db5f31969fb6d4d002a99685949d7e12300cde9533b69faec9d"><div class="ttname"><a href="#a7ada2556f3c386db5f31969fb6d4d002a99685949d7e12300cde9533b69faec9d">OCI_LINUX_READONLYPATHS</a></div><div class="ttdeci">@ OCI_LINUX_READONLYPATHS</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02179">jail.c:2179</a></div></div>
<div class="ttc" id="ajail_8c_html_a7ada2556f3c386db5f31969fb6d4d002a9d6ef21b01ed6532bff2ac2c28c5a075"><div class="ttname"><a href="#a7ada2556f3c386db5f31969fb6d4d002a9d6ef21b01ed6532bff2ac2c28c5a075">OCI_LINUX_UIDMAPPINGS</a></div><div class="ttdeci">@ OCI_LINUX_UIDMAPPINGS</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02176">jail.c:2176</a></div></div>
<div class="ttc" id="ajail_8c_html_a7ada2556f3c386db5f31969fb6d4d002aa8e03afa65029fb9a01906fe0a12fb79"><div class="ttname"><a href="#a7ada2556f3c386db5f31969fb6d4d002aa8e03afa65029fb9a01906fe0a12fb79">__OCI_LINUX_MAX</a></div><div class="ttdeci">@ __OCI_LINUX_MAX</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02181">jail.c:2181</a></div></div>
<div class="ttc" id="ajail_8c_html_a7ada2556f3c386db5f31969fb6d4d002abaa0938b58a04b3660a37c8708610f7f"><div class="ttname"><a href="#a7ada2556f3c386db5f31969fb6d4d002abaa0938b58a04b3660a37c8708610f7f">OCI_LINUX_SECCOMP</a></div><div class="ttdeci">@ OCI_LINUX_SECCOMP</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02172">jail.c:2172</a></div></div>
<div class="ttc" id="ajail_8c_html_a7ada2556f3c386db5f31969fb6d4d002ad9d5c35f112531b3441718b70580ad3b"><div class="ttname"><a href="#a7ada2556f3c386db5f31969fb6d4d002ad9d5c35f112531b3441718b70580ad3b">OCI_LINUX_SYSCTL</a></div><div class="ttdeci">@ OCI_LINUX_SYSCTL</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02173">jail.c:2173</a></div></div>
<div class="ttc" id="ajail_8c_html_a7ada2556f3c386db5f31969fb6d4d002af04b23cc25d65aa924674451e37742b5"><div class="ttname"><a href="#a7ada2556f3c386db5f31969fb6d4d002af04b23cc25d65aa924674451e37742b5">OCI_LINUX_MASKEDPATHS</a></div><div class="ttdeci">@ OCI_LINUX_MASKEDPATHS</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02178">jail.c:2178</a></div></div>
<div class="ttc" id="ajail_8c_html_a7ada2556f3c386db5f31969fb6d4d002afd9a8d6225d58630adfdd9b127bd2b75"><div class="ttname"><a href="#a7ada2556f3c386db5f31969fb6d4d002afd9a8d6225d58630adfdd9b127bd2b75">OCI_LINUX_GIDMAPPINGS</a></div><div class="ttdeci">@ OCI_LINUX_GIDMAPPINGS</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02177">jail.c:2177</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a25e50be5c73e0b2fab54944e68dd48c2" name="a25e50be5c73e0b2fab54944e68dd48c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25e50be5c73e0b2fab54944e68dd48c2">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a25e50be5c73e0b2fab54944e68dd48c2a1fe8c34674764c6ec2f2d1984072c62d" name="a25e50be5c73e0b2fab54944e68dd48c2a1fe8c34674764c6ec2f2d1984072c62d"></a>OCI_VERSION&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a25e50be5c73e0b2fab54944e68dd48c2ac4dfa375741e7a69482e70cd6895ee0b" name="a25e50be5c73e0b2fab54944e68dd48c2ac4dfa375741e7a69482e70cd6895ee0b"></a>OCI_HOSTNAME&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a25e50be5c73e0b2fab54944e68dd48c2aeefd9fc5dfb29881871de9083a277396" name="a25e50be5c73e0b2fab54944e68dd48c2aeefd9fc5dfb29881871de9083a277396"></a>OCI_PROCESS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a25e50be5c73e0b2fab54944e68dd48c2af6442ef34bfc169790d9429b2fd4e732" name="a25e50be5c73e0b2fab54944e68dd48c2af6442ef34bfc169790d9429b2fd4e732"></a>OCI_ROOT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a25e50be5c73e0b2fab54944e68dd48c2a138e90c68b0f6df726b8169e93b96d08" name="a25e50be5c73e0b2fab54944e68dd48c2a138e90c68b0f6df726b8169e93b96d08"></a>OCI_MOUNTS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a25e50be5c73e0b2fab54944e68dd48c2ae5b76fcf322dc75c322e5ce6db99448d" name="a25e50be5c73e0b2fab54944e68dd48c2ae5b76fcf322dc75c322e5ce6db99448d"></a>OCI_HOOKS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a25e50be5c73e0b2fab54944e68dd48c2a7dbca8874590bfff6d39937b3fa80dce" name="a25e50be5c73e0b2fab54944e68dd48c2a7dbca8874590bfff6d39937b3fa80dce"></a>OCI_LINUX&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a25e50be5c73e0b2fab54944e68dd48c2a13a552ae7da72cf7868d1e286ffc0921" name="a25e50be5c73e0b2fab54944e68dd48c2a13a552ae7da72cf7868d1e286ffc0921"></a>OCI_ANNOTATIONS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a25e50be5c73e0b2fab54944e68dd48c2a158774e5aaadcff6bcf7daf6db2ea105" name="a25e50be5c73e0b2fab54944e68dd48c2a158774e5aaadcff6bcf7daf6db2ea105"></a>__OCI_MAX&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02300">2300</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2300</span>     {</div>
<div class="line"><span class="lineno"> 2301</span>    <a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a1fe8c34674764c6ec2f2d1984072c62d">OCI_VERSION</a>,</div>
<div class="line"><span class="lineno"> 2302</span>    <a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2ac4dfa375741e7a69482e70cd6895ee0b">OCI_HOSTNAME</a>,</div>
<div class="line"><span class="lineno"> 2303</span>    <a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2aeefd9fc5dfb29881871de9083a277396">OCI_PROCESS</a>,</div>
<div class="line"><span class="lineno"> 2304</span>    <a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2af6442ef34bfc169790d9429b2fd4e732">OCI_ROOT</a>,</div>
<div class="line"><span class="lineno"> 2305</span>    <a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a138e90c68b0f6df726b8169e93b96d08">OCI_MOUNTS</a>,</div>
<div class="line"><span class="lineno"> 2306</span>    <a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2ae5b76fcf322dc75c322e5ce6db99448d">OCI_HOOKS</a>,</div>
<div class="line"><span class="lineno"> 2307</span>    <a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a7dbca8874590bfff6d39937b3fa80dce">OCI_LINUX</a>,</div>
<div class="line"><span class="lineno"> 2308</span>    <a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a13a552ae7da72cf7868d1e286ffc0921">OCI_ANNOTATIONS</a>,</div>
<div class="line"><span class="lineno"> 2309</span>    <a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a158774e5aaadcff6bcf7daf6db2ea105">__OCI_MAX</a>,</div>
<div class="line"><span class="lineno"> 2310</span>};</div>
<div class="ttc" id="ajail_8c_html_a25e50be5c73e0b2fab54944e68dd48c2a138e90c68b0f6df726b8169e93b96d08"><div class="ttname"><a href="#a25e50be5c73e0b2fab54944e68dd48c2a138e90c68b0f6df726b8169e93b96d08">OCI_MOUNTS</a></div><div class="ttdeci">@ OCI_MOUNTS</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02305">jail.c:2305</a></div></div>
<div class="ttc" id="ajail_8c_html_a25e50be5c73e0b2fab54944e68dd48c2a13a552ae7da72cf7868d1e286ffc0921"><div class="ttname"><a href="#a25e50be5c73e0b2fab54944e68dd48c2a13a552ae7da72cf7868d1e286ffc0921">OCI_ANNOTATIONS</a></div><div class="ttdeci">@ OCI_ANNOTATIONS</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02308">jail.c:2308</a></div></div>
<div class="ttc" id="ajail_8c_html_a25e50be5c73e0b2fab54944e68dd48c2a158774e5aaadcff6bcf7daf6db2ea105"><div class="ttname"><a href="#a25e50be5c73e0b2fab54944e68dd48c2a158774e5aaadcff6bcf7daf6db2ea105">__OCI_MAX</a></div><div class="ttdeci">@ __OCI_MAX</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02309">jail.c:2309</a></div></div>
<div class="ttc" id="ajail_8c_html_a25e50be5c73e0b2fab54944e68dd48c2a1fe8c34674764c6ec2f2d1984072c62d"><div class="ttname"><a href="#a25e50be5c73e0b2fab54944e68dd48c2a1fe8c34674764c6ec2f2d1984072c62d">OCI_VERSION</a></div><div class="ttdeci">@ OCI_VERSION</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02301">jail.c:2301</a></div></div>
<div class="ttc" id="ajail_8c_html_a25e50be5c73e0b2fab54944e68dd48c2a7dbca8874590bfff6d39937b3fa80dce"><div class="ttname"><a href="#a25e50be5c73e0b2fab54944e68dd48c2a7dbca8874590bfff6d39937b3fa80dce">OCI_LINUX</a></div><div class="ttdeci">@ OCI_LINUX</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02307">jail.c:2307</a></div></div>
<div class="ttc" id="ajail_8c_html_a25e50be5c73e0b2fab54944e68dd48c2ac4dfa375741e7a69482e70cd6895ee0b"><div class="ttname"><a href="#a25e50be5c73e0b2fab54944e68dd48c2ac4dfa375741e7a69482e70cd6895ee0b">OCI_HOSTNAME</a></div><div class="ttdeci">@ OCI_HOSTNAME</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02302">jail.c:2302</a></div></div>
<div class="ttc" id="ajail_8c_html_a25e50be5c73e0b2fab54944e68dd48c2ae5b76fcf322dc75c322e5ce6db99448d"><div class="ttname"><a href="#a25e50be5c73e0b2fab54944e68dd48c2ae5b76fcf322dc75c322e5ce6db99448d">OCI_HOOKS</a></div><div class="ttdeci">@ OCI_HOOKS</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02306">jail.c:2306</a></div></div>
<div class="ttc" id="ajail_8c_html_a25e50be5c73e0b2fab54944e68dd48c2aeefd9fc5dfb29881871de9083a277396"><div class="ttname"><a href="#a25e50be5c73e0b2fab54944e68dd48c2aeefd9fc5dfb29881871de9083a277396">OCI_PROCESS</a></div><div class="ttdeci">@ OCI_PROCESS</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02303">jail.c:2303</a></div></div>
<div class="ttc" id="ajail_8c_html_a25e50be5c73e0b2fab54944e68dd48c2af6442ef34bfc169790d9429b2fd4e732"><div class="ttname"><a href="#a25e50be5c73e0b2fab54944e68dd48c2af6442ef34bfc169790d9429b2fd4e732">OCI_ROOT</a></div><div class="ttdeci">@ OCI_ROOT</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02304">jail.c:2304</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a97f905ac94bfebd46e50e32c7389e6eb" name="a97f905ac94bfebd46e50e32c7389e6eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97f905ac94bfebd46e50e32c7389e6eb">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a97f905ac94bfebd46e50e32c7389e6eba13f094d14b519859226de69d2baca06d" name="a97f905ac94bfebd46e50e32c7389e6eba13f094d14b519859226de69d2baca06d"></a>OCI_STATE_CREATING&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a97f905ac94bfebd46e50e32c7389e6eba7d55a02065f2ef38d43d0c0858bee940" name="a97f905ac94bfebd46e50e32c7389e6eba7d55a02065f2ef38d43d0c0858bee940"></a>OCI_STATE_CREATED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a97f905ac94bfebd46e50e32c7389e6eba9c098b9727e0c4f5a1c90b249cd4aacc" name="a97f905ac94bfebd46e50e32c7389e6eba9c098b9727e0c4f5a1c90b249cd4aacc"></a>OCI_STATE_RUNNING&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a97f905ac94bfebd46e50e32c7389e6eba8c03b9e1abf979c0ec7b1900c86b60f1" name="a97f905ac94bfebd46e50e32c7389e6eba8c03b9e1abf979c0ec7b1900c86b60f1"></a>OCI_STATE_STOPPED&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02412">2412</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2412</span>     {</div>
<div class="line"><span class="lineno"> 2413</span>    <a class="code hl_enumvalue" href="#a97f905ac94bfebd46e50e32c7389e6eba13f094d14b519859226de69d2baca06d">OCI_STATE_CREATING</a>,</div>
<div class="line"><span class="lineno"> 2414</span>    <a class="code hl_enumvalue" href="#a97f905ac94bfebd46e50e32c7389e6eba7d55a02065f2ef38d43d0c0858bee940">OCI_STATE_CREATED</a>,</div>
<div class="line"><span class="lineno"> 2415</span>    <a class="code hl_enumvalue" href="#a97f905ac94bfebd46e50e32c7389e6eba9c098b9727e0c4f5a1c90b249cd4aacc">OCI_STATE_RUNNING</a>,</div>
<div class="line"><span class="lineno"> 2416</span>    <a class="code hl_enumvalue" href="#a97f905ac94bfebd46e50e32c7389e6eba8c03b9e1abf979c0ec7b1900c86b60f1">OCI_STATE_STOPPED</a>,</div>
<div class="line"><span class="lineno"> 2417</span>};</div>
<div class="ttc" id="ajail_8c_html_a97f905ac94bfebd46e50e32c7389e6eba13f094d14b519859226de69d2baca06d"><div class="ttname"><a href="#a97f905ac94bfebd46e50e32c7389e6eba13f094d14b519859226de69d2baca06d">OCI_STATE_CREATING</a></div><div class="ttdeci">@ OCI_STATE_CREATING</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02413">jail.c:2413</a></div></div>
<div class="ttc" id="ajail_8c_html_a97f905ac94bfebd46e50e32c7389e6eba7d55a02065f2ef38d43d0c0858bee940"><div class="ttname"><a href="#a97f905ac94bfebd46e50e32c7389e6eba7d55a02065f2ef38d43d0c0858bee940">OCI_STATE_CREATED</a></div><div class="ttdeci">@ OCI_STATE_CREATED</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02414">jail.c:2414</a></div></div>
<div class="ttc" id="ajail_8c_html_a97f905ac94bfebd46e50e32c7389e6eba8c03b9e1abf979c0ec7b1900c86b60f1"><div class="ttname"><a href="#a97f905ac94bfebd46e50e32c7389e6eba8c03b9e1abf979c0ec7b1900c86b60f1">OCI_STATE_STOPPED</a></div><div class="ttdeci">@ OCI_STATE_STOPPED</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02416">jail.c:2416</a></div></div>
<div class="ttc" id="ajail_8c_html_a97f905ac94bfebd46e50e32c7389e6eba9c098b9727e0c4f5a1c90b249cd4aacc"><div class="ttname"><a href="#a97f905ac94bfebd46e50e32c7389e6eba9c098b9727e0c4f5a1c90b249cd4aacc">OCI_STATE_RUNNING</a></div><div class="ttdeci">@ OCI_STATE_RUNNING</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02415">jail.c:2415</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9b29769343da78881f442e657eb62b6e" name="a9b29769343da78881f442e657eb62b6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b29769343da78881f442e657eb62b6e">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a9b29769343da78881f442e657eb62b6eaf6c2e8ccd2ffe9d627f296e938428c0b" name="a9b29769343da78881f442e657eb62b6eaf6c2e8ccd2ffe9d627f296e938428c0b"></a>CONTAINER_KILL_ATTR_SIGNAL&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a9b29769343da78881f442e657eb62b6eaa656c9648d631f597fe6ab93da6c8420" name="a9b29769343da78881f442e657eb62b6eaa656c9648d631f597fe6ab93da6c8420"></a>__CONTAINER_KILL_ATTR_MAX&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02479">2479</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2479</span>     {</div>
<div class="line"><span class="lineno"> 2480</span>    <a class="code hl_enumvalue" href="#a9b29769343da78881f442e657eb62b6eaf6c2e8ccd2ffe9d627f296e938428c0b">CONTAINER_KILL_ATTR_SIGNAL</a>,</div>
<div class="line"><span class="lineno"> 2481</span>    <a class="code hl_enumvalue" href="#a9b29769343da78881f442e657eb62b6eaa656c9648d631f597fe6ab93da6c8420">__CONTAINER_KILL_ATTR_MAX</a>,</div>
<div class="line"><span class="lineno"> 2482</span>};</div>
<div class="ttc" id="ajail_8c_html_a9b29769343da78881f442e657eb62b6eaa656c9648d631f597fe6ab93da6c8420"><div class="ttname"><a href="#a9b29769343da78881f442e657eb62b6eaa656c9648d631f597fe6ab93da6c8420">__CONTAINER_KILL_ATTR_MAX</a></div><div class="ttdeci">@ __CONTAINER_KILL_ATTR_MAX</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02481">jail.c:2481</a></div></div>
<div class="ttc" id="ajail_8c_html_a9b29769343da78881f442e657eb62b6eaf6c2e8ccd2ffe9d627f296e938428c0b"><div class="ttname"><a href="#a9b29769343da78881f442e657eb62b6eaf6c2e8ccd2ffe9d627f296e938428c0b">CONTAINER_KILL_ATTR_SIGNAL</a></div><div class="ttdeci">@ CONTAINER_KILL_ATTR_SIGNAL</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02480">jail.c:2480</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae076946d2fc6067e05a7851cad082a4a" name="ae076946d2fc6067e05a7851cad082a4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae076946d2fc6067e05a7851cad082a4a">&#9670;&#160;</a></span>apply_rlimits()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int apply_rlimits </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00942">942</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  943</span>{</div>
<div class="line"><span class="lineno">  944</span>    <span class="keywordtype">int</span> resource;</div>
<div class="line"><span class="lineno">  945</span> </div>
<div class="line"><span class="lineno">  946</span>    <span class="keywordflow">for</span> (resource = 0; resource &lt; RLIM_NLIMITS; ++resource) {</div>
<div class="line"><span class="lineno">  947</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.rlimits[resource])</div>
<div class="line"><span class="lineno">  948</span>            <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;applying limits to resource %u\n&quot;</span>, resource);</div>
<div class="line"><span class="lineno">  949</span> </div>
<div class="line"><span class="lineno">  950</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.rlimits[resource] &amp;&amp;</div>
<div class="line"><span class="lineno">  951</span>            setrlimit(resource, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.rlimits[resource]))</div>
<div class="line"><span class="lineno">  952</span>            <span class="keywordflow">return</span> errno;</div>
<div class="line"><span class="lineno">  953</span>    }</div>
<div class="line"><span class="lineno">  954</span> </div>
<div class="line"><span class="lineno">  955</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  956</span>}</div>
<div class="ttc" id="ajail_8c_html_ab6fdb9300031a4ac782a6a3a7ec742cd"><div class="ttname"><a href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a></div><div class="ttdeci">static struct @121 opts</div></div>
<div class="ttc" id="asystem-dummy_8c_html_ad72dbcf6d0153db1b8d8a58001feed83"><div class="ttname"><a href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a></div><div class="ttdeci">#define DEBUG</div><div class="ttdef"><b>Definition</b> <a href="../../da/d12/system-dummy_8c_source.html#l00021">system-dummy.c:21</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, and <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>.</p>

</div>
</div>
<a id="a76506091a3ac45cc3ce7bdf1c3c279c9" name="a76506091a3ac45cc3ce7bdf1c3c279c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76506091a3ac45cc3ce7bdf1c3c279c9">&#9670;&#160;</a></span>apply_sysctl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int apply_sysctl </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>jail_root</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00523">523</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  524</span>{</div>
<div class="line"><span class="lineno">  525</span>    <span class="keyword">struct </span><a class="code hl_struct" href="#de/d02/structsysctl__val">sysctl_val</a> **cur;</div>
<div class="line"><span class="lineno">  526</span>    <span class="keywordtype">char</span> *procdir, *fname;</div>
<div class="line"><span class="lineno">  527</span>    <span class="keywordtype">int</span> f;</div>
<div class="line"><span class="lineno">  528</span> </div>
<div class="line"><span class="lineno">  529</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.sysctl)</div>
<div class="line"><span class="lineno">  530</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  531</span> </div>
<div class="line"><span class="lineno">  532</span>    <span class="keywordflow">if</span> (asprintf(&amp;procdir, <span class="stringliteral">&quot;%s/proc&quot;</span>, <a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>) &lt; 0)</div>
<div class="line"><span class="lineno">  533</span>        <span class="keywordflow">return</span> ENOMEM;</div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span>    mkdir(procdir, 0700);</div>
<div class="line"><span class="lineno">  536</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="../../d2/d5a/fs_8c.html#d3/df8/structmount">mount</a>(<span class="stringliteral">&quot;proc&quot;</span>, procdir, <span class="stringliteral">&quot;proc&quot;</span>, MS_NOATIME | MS_NODEV | MS_NOEXEC | MS_NOSUID, 0))</div>
<div class="line"><span class="lineno">  537</span>        <span class="keywordflow">return</span> EPERM;</div>
<div class="line"><span class="lineno">  538</span> </div>
<div class="line"><span class="lineno">  539</span>    cur = <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.sysctl;</div>
<div class="line"><span class="lineno">  540</span> </div>
<div class="line"><span class="lineno">  541</span>    <span class="keywordflow">while</span> (*cur) {</div>
<div class="line"><span class="lineno">  542</span>        <span class="keywordflow">if</span> (asprintf(&amp;fname, <span class="stringliteral">&quot;%s/sys/%s&quot;</span>, procdir, (*cur)-&gt;entry) &lt; 0)</div>
<div class="line"><span class="lineno">  543</span>            <span class="keywordflow">return</span> ENOMEM;</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>        <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;sysctl: writing &#39;%s&#39; to %s\n&quot;</span>, (*cur)-&gt;value, fname);</div>
<div class="line"><span class="lineno">  546</span> </div>
<div class="line"><span class="lineno">  547</span>        f = open(fname, O_WRONLY);</div>
<div class="line"><span class="lineno">  548</span>        <span class="keywordflow">if</span> (f &lt; 0) {</div>
<div class="line"><span class="lineno">  549</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;sysctl: can&#39;t open %s\n&quot;</span>, fname);</div>
<div class="line"><span class="lineno">  550</span>            free(fname);</div>
<div class="line"><span class="lineno">  551</span>            <span class="keywordflow">return</span> errno;</div>
<div class="line"><span class="lineno">  552</span>        }</div>
<div class="line"><span class="lineno">  553</span>        <span class="keywordflow">if</span> (write(f, (*cur)-&gt;value, strlen((*cur)-&gt;value)) &lt; 0) {</div>
<div class="line"><span class="lineno">  554</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;sysctl: write to %s\n&quot;</span>, fname);</div>
<div class="line"><span class="lineno">  555</span>            free(fname);</div>
<div class="line"><span class="lineno">  556</span>            close(f);</div>
<div class="line"><span class="lineno">  557</span>            <span class="keywordflow">return</span> errno;</div>
<div class="line"><span class="lineno">  558</span>        }</div>
<div class="line"><span class="lineno">  559</span> </div>
<div class="line"><span class="lineno">  560</span>        free(fname);</div>
<div class="line"><span class="lineno">  561</span>        close(f);</div>
<div class="line"><span class="lineno">  562</span>        ++cur;</div>
<div class="line"><span class="lineno">  563</span>    }</div>
<div class="line"><span class="lineno">  564</span>    umount(procdir);</div>
<div class="line"><span class="lineno">  565</span>    rmdir(procdir);</div>
<div class="line"><span class="lineno">  566</span>    free(procdir);</div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  569</span>}</div>
<div class="ttc" id="afs_8c_html_d3/df8/structmount"><div class="ttname"><a href="../../d2/d5a/fs_8c.html#d3/df8/structmount">mount</a></div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00044">fs.c:44</a></div></div>
<div class="ttc" id="ajail_8c_html_a45c79303cad1e1847d711c3946e93e85"><div class="ttname"><a href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a></div><div class="ttdeci">static char jail_root[]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00675">jail.c:675</a></div></div>
<div class="ttc" id="ajail_8c_html_de/d02/structsysctl__val"><div class="ttname"><a href="#de/d02/structsysctl__val">sysctl_val</a></div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00083">jail.c:83</a></div></div>
<div class="ttc" id="aprocd_2jail_2log_8h_html_a15378cd15bafb3a79061424b452497aa"><div class="ttname"><a href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a></div><div class="ttdeci">#define ERROR(fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">log.h:27</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00675">jail_root</a>, and <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00679">build_jail_fs()</a>.</p>

</div>
</div>
<a id="a6c0f3a1b16c319c90fadb78ad09a5336" name="a6c0f3a1b16c319c90fadb78ad09a5336"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c0f3a1b16c319c90fadb78ad09a5336">&#9670;&#160;</a></span>build_envp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char ** build_envp </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>seccomp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>ocienvp</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00959">959</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  960</span>{</div>
<div class="line"><span class="lineno">  961</span>    <span class="keyword">static</span> <span class="keywordtype">char</span> *envp[<a class="code hl_define" href="#a99f47b784bea630430c5e178a336daa4">MAX_ENVP</a>];</div>
<div class="line"><span class="lineno">  962</span>    <span class="keyword">static</span> <span class="keywordtype">char</span> preload_var[PATH_MAX];</div>
<div class="line"><span class="lineno">  963</span>    <span class="keyword">static</span> <span class="keywordtype">char</span> seccomp_var[PATH_MAX];</div>
<div class="line"><span class="lineno">  964</span>    <span class="keyword">static</span> <span class="keywordtype">char</span> seccomp_debug_var[20];</div>
<div class="line"><span class="lineno">  965</span>    <span class="keyword">static</span> <span class="keywordtype">char</span> debug_var[] = <span class="stringliteral">&quot;LD_DEBUG=all&quot;</span>;</div>
<div class="line"><span class="lineno">  966</span>    <span class="keyword">static</span> <span class="keywordtype">char</span> container_var[] = <span class="stringliteral">&quot;container=ujail&quot;</span>;</div>
<div class="line"><span class="lineno">  967</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *preload_lib = <a class="code hl_function" href="../../d2/da6/elf_8c.html#aefdad32a1f287a539e1d6f6d31301e4e">find_lib</a>(<span class="stringliteral">&quot;libpreload-seccomp.so&quot;</span>);</div>
<div class="line"><span class="lineno">  968</span>    <span class="keywordtype">char</span> **addenv;</div>
<div class="line"><span class="lineno">  969</span> </div>
<div class="line"><span class="lineno">  970</span>    <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><span class="lineno">  971</span> </div>
<div class="line"><span class="lineno">  972</span>    <span class="keywordflow">if</span> (seccomp &amp;&amp; !preload_lib) {</div>
<div class="line"><span class="lineno">  973</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to add preload-lib to env\n&quot;</span>);</div>
<div class="line"><span class="lineno">  974</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  975</span>    }</div>
<div class="line"><span class="lineno">  976</span>    <span class="keywordflow">if</span> (seccomp) {</div>
<div class="line"><span class="lineno">  977</span>        snprintf(seccomp_var, <span class="keyword">sizeof</span>(seccomp_var), <span class="stringliteral">&quot;SECCOMP_FILE=%s&quot;</span>, seccomp);</div>
<div class="line"><span class="lineno">  978</span>        envp[count++] = seccomp_var;</div>
<div class="line"><span class="lineno">  979</span>        snprintf(seccomp_debug_var, <span class="keyword">sizeof</span>(seccomp_debug_var), <span class="stringliteral">&quot;SECCOMP_DEBUG=%2d&quot;</span>, <a class="code hl_variable" href="#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>);</div>
<div class="line"><span class="lineno">  980</span>        envp[count++] = seccomp_debug_var;</div>
<div class="line"><span class="lineno">  981</span>        snprintf(preload_var, <span class="keyword">sizeof</span>(preload_var), <span class="stringliteral">&quot;LD_PRELOAD=%s&quot;</span>, preload_lib);</div>
<div class="line"><span class="lineno">  982</span>        envp[count++] = preload_var;</div>
<div class="line"><span class="lineno">  983</span>    }</div>
<div class="line"><span class="lineno">  984</span> </div>
<div class="line"><span class="lineno">  985</span>    envp[count++] = container_var;</div>
<div class="line"><span class="lineno">  986</span> </div>
<div class="line"><span class="lineno">  987</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac3e1795766a80ec63b157951b4b9a7d4">debug</a> &gt; 1)</div>
<div class="line"><span class="lineno">  988</span>        envp[count++] = debug_var;</div>
<div class="line"><span class="lineno">  989</span> </div>
<div class="line"><span class="lineno">  990</span>    addenv = ocienvp;</div>
<div class="line"><span class="lineno">  991</span>    <span class="keywordflow">while</span> (addenv &amp;&amp; *addenv) {</div>
<div class="line"><span class="lineno">  992</span>        envp[count++] = *(addenv++);</div>
<div class="line"><span class="lineno">  993</span>        <span class="keywordflow">if</span> (count &gt;= <a class="code hl_define" href="#a99f47b784bea630430c5e178a336daa4">MAX_ENVP</a>) {</div>
<div class="line"><span class="lineno">  994</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;environment limited to %d extra records, truncating\n&quot;</span>, <a class="code hl_define" href="#a99f47b784bea630430c5e178a336daa4">MAX_ENVP</a>);</div>
<div class="line"><span class="lineno">  995</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  996</span>        }</div>
<div class="line"><span class="lineno">  997</span>    }</div>
<div class="line"><span class="lineno">  998</span>    <span class="keywordflow">return</span> envp;</div>
<div class="line"><span class="lineno">  999</span>}</div>
<div class="ttc" id="aelf_8c_html_aefdad32a1f287a539e1d6f6d31301e4e"><div class="ttname"><a href="../../d2/da6/elf_8c.html#aefdad32a1f287a539e1d6f6d31301e4e">find_lib</a></div><div class="ttdeci">const char * find_lib(const char *file)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/da6/elf_8c_source.html#l00094">elf.c:94</a></div></div>
<div class="ttc" id="ajail_8c_html_a99f47b784bea630430c5e178a336daa4"><div class="ttname"><a href="#a99f47b784bea630430c5e178a336daa4">MAX_ENVP</a></div><div class="ttdeci">#define MAX_ENVP</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00958">jail.c:958</a></div></div>
<div class="ttc" id="ajail_8c_html_ac3e1795766a80ec63b157951b4b9a7d4"><div class="ttname"><a href="#ac3e1795766a80ec63b157951b4b9a7d4">debug</a></div><div class="ttdeci">int debug</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00163">jail.c:163</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l00163">debug</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00094">find_lib()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00958">MAX_ENVP</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01256">post_start_hook()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a6c0f3a1b16c319c90fadb78ad09a5336_cgraph.png" border="0" usemap="#add/d26/jail_8c_a6c0f3a1b16c319c90fadb78ad09a5336_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a6c0f3a1b16c319c90fadb78ad09a5336_cgraph" id="add/d26/jail_8c_a6c0f3a1b16c319c90fadb78ad09a5336_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,128,39"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#aefdad32a1f287a539e1d6f6d31301e4e" title=" " alt="" coords="176,5,264,39"/>
<area shape="poly" title=" " alt="" coords="128,20,160,20,160,25,128,25"/>
</map>
</div>

</div>
</div>
<a id="a2f273b0b45f3de3b40e828800395c913" name="a2f273b0b45f3de3b40e828800395c913"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f273b0b45f3de3b40e828800395c913">&#9670;&#160;</a></span>build_jail_fs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int build_jail_fs </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00679">679</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  680</span>{</div>
<div class="line"><span class="lineno">  681</span>    <span class="keywordtype">char</span> *overlaydir = NULL;</div>
<div class="line"><span class="lineno">  682</span>    <span class="keywordtype">int</span> ret;</div>
<div class="line"><span class="lineno">  683</span> </div>
<div class="line"><span class="lineno">  684</span>    <a class="code hl_variable" href="#af71983723dc8d0eeea681bdda36ef470">old_umask</a> = umask(0);</div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>    <span class="keywordflow">if</span> (mkdtemp(<a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>) == NULL) {</div>
<div class="line"><span class="lineno">  687</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;mkdtemp(%s) failed: %m\n&quot;</span>, <a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>);</div>
<div class="line"><span class="lineno">  688</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  689</span>    }</div>
<div class="line"><span class="lineno">  690</span> </div>
<div class="line"><span class="lineno">  691</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="#a76506091a3ac45cc3ce7bdf1c3c279c9">apply_sysctl</a>(<a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>)) {</div>
<div class="line"><span class="lineno">  692</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to apply sysctl values\n&quot;</span>);</div>
<div class="line"><span class="lineno">  693</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  694</span>    }</div>
<div class="line"><span class="lineno">  695</span> </div>
<div class="line"><span class="lineno">  696</span>    <span class="comment">/* oldroot can&#39;t be MS_SHARED else pivot_root() fails */</span></div>
<div class="line"><span class="lineno">  697</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="../../d2/d5a/fs_8c.html#d3/df8/structmount">mount</a>(<span class="stringliteral">&quot;none&quot;</span>, <span class="stringliteral">&quot;/&quot;</span>, <span class="stringliteral">&quot;none&quot;</span>, MS_REC|MS_PRIVATE, NULL)) {</div>
<div class="line"><span class="lineno">  698</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;private mount failed %m\n&quot;</span>);</div>
<div class="line"><span class="lineno">  699</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  700</span>    }</div>
<div class="line"><span class="lineno">  701</span> </div>
<div class="line"><span class="lineno">  702</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.extroot) {</div>
<div class="line"><span class="lineno">  703</span>        <span class="keywordflow">if</span> (<a class="code hl_struct" href="../../d2/d5a/fs_8c.html#d3/df8/structmount">mount</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.extroot, <a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>, <span class="stringliteral">&quot;bind&quot;</span>, MS_BIND, NULL)) {</div>
<div class="line"><span class="lineno">  704</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;extroot mount failed %m\n&quot;</span>);</div>
<div class="line"><span class="lineno">  705</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  706</span>        }</div>
<div class="line"><span class="lineno">  707</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  708</span>        <span class="keywordflow">if</span> (<a class="code hl_struct" href="../../d2/d5a/fs_8c.html#d3/df8/structmount">mount</a>(<span class="stringliteral">&quot;tmpfs&quot;</span>, <a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>, <span class="stringliteral">&quot;tmpfs&quot;</span>, MS_NOATIME, <span class="stringliteral">&quot;mode=0755&quot;</span>)) {</div>
<div class="line"><span class="lineno">  709</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;tmpfs mount failed %m\n&quot;</span>);</div>
<div class="line"><span class="lineno">  710</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  711</span>        }</div>
<div class="line"><span class="lineno">  712</span>    }</div>
<div class="line"><span class="lineno">  713</span> </div>
<div class="line"><span class="lineno">  714</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.tmpoverlaysize) {</div>
<div class="line"><span class="lineno">  715</span>        <span class="keywordtype">char</span> mountoptsstr[] = <span class="stringliteral">&quot;mode=0755,size=XXXXXXXX&quot;</span>;</div>
<div class="line"><span class="lineno">  716</span> </div>
<div class="line"><span class="lineno">  717</span>        snprintf(mountoptsstr, <span class="keyword">sizeof</span>(mountoptsstr),</div>
<div class="line"><span class="lineno">  718</span>             <span class="stringliteral">&quot;mode=0755,size=%s&quot;</span>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.tmpoverlaysize);</div>
<div class="line"><span class="lineno">  719</span>        <span class="keywordflow">if</span> (mkdtemp(<a class="code hl_variable" href="#a3ff424f2e02a1e7f39fc184b68114655">tmpovdir</a>) == NULL) {</div>
<div class="line"><span class="lineno">  720</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;mkdtemp(%s) failed: %m\n&quot;</span>, <a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>);</div>
<div class="line"><span class="lineno">  721</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  722</span>        }</div>
<div class="line"><span class="lineno">  723</span>        <span class="keywordflow">if</span> (<a class="code hl_struct" href="../../d2/d5a/fs_8c.html#d3/df8/structmount">mount</a>(<span class="stringliteral">&quot;tmpfs&quot;</span>, <a class="code hl_variable" href="#a3ff424f2e02a1e7f39fc184b68114655">tmpovdir</a>, <span class="stringliteral">&quot;tmpfs&quot;</span>, MS_NOATIME,</div>
<div class="line"><span class="lineno">  724</span>              mountoptsstr)) {</div>
<div class="line"><span class="lineno">  725</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to mount tmpfs for overlay (size=%s)\n&quot;</span>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.tmpoverlaysize);</div>
<div class="line"><span class="lineno">  726</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  727</span>        }</div>
<div class="line"><span class="lineno">  728</span>        overlaydir = <a class="code hl_variable" href="#a3ff424f2e02a1e7f39fc184b68114655">tmpovdir</a>;</div>
<div class="line"><span class="lineno">  729</span>    }</div>
<div class="line"><span class="lineno">  730</span> </div>
<div class="line"><span class="lineno">  731</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.overlaydir)</div>
<div class="line"><span class="lineno">  732</span>        overlaydir = <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.overlaydir;</div>
<div class="line"><span class="lineno">  733</span> </div>
<div class="line"><span class="lineno">  734</span>    <span class="keywordflow">if</span> (overlaydir) {</div>
<div class="line"><span class="lineno">  735</span>        ret = <a class="code hl_function" href="#af49948409c11b79dd0b28ce038cdd592">mount_overlay</a>(<a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>, overlaydir);</div>
<div class="line"><span class="lineno">  736</span>        <span class="keywordflow">if</span> (ret)</div>
<div class="line"><span class="lineno">  737</span>            <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno">  738</span>    }</div>
<div class="line"><span class="lineno">  739</span> </div>
<div class="line"><span class="lineno">  740</span>    <span class="keywordflow">if</span> (chdir(<a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>)) {</div>
<div class="line"><span class="lineno">  741</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;chdir(%s) (jail_root) failed: %m\n&quot;</span>, <a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>);</div>
<div class="line"><span class="lineno">  742</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  743</span>    }</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a47cfef0db3b7b8feb6675dd2ee7e4d4e">mount_all</a>(<a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>)) {</div>
<div class="line"><span class="lineno">  746</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;mount_all() failed\n&quot;</span>);</div>
<div class="line"><span class="lineno">  747</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  748</span>    }</div>
<div class="line"><span class="lineno">  749</span> </div>
<div class="line"><span class="lineno">  750</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.console)</div>
<div class="line"><span class="lineno">  751</span>        <a class="code hl_function" href="#a08d9992cf8eb531a1783fd80c2af7630">create_dev_console</a>(<a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>);</div>
<div class="line"><span class="lineno">  752</span> </div>
<div class="line"><span class="lineno">  753</span>    <span class="comment">/* make sure /etc/resolv.conf exists if in new network namespace */</span></div>
<div class="line"><span class="lineno">  754</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp; CLONE_NEWNET) {</div>
<div class="line"><span class="lineno">  755</span>        <span class="keywordtype">char</span> jailetc[PATH_MAX], jaillink[PATH_MAX];</div>
<div class="line"><span class="lineno">  756</span> </div>
<div class="line"><span class="lineno">  757</span>        snprintf(jailetc, PATH_MAX, <span class="stringliteral">&quot;%s/etc&quot;</span>, <a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>);</div>
<div class="line"><span class="lineno">  758</span>        <a class="code hl_function" href="../../d0/d2b/libubox_2utils_8c.html#a9fb089901b41392a5ac197f3e18cc3f7">mkdir_p</a>(jailetc, 0755);</div>
<div class="line"><span class="lineno">  759</span>        snprintf(jaillink, PATH_MAX, <span class="stringliteral">&quot;%s/etc/resolv.conf&quot;</span>, <a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>);</div>
<div class="line"><span class="lineno">  760</span>        <span class="keywordflow">if</span> (overlaydir)</div>
<div class="line"><span class="lineno">  761</span>            unlink(jaillink);</div>
<div class="line"><span class="lineno">  762</span> </div>
<div class="line"><span class="lineno">  763</span>        ret = symlink(<span class="stringliteral">&quot;../dev/resolv.conf.d/resolv.conf.auto&quot;</span>, jaillink);</div>
<div class="line"><span class="lineno">  764</span>        <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line"><span class="lineno">  765</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#adf687db7cdc51402cda267cc86883cc2">WARNING</a>(<span class="stringliteral">&quot;symlink() failed to create link to ../dev/resolv.conf.d/resolv.conf.auto&quot;</span>);</div>
<div class="line"><span class="lineno">  766</span>    }</div>
<div class="line"><span class="lineno">  767</span> </div>
<div class="line"><span class="lineno">  768</span>    <a class="code hl_function" href="#a1756d87ceab7e1c79fe7caf453cb102a">run_hooks</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.createContainer, <a class="code hl_function" href="#a3b82670b51026fbff91952438dd301ac">enter_jail_fs</a>);</div>
<div class="line"><span class="lineno">  769</span> </div>
<div class="line"><span class="lineno">  770</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  771</span>}</div>
<div class="ttc" id="afs_8c_html_a47cfef0db3b7b8feb6675dd2ee7e4d4e"><div class="ttname"><a href="../../d2/d5a/fs_8c.html#a47cfef0db3b7b8feb6675dd2ee7e4d4e">mount_all</a></div><div class="ttdeci">int mount_all(const char *jailroot)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00429">fs.c:429</a></div></div>
<div class="ttc" id="ajail_8c_html_a08d9992cf8eb531a1783fd80c2af7630"><div class="ttname"><a href="#a08d9992cf8eb531a1783fd80c2af7630">create_dev_console</a></div><div class="ttdeci">static int create_dev_console(const char *jail_root)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00373">jail.c:373</a></div></div>
<div class="ttc" id="ajail_8c_html_a1756d87ceab7e1c79fe7caf453cb102a"><div class="ttname"><a href="#a1756d87ceab7e1c79fe7caf453cb102a">run_hooks</a></div><div class="ttdeci">static void run_hooks(struct hook_execvpe **hooklist, hook_return_handler return_cb)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00512">jail.c:512</a></div></div>
<div class="ttc" id="ajail_8c_html_a3b82670b51026fbff91952438dd301ac"><div class="ttname"><a href="#a3b82670b51026fbff91952438dd301ac">enter_jail_fs</a></div><div class="ttdeci">static void enter_jail_fs(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00788">jail.c:788</a></div></div>
<div class="ttc" id="ajail_8c_html_a3ff424f2e02a1e7f39fc184b68114655"><div class="ttname"><a href="#a3ff424f2e02a1e7f39fc184b68114655">tmpovdir</a></div><div class="ttdeci">static char tmpovdir[]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00676">jail.c:676</a></div></div>
<div class="ttc" id="ajail_8c_html_a76506091a3ac45cc3ce7bdf1c3c279c9"><div class="ttname"><a href="#a76506091a3ac45cc3ce7bdf1c3c279c9">apply_sysctl</a></div><div class="ttdeci">static int apply_sysctl(const char *jail_root)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00523">jail.c:523</a></div></div>
<div class="ttc" id="ajail_8c_html_af49948409c11b79dd0b28ce038cdd592"><div class="ttname"><a href="#af49948409c11b79dd0b28ce038cdd592">mount_overlay</a></div><div class="ttdeci">static int mount_overlay(char *jail_root, char *overlaydir)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00288">jail.c:288</a></div></div>
<div class="ttc" id="ajail_8c_html_af71983723dc8d0eeea681bdda36ef470"><div class="ttname"><a href="#af71983723dc8d0eeea681bdda36ef470">old_umask</a></div><div class="ttdeci">static mode_t old_umask</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00677">jail.c:677</a></div></div>
<div class="ttc" id="alibubox_2utils_8c_html_a9fb089901b41392a5ac197f3e18cc3f7"><div class="ttname"><a href="../../d0/d2b/libubox_2utils_8c.html#a9fb089901b41392a5ac197f3e18cc3f7">mkdir_p</a></div><div class="ttdeci">int mkdir_p(char *dir, mode_t mask)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d2b/libubox_2utils_8c_source.html#l00161">utils.c:161</a></div></div>
<div class="ttc" id="aprocd_2jail_2log_8h_html_adf687db7cdc51402cda267cc86883cc2"><div class="ttname"><a href="../../d8/d30/procd_2jail_2log_8h.html#adf687db7cdc51402cda267cc86883cc2">WARNING</a></div><div class="ttdeci">#define WARNING(fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d30/procd_2jail_2log_8h_source.html#l00023">log.h:23</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l00523">apply_sysctl()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00373">create_dev_console()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00788">enter_jail_fs()</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00675">jail_root</a>, <a class="el" href="../../d0/d2b/libubox_2utils_8c_source.html#l00161">mkdir_p()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00429">mount_all()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00288">mount_overlay()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00677">old_umask</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00512">run_hooks()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00676">tmpovdir</a>, and <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00023">WARNING</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01228">pre_exec_jail()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a2f273b0b45f3de3b40e828800395c913_cgraph.png" border="0" usemap="#add/d26/jail_8c_a2f273b0b45f3de3b40e828800395c913_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a2f273b0b45f3de3b40e828800395c913_cgraph" id="add/d26/jail_8c_a2f273b0b45f3de3b40e828800395c913_cgraph">
<area shape="rect" title=" " alt="" coords="5,560,134,594"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a76506091a3ac45cc3ce7bdf1c3c279c9" title=" " alt="" coords="215,363,349,396"/>
<area shape="poly" title=" " alt="" coords="75,558,89,526,112,484,142,442,180,405,199,394,202,399,183,410,146,445,116,487,94,528,80,561"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a08d9992cf8eb531a1783fd80c2af7630" title=" " alt="" coords="182,420,382,454"/>
<area shape="poly" title=" " alt="" coords="81,558,122,511,149,485,180,463,189,458,191,463,183,467,153,489,125,514,85,561"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a3b82670b51026fbff91952438dd301ac" title=" " alt="" coords="216,477,348,511"/>
<area shape="poly" title=" " alt="" coords="114,557,221,515,223,520,116,562"/>
<area shape="rect" href="../../d0/d2b/libubox_2utils_8c.html#a9fb089901b41392a5ac197f3e18cc3f7" title=" " alt="" coords="709,652,806,686"/>
<area shape="poly" title=" " alt="" coords="134,583,694,658,694,663,134,588"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a1756d87ceab7e1c79fe7caf453cb102a" title=" " alt="" coords="699,560,816,594"/>
<area shape="poly" title=" " alt="" coords="134,574,683,574,683,580,134,580"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a47cfef0db3b7b8feb6675dd2ee7e4d4e" title=" " alt="" coords="226,748,338,782"/>
<area shape="poly" title=" " alt="" coords="84,592,124,648,152,680,183,709,229,739,226,743,180,714,148,684,120,651,80,596"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#af49948409c11b79dd0b28ce038cdd592" title=" " alt="" coords="203,665,361,699"/>
<area shape="poly" title=" " alt="" coords="97,592,136,618,183,644,213,657,211,662,180,649,133,622,94,596"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#ab8805304877ae73abf20f1016d21de70" title=" " alt="" coords="446,200,589,234"/>
<area shape="poly" title=" " alt="" coords="363,417,380,407,398,388,407,370,415,349,428,325,490,244,494,247,432,328,420,351,412,372,402,391,384,411,366,422"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a58d1b624b96aa768608f45d390cc0d59" title=" " alt="" coords="684,229,831,263"/>
<area shape="poly" title=" " alt="" coords="590,223,669,233,668,238,589,228"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#af8ca2237342df92c699fbb2ddb5f390b" title=" " alt="" coords="937,89,1077,123"/>
<area shape="poly" title=" " alt="" coords="530,198,579,146,614,120,652,100,721,82,793,77,861,79,922,86,921,91,861,84,793,82,722,88,654,105,617,124,583,150,534,201"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a4bba0979961750f86b8dc9915b2fa4d6" title=" " alt="" coords="653,339,862,372"/>
<area shape="poly" title=" " alt="" coords="539,232,590,274,655,317,683,330,681,335,652,322,586,278,536,236"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a332dc7ace8193793cad0d83b33acbc07" title=" " alt="" coords="683,5,832,39"/>
<area shape="poly" title=" " alt="" coords="527,198,575,130,611,90,652,56,675,43,678,48,655,60,615,94,579,133,531,201"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2" title=" " alt="" coords="1209,309,1321,343"/>
<area shape="poly" title=" " alt="" coords="552,232,599,254,654,273,761,290,910,304,1194,321,1193,326,909,309,760,295,653,278,597,259,549,237"/>
<area shape="rect" href="../../d2/de5/libubus-req_8c.html#a572cdb5570d677242d1bc90d2d592852" title=" " alt="" coords="675,172,840,206"/>
<area shape="poly" title=" " alt="" coords="589,206,660,198,660,203,590,211"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a8567c5497fc066b17da409d9b0512c54" title=" " alt="" coords="676,115,839,148"/>
<area shape="poly" title=" " alt="" coords="555,197,652,157,672,151,674,156,654,162,557,202"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#af8de35ec0673663c45f2aad7c876d329" title=" " alt="" coords="1213,117,1318,151"/>
<area shape="poly" title=" " alt="" coords="1077,111,1197,124,1196,129,1077,116"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6f17715cbf1ce82b0981a452537b4dc6" title=" " alt="" coords="1175,60,1355,94"/>
<area shape="poly" title=" " alt="" coords="1077,96,1159,86,1160,91,1077,101"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5bf37ab2b48095b7fb16ac11449b08f6" title=" " alt="" coords="910,339,1104,372"/>
<area shape="poly" title=" " alt="" coords="862,353,894,353,894,358,862,358"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a7af2a1ce52064d2c84b5bc1d97244acd" title=" " alt="" coords="914,5,1100,39"/>
<area shape="poly" title=" " alt="" coords="833,20,898,20,898,25,833,25"/>
<area shape="poly" title=" " alt="" coords="839,121,921,112,922,117,840,126"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#af4fee5cb798e92300377ba06fda39a5b" title=" " alt="" coords="439,505,596,539"/>
<area shape="poly" title=" " alt="" coords="348,499,424,508,423,514,348,505"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a0d1316d1e009899e8b8b735bb6ba70e3" title=" " alt="" coords="935,424,1079,458"/>
<area shape="poly" title=" " alt="" coords="347,476,381,464,404,447,414,440,429,433,494,417,561,408,628,403,695,402,818,409,920,422,919,427,818,414,694,407,628,408,561,413,495,423,431,438,417,444,407,452,383,469,349,481"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a607ba83d17934834c11576f3761ac577" title=" " alt="" coords="462,339,574,372"/>
<area shape="poly" title=" " alt="" coords="347,481,380,464,396,447,404,429,412,409,428,390,446,377,449,382,432,393,416,412,409,431,401,450,384,468,349,485"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#ab88c4a768e1c297fb6b3757942876398" title=" " alt="" coords="457,448,579,482"/>
<area shape="poly" title=" " alt="" coords="348,483,441,472,441,477,348,489"/>
<area shape="poly" title=" " alt="" coords="548,537,655,604,716,641,713,646,652,608,545,542"/>
<area shape="poly" title=" " alt="" coords="715,653,710,643,716,633,732,627,758,625,785,628,800,634,798,639,783,633,757,631,733,633,719,637,715,643,719,650"/>
<area shape="poly" title=" " alt="" coords="1046,421,1210,347,1212,352,1048,426"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b" title=" " alt="" coords="1426,412,1567,446"/>
<area shape="poly" title=" " alt="" coords="1079,429,1152,424,1265,421,1378,424,1411,424,1411,429,1378,429,1265,426,1152,429,1080,435"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a61855620d1a0683f786486b1722d7dfa" title=" " alt="" coords="1212,439,1318,472"/>
<area shape="poly" title=" " alt="" coords="1080,442,1197,449,1197,454,1079,448"/>
<area shape="poly" title=" " alt="" coords="1319,447,1411,436,1411,441,1319,452"/>
<area shape="poly" title=" " alt="" coords="579,459,919,442,919,448,579,465"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a292407d99b98bbc178b7760e2107725d" title=" " alt="" coords="674,499,841,532"/>
<area shape="poly" title=" " alt="" coords="580,475,660,492,659,497,579,480"/>
<area shape="poly" title=" " alt="" coords="581,478,607,491,622,504,631,517,640,530,655,543,685,557,683,562,652,547,636,534,627,520,618,508,604,495,578,482"/>
<area shape="poly" title=" " alt="" coords="815,496,933,460,934,465,817,501"/>
<area shape="poly" title=" " alt="" coords="841,503,1196,461,1197,466,842,508"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a88ee3d42d3e892d3b5dd714d89b49505" title=" " alt="" coords="940,588,1074,622"/>
<area shape="poly" title=" " alt="" coords="817,581,924,593,924,598,816,586"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a71525bf218f3fe2889a36b88e7b9964d" title=" " alt="" coords="1152,668,1378,702"/>
<area shape="poly" title=" " alt="" coords="1032,620,1080,641,1138,662,1136,667,1078,646,1030,625"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb" title=" " alt="" coords="1167,496,1363,530"/>
<area shape="poly" title=" " alt="" coords="1041,585,1092,561,1151,538,1172,532,1173,537,1153,543,1095,566,1043,590"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077" title=" " alt="" coords="1209,553,1322,587"/>
<area shape="poly" title=" " alt="" coords="1074,593,1193,577,1194,582,1074,599"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="1171,611,1360,644"/>
<area shape="poly" title=" " alt="" coords="1074,608,1155,615,1155,621,1074,613"/>
<area shape="poly" title=" " alt="" coords="1230,670,1151,647,1088,627,1090,622,1153,642,1232,665"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a31752c6608fbf56bb359ba109bdc6f6f" title=" " alt="" coords="430,773,605,807"/>
<area shape="poly" title=" " alt="" coords="338,768,415,776,414,782,338,773"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#ab3f280d4a5a86fc2a2c0632a4a271ef8" title=" " alt="" coords="449,831,587,864"/>
<area shape="poly" title=" " alt="" coords="330,780,431,817,448,823,446,828,429,822,328,785"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a9a6c15b3db1b76232ac5ccf46cca0aef" title=" " alt="" coords="461,716,574,750"/>
<area shape="poly" title=" " alt="" coords="337,755,445,740,446,745,338,760"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4824ede62a9ceedb153f039c5dc212f9" title=" " alt="" coords="665,773,850,807"/>
<area shape="poly" title=" " alt="" coords="606,788,650,788,650,793,606,793"/>
<area shape="poly" title=" " alt="" coords="574,715,694,683,695,688,575,720"/>
<area shape="poly" title=" " alt="" coords="361,677,694,668,694,673,361,683"/>
</map>
</div>

</div>
</div>
<a id="a31575d38ed43b739ca94e78c23e5b1e0" name="a31575d38ed43b739ca94e78c23e5b1e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31575d38ed43b739ca94e78c23e5b1e0">&#9670;&#160;</a></span>checkpath()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int checkpath </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02540">2540</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2541</span>{</div>
<div class="line"><span class="lineno"> 2542</span>    <span class="keywordtype">int</span> dirfd = open(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, O_RDONLY | O_DIRECTORY | O_CLOEXEC);</div>
<div class="line"><span class="lineno"> 2543</span>    <span class="keywordflow">if</span> (dirfd &lt; 0) {</div>
<div class="line"><span class="lineno"> 2544</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;path %s open failed %m\n&quot;</span>, <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>);</div>
<div class="line"><span class="lineno"> 2545</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 2546</span>    }</div>
<div class="line"><span class="lineno"> 2547</span>    close(dirfd);</div>
<div class="line"><span class="lineno"> 2548</span> </div>
<div class="line"><span class="lineno"> 2549</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2550</span>}</div>
<div class="ttc" id="aubusd__obj_8c_html_a9ece2e576492090c46d5e3b435cef7d4"><div class="ttname"><a href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a></div><div class="ttdeci">struct avl_tree path</div><div class="ttdef"><b>Definition</b> <a href="../../df/d0e/ubusd__obj_8c_source.html#l00019">ubusd_obj.c:19</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, and <a class="el" href="../../df/d0e/ubusd__obj_8c_source.html#l00019">path</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02583">main()</a>.</p>

</div>
</div>
<a id="ae3670ecb9a71cd74f8a871ca3ff6f091" name="ae3670ecb9a71cd74f8a871ca3ff6f091"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3670ecb9a71cd74f8a871ca3ff6f091">&#9670;&#160;</a></span>container_handle_kill()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int container_handle_kill </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d55/libubus_8h.html#df/d18/structubus__context">ubus_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/d00/ubusd__obj_8h.html#d6/d75/structubus__object">ubus_object</a> *</td>          <td class="paramname"><span class="paramname"><em>obj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../db/d55/libubus_8h.html#d5/d2a/structubus__request__data">ubus_request_data</a> *</td>          <td class="paramname"><span class="paramname"><em>req</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>method</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02489">2489</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2492</span>{</div>
<div class="line"><span class="lineno"> 2493</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *tb[<a class="code hl_enumvalue" href="#a9b29769343da78881f442e657eb62b6eaa656c9648d631f597fe6ab93da6c8420">__CONTAINER_KILL_ATTR_MAX</a>], *cur;</div>
<div class="line"><span class="lineno"> 2494</span>    <span class="keywordtype">int</span> sig = SIGTERM;</div>
<div class="line"><span class="lineno"> 2495</span> </div>
<div class="line"><span class="lineno"> 2496</span>    <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#a8acd133e16a1d2f660965034ad651713">container_kill_attrs</a>, <a class="code hl_enumvalue" href="#a9b29769343da78881f442e657eb62b6eaa656c9648d631f597fe6ab93da6c8420">__CONTAINER_KILL_ATTR_MAX</a>, tb, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(msg), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052">blobmsg_data_len</a>(msg));</div>
<div class="line"><span class="lineno"> 2497</span> </div>
<div class="line"><span class="lineno"> 2498</span>    cur = tb[<a class="code hl_enumvalue" href="#a9b29769343da78881f442e657eb62b6eaf6c2e8ccd2ffe9d627f296e938428c0b">CONTAINER_KILL_ATTR_SIGNAL</a>];</div>
<div class="line"><span class="lineno"> 2499</span>    <span class="keywordflow">if</span> (cur)</div>
<div class="line"><span class="lineno"> 2500</span>        sig = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(cur);</div>
<div class="line"><span class="lineno"> 2501</span> </div>
<div class="line"><span class="lineno"> 2502</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af5e3a2bd12c4c9ed553bdacc21e97b65">jail_oci_state</a> == <a class="code hl_enumvalue" href="#a97f905ac94bfebd46e50e32c7389e6eba13f094d14b519859226de69d2baca06d">OCI_STATE_CREATING</a>)</div>
<div class="line"><span class="lineno"> 2503</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d5/d79/ubusmsg_8h.html#a99bec0c168a4d5ac338ad787dfb73312a50138190147e8a5a7af366614d0c4b97">UBUS_STATUS_NOT_FOUND</a>;</div>
<div class="line"><span class="lineno"> 2504</span> </div>
<div class="line"><span class="lineno"> 2505</span>    <span class="keywordflow">if</span> (kill(<a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, sig) == 0)</div>
<div class="line"><span class="lineno"> 2506</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2507</span> </div>
<div class="line"><span class="lineno"> 2508</span>    <span class="keywordflow">switch</span> (errno) {</div>
<div class="line"><span class="lineno"> 2509</span>    <span class="keywordflow">case</span> EINVAL: <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d5/d79/ubusmsg_8h.html#a99bec0c168a4d5ac338ad787dfb73312a01547e86014c16f5a948f832185ce2e7">UBUS_STATUS_INVALID_ARGUMENT</a>;</div>
<div class="line"><span class="lineno"> 2510</span>    <span class="keywordflow">case</span> EPERM:  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d5/d79/ubusmsg_8h.html#a99bec0c168a4d5ac338ad787dfb73312aa18a040703e9965952f5c93c3e727d39">UBUS_STATUS_PERMISSION_DENIED</a>;</div>
<div class="line"><span class="lineno"> 2511</span>    <span class="keywordflow">case</span> ESRCH:  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d5/d79/ubusmsg_8h.html#a99bec0c168a4d5ac338ad787dfb73312a50138190147e8a5a7af366614d0c4b97">UBUS_STATUS_NOT_FOUND</a>;</div>
<div class="line"><span class="lineno"> 2512</span>    }</div>
<div class="line"><span class="lineno"> 2513</span> </div>
<div class="line"><span class="lineno"> 2514</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d5/d79/ubusmsg_8h.html#a99bec0c168a4d5ac338ad787dfb73312ab8845eab4efc86465452fa517b43c2b5">UBUS_STATUS_UNKNOWN_ERROR</a>;</div>
<div class="line"><span class="lineno"> 2515</span>}</div>
<div class="ttc" id="ablob_8h_html_dc/dd9/structblob__attr"><div class="ttname"><a href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a></div><div class="ttdef"><b>Definition</b> <a href="../../d8/d3c/blob_8h_source.html#l00052">blob.h:52</a></div></div>
<div class="ttc" id="ablobmsg_8c_html_afb56b36905412b6618a529c171e833ed"><div class="ttname"><a href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a></div><div class="ttdeci">int blobmsg_parse(const struct blobmsg_policy *policy, int policy_len, struct blob_attr **tb, void *data, unsigned int len)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d30/blobmsg_8c_source.html#l00166">blobmsg.c:166</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a065ed993444c3173838a480ba4aac052"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052">blobmsg_data_len</a></div><div class="ttdeci">static size_t blobmsg_data_len(const struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00095">blobmsg.h:95</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a856562b4d96007d3ce1a052998451a0f"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a></div><div class="ttdeci">static uint32_t blobmsg_get_u32(struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00293">blobmsg.h:293</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_ab788ffb2ae75d047fa39be6e79571d20"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a></div><div class="ttdeci">static void * blobmsg_data(const struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00078">blobmsg.h:78</a></div></div>
<div class="ttc" id="ajail_8c_html_a02d170ed9179a61ee4049ed3ec9eadf1"><div class="ttname"><a href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a></div><div class="ttdeci">static struct uloop_process jail_process</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01107">jail.c:1107</a></div></div>
<div class="ttc" id="ajail_8c_html_a8acd133e16a1d2f660965034ad651713"><div class="ttname"><a href="#a8acd133e16a1d2f660965034ad651713">container_kill_attrs</a></div><div class="ttdeci">static const struct blobmsg_policy container_kill_attrs[__CONTAINER_KILL_ATTR_MAX]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02484">jail.c:2484</a></div></div>
<div class="ttc" id="ajail_8c_html_af5e3a2bd12c4c9ed553bdacc21e97b65"><div class="ttname"><a href="#af5e3a2bd12c4c9ed553bdacc21e97b65">jail_oci_state</a></div><div class="ttdeci">static int jail_oci_state</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02419">jail.c:2419</a></div></div>
<div class="ttc" id="aubusmsg_8h_html_a99bec0c168a4d5ac338ad787dfb73312a01547e86014c16f5a948f832185ce2e7"><div class="ttname"><a href="../../d5/d79/ubusmsg_8h.html#a99bec0c168a4d5ac338ad787dfb73312a01547e86014c16f5a948f832185ce2e7">UBUS_STATUS_INVALID_ARGUMENT</a></div><div class="ttdeci">@ UBUS_STATUS_INVALID_ARGUMENT</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d79/ubusmsg_8h_source.html#l00121">ubusmsg.h:121</a></div></div>
<div class="ttc" id="aubusmsg_8h_html_a99bec0c168a4d5ac338ad787dfb73312a50138190147e8a5a7af366614d0c4b97"><div class="ttname"><a href="../../d5/d79/ubusmsg_8h.html#a99bec0c168a4d5ac338ad787dfb73312a50138190147e8a5a7af366614d0c4b97">UBUS_STATUS_NOT_FOUND</a></div><div class="ttdeci">@ UBUS_STATUS_NOT_FOUND</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d79/ubusmsg_8h_source.html#l00123">ubusmsg.h:123</a></div></div>
<div class="ttc" id="aubusmsg_8h_html_a99bec0c168a4d5ac338ad787dfb73312aa18a040703e9965952f5c93c3e727d39"><div class="ttname"><a href="../../d5/d79/ubusmsg_8h.html#a99bec0c168a4d5ac338ad787dfb73312aa18a040703e9965952f5c93c3e727d39">UBUS_STATUS_PERMISSION_DENIED</a></div><div class="ttdeci">@ UBUS_STATUS_PERMISSION_DENIED</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d79/ubusmsg_8h_source.html#l00125">ubusmsg.h:125</a></div></div>
<div class="ttc" id="aubusmsg_8h_html_a99bec0c168a4d5ac338ad787dfb73312ab8845eab4efc86465452fa517b43c2b5"><div class="ttname"><a href="../../d5/d79/ubusmsg_8h.html#a99bec0c168a4d5ac338ad787dfb73312ab8845eab4efc86465452fa517b43c2b5">UBUS_STATUS_UNKNOWN_ERROR</a></div><div class="ttdeci">@ UBUS_STATUS_UNKNOWN_ERROR</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d79/ubusmsg_8h_source.html#l00128">ubusmsg.h:128</a></div></div>
<div class="ttc" id="auloop_8h_html_a41e26562918b24966ac2e0d7906fb1b8"><div class="ttname"><a href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">uloop_process::pid</a></div><div class="ttdeci">pid_t pid</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d56/uloop_8h_source.html#l00087">uloop.h:87</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l02481">__CONTAINER_KILL_ATTR_MAX</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00078">blobmsg_data()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00095">blobmsg_data_len()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00293">blobmsg_get_u32()</a>, <a class="el" href="../../d1/d30/blobmsg_8c_source.html#l00166">blobmsg_parse()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02480">CONTAINER_KILL_ATTR_SIGNAL</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02484">container_kill_attrs</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02419">jail_oci_state</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01107">jail_process</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02413">OCI_STATE_CREATING</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00087">uloop_process::pid</a>, <a class="el" href="../../d5/d79/ubusmsg_8h_source.html#l00121">UBUS_STATUS_INVALID_ARGUMENT</a>, <a class="el" href="../../d5/d79/ubusmsg_8h_source.html#l00123">UBUS_STATUS_NOT_FOUND</a>, <a class="el" href="../../d5/d79/ubusmsg_8h_source.html#l00125">UBUS_STATUS_PERMISSION_DENIED</a>, and <a class="el" href="../../d5/d79/ubusmsg_8h_source.html#l00128">UBUS_STATUS_UNKNOWN_ERROR</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_ae3670ecb9a71cd74f8a871ca3ff6f091_cgraph.png" border="0" usemap="#add/d26/jail_8c_ae3670ecb9a71cd74f8a871ca3ff6f091_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_ae3670ecb9a71cd74f8a871ca3ff6f091_cgraph" id="add/d26/jail_8c_ae3670ecb9a71cd74f8a871ca3ff6f091_cgraph">
<area shape="rect" title=" " alt="" coords="5,181,221,215"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="1044,256,1195,290"/>
<area shape="poly" title=" " alt="" coords="171,178,314,144,408,127,513,115,624,108,738,112,851,127,906,140,960,157,998,174,1034,197,1091,243,1088,247,1031,201,995,179,958,162,905,145,850,132,737,117,624,114,513,120,409,133,315,149,173,183"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052" title=" " alt="" coords="770,479,959,512"/>
<area shape="poly" title=" " alt="" coords="153,213,410,325,588,397,771,465,789,471,788,476,769,470,586,402,408,330,151,218"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f" title=" " alt="" coords="508,153,693,187"/>
<area shape="poly" title=" " alt="" coords="221,189,492,174,492,179,221,195"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed" title=" " alt="" coords="269,208,431,242"/>
<area shape="poly" title=" " alt="" coords="221,208,253,211,253,216,221,213"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="1320,456,1431,490"/>
<area shape="poly" title=" " alt="" coords="1197,279,1216,287,1234,299,1247,314,1255,329,1260,360,1265,391,1271,406,1282,421,1314,446,1310,450,1278,425,1266,408,1260,392,1255,361,1250,331,1243,317,1230,303,1214,291,1195,284"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="1285,199,1466,232"/>
<area shape="poly" title=" " alt="" coords="1195,253,1282,233,1283,239,1196,258"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ac239a83ed3c7f835e2b49f785953c934" title=" " alt="" coords="1290,313,1460,347"/>
<area shape="poly" title=" " alt="" coords="1196,287,1283,307,1282,312,1195,292"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a7613e130753e766f5d381c06b1f7b86f" title=" " alt="" coords="1280,256,1470,290"/>
<area shape="poly" title=" " alt="" coords="1196,270,1265,270,1265,275,1196,275"/>
<area shape="poly" title=" " alt="" coords="943,476,957,465,972,445,979,425,980,383,981,341,989,320,1005,299,1028,283,1031,287,1008,303,993,322,986,342,985,384,984,426,976,448,961,469,947,480"/>
<area shape="poly" title=" " alt="" coords="959,489,1304,473,1304,478,959,494"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a9921d2b89577d3344abbb66f24773e32" title=" " alt="" coords="1326,377,1424,411"/>
<area shape="poly" title=" " alt="" coords="943,475,1006,462,1231,423,1310,406,1311,412,1233,429,1007,467,944,480"/>
<area shape="poly" title=" " alt="" coords="694,163,821,166,891,174,959,189,1025,214,1081,245,1078,250,1023,219,958,194,890,180,821,172,694,168"/>
<area shape="poly" title=" " alt="" coords="367,240,415,293,481,353,556,413,616,458,681,492,771,522,843,537,917,543,992,543,1065,537,1199,517,1304,491,1305,497,1200,522,1066,543,992,548,917,548,842,542,770,527,679,497,613,462,552,417,477,357,411,297,363,244"/>
<area shape="poly" title=" " alt="" coords="359,206,378,180,405,148,439,117,478,94,586,53,682,24,770,8,854,3,937,10,1026,28,1123,56,1233,94,1269,112,1302,135,1352,185,1349,189,1298,140,1266,116,1231,99,1121,61,1024,33,937,15,853,8,770,13,683,29,588,58,480,99,442,122,409,152,382,183,364,209"/>
<area shape="poly" title=" " alt="" coords="368,205,415,169,446,151,478,138,549,120,610,110,665,107,717,111,824,130,959,157,1118,196,1302,248,1300,254,1116,201,958,162,823,135,716,116,665,113,611,115,550,125,480,143,448,156,418,173,371,209"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#ac79cacbc6a47f754832dc10bafa3b761" title=" " alt="" coords="821,204,908,238"/>
<area shape="poly" title=" " alt="" coords="431,221,806,218,806,224,431,227"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5a5283071ac5677652515d9a8460e655" title=" " alt="" coords="479,309,722,343"/>
<area shape="poly" title=" " alt="" coords="395,240,544,300,542,305,393,245"/>
<area shape="poly" title=" " alt="" coords="723,311,1028,279,1029,285,723,316"/>
<area shape="poly" title=" " alt="" coords="620,341,683,402,725,436,772,465,781,470,779,475,769,470,722,440,679,406,616,345"/>
<area shape="poly" title=" " alt="" coords="643,306,769,254,805,240,807,245,771,259,645,311"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6b6c429265d86411d05951d2fae7289a" title=" " alt="" coords="777,364,952,398"/>
<area shape="poly" title=" " alt="" coords="686,341,765,358,764,363,685,346"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a2c4753820a7472bba7b999fbba79df01" title=" " alt="" coords="794,421,935,455"/>
<area shape="poly" title=" " alt="" coords="634,341,697,374,771,408,787,413,785,418,769,412,694,379,632,346"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a131936c081164c18e6241d79f3b276d1" title=" " alt="" coords="1007,313,1232,347"/>
<area shape="poly" title=" " alt="" coords="723,324,991,326,991,332,723,330"/>
<area shape="poly" title=" " alt="" coords="935,429,1310,397,1311,402,936,435"/>
<area shape="poly" title=" " alt="" coords="1151,345,1281,421,1328,446,1325,451,1279,426,1148,350"/>
<area shape="poly" title=" " alt="" coords="1210,310,1230,300,1245,286,1254,272,1263,256,1278,241,1285,237,1288,242,1282,245,1267,259,1258,274,1250,290,1234,304,1212,315"/>
<area shape="poly" title=" " alt="" coords="1232,327,1274,327,1274,333,1232,333"/>
<area shape="poly" title=" " alt="" coords="1197,310,1282,291,1283,296,1198,315"/>
<area shape="poly" title=" " alt="" coords="1190,345,1312,376,1310,381,1189,350"/>
</map>
</div>

</div>
</div>
<a id="a08d9992cf8eb531a1783fd80c2af7630" name="a08d9992cf8eb531a1783fd80c2af7630"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08d9992cf8eb531a1783fd80c2af7630">&#9670;&#160;</a></span>create_dev_console()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int create_dev_console </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>jail_root</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00373">373</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  374</span>{</div>
<div class="line"><span class="lineno">  375</span>    <span class="keywordtype">char</span> *console_fname;</div>
<div class="line"><span class="lineno">  376</span>    <span class="keywordtype">char</span> dev_console_path[PATH_MAX];</div>
<div class="line"><span class="lineno">  377</span>    <span class="keywordtype">int</span> slave_console_fd, dev_console_dummy;</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>    <span class="comment">/* Open UNIX/98 virtual console */</span></div>
<div class="line"><span class="lineno">  380</span>    <a class="code hl_variable" href="#a9942f1401f46e915dbfecc403324f562">console_fd</a> = posix_openpt(O_RDWR | O_NOCTTY);</div>
<div class="line"><span class="lineno">  381</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a9942f1401f46e915dbfecc403324f562">console_fd</a> &lt; 0)</div>
<div class="line"><span class="lineno">  382</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>    console_fname = ptsname(<a class="code hl_variable" href="#a9942f1401f46e915dbfecc403324f562">console_fd</a>);</div>
<div class="line"><span class="lineno">  385</span>    <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;got console fd %d and PTS client name %s\n&quot;</span>, <a class="code hl_variable" href="#a9942f1401f46e915dbfecc403324f562">console_fd</a>, console_fname);</div>
<div class="line"><span class="lineno">  386</span>    <span class="keywordflow">if</span> (!console_fname)</div>
<div class="line"><span class="lineno">  387</span>        <span class="keywordflow">goto</span> no_console;</div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span>    grantpt(<a class="code hl_variable" href="#a9942f1401f46e915dbfecc403324f562">console_fd</a>);</div>
<div class="line"><span class="lineno">  390</span>    unlockpt(<a class="code hl_variable" href="#a9942f1401f46e915dbfecc403324f562">console_fd</a>);</div>
<div class="line"><span class="lineno">  391</span> </div>
<div class="line"><span class="lineno">  392</span>    <span class="comment">/* pass PTY master to procd */</span></div>
<div class="line"><span class="lineno">  393</span>    <a class="code hl_function" href="#ab8805304877ae73abf20f1016d21de70">pass_console</a>(<a class="code hl_variable" href="#a9942f1401f46e915dbfecc403324f562">console_fd</a>);</div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>    <span class="comment">/* mount-bind PTY slave to /dev/console in jail */</span></div>
<div class="line"><span class="lineno">  396</span>    snprintf(dev_console_path, <span class="keyword">sizeof</span>(dev_console_path), <span class="stringliteral">&quot;%s/dev/console&quot;</span>, <a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>);</div>
<div class="line"><span class="lineno">  397</span>    dev_console_dummy = creat(dev_console_path, 0620);</div>
<div class="line"><span class="lineno">  398</span>    <span class="keywordflow">if</span> (dev_console_dummy &lt; 0)</div>
<div class="line"><span class="lineno">  399</span>        <span class="keywordflow">goto</span> no_console;</div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>    close(dev_console_dummy);</div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="../../d2/d5a/fs_8c.html#d3/df8/structmount">mount</a>(console_fname, dev_console_path, <span class="stringliteral">&quot;bind&quot;</span>, MS_BIND, NULL))</div>
<div class="line"><span class="lineno">  404</span>        <span class="keywordflow">goto</span> no_console;</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>    <span class="comment">/* use PTY slave for stdio */</span></div>
<div class="line"><span class="lineno">  407</span>    slave_console_fd = open(console_fname, O_RDWR); <span class="comment">/* | O_NOCTTY */</span></div>
<div class="line"><span class="lineno">  408</span>    <span class="keywordflow">if</span> (slave_console_fd &lt; 0)</div>
<div class="line"><span class="lineno">  409</span>        <span class="keywordflow">goto</span> no_console;</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>    dup2(slave_console_fd, 0);</div>
<div class="line"><span class="lineno">  412</span>    dup2(slave_console_fd, 1);</div>
<div class="line"><span class="lineno">  413</span>    dup2(slave_console_fd, 2);</div>
<div class="line"><span class="lineno">  414</span>    close(slave_console_fd);</div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span>    <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#ab56f6599fb46785e4265a3033ba91aa6">INFO</a>(<span class="stringliteral">&quot;using guest console %s\n&quot;</span>, console_fname);</div>
<div class="line"><span class="lineno">  417</span> </div>
<div class="line"><span class="lineno">  418</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span>no_console:</div>
<div class="line"><span class="lineno">  421</span>    close(<a class="code hl_variable" href="#a9942f1401f46e915dbfecc403324f562">console_fd</a>);</div>
<div class="line"><span class="lineno">  422</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  423</span>}</div>
<div class="ttc" id="ajail_8c_html_a9942f1401f46e915dbfecc403324f562"><div class="ttname"><a href="#a9942f1401f46e915dbfecc403324f562">console_fd</a></div><div class="ttdeci">int console_fd</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00169">jail.c:169</a></div></div>
<div class="ttc" id="ajail_8c_html_ab8805304877ae73abf20f1016d21de70"><div class="ttname"><a href="#ab8805304877ae73abf20f1016d21de70">pass_console</a></div><div class="ttdeci">static void pass_console(int console_fd)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00351">jail.c:351</a></div></div>
<div class="ttc" id="aprocd_2jail_2log_8h_html_ab56f6599fb46785e4265a3033ba91aa6"><div class="ttname"><a href="../../d8/d30/procd_2jail_2log_8h.html#ab56f6599fb46785e4265a3033ba91aa6">INFO</a></div><div class="ttdeci">#define INFO(fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d30/procd_2jail_2log_8h_source.html#l00020">log.h:20</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l00169">console_fd</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00020">INFO</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00675">jail_root</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00351">pass_console()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00679">build_jail_fs()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a08d9992cf8eb531a1783fd80c2af7630_cgraph.png" border="0" usemap="#add/d26/jail_8c_a08d9992cf8eb531a1783fd80c2af7630_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a08d9992cf8eb531a1783fd80c2af7630_cgraph" id="add/d26/jail_8c_a08d9992cf8eb531a1783fd80c2af7630_cgraph">
<area shape="rect" title=" " alt="" coords="5,408,206,442"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#ab8805304877ae73abf20f1016d21de70" title=" " alt="" coords="254,408,397,442"/>
<area shape="poly" title=" " alt="" coords="206,422,238,422,238,428,206,428"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a58d1b624b96aa768608f45d390cc0d59" title=" " alt="" coords="1063,5,1210,39"/>
<area shape="poly" title=" " alt="" coords="326,407,336,356,356,287,372,250,391,214,415,180,443,151,477,125,513,102,591,65,673,39,757,22,840,12,917,8,1048,11,1048,16,918,13,840,17,758,27,675,44,593,70,516,107,480,129,447,155,419,183,396,216,377,252,361,289,341,358,332,408"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#af8ca2237342df92c699fbb2ddb5f390b" title=" " alt="" coords="1067,625,1206,659"/>
<area shape="poly" title=" " alt="" coords="397,415,531,406,692,402,771,406,842,413,901,427,943,448,961,467,969,488,971,509,970,531,970,573,976,593,991,612,1020,630,1052,639,1051,644,1017,635,988,616,972,596,964,574,964,530,966,509,964,489,956,470,940,452,900,432,841,419,771,411,692,408,531,411,398,420"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a4bba0979961750f86b8dc9915b2fa4d6" title=" " alt="" coords="445,796,653,830"/>
<area shape="poly" title=" " alt="" coords="334,441,374,555,407,630,447,702,482,747,519,784,515,787,478,750,443,705,402,632,369,557,329,443"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a332dc7ace8193793cad0d83b33acbc07" title=" " alt="" coords="475,353,624,387"/>
<area shape="poly" title=" " alt="" coords="397,405,462,389,463,394,398,410"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2" title=" " alt="" coords="493,165,605,199"/>
<area shape="poly" title=" " alt="" coords="341,406,520,209,524,212,345,409"/>
<area shape="rect" href="../../d2/de5/libubus-req_8c.html#a572cdb5570d677242d1bc90d2d592852" title=" " alt="" coords="467,492,631,526"/>
<area shape="poly" title=" " alt="" coords="373,440,489,484,487,489,372,445"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a8567c5497fc066b17da409d9b0512c54" title=" " alt="" coords="468,657,631,691"/>
<area shape="poly" title=" " alt="" coords="344,440,524,644,520,647,340,444"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#af8de35ec0673663c45f2aad7c876d329" title=" " alt="" coords="1369,597,1474,631"/>
<area shape="poly" title=" " alt="" coords="1206,633,1353,618,1353,623,1207,638"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6f17715cbf1ce82b0981a452537b4dc6" title=" " alt="" coords="1331,655,1511,688"/>
<area shape="poly" title=" " alt="" coords="1207,647,1316,658,1315,663,1206,652"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a99c424ce706ada40920b2f57259e223b" title=" " alt="" coords="1763,501,1905,535"/>
<area shape="poly" title=" " alt="" coords="1442,595,1492,559,1524,541,1559,528,1606,516,1655,510,1747,508,1747,514,1656,516,1607,522,1560,533,1527,546,1495,563,1445,599"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#ab4e3964334a7aec029ab29a2c724f248" title=" " alt="" coords="1559,543,1715,576"/>
<area shape="poly" title=" " alt="" coords="1473,598,1552,578,1554,583,1475,604"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a686c428a3ab7c421820e049ab2384d47" title=" " alt="" coords="1763,572,1905,606"/>
<area shape="poly" title=" " alt="" coords="1474,608,1747,591,1747,597,1475,614"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#abe9f6013aad507ac84630ee773b806b6" title=" " alt="" coords="1569,652,1705,686"/>
<area shape="poly" title=" " alt="" coords="1475,625,1554,645,1553,650,1473,630"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a4fb5423718fbcc165ed995360ab3ea96" title=" " alt="" coords="1587,709,1687,743"/>
<area shape="poly" title=" " alt="" coords="1476,623,1513,640,1529,654,1538,669,1546,682,1561,696,1574,704,1572,709,1558,700,1542,686,1533,671,1525,658,1510,644,1473,628"/>
<area shape="poly" title=" " alt="" coords="1715,541,1747,534,1748,539,1716,546"/>
<area shape="poly" title=" " alt="" coords="1715,568,1748,573,1747,579,1715,574"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5bf37ab2b48095b7fb16ac11449b08f6" title=" " alt="" coords="724,852,919,886"/>
<area shape="poly" title=" " alt="" coords="635,828,722,846,721,851,634,833"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#aed178aa087a351c74f7f6cd34e56ba0c" title=" " alt="" coords="1062,852,1211,886"/>
<area shape="poly" title=" " alt="" coords="919,866,1047,866,1047,872,919,872"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a7af2a1ce52064d2c84b5bc1d97244acd" title=" " alt="" coords="728,353,915,387"/>
<area shape="poly" title=" " alt="" coords="624,368,712,368,712,373,624,373"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#af44d4960ede7f23f071bf00e360bc23d" title=" " alt="" coords="1093,396,1180,430"/>
<area shape="poly" title=" " alt="" coords="916,380,1078,402,1078,408,915,385"/>
<area shape="rect" href="../../da/d23/list_8h.html#aea85dd50b9129ddaa3e3c67ed55804e4" title=" " alt="" coords="1337,369,1505,403"/>
<area shape="poly" title=" " alt="" coords="915,370,1321,381,1321,386,915,375"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a036f33fcd35d949bef89d33b8615cdac" title=" " alt="" coords="1065,453,1208,487"/>
<area shape="poly" title=" " alt="" coords="896,385,943,404,967,423,977,432,991,440,1051,458,1049,463,989,445,974,436,964,427,940,408,894,390"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#aad66bdeaeb9fd01138f3956eff30c69b" title=" " alt="" coords="990,511,1283,544"/>
<area shape="poly" title=" " alt="" coords="911,385,943,404,955,416,962,428,968,453,974,476,980,487,991,497,995,500,992,505,988,502,976,490,969,478,963,454,957,430,950,419,940,408,909,390"/>
<area shape="rect" href="../../dc/d80/libubus-io_8c.html#aa0791c7960dffbb35e38a4f32001c331" title=" " alt="" coords="1042,568,1231,602"/>
<area shape="poly" title=" " alt="" coords="916,385,943,404,958,424,966,443,967,482,970,520,977,538,991,555,1008,567,1028,575,1026,580,1006,571,988,559,972,540,964,521,962,483,960,444,954,426,940,408,913,390"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#af261be039e78f42c48f896232e2c2c62" title=" " alt="" coords="996,172,1277,206"/>
<area shape="poly" title=" " alt="" coords="834,351,895,284,939,246,988,214,1000,209,1002,214,991,219,942,250,899,288,838,355"/>
<area shape="rect" href="../../dc/d80/libubus-io_8c.html#ac9d684a5b03a2819e0ea9780975a44e1" title=" " alt="" coords="1053,287,1220,320"/>
<area shape="poly" title=" " alt="" coords="904,350,1038,322,1039,327,905,355"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae960d01033fb72572bc1aa539a501fe7" title=" " alt="" coords="1081,229,1192,263"/>
<area shape="poly" title=" " alt="" coords="846,351,908,311,948,290,989,272,1027,260,1065,252,1066,257,1028,265,991,277,950,294,911,315,848,355"/>
<area shape="poly" title=" " alt="" coords="1180,406,1321,393,1322,398,1180,411"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="1338,173,1504,207"/>
<area shape="poly" title=" " alt="" coords="1220,290,1282,273,1337,245,1384,214,1387,218,1340,250,1284,278,1221,296"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a7390a5f2c227d5ba53e2bd65afda1cfc" title=" " alt="" coords="738,101,905,135"/>
<area shape="poly" title=" " alt="" coords="605,166,732,136,733,142,606,172"/>
<area shape="poly" title=" " alt="" coords="867,98,989,56,1047,40,1049,45,990,61,868,103"/>
<area shape="poly" title=" " alt="" coords="901,98,982,86,1078,78,1182,81,1234,88,1284,100,1314,111,1343,127,1391,161,1388,165,1340,131,1312,116,1282,105,1233,93,1182,86,1079,83,982,91,902,103"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="1026,115,1247,148"/>
<area shape="poly" title=" " alt="" coords="906,119,1011,124,1011,129,906,124"/>
<area shape="rect" href="../../d1/d5c/rcS_8c.html#a49473a90e2fe9252f856e10246252554" title=" " alt="" coords="802,463,841,496"/>
<area shape="poly" title=" " alt="" coords="631,497,786,480,787,486,632,503"/>
<area shape="rect" href="../../d2/de5/libubus-req_8c.html#a42b839aa1a2ef9dd5abdba7c25400b4b" title=" " alt="" coords="701,577,942,611"/>
<area shape="poly" title=" " alt="" coords="593,524,702,564,726,570,725,576,701,569,591,529"/>
<area shape="rect" href="../../d2/de5/libubus-req_8c.html#a50302440f98786d5bcc4770a627bf8dc" title=" " alt="" coords="708,520,935,554"/>
<area shape="poly" title=" " alt="" coords="632,515,693,521,692,526,631,520"/>
<area shape="poly" title=" " alt="" coords="920,552,943,563,959,575,968,588,976,601,991,612,1020,624,1052,632,1051,638,1019,629,988,616,973,604,963,591,955,579,940,567,918,557"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#ac8502f265053dcc41bf8b5ea1fd2dd33" title=" " alt="" coords="1054,683,1219,716"/>
<area shape="poly" title=" " alt="" coords="927,552,943,563,956,576,963,590,968,618,973,645,980,657,991,669,1014,683,1040,692,1038,697,1012,688,988,674,975,661,968,647,963,619,958,592,951,579,940,567,924,557"/>
<area shape="poly" title=" " alt="" coords="631,667,1051,644,1051,649,631,672"/>
<area shape="poly" title=" " alt="" coords="608,654,746,613,748,618,610,659"/>
<area shape="poly" title=" " alt="" coords="631,675,1039,693,1038,698,631,680"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#ad9a92a327d8621e1eee7014bac19bc2b" title=" " alt="" coords="724,737,919,771"/>
<area shape="poly" title=" " alt="" coords="610,689,748,730,746,735,608,694"/>
<area shape="rect" href="../../d2/de5/libubus-req_8c.html#a4cba0d855e6f3ed0fac6a0c6c41c8f49" title=" " alt="" coords="722,795,921,828"/>
<area shape="poly" title=" " alt="" coords="571,689,627,735,664,760,702,781,716,787,714,792,700,786,661,765,624,740,567,693"/>
</map>
</div>

</div>
</div>
<a id="af4fee5cb798e92300377ba06fda39a5b" name="af4fee5cb798e92300377ba06fda39a5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4fee5cb798e92300377ba06fda39a5b">&#9670;&#160;</a></span>create_devices()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int create_devices </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00592">592</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  593</span>{</div>
<div class="line"><span class="lineno">  594</span>    <span class="keyword">struct </span><a class="code hl_struct" href="#d5/db5/structmknod__args">mknod_args</a> **cur, *curdef;</div>
<div class="line"><span class="lineno">  595</span>    <span class="keywordtype">char</span> *<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, *tmp;</div>
<div class="line"><span class="lineno">  596</span>    <span class="keywordtype">int</span> ret;</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.devices)</div>
<div class="line"><span class="lineno">  599</span>        <span class="keywordflow">goto</span> only_default_devices;</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>    cur = <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.devices;</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>    <span class="keywordflow">while</span> (*cur) {</div>
<div class="line"><span class="lineno">  604</span>        <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a> = (*cur)-&gt;path;</div>
<div class="line"><span class="lineno">  605</span>        <span class="comment">/* don&#39;t allow devices outside of /dev */</span></div>
<div class="line"><span class="lineno">  606</span>        <span class="keywordflow">if</span> (strncmp(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, <span class="stringliteral">&quot;/dev&quot;</span>, 4))</div>
<div class="line"><span class="lineno">  607</span>            <span class="keywordflow">return</span> EPERM;</div>
<div class="line"><span class="lineno">  608</span> </div>
<div class="line"><span class="lineno">  609</span>        <span class="comment">/* make sure parent folder exists */</span></div>
<div class="line"><span class="lineno">  610</span>        tmp = strrchr(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno">  611</span>        <span class="keywordflow">if</span> (!tmp)</div>
<div class="line"><span class="lineno">  612</span>            <span class="keywordflow">return</span> EINVAL;</div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span>        *tmp = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  615</span>        <span class="keywordflow">if</span> (strcmp(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, <span class="stringliteral">&quot;/dev&quot;</span>)) {</div>
<div class="line"><span class="lineno">  616</span>            <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;creating directory %s\n&quot;</span>, <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>);</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>            <a class="code hl_function" href="../../d0/d2b/libubox_2utils_8c.html#a9fb089901b41392a5ac197f3e18cc3f7">mkdir_p</a>(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, 0755);</div>
<div class="line"><span class="lineno">  619</span>        }</div>
<div class="line"><span class="lineno">  620</span>        *tmp = <span class="charliteral">&#39;/&#39;</span>;</div>
<div class="line"><span class="lineno">  621</span> </div>
<div class="line"><span class="lineno">  622</span>        <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;creating %s (mode=%08o)\n&quot;</span>, <a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, (*cur)-&gt;mode);</div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span>        <span class="comment">/* create device */</span></div>
<div class="line"><span class="lineno">  625</span>        <span class="keywordflow">if</span> (mknod(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, (*cur)-&gt;mode, (*cur)-&gt;dev))</div>
<div class="line"><span class="lineno">  626</span>            <span class="keywordflow">return</span> errno;</div>
<div class="line"><span class="lineno">  627</span> </div>
<div class="line"><span class="lineno">  628</span>        <span class="comment">/* change owner, if needed */</span></div>
<div class="line"><span class="lineno">  629</span>        <span class="keywordflow">if</span> (((*cur)-&gt;uid || (*cur)-&gt;gid) &amp;&amp;</div>
<div class="line"><span class="lineno">  630</span>            chown(<a class="code hl_variable" href="../../df/d0e/ubusd__obj_8c.html#a9ece2e576492090c46d5e3b435cef7d4">path</a>, (*cur)-&gt;uid, (*cur)-&gt;gid))</div>
<div class="line"><span class="lineno">  631</span>            <span class="keywordflow">return</span> errno;</div>
<div class="line"><span class="lineno">  632</span> </div>
<div class="line"><span class="lineno">  633</span>        ++cur;</div>
<div class="line"><span class="lineno">  634</span>    }</div>
<div class="line"><span class="lineno">  635</span> </div>
<div class="line"><span class="lineno">  636</span>only_default_devices:</div>
<div class="line"><span class="lineno">  637</span>    curdef = <a class="code hl_variable" href="#ac967e6b320d955511a5e66e36f579622">default_devices</a>;</div>
<div class="line"><span class="lineno">  638</span>    <span class="keywordflow">while</span>(curdef-&gt;<a class="code hl_variable" href="#ad0d8de31878303df1c911492dfade935">path</a>) {</div>
<div class="line"><span class="lineno">  639</span>        <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;creating %s (mode=%08o)\n&quot;</span>, curdef-&gt;<a class="code hl_variable" href="#ad0d8de31878303df1c911492dfade935">path</a>, curdef-&gt;<a class="code hl_variable" href="#a3b9b0f5b6acc5a3df5e4c7eb0f686ef6">mode</a>);</div>
<div class="line"><span class="lineno">  640</span>        <span class="keywordflow">if</span> (mknod(curdef-&gt;<a class="code hl_variable" href="#ad0d8de31878303df1c911492dfade935">path</a>, curdef-&gt;<a class="code hl_variable" href="#a3b9b0f5b6acc5a3df5e4c7eb0f686ef6">mode</a>, curdef-&gt;<a class="code hl_variable" href="#a1e856bfa3ae2ac3a7c555a66140bea42">dev</a>)) {</div>
<div class="line"><span class="lineno">  641</span>            ++curdef;</div>
<div class="line"><span class="lineno">  642</span>            <span class="keywordflow">continue</span>; <span class="comment">/* may already exist, eg. due to a bind-mount */</span></div>
<div class="line"><span class="lineno">  643</span>        }</div>
<div class="line"><span class="lineno">  644</span>        <span class="keywordflow">if</span> ((curdef-&gt;<a class="code hl_variable" href="#a12ad74a7a8c429f2cbd4341dbc0fcea7">uid</a> || curdef-&gt;<a class="code hl_variable" href="#a5d2aa9579d69f85c4762141947bdb3e1">gid</a>) &amp;&amp;</div>
<div class="line"><span class="lineno">  645</span>            chown(curdef-&gt;<a class="code hl_variable" href="#ad0d8de31878303df1c911492dfade935">path</a>, curdef-&gt;<a class="code hl_variable" href="#a12ad74a7a8c429f2cbd4341dbc0fcea7">uid</a>, curdef-&gt;<a class="code hl_variable" href="#a5d2aa9579d69f85c4762141947bdb3e1">gid</a>))</div>
<div class="line"><span class="lineno">  646</span>            <span class="keywordflow">return</span> errno;</div>
<div class="line"><span class="lineno">  647</span> </div>
<div class="line"><span class="lineno">  648</span>        ++curdef;</div>
<div class="line"><span class="lineno">  649</span>    }</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>    <span class="comment">/* Dev symbolic links as defined in OCI spec */</span></div>
<div class="line"><span class="lineno">  652</span>    ret = symlink(<span class="stringliteral">&quot;/dev/pts/ptmx&quot;</span>, <span class="stringliteral">&quot;/dev/ptmx&quot;</span>);</div>
<div class="line"><span class="lineno">  653</span>    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line"><span class="lineno">  654</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#adf687db7cdc51402cda267cc86883cc2">WARNING</a>(<span class="stringliteral">&quot;symlink() failed to create link to /dev/pts/ptmx&quot;</span>);</div>
<div class="line"><span class="lineno">  655</span> </div>
<div class="line"><span class="lineno">  656</span>    ret = symlink(<span class="stringliteral">&quot;/proc/self/fd&quot;</span>, <span class="stringliteral">&quot;/dev/fd&quot;</span>);</div>
<div class="line"><span class="lineno">  657</span>    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line"><span class="lineno">  658</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#adf687db7cdc51402cda267cc86883cc2">WARNING</a>(<span class="stringliteral">&quot;symlink() failed to create link to /proc/self/fd&quot;</span>);</div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span>    ret = symlink(<span class="stringliteral">&quot;/proc/self/fd/0&quot;</span>, <span class="stringliteral">&quot;/dev/stdin&quot;</span>);</div>
<div class="line"><span class="lineno">  661</span>    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line"><span class="lineno">  662</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#adf687db7cdc51402cda267cc86883cc2">WARNING</a>(<span class="stringliteral">&quot;symlink() failed to create link to /proc/self/fd/0&quot;</span>);</div>
<div class="line"><span class="lineno">  663</span> </div>
<div class="line"><span class="lineno">  664</span>    ret = symlink(<span class="stringliteral">&quot;/proc/self/fd/1&quot;</span>, <span class="stringliteral">&quot;/dev/stdout&quot;</span>);</div>
<div class="line"><span class="lineno">  665</span>    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line"><span class="lineno">  666</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#adf687db7cdc51402cda267cc86883cc2">WARNING</a>(<span class="stringliteral">&quot;symlink() failed to create link to /proc/self/fd/1&quot;</span>);</div>
<div class="line"><span class="lineno">  667</span> </div>
<div class="line"><span class="lineno">  668</span>    ret = symlink(<span class="stringliteral">&quot;/proc/self/fd/2&quot;</span>, <span class="stringliteral">&quot;/dev/stderr&quot;</span>);</div>
<div class="line"><span class="lineno">  669</span>    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line"><span class="lineno">  670</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#adf687db7cdc51402cda267cc86883cc2">WARNING</a>(<span class="stringliteral">&quot;symlink() failed to create link to /proc/self/fd/2&quot;</span>);</div>
<div class="line"><span class="lineno">  671</span> </div>
<div class="line"><span class="lineno">  672</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  673</span>}</div>
<div class="ttc" id="ajail_8c_html_a12ad74a7a8c429f2cbd4341dbc0fcea7"><div class="ttname"><a href="#a12ad74a7a8c429f2cbd4341dbc0fcea7">mknod_args::uid</a></div><div class="ttdeci">uid_t uid</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00092">jail.c:92</a></div></div>
<div class="ttc" id="ajail_8c_html_a1e856bfa3ae2ac3a7c555a66140bea42"><div class="ttname"><a href="#a1e856bfa3ae2ac3a7c555a66140bea42">mknod_args::dev</a></div><div class="ttdeci">dev_t dev</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00091">jail.c:91</a></div></div>
<div class="ttc" id="ajail_8c_html_a3b9b0f5b6acc5a3df5e4c7eb0f686ef6"><div class="ttname"><a href="#a3b9b0f5b6acc5a3df5e4c7eb0f686ef6">mknod_args::mode</a></div><div class="ttdeci">mode_t mode</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00090">jail.c:90</a></div></div>
<div class="ttc" id="ajail_8c_html_a5d2aa9579d69f85c4762141947bdb3e1"><div class="ttname"><a href="#a5d2aa9579d69f85c4762141947bdb3e1">mknod_args::gid</a></div><div class="ttdeci">gid_t gid</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00093">jail.c:93</a></div></div>
<div class="ttc" id="ajail_8c_html_ac967e6b320d955511a5e66e36f579622"><div class="ttname"><a href="#ac967e6b320d955511a5e66e36f579622">default_devices</a></div><div class="ttdeci">static struct mknod_args default_devices[]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00582">jail.c:582</a></div></div>
<div class="ttc" id="ajail_8c_html_ad0d8de31878303df1c911492dfade935"><div class="ttname"><a href="#ad0d8de31878303df1c911492dfade935">mknod_args::path</a></div><div class="ttdeci">char * path</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00089">jail.c:89</a></div></div>
<div class="ttc" id="ajail_8c_html_d5/db5/structmknod__args"><div class="ttname"><a href="#d5/db5/structmknod__args">mknod_args</a></div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00088">jail.c:88</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00582">default_devices</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00091">mknod_args::dev</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00093">mknod_args::gid</a>, <a class="el" href="../../d0/d2b/libubox_2utils_8c_source.html#l00161">mkdir_p()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00090">mknod_args::mode</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00089">mknod_args::path</a>, <a class="el" href="../../df/d0e/ubusd__obj_8c_source.html#l00019">path</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00092">mknod_args::uid</a>, and <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00023">WARNING</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00788">enter_jail_fs()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_af4fee5cb798e92300377ba06fda39a5b_cgraph.png" border="0" usemap="#add/d26/jail_8c_af4fee5cb798e92300377ba06fda39a5b_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_af4fee5cb798e92300377ba06fda39a5b_cgraph" id="add/d26/jail_8c_af4fee5cb798e92300377ba06fda39a5b_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,163,63"/>
<area shape="rect" href="../../d0/d2b/libubox_2utils_8c.html#a9fb089901b41392a5ac197f3e18cc3f7" title=" " alt="" coords="211,29,307,63"/>
<area shape="poly" title=" " alt="" coords="163,44,195,44,195,49,163,49"/>
<area shape="poly" title=" " alt="" coords="227,30,223,20,228,11,240,5,259,3,279,5,290,12,288,16,277,10,259,8,242,10,232,15,229,20,232,28"/>
</map>
</div>

</div>
</div>
<a id="a3b82670b51026fbff91952438dd301ac" name="a3b82670b51026fbff91952438dd301ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b82670b51026fbff91952438dd301ac">&#9670;&#160;</a></span>enter_jail_fs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void enter_jail_fs </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00788">788</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  789</span>{</div>
<div class="line"><span class="lineno">  790</span>    <span class="keywordtype">char</span> dirbuf[<span class="keyword">sizeof</span>(<a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>) + 4];</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>    snprintf(dirbuf, <span class="keyword">sizeof</span>(dirbuf), <span class="stringliteral">&quot;%s/old&quot;</span>, <a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>);</div>
<div class="line"><span class="lineno">  793</span>    mkdir(dirbuf, 0755);</div>
<div class="line"><span class="lineno">  794</span> </div>
<div class="line"><span class="lineno">  795</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="#a607ba83d17934834c11576f3761ac577">pivot_root</a>(<a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>, dirbuf) == -1) {</div>
<div class="line"><span class="lineno">  796</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;pivot_root(%s, %s) failed: %m\n&quot;</span>, <a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>, dirbuf);</div>
<div class="line"><span class="lineno">  797</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(-1);</div>
<div class="line"><span class="lineno">  798</span>    }</div>
<div class="line"><span class="lineno">  799</span>    <span class="keywordflow">if</span> (chdir(<span class="stringliteral">&quot;/&quot;</span>)) {</div>
<div class="line"><span class="lineno">  800</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;chdir(/) (after pivot_root) failed: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno">  801</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(-1);</div>
<div class="line"><span class="lineno">  802</span>    }</div>
<div class="line"><span class="lineno">  803</span> </div>
<div class="line"><span class="lineno">  804</span>    snprintf(dirbuf, <span class="keyword">sizeof</span>(dirbuf), <span class="stringliteral">&quot;/old%s&quot;</span>, <a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>);</div>
<div class="line"><span class="lineno">  805</span>    umount2(dirbuf, MNT_DETACH);</div>
<div class="line"><span class="lineno">  806</span>    rmdir(dirbuf);</div>
<div class="line"><span class="lineno">  807</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.tmpoverlaysize) {</div>
<div class="line"><span class="lineno">  808</span>        <span class="keywordtype">char</span> tmpdirbuf[<span class="keyword">sizeof</span>(<a class="code hl_variable" href="#a3ff424f2e02a1e7f39fc184b68114655">tmpovdir</a>) + 4];</div>
<div class="line"><span class="lineno">  809</span>        snprintf(tmpdirbuf, <span class="keyword">sizeof</span>(tmpdirbuf), <span class="stringliteral">&quot;/old%s&quot;</span>, <a class="code hl_variable" href="#a3ff424f2e02a1e7f39fc184b68114655">tmpovdir</a>);</div>
<div class="line"><span class="lineno">  810</span>        umount2(tmpdirbuf, MNT_DETACH);</div>
<div class="line"><span class="lineno">  811</span>        rmdir(tmpdirbuf);</div>
<div class="line"><span class="lineno">  812</span>    }</div>
<div class="line"><span class="lineno">  813</span> </div>
<div class="line"><span class="lineno">  814</span>    umount2(<span class="stringliteral">&quot;/old&quot;</span>, MNT_DETACH);</div>
<div class="line"><span class="lineno">  815</span>    rmdir(<span class="stringliteral">&quot;/old&quot;</span>);</div>
<div class="line"><span class="lineno">  816</span> </div>
<div class="line"><span class="lineno">  817</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="#af4fee5cb798e92300377ba06fda39a5b">create_devices</a>()) {</div>
<div class="line"><span class="lineno">  818</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;create_devices() failed\n&quot;</span>);</div>
<div class="line"><span class="lineno">  819</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(-1);</div>
<div class="line"><span class="lineno">  820</span>    }</div>
<div class="line"><span class="lineno">  821</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ronly)</div>
<div class="line"><span class="lineno">  822</span>        <a class="code hl_struct" href="../../d2/d5a/fs_8c.html#d3/df8/structmount">mount</a>(NULL, <span class="stringliteral">&quot;/&quot;</span>, <span class="stringliteral">&quot;bind&quot;</span>, MS_REMOUNT | MS_BIND | MS_RDONLY, 0);</div>
<div class="line"><span class="lineno">  823</span> </div>
<div class="line"><span class="lineno">  824</span>    umask(<a class="code hl_variable" href="#af71983723dc8d0eeea681bdda36ef470">old_umask</a>);</div>
<div class="line"><span class="lineno">  825</span>    <a class="code hl_function" href="#ab88c4a768e1c297fb6b3757942876398">post_jail_fs</a>();</div>
<div class="line"><span class="lineno">  826</span>}</div>
<div class="ttc" id="ajail_8c_html_a0d1316d1e009899e8b8b735bb6ba70e3"><div class="ttname"><a href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a></div><div class="ttdeci">static void free_and_exit(int ret)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00774">jail.c:774</a></div></div>
<div class="ttc" id="ajail_8c_html_a607ba83d17934834c11576f3761ac577"><div class="ttname"><a href="#a607ba83d17934834c11576f3761ac577">pivot_root</a></div><div class="ttdeci">int pivot_root(const char *new_root, const char *put_old)</div></div>
<div class="ttc" id="ajail_8c_html_ab88c4a768e1c297fb6b3757942876398"><div class="ttname"><a href="#ab88c4a768e1c297fb6b3757942876398">post_jail_fs</a></div><div class="ttdeci">static void post_jail_fs(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01239">jail.c:1239</a></div></div>
<div class="ttc" id="ajail_8c_html_af4fee5cb798e92300377ba06fda39a5b"><div class="ttname"><a href="#af4fee5cb798e92300377ba06fda39a5b">create_devices</a></div><div class="ttdeci">static int create_devices(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00592">jail.c:592</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l00592">create_devices()</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00774">free_and_exit()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00675">jail_root</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00677">old_umask</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="#a607ba83d17934834c11576f3761ac577">pivot_root()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01239">post_jail_fs()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00676">tmpovdir</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00679">build_jail_fs()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a3b82670b51026fbff91952438dd301ac_cgraph.png" border="0" usemap="#add/d26/jail_8c_a3b82670b51026fbff91952438dd301ac_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a3b82670b51026fbff91952438dd301ac_cgraph" id="add/d26/jail_8c_a3b82670b51026fbff91952438dd301ac_cgraph">
<area shape="rect" title=" " alt="" coords="5,647,137,680"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#af4fee5cb798e92300377ba06fda39a5b" title=" " alt="" coords="185,427,342,460"/>
<area shape="poly" title=" " alt="" coords="85,644,235,470,239,474,89,648"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a0d1316d1e009899e8b8b735bb6ba70e3" title=" " alt="" coords="887,459,1031,492"/>
<area shape="poly" title=" " alt="" coords="137,670,273,682,359,684,453,681,551,672,650,653,747,624,837,583,890,544,932,502,935,506,893,548,840,587,749,629,652,658,552,677,453,687,359,690,272,688,137,676"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a607ba83d17934834c11576f3761ac577" title=" " alt="" coords="207,728,320,762"/>
<area shape="poly" title=" " alt="" coords="114,678,209,719,207,724,112,683"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#ab88c4a768e1c297fb6b3757942876398" title=" " alt="" coords="202,592,325,626"/>
<area shape="poly" title=" " alt="" coords="132,643,187,628,188,633,134,649"/>
<area shape="rect" href="../../d0/d2b/libubox_2utils_8c.html#a9fb089901b41392a5ac197f3e18cc3f7" title=" " alt="" coords="426,316,522,350"/>
<area shape="poly" title=" " alt="" coords="286,424,332,391,389,358,409,349,412,354,391,363,335,396,289,428"/>
<area shape="poly" title=" " alt="" coords="436,317,432,307,437,297,451,291,474,289,498,292,511,298,509,303,496,297,474,295,453,297,441,301,437,307,441,315"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b" title=" " alt="" coords="1304,401,1445,435"/>
<area shape="poly" title=" " alt="" coords="1023,455,1079,444,1188,429,1288,420,1289,426,1188,434,1079,449,1024,461"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a61855620d1a0683f786486b1722d7dfa" title=" " alt="" coords="1093,207,1199,240"/>
<area shape="poly" title=" " alt="" coords="971,457,1121,252,1125,255,975,460"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2" title=" " alt="" coords="1090,459,1202,492"/>
<area shape="poly" title=" " alt="" coords="1032,473,1075,473,1075,478,1032,478"/>
<area shape="poly" title=" " alt="" coords="1157,240,1172,272,1194,312,1225,353,1263,388,1291,402,1289,407,1260,392,1221,357,1190,315,1167,274,1152,242"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a7cdfa1304cca32224a444b6e84fac194" title=" " alt="" coords="1306,235,1443,268"/>
<area shape="poly" title=" " alt="" coords="1200,227,1291,239,1290,244,1200,233"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5127f557f43086299c2bf291618dcef5" title=" " alt="" coords="1305,344,1444,378"/>
<area shape="poly" title=" " alt="" coords="1165,239,1206,281,1234,303,1263,323,1292,336,1290,341,1260,327,1230,307,1203,285,1161,243"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a766dbc37dd9f160e1a3b8a9f19651b38" title=" " alt="" coords="1572,317,1720,351"/>
<area shape="poly" title=" " alt="" coords="1177,238,1216,260,1262,278,1338,298,1417,312,1557,327,1556,333,1416,318,1337,303,1260,283,1214,265,1174,243"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#abb68ed1aa9f416ea5f299d7672a3b5c1" title=" " alt="" coords="1276,5,1473,39"/>
<area shape="poly" title=" " alt="" coords="1151,205,1166,171,1189,129,1220,85,1260,48,1266,44,1268,49,1263,52,1224,89,1193,132,1171,174,1156,207"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5a2acf003db67e7475dcb66937cc12bb" title=" " alt="" coords="1312,63,1437,96"/>
<area shape="poly" title=" " alt="" coords="1157,205,1199,155,1228,128,1260,105,1297,90,1299,95,1263,110,1231,132,1203,159,1161,208"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5064c6dcd09eae061c30cba4146bee18" title=" " alt="" coords="1315,120,1434,154"/>
<area shape="poly" title=" " alt="" coords="1175,204,1215,183,1260,162,1299,150,1301,155,1262,167,1217,187,1178,208"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4b6f537dfef57c06536c73d6c7c2ff48" title=" " alt="" coords="1311,177,1438,211"/>
<area shape="poly" title=" " alt="" coords="1199,214,1295,202,1296,207,1200,219"/>
<area shape="poly" title=" " alt="" coords="1444,351,1556,340,1557,346,1445,357"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a7390a5f2c227d5ba53e2bd65afda1cfc" title=" " alt="" coords="1291,459,1458,492"/>
<area shape="poly" title=" " alt="" coords="1203,473,1275,473,1275,478,1203,478"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a58d1b624b96aa768608f45d390cc0d59" title=" " alt="" coords="1573,488,1719,522"/>
<area shape="poly" title=" " alt="" coords="1459,482,1558,493,1557,498,1458,487"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="1563,431,1729,464"/>
<area shape="poly" title=" " alt="" coords="1458,464,1547,455,1548,460,1459,470"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="1536,631,1756,664"/>
<area shape="poly" title=" " alt="" coords="1460,489,1489,501,1529,527,1566,558,1623,617,1619,621,1563,562,1526,532,1486,506,1458,494"/>
<area shape="poly" title=" " alt="" coords="325,604,424,597,553,583,696,561,838,528,876,514,912,497,914,502,878,519,839,533,697,566,554,589,425,602,325,609"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a292407d99b98bbc178b7760e2107725d" title=" " alt="" coords="390,373,557,407"/>
<area shape="poly" title=" " alt="" coords="279,590,444,416,448,420,283,594"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a1756d87ceab7e1c79fe7caf453cb102a" title=" " alt="" coords="415,619,532,652"/>
<area shape="poly" title=" " alt="" coords="325,614,400,623,399,629,324,619"/>
<area shape="poly" title=" " alt="" coords="490,406,537,457,569,483,606,502,643,513,681,519,758,520,830,509,892,495,894,500,831,515,758,525,680,524,642,518,604,507,567,487,533,461,486,409"/>
<area shape="poly" title=" " alt="" coords="543,371,555,360,572,335,578,309,578,283,575,257,572,231,573,205,583,180,604,157,657,121,708,101,757,93,806,95,856,105,909,120,1032,157,1074,174,1111,195,1109,200,1072,178,1030,162,907,125,854,110,805,100,757,98,709,106,660,126,607,162,587,183,579,206,577,231,580,256,583,283,584,310,577,337,559,364,546,375"/>
<area shape="rect" href="../../d2/d61/capabilities_8c.html#a1b699befb42c1321a6088fb948e148ba" title=" " alt="" coords="617,172,827,206"/>
<area shape="poly" title=" " alt="" coords="542,371,555,360,569,343,575,325,578,288,581,252,589,233,603,215,606,213,609,217,607,219,593,236,586,253,583,289,581,326,573,345,559,364,545,375"/>
<area shape="rect" href="../../d8/da1/seccomp-oci_8c.html#a1cd5004c8913a313ee7b35e8bbd27d50" title=" " alt="" coords="605,344,839,378"/>
<area shape="poly" title=" " alt="" coords="558,378,590,374,590,379,558,383"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a6c0f3a1b16c319c90fadb78ad09a5336" title=" " alt="" coords="661,229,783,263"/>
<area shape="poly" title=" " alt="" coords="540,371,556,360,572,339,578,317,585,294,604,272,623,260,644,252,646,257,626,265,607,276,590,297,583,318,577,341,559,364,543,375"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a6f77c1e493a8d84fc93bec1de3f871de" title=" " alt="" coords="654,287,790,320"/>
<area shape="poly" title=" " alt="" coords="531,370,556,360,580,344,604,329,638,317,640,322,606,334,583,349,559,365,533,375"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#aff8b6e0b00af342a873f29ed0161479d" title=" " alt="" coords="655,459,789,492"/>
<area shape="poly" title=" " alt="" coords="511,405,606,445,640,455,639,460,604,450,509,410"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#a5881608c3589830842d1db287f1f896e" title=" " alt="" coords="664,401,780,435"/>
<area shape="poly" title=" " alt="" coords="558,397,649,407,648,413,558,402"/>
<area shape="rect" href="../../d8/d14/capabilities_8h.html#ae865dd59489e27a32f181825180a296d" title=" " alt="" coords="917,229,1001,263"/>
<area shape="poly" title=" " alt="" coords="796,204,839,214,902,230,901,235,838,219,795,209"/>
<area shape="rect" href="../../d8/d14/capabilities_8h.html#abf7e4e3c4c0bc644ea5e76a5e3326108" title=" " alt="" coords="918,172,1000,206"/>
<area shape="poly" title=" " alt="" coords="828,186,902,186,902,192,828,192"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#aefdad32a1f287a539e1d6f6d31301e4e" title=" " alt="" coords="915,287,1003,320"/>
<area shape="poly" title=" " alt="" coords="784,258,839,272,900,286,899,292,838,277,783,263"/>
<area shape="poly" title=" " alt="" coords="791,310,816,317,840,329,873,355,901,385,943,444,939,447,897,388,869,359,837,334,814,322,790,315"/>
<area shape="poly" title=" " alt="" coords="790,473,871,473,871,478,790,478"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a88ee3d42d3e892d3b5dd714d89b49505" title=" " alt="" coords="1079,627,1213,660"/>
<area shape="poly" title=" " alt="" coords="533,634,1064,640,1063,645,533,639"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a71525bf218f3fe2889a36b88e7b9964d" title=" " alt="" coords="1261,631,1488,664"/>
<area shape="poly" title=" " alt="" coords="1214,650,1246,652,1246,657,1214,656"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb" title=" " alt="" coords="1276,516,1473,550"/>
<area shape="poly" title=" " alt="" coords="1165,624,1207,591,1260,558,1274,553,1276,558,1263,563,1210,595,1168,628"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077" title=" " alt="" coords="1318,573,1431,607"/>
<area shape="poly" title=" " alt="" coords="1213,625,1302,604,1303,609,1215,630"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="1280,688,1469,722"/>
<area shape="poly" title=" " alt="" coords="1206,658,1262,674,1288,681,1287,686,1261,679,1205,663"/>
<area shape="poly" title=" " alt="" coords="1488,645,1520,645,1520,650,1488,650"/>
<area shape="poly" title=" " alt="" coords="1261,639,1229,639,1229,634,1261,634"/>
<area shape="poly" title=" " alt="" coords="1457,685,1547,665,1549,671,1458,690"/>
</map>
</div>

</div>
</div>
<a id="a0ec0440bd3676ab8e8d63f8ca3660b3a" name="a0ec0440bd3676ab8e8d63f8ca3660b3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ec0440bd3676ab8e8d63f8ca3660b3a">&#9670;&#160;</a></span>exec_jail()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int exec_jail </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>arg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01161">1161</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1162</span>{</div>
<div class="line"><span class="lineno"> 1163</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>[1];</div>
<div class="line"><span class="lineno"> 1164</span> </div>
<div class="line"><span class="lineno"> 1165</span>    <a class="code hl_variable" href="#a49b89154fcd9cd0089f8c4d9df354d1a">exit_from_child</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1166</span>    prctl(PR_SET_SECUREBITS, 0);</div>
<div class="line"><span class="lineno"> 1167</span> </div>
<div class="line"><span class="lineno"> 1168</span>    <a class="code hl_function" href="../../d1/d08/uloop_8c.html#ae960d01033fb72572bc1aa539a501fe7">uloop_init</a>();</div>
<div class="line"><span class="lineno"> 1169</span>    <a class="code hl_function" href="#ab97dc72992426f87762ca05057c651b3">signals_init</a>();</div>
<div class="line"><span class="lineno"> 1170</span> </div>
<div class="line"><span class="lineno"> 1171</span>    close(<a class="code hl_variable" href="#a541f86a9c230bc87b5e7e2c83e2a6d34">pipes</a>[0]);</div>
<div class="line"><span class="lineno"> 1172</span>    close(<a class="code hl_variable" href="#a541f86a9c230bc87b5e7e2c83e2a6d34">pipes</a>[3]);</div>
<div class="line"><span class="lineno"> 1173</span> </div>
<div class="line"><span class="lineno"> 1174</span>    <a class="code hl_function" href="#ad16db5f10de76210ae8d78de47da352e">setns_open</a>(CLONE_NEWUSER);</div>
<div class="line"><span class="lineno"> 1175</span>    <a class="code hl_function" href="#ad16db5f10de76210ae8d78de47da352e">setns_open</a>(CLONE_NEWNET);</div>
<div class="line"><span class="lineno"> 1176</span>    <a class="code hl_function" href="#ad16db5f10de76210ae8d78de47da352e">setns_open</a>(CLONE_NEWNS);</div>
<div class="line"><span class="lineno"> 1177</span>    <a class="code hl_function" href="#ad16db5f10de76210ae8d78de47da352e">setns_open</a>(CLONE_NEWIPC);</div>
<div class="line"><span class="lineno"> 1178</span>    <a class="code hl_function" href="#ad16db5f10de76210ae8d78de47da352e">setns_open</a>(CLONE_NEWUTS);</div>
<div class="line"><span class="lineno"> 1179</span> </div>
<div class="line"><span class="lineno"> 1180</span>    <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>[0] = <span class="charliteral">&#39;i&#39;</span>;</div>
<div class="line"><span class="lineno"> 1181</span>    <span class="keywordflow">if</span> (write(<a class="code hl_variable" href="#a541f86a9c230bc87b5e7e2c83e2a6d34">pipes</a>[1], <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, 1) &lt; 1) {</div>
<div class="line"><span class="lineno"> 1182</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;can&#39;t write to parent\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1183</span>        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line"><span class="lineno"> 1184</span>    }</div>
<div class="line"><span class="lineno"> 1185</span>    close(<a class="code hl_variable" href="#a541f86a9c230bc87b5e7e2c83e2a6d34">pipes</a>[1]);</div>
<div class="line"><span class="lineno"> 1186</span>    <span class="keywordflow">if</span> (read(<a class="code hl_variable" href="#a541f86a9c230bc87b5e7e2c83e2a6d34">pipes</a>[2], <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, 1) &lt; 1) {</div>
<div class="line"><span class="lineno"> 1187</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;can&#39;t read from parent\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1188</span>        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line"><span class="lineno"> 1189</span>    }</div>
<div class="line"><span class="lineno"> 1190</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>[0] != <span class="charliteral">&#39;O&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1191</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;parent had an error, child exiting\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1192</span>        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line"><span class="lineno"> 1193</span>    }</div>
<div class="line"><span class="lineno"> 1194</span> </div>
<div class="line"><span class="lineno"> 1195</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp; <a class="code hl_define" href="#a9d5d88148a26086567c3731e2e5e110a">CLONE_NEWCGROUP</a>)</div>
<div class="line"><span class="lineno"> 1196</span>        unshare(<a class="code hl_define" href="#a9d5d88148a26086567c3731e2e5e110a">CLONE_NEWCGROUP</a>);</div>
<div class="line"><span class="lineno"> 1197</span> </div>
<div class="line"><span class="lineno"> 1198</span>    <a class="code hl_function" href="#ad16db5f10de76210ae8d78de47da352e">setns_open</a>(<a class="code hl_define" href="#a9d5d88148a26086567c3731e2e5e110a">CLONE_NEWCGROUP</a>);</div>
<div class="line"><span class="lineno"> 1199</span> </div>
<div class="line"><span class="lineno"> 1200</span>    <span class="keywordflow">if</span> ((<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp; CLONE_NEWUSER) || (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.user != -1)) {</div>
<div class="line"><span class="lineno"> 1201</span>        <span class="keywordflow">if</span> (setregid(0, 0) &lt; 0) {</div>
<div class="line"><span class="lineno"> 1202</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;setgid\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1203</span>            <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1204</span>        }</div>
<div class="line"><span class="lineno"> 1205</span>        <span class="keywordflow">if</span> (setreuid(0, 0) &lt; 0) {</div>
<div class="line"><span class="lineno"> 1206</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;setuid\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1207</span>            <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1208</span>        }</div>
<div class="line"><span class="lineno"> 1209</span>        <span class="keywordflow">if</span> (setgroups(0, NULL) &lt; 0) {</div>
<div class="line"><span class="lineno"> 1210</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;setgroups\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1211</span>            <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1212</span>        }</div>
<div class="line"><span class="lineno"> 1213</span>    }</div>
<div class="line"><span class="lineno"> 1214</span> </div>
<div class="line"><span class="lineno"> 1215</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp;&amp; <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hostname &amp;&amp; strlen(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hostname) &gt; 0</div>
<div class="line"><span class="lineno"> 1216</span>            &amp;&amp; sethostname(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hostname, strlen(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hostname))) {</div>
<div class="line"><span class="lineno"> 1217</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;sethostname(%s) failed: %m\n&quot;</span>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hostname);</div>
<div class="line"><span class="lineno"> 1218</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1219</span>    }</div>
<div class="line"><span class="lineno"> 1220</span> </div>
<div class="line"><span class="lineno"> 1221</span>    <a class="code hl_function" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07">uloop_timeout_add</a>(&amp;<a class="code hl_variable" href="#a8d6a59324899212d8504b098b976c894">pre_exec_timeout</a>);</div>
<div class="line"><span class="lineno"> 1222</span>    <a class="code hl_function" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077">uloop_run</a>();</div>
<div class="line"><span class="lineno"> 1223</span> </div>
<div class="line"><span class="lineno"> 1224</span>    <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(-1);</div>
<div class="line"><span class="lineno"> 1225</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1226</span>}</div>
<div class="ttc" id="ajail_8c_html_a49b89154fcd9cd0089f8c4d9df354d1a"><div class="ttname"><a href="#a49b89154fcd9cd0089f8c4d9df354d1a">exit_from_child</a></div><div class="ttdeci">static bool exit_from_child</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00773">jail.c:773</a></div></div>
<div class="ttc" id="ajail_8c_html_a541f86a9c230bc87b5e7e2c83e2a6d34"><div class="ttname"><a href="#a541f86a9c230bc87b5e7e2c83e2a6d34">pipes</a></div><div class="ttdeci">int pipes[4]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01160">jail.c:1160</a></div></div>
<div class="ttc" id="ajail_8c_html_a8d6a59324899212d8504b098b976c894"><div class="ttname"><a href="#a8d6a59324899212d8504b098b976c894">pre_exec_timeout</a></div><div class="ttdeci">static struct uloop_timeout pre_exec_timeout</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01156">jail.c:1156</a></div></div>
<div class="ttc" id="ajail_8c_html_a9d5d88148a26086567c3731e2e5e110a"><div class="ttname"><a href="#a9d5d88148a26086567c3731e2e5e110a">CLONE_NEWCGROUP</a></div><div class="ttdeci">#define CLONE_NEWCGROUP</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00068">jail.c:68</a></div></div>
<div class="ttc" id="ajail_8c_html_ab97dc72992426f87762ca05057c651b3"><div class="ttname"><a href="#ab97dc72992426f87762ca05057c651b3">signals_init</a></div><div class="ttdeci">static void signals_init(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01136">jail.c:1136</a></div></div>
<div class="ttc" id="ajail_8c_html_ad16db5f10de76210ae8d78de47da352e"><div class="ttname"><a href="#ad16db5f10de76210ae8d78de47da352e">setns_open</a></div><div class="ttdeci">static int setns_open(unsigned long nstype)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01067">jail.c:1067</a></div></div>
<div class="ttc" id="amkdev_8c_html_a024e65f7d9664cdc767f51c283fd8353"><div class="ttname"><a href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a></div><div class="ttdeci">static char buf[PATH_MAX]</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d9a/mkdev_8c_source.html#l00034">mkdev.c:34</a></div></div>
<div class="ttc" id="auloop_8c_html_ae60859ac8015e8f1381e56f5eaae0a07"><div class="ttname"><a href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07">uloop_timeout_add</a></div><div class="ttdeci">int uloop_timeout_add(struct uloop_timeout *timeout)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d08/uloop_8c_source.html#l00298">uloop.c:298</a></div></div>
<div class="ttc" id="auloop_8c_html_ae960d01033fb72572bc1aa539a501fe7"><div class="ttname"><a href="../../d1/d08/uloop_8c.html#ae960d01033fb72572bc1aa539a501fe7">uloop_init</a></div><div class="ttdeci">int uloop_init(void)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d08/uloop_8c_source.html#l00150">uloop.c:150</a></div></div>
<div class="ttc" id="auloop_8h_html_aba97081464ac3304fef640bcfc7d3077"><div class="ttname"><a href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077">uloop_run</a></div><div class="ttdeci">static int uloop_run(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d56/uloop_8h_source.html#l00147">uloop.h:147</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00068">CLONE_NEWCGROUP</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00773">exit_from_child</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00774">free_and_exit()</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01160">pipes</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01156">pre_exec_timeout</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01067">setns_open()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01136">signals_init()</a>, <a class="el" href="../../d1/d08/uloop_8c_source.html#l00150">uloop_init()</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00147">uloop_run()</a>, and <a class="el" href="../../d1/d08/uloop_8c_source.html#l00298">uloop_timeout_add()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a0ec0440bd3676ab8e8d63f8ca3660b3a_cgraph.png" border="0" usemap="#add/d26/jail_8c_a0ec0440bd3676ab8e8d63f8ca3660b3a_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a0ec0440bd3676ab8e8d63f8ca3660b3a_cgraph" id="add/d26/jail_8c_a0ec0440bd3676ab8e8d63f8ca3660b3a_cgraph">
<area shape="rect" title=" " alt="" coords="5,499,104,532"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a0d1316d1e009899e8b8b735bb6ba70e3" title=" " alt="" coords="152,483,296,516"/>
<area shape="poly" title=" " alt="" coords="104,508,136,505,137,510,104,514"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#ad16db5f10de76210ae8d78de47da352e" title=" " alt="" coords="161,555,287,588"/>
<area shape="poly" title=" " alt="" coords="105,529,157,547,156,552,103,534"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#ab97dc72992426f87762ca05057c651b3" title=" " alt="" coords="162,5,286,39"/>
<area shape="poly" title=" " alt="" coords="55,498,65,408,84,277,112,146,130,94,150,57,159,46,163,50,154,60,135,96,117,147,89,278,70,408,60,499"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07" title=" " alt="" coords="872,33,1068,67"/>
<area shape="poly" title=" " alt="" coords="69,496,141,421,261,311,334,252,413,195,498,143,585,100,653,77,723,61,792,52,856,48,856,53,793,57,724,67,654,82,587,105,500,147,416,199,337,256,264,315,145,425,73,500"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae960d01033fb72572bc1aa539a501fe7" title=" " alt="" coords="169,683,279,716"/>
<area shape="poly" title=" " alt="" coords="73,531,199,669,195,673,70,535"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077" title=" " alt="" coords="167,795,281,828"/>
<area shape="poly" title=" " alt="" coords="64,532,98,618,124,674,154,727,197,782,193,785,149,730,119,676,93,621,59,534"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b" title=" " alt="" coords="630,511,770,544"/>
<area shape="poly" title=" " alt="" coords="296,496,344,496,441,492,539,496,615,506,614,512,538,501,441,498,344,501,296,501"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a61855620d1a0683f786486b1722d7dfa" title=" " alt="" coords="388,344,494,378"/>
<area shape="poly" title=" " alt="" coords="250,480,399,384,402,389,253,484"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2" title=" " alt="" coords="385,511,497,544"/>
<area shape="poly" title=" " alt="" coords="297,506,370,516,369,521,296,511"/>
<area shape="poly" title=" " alt="" coords="462,376,526,439,588,489,616,503,614,508,585,494,523,443,458,380"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a7cdfa1304cca32224a444b6e84fac194" title=" " alt="" coords="632,229,768,263"/>
<area shape="poly" title=" " alt="" coords="465,341,518,306,585,272,616,261,618,266,587,277,521,311,468,346"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5127f557f43086299c2bf291618dcef5" title=" " alt="" coords="631,287,769,320"/>
<area shape="poly" title=" " alt="" coords="494,346,615,320,616,325,496,352"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a766dbc37dd9f160e1a3b8a9f19651b38" title=" " alt="" coords="896,372,1044,406"/>
<area shape="poly" title=" " alt="" coords="464,376,518,413,551,431,587,445,649,459,699,462,750,456,813,445,869,430,919,410,921,415,870,435,814,450,750,462,699,467,649,464,586,450,549,436,515,418,461,380"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#abb68ed1aa9f416ea5f299d7672a3b5c1" title=" " alt="" coords="602,344,798,378"/>
<area shape="poly" title=" " alt="" coords="495,358,586,358,586,364,495,364"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5a2acf003db67e7475dcb66937cc12bb" title=" " alt="" coords="638,401,762,435"/>
<area shape="poly" title=" " alt="" coords="496,370,623,399,622,404,494,375"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5064c6dcd09eae061c30cba4146bee18" title=" " alt="" coords="640,115,760,148"/>
<area shape="poly" title=" " alt="" coords="447,343,466,304,496,254,535,202,559,178,585,157,624,139,626,144,588,162,562,182,539,205,500,257,471,306,452,345"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4b6f537dfef57c06536c73d6c7c2ff48" title=" " alt="" coords="637,172,763,206"/>
<area shape="poly" title=" " alt="" coords="453,342,505,279,543,244,585,214,621,200,623,204,588,219,546,248,509,283,457,345"/>
<area shape="poly" title=" " alt="" coords="770,317,814,329,912,363,911,369,813,334,769,322"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a7390a5f2c227d5ba53e2bd65afda1cfc" title=" " alt="" coords="616,568,784,602"/>
<area shape="poly" title=" " alt="" coords="498,537,607,562,606,567,497,542"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="887,624,1053,658"/>
<area shape="poly" title=" " alt="" coords="785,600,872,618,871,623,783,605"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a3aa34193a0ba95da6ede6aa8e16d726f" title=" " alt="" coords="344,568,538,602"/>
<area shape="poly" title=" " alt="" coords="287,573,328,575,328,581,287,578"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a4d20901cfe9adbe227505e368612346d" title=" " alt="" coords="350,5,533,39"/>
<area shape="poly" title=" " alt="" coords="286,20,334,20,334,25,286,25"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="605,5,795,39"/>
<area shape="poly" title=" " alt="" coords="533,20,590,20,590,25,533,25"/>
<area shape="poly" title=" " alt="" coords="795,29,857,36,856,41,795,35"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="1158,63,1287,96"/>
<area shape="poly" title=" " alt="" coords="1069,59,1142,68,1142,73,1068,64"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a76f33118cba0a358482528fad8c0f4cd" title=" " alt="" coords="1183,5,1261,39"/>
<area shape="poly" title=" " alt="" coords="1068,37,1167,25,1168,31,1069,42"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ac0bcdd57d004a600844745bd38e83a2d" title=" " alt="" coords="378,740,505,774"/>
<area shape="poly" title=" " alt="" coords="280,711,363,734,362,739,279,717"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a28e87c6264a681dc2a422d32794416c5" title=" " alt="" coords="596,849,804,883"/>
<area shape="poly" title=" " alt="" coords="245,715,289,750,345,784,388,799,449,814,587,843,585,849,448,820,387,804,343,789,286,754,242,719"/>
<area shape="rect" href="../../d3/d91/uloop-epoll_8c.html#a5b8f7c4e758eaf7384d7dafa9cd59502" title=" " alt="" coords="356,683,527,716"/>
<area shape="poly" title=" " alt="" coords="279,697,340,697,340,702,279,702"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae9d27835a99bfac45ed3f07a26287d7a" title=" " alt="" coords="384,625,498,659"/>
<area shape="poly" title=" " alt="" coords="279,682,368,659,369,664,280,688"/>
<area shape="poly" title=" " alt="" coords="505,739,586,720,871,658,872,663,587,725,506,744"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a13ca20f7af9aa4aa3057b1114e23e7f1" title=" " alt="" coords="586,735,814,768"/>
<area shape="poly" title=" " alt="" coords="505,753,571,751,571,757,505,758"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#afe30e87975d460220899f69103f90d0d" title=" " alt="" coords="592,792,808,826"/>
<area shape="poly" title=" " alt="" coords="506,767,598,786,597,791,505,772"/>
<area shape="poly" title=" " alt="" coords="501,772,540,791,555,803,564,814,573,825,588,836,597,841,595,845,585,840,570,829,560,818,551,806,537,795,499,777"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aabc9ad24aad72332a1e4d9221ee472e4" title=" " alt="" coords="868,931,1072,964"/>
<area shape="poly" title=" " alt="" coords="759,881,898,923,896,928,758,886"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a1651f5bc65e4fff991f6df6f997c6821" title=" " alt="" coords="1126,903,1318,936"/>
<area shape="poly" title=" " alt="" coords="804,874,1111,906,1110,911,804,879"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#accc698d934ee8aef79f735562f95c5fa" title=" " alt="" coords="868,764,1072,798"/>
<area shape="poly" title=" " alt="" coords="783,846,813,836,836,821,860,806,876,801,878,806,863,811,839,826,815,841,785,851"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a57cfc499a638333604b2ab14b3a11a9b" title=" " alt="" coords="862,821,1078,855"/>
<area shape="poly" title=" " alt="" coords="804,853,846,848,846,854,805,858"/>
<area shape="poly" title=" " alt="" coords="1072,934,1110,929,1111,935,1073,939"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a994ffe62801650ad1dca601989bc8145" title=" " alt="" coords="615,625,785,659"/>
<area shape="poly" title=" " alt="" coords="499,640,600,640,600,645,499,645"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a14d4e1fa83f245cd59f0c68f48c90d75" title=" " alt="" coords="345,849,538,883"/>
<area shape="poly" title=" " alt="" coords="282,823,357,842,356,848,280,828"/>
</map>
</div>

</div>
</div>
<a id="a0d1316d1e009899e8b8b735bb6ba70e3" name="a0d1316d1e009899e8b8b735bb6ba70e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d1316d1e009899e8b8b735bb6ba70e3">&#9670;&#160;</a></span>free_and_exit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void free_and_exit </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ret</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00774">774</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  775</span>{</div>
<div class="line"><span class="lineno">  776</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#a49b89154fcd9cd0089f8c4d9df354d1a">exit_from_child</a> &amp;&amp; <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ocibundle)</div>
<div class="line"><span class="lineno">  777</span>        <a class="code hl_function" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b">cgroups_free</a>();</div>
<div class="line"><span class="lineno">  778</span> </div>
<div class="line"><span class="lineno">  779</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#a49b89154fcd9cd0089f8c4d9df354d1a">exit_from_child</a> &amp;&amp; <a class="code hl_variable" href="#a00f1e87fefda65b43a661aefc6f16566">parent_ctx</a>)</div>
<div class="line"><span class="lineno">  780</span>        <a class="code hl_function" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2">ubus_free</a>(<a class="code hl_variable" href="#a00f1e87fefda65b43a661aefc6f16566">parent_ctx</a>);</div>
<div class="line"><span class="lineno">  781</span> </div>
<div class="line"><span class="lineno">  782</span>    <a class="code hl_function" href="#a61855620d1a0683f786486b1722d7dfa">free_opts</a>(!<a class="code hl_variable" href="#a49b89154fcd9cd0089f8c4d9df354d1a">exit_from_child</a>);</div>
<div class="line"><span class="lineno">  783</span> </div>
<div class="line"><span class="lineno">  784</span>    exit(ret);</div>
<div class="line"><span class="lineno">  785</span>}</div>
<div class="ttc" id="acgroups_8c_html_aee024037da9b0bf2d6313b0618a9337b"><div class="ttname"><a href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b">cgroups_free</a></div><div class="ttdeci">void cgroups_free(void)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d40/cgroups_8c_source.html#l00088">cgroups.c:88</a></div></div>
<div class="ttc" id="ajail_8c_html_a00f1e87fefda65b43a661aefc6f16566"><div class="ttname"><a href="#a00f1e87fefda65b43a661aefc6f16566">parent_ctx</a></div><div class="ttdeci">static struct ubus_context * parent_ctx</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00167">jail.c:167</a></div></div>
<div class="ttc" id="ajail_8c_html_a61855620d1a0683f786486b1722d7dfa"><div class="ttname"><a href="#a61855620d1a0683f786486b1722d7dfa">free_opts</a></div><div class="ttdeci">static void free_opts(bool parent)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00254">jail.c:254</a></div></div>
<div class="ttc" id="alibubus_8c_html_a71987f233caf53482181b6eb504d46f2"><div class="ttname"><a href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2">ubus_free</a></div><div class="ttdeci">void ubus_free(struct ubus_context *ctx)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/db9/libubus_8c_source.html#l00378">libubus.c:378</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../db/d40/cgroups_8c_source.html#l00088">cgroups_free()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00773">exit_from_child</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00254">free_opts()</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00167">parent_ctx</a>, and <a class="el" href="../../d4/db9/libubus_8c_source.html#l00378">ubus_free()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00788">enter_jail_fs()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01161">exec_jail()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00893">get_jail_user()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l03132">pipe_send_start_container()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l03115">post_create_runtime()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01239">post_jail_fs()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01256">post_start_hook()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01228">pre_exec_jail()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00924">set_jail_user()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a0d1316d1e009899e8b8b735bb6ba70e3_cgraph.png" border="0" usemap="#add/d26/jail_8c_a0d1316d1e009899e8b8b735bb6ba70e3_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a0d1316d1e009899e8b8b735bb6ba70e3_cgraph" id="add/d26/jail_8c_a0d1316d1e009899e8b8b735bb6ba70e3_cgraph">
<area shape="rect" title=" " alt="" coords="5,203,150,236"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b" title=" " alt="" coords="386,5,526,39"/>
<area shape="poly" title=" " alt="" coords="101,200,209,128,281,85,357,48,371,42,373,47,359,53,284,90,212,132,104,204"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a61855620d1a0683f786486b1722d7dfa" title=" " alt="" coords="201,203,307,236"/>
<area shape="poly" title=" " alt="" coords="150,217,185,217,185,222,150,222"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2" title=" " alt="" coords="198,345,310,379"/>
<area shape="poly" title=" " alt="" coords="102,235,222,333,218,338,98,239"/>
<area shape="poly" title=" " alt="" coords="258,201,271,169,292,127,320,85,356,48,370,39,373,44,360,52,324,88,296,130,276,171,263,203"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a7cdfa1304cca32224a444b6e84fac194" title=" " alt="" coords="388,63,524,96"/>
<area shape="poly" title=" " alt="" coords="264,201,301,153,327,127,357,105,373,97,375,102,359,110,331,131,305,157,268,204"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5127f557f43086299c2bf291618dcef5" title=" " alt="" coords="387,120,525,154"/>
<area shape="poly" title=" " alt="" coords="291,200,357,170,391,157,393,162,359,175,293,204"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a766dbc37dd9f160e1a3b8a9f19651b38" title=" " alt="" coords="639,148,786,182"/>
<area shape="poly" title=" " alt="" coords="307,211,623,173,624,178,308,216"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#abb68ed1aa9f416ea5f299d7672a3b5c1" title=" " alt="" coords="358,229,554,263"/>
<area shape="poly" title=" " alt="" coords="308,224,343,229,342,234,307,229"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5a2acf003db67e7475dcb66937cc12bb" title=" " alt="" coords="394,287,518,320"/>
<area shape="poly" title=" " alt="" coords="284,235,359,273,380,281,379,286,357,278,282,239"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5064c6dcd09eae061c30cba4146bee18" title=" " alt="" coords="397,344,516,378"/>
<area shape="poly" title=" " alt="" coords="268,235,305,283,331,309,359,331,383,342,381,347,357,335,327,313,301,286,264,238"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4b6f537dfef57c06536c73d6c7c2ff48" title=" " alt="" coords="393,401,519,435"/>
<area shape="poly" title=" " alt="" coords="266,236,310,319,336,361,360,388,380,400,377,404,356,392,332,364,305,322,261,238"/>
<area shape="poly" title=" " alt="" coords="526,142,624,152,623,158,526,147"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a7390a5f2c227d5ba53e2bd65afda1cfc" title=" " alt="" coords="373,459,540,492"/>
<area shape="poly" title=" " alt="" coords="273,377,311,412,359,445,369,450,367,455,357,450,307,416,270,381"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a58d1b624b96aa768608f45d390cc0d59" title=" " alt="" coords="639,401,786,435"/>
<area shape="poly" title=" " alt="" coords="534,455,623,435,624,440,535,461"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="629,459,796,492"/>
<area shape="poly" title=" " alt="" coords="540,473,614,473,614,478,540,478"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="602,516,823,550"/>
<area shape="poly" title=" " alt="" coords="535,490,620,509,619,515,534,496"/>
<area shape="rect" href="../../d3/d91/uloop-epoll_8c.html#ae98d2f54596aacb1f0f176d0e565e2e2" title=" " alt="" coords="888,401,1073,435"/>
<area shape="poly" title=" " alt="" coords="794,455,883,436,884,441,795,461"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#abe443fe3f794c14f0aaa0c5f18a27ddd" title=" " alt="" coords="871,459,1090,492"/>
<area shape="poly" title=" " alt="" coords="796,473,855,473,855,478,796,478"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="938,516,1023,550"/>
<area shape="poly" title=" " alt="" coords="823,530,922,530,922,536,823,536"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="1138,516,1232,550"/>
<area shape="poly" title=" " alt="" coords="1024,530,1122,530,1122,536,1024,536"/>
</map>
</div>

</div>
</div>
<a id="a7cdfa1304cca32224a444b6e84fac194" name="a7cdfa1304cca32224a444b6e84fac194"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cdfa1304cca32224a444b6e84fac194">&#9670;&#160;</a></span>free_devices()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void free_devices </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00232">232</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  232</span>                               {</div>
<div class="line"><span class="lineno">  233</span>    <span class="keyword">struct </span><a class="code hl_struct" href="#d5/db5/structmknod__args">mknod_args</a> **cur;</div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.devices)</div>
<div class="line"><span class="lineno">  236</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>    cur = <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.devices;</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>    <span class="keywordflow">while</span> (*cur) {</div>
<div class="line"><span class="lineno">  241</span>        free((*cur)-&gt;path);</div>
<div class="line"><span class="lineno">  242</span>        free(*(cur++));</div>
<div class="line"><span class="lineno">  243</span>    }</div>
<div class="line"><span class="lineno">  244</span>    free(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.devices);</div>
<div class="line"><span class="lineno">  245</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00254">free_opts()</a>.</p>

</div>
</div>
<a id="a5127f557f43086299c2bf291618dcef5" name="a5127f557f43086299c2bf291618dcef5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5127f557f43086299c2bf291618dcef5">&#9670;&#160;</a></span>free_hooklist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void free_hooklist </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="#da/d60/structhook__execvpe">hook_execvpe</a> **</td>          <td class="paramname"><span class="paramname"><em>hooklist</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00199">199</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  200</span>{</div>
<div class="line"><span class="lineno">  201</span>    <span class="keyword">struct </span><a class="code hl_struct" href="#da/d60/structhook__execvpe">hook_execvpe</a> *cur;</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>    <span class="keywordflow">if</span> (!hooklist)</div>
<div class="line"><span class="lineno">  204</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>    cur = *hooklist;</div>
<div class="line"><span class="lineno">  207</span>    <span class="keywordflow">while</span> (cur) {</div>
<div class="line"><span class="lineno">  208</span>        <a class="code hl_function" href="#a766dbc37dd9f160e1a3b8a9f19651b38">free_oci_envp</a>(cur-&gt;<a class="code hl_variable" href="#acff24ad419db504adfdff5c62987cd41">argv</a>);</div>
<div class="line"><span class="lineno">  209</span>        <a class="code hl_function" href="#a766dbc37dd9f160e1a3b8a9f19651b38">free_oci_envp</a>(cur-&gt;<a class="code hl_variable" href="#a644aeb00b6756f5c6d4e3fdcc8263405">envp</a>);</div>
<div class="line"><span class="lineno">  210</span>        free(cur-&gt;<a class="code hl_variable" href="#ac39f04640b0f1f1967ffcd5aa5f158ae">file</a>);</div>
<div class="line"><span class="lineno">  211</span>        free(cur++);</div>
<div class="line"><span class="lineno">  212</span>    }</div>
<div class="line"><span class="lineno">  213</span>    free(hooklist);</div>
<div class="line"><span class="lineno">  214</span>}</div>
<div class="ttc" id="ajail_8c_html_a644aeb00b6756f5c6d4e3fdcc8263405"><div class="ttname"><a href="#a644aeb00b6756f5c6d4e3fdcc8263405">hook_execvpe::envp</a></div><div class="ttdeci">char ** envp</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00079">jail.c:79</a></div></div>
<div class="ttc" id="ajail_8c_html_a766dbc37dd9f160e1a3b8a9f19651b38"><div class="ttname"><a href="#a766dbc37dd9f160e1a3b8a9f19651b38">free_oci_envp</a></div><div class="ttdeci">static void free_oci_envp(char **p)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00187">jail.c:187</a></div></div>
<div class="ttc" id="ajail_8c_html_ac39f04640b0f1f1967ffcd5aa5f158ae"><div class="ttname"><a href="#ac39f04640b0f1f1967ffcd5aa5f158ae">hook_execvpe::file</a></div><div class="ttdeci">char * file</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00077">jail.c:77</a></div></div>
<div class="ttc" id="ajail_8c_html_acff24ad419db504adfdff5c62987cd41"><div class="ttname"><a href="#acff24ad419db504adfdff5c62987cd41">hook_execvpe::argv</a></div><div class="ttdeci">char ** argv</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00078">jail.c:78</a></div></div>
<div class="ttc" id="ajail_8c_html_da/d60/structhook__execvpe"><div class="ttname"><a href="#da/d60/structhook__execvpe">hook_execvpe</a></div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00076">jail.c:76</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l00078">hook_execvpe::argv</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00079">hook_execvpe::envp</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00077">hook_execvpe::file</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00187">free_oci_envp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00254">free_opts()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01432">parseOCIhook()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l01518">parseOCIhooks()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a5127f557f43086299c2bf291618dcef5_cgraph.png" border="0" usemap="#add/d26/jail_8c_a5127f557f43086299c2bf291618dcef5_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a5127f557f43086299c2bf291618dcef5_cgraph" id="add/d26/jail_8c_a5127f557f43086299c2bf291618dcef5_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,144,39"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a766dbc37dd9f160e1a3b8a9f19651b38" title=" " alt="" coords="192,5,339,39"/>
<area shape="poly" title=" " alt="" coords="144,20,176,20,176,25,144,25"/>
</map>
</div>

</div>
</div>
<a id="a766dbc37dd9f160e1a3b8a9f19651b38" name="a766dbc37dd9f160e1a3b8a9f19651b38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a766dbc37dd9f160e1a3b8a9f19651b38">&#9670;&#160;</a></span>free_oci_envp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void free_oci_envp </td>
          <td>(</td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>p</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00187">187</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  187</span>                                    {</div>
<div class="line"><span class="lineno">  188</span>    <span class="keywordtype">char</span> **tmp;</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>    <span class="keywordflow">if</span> (p) {</div>
<div class="line"><span class="lineno">  191</span>        tmp = p;</div>
<div class="line"><span class="lineno">  192</span>        <span class="keywordflow">while</span> (*tmp)</div>
<div class="line"><span class="lineno">  193</span>            free(*(tmp++));</div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span>        free(p);</div>
<div class="line"><span class="lineno">  196</span>    }</div>
<div class="line"><span class="lineno">  197</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00199">free_hooklist()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00254">free_opts()</a>.</p>

</div>
</div>
<a id="a61855620d1a0683f786486b1722d7dfa" name="a61855620d1a0683f786486b1722d7dfa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61855620d1a0683f786486b1722d7dfa">&#9670;&#160;</a></span>free_opts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void free_opts </td>
          <td>(</td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>parent</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00254">254</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  254</span>                                   {</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>    <a class="code hl_function" href="../../d2/da6/elf_8c.html#abb68ed1aa9f416ea5f299d7672a3b5c1">free_library_search</a>();</div>
<div class="line"><span class="lineno">  257</span>    <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a4b6f537dfef57c06536c73d6c7c2ff48">mount_free</a>();</div>
<div class="line"><span class="lineno">  258</span>    <a class="code hl_function" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b">cgroups_free</a>();</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>    <span class="comment">/* we need to keep argv, envp and seccomp filter in child */</span></div>
<div class="line"><span class="lineno">  261</span>    <span class="keywordflow">if</span> (parent) { <span class="comment">/* parent-only */</span></div>
<div class="line"><span class="lineno">  262</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ociseccomp) {</div>
<div class="line"><span class="lineno">  263</span>            free(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ociseccomp-&gt;filter);</div>
<div class="line"><span class="lineno">  264</span>            free(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ociseccomp);</div>
<div class="line"><span class="lineno">  265</span>        }</div>
<div class="line"><span class="lineno">  266</span> </div>
<div class="line"><span class="lineno">  267</span>        <a class="code hl_function" href="#a766dbc37dd9f160e1a3b8a9f19651b38">free_oci_envp</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.jail_argv);</div>
<div class="line"><span class="lineno">  268</span>        <a class="code hl_function" href="#a766dbc37dd9f160e1a3b8a9f19651b38">free_oci_envp</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.envp);</div>
<div class="line"><span class="lineno">  269</span>    }</div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>    <a class="code hl_function" href="#a5a2acf003db67e7475dcb66937cc12bb">free_rlimits</a>();</div>
<div class="line"><span class="lineno">  272</span>    <a class="code hl_function" href="#a5064c6dcd09eae061c30cba4146bee18">free_sysctl</a>();</div>
<div class="line"><span class="lineno">  273</span>    <a class="code hl_function" href="#a7cdfa1304cca32224a444b6e84fac194">free_devices</a>();</div>
<div class="line"><span class="lineno">  274</span>    free(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hostname);</div>
<div class="line"><span class="lineno">  275</span>    free(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.cwd);</div>
<div class="line"><span class="lineno">  276</span>    free(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.uidmap);</div>
<div class="line"><span class="lineno">  277</span>    free(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.gidmap);</div>
<div class="line"><span class="lineno">  278</span>    free(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.annotations);</div>
<div class="line"><span class="lineno">  279</span>    free(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.extroot);</div>
<div class="line"><span class="lineno">  280</span>    free(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.overlaydir);</div>
<div class="line"><span class="lineno">  281</span>    <a class="code hl_function" href="#a5127f557f43086299c2bf291618dcef5">free_hooklist</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.createRuntime);</div>
<div class="line"><span class="lineno">  282</span>    <a class="code hl_function" href="#a5127f557f43086299c2bf291618dcef5">free_hooklist</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.createContainer);</div>
<div class="line"><span class="lineno">  283</span>    <a class="code hl_function" href="#a5127f557f43086299c2bf291618dcef5">free_hooklist</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.startContainer);</div>
<div class="line"><span class="lineno">  284</span>    <a class="code hl_function" href="#a5127f557f43086299c2bf291618dcef5">free_hooklist</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.poststart);</div>
<div class="line"><span class="lineno">  285</span>    <a class="code hl_function" href="#a5127f557f43086299c2bf291618dcef5">free_hooklist</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.poststop);</div>
<div class="line"><span class="lineno">  286</span>}</div>
<div class="ttc" id="aelf_8c_html_abb68ed1aa9f416ea5f299d7672a3b5c1"><div class="ttname"><a href="../../d2/da6/elf_8c.html#abb68ed1aa9f416ea5f299d7672a3b5c1">free_library_search</a></div><div class="ttdeci">void free_library_search(void)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/da6/elf_8c_source.html#l00319">elf.c:319</a></div></div>
<div class="ttc" id="afs_8c_html_a4b6f537dfef57c06536c73d6c7c2ff48"><div class="ttname"><a href="../../d2/d5a/fs_8c.html#a4b6f537dfef57c06536c73d6c7c2ff48">mount_free</a></div><div class="ttdeci">void mount_free(void)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00446">fs.c:446</a></div></div>
<div class="ttc" id="ajail_8c_html_a5064c6dcd09eae061c30cba4146bee18"><div class="ttname"><a href="#a5064c6dcd09eae061c30cba4146bee18">free_sysctl</a></div><div class="ttdeci">static void free_sysctl(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00216">jail.c:216</a></div></div>
<div class="ttc" id="ajail_8c_html_a5127f557f43086299c2bf291618dcef5"><div class="ttname"><a href="#a5127f557f43086299c2bf291618dcef5">free_hooklist</a></div><div class="ttdeci">static void free_hooklist(struct hook_execvpe **hooklist)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00199">jail.c:199</a></div></div>
<div class="ttc" id="ajail_8c_html_a5a2acf003db67e7475dcb66937cc12bb"><div class="ttname"><a href="#a5a2acf003db67e7475dcb66937cc12bb">free_rlimits</a></div><div class="ttdeci">static void free_rlimits(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00247">jail.c:247</a></div></div>
<div class="ttc" id="ajail_8c_html_a7cdfa1304cca32224a444b6e84fac194"><div class="ttname"><a href="#a7cdfa1304cca32224a444b6e84fac194">free_devices</a></div><div class="ttdeci">static void free_devices(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00232">jail.c:232</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../db/d40/cgroups_8c_source.html#l00088">cgroups_free()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00232">free_devices()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00199">free_hooklist()</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00319">free_library_search()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00187">free_oci_envp()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00247">free_rlimits()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00216">free_sysctl()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00446">mount_free()</a>, and <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00774">free_and_exit()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02583">main()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l03170">post_poststop()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l01256">post_start_hook()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a61855620d1a0683f786486b1722d7dfa_cgraph.png" border="0" usemap="#add/d26/jail_8c_a61855620d1a0683f786486b1722d7dfa_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a61855620d1a0683f786486b1722d7dfa_cgraph" id="add/d26/jail_8c_a61855620d1a0683f786486b1722d7dfa_cgraph">
<area shape="rect" title=" " alt="" coords="5,203,112,236"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b" title=" " alt="" coords="188,5,328,39"/>
<area shape="poly" title=" " alt="" coords="63,201,75,169,95,127,122,85,158,48,172,39,175,44,161,52,126,88,99,130,80,171,68,203"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a7cdfa1304cca32224a444b6e84fac194" title=" " alt="" coords="190,63,326,96"/>
<area shape="poly" title=" " alt="" coords="68,201,104,153,130,127,158,105,174,97,177,101,161,110,133,131,108,157,73,204"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5127f557f43086299c2bf291618dcef5" title=" " alt="" coords="189,120,327,154"/>
<area shape="poly" title=" " alt="" coords="94,200,159,170,192,157,194,162,161,175,96,205"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a766dbc37dd9f160e1a3b8a9f19651b38" title=" " alt="" coords="404,148,551,182"/>
<area shape="poly" title=" " alt="" coords="112,210,388,174,389,179,113,215"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#abb68ed1aa9f416ea5f299d7672a3b5c1" title=" " alt="" coords="160,229,356,263"/>
<area shape="poly" title=" " alt="" coords="112,224,145,228,144,234,112,229"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5a2acf003db67e7475dcb66937cc12bb" title=" " alt="" coords="196,287,320,320"/>
<area shape="poly" title=" " alt="" coords="88,235,161,273,182,281,180,286,159,278,86,239"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5064c6dcd09eae061c30cba4146bee18" title=" " alt="" coords="198,344,318,378"/>
<area shape="poly" title=" " alt="" coords="73,235,108,283,133,309,161,331,185,342,182,347,158,335,129,313,104,286,68,238"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4b6f537dfef57c06536c73d6c7c2ff48" title=" " alt="" coords="195,401,321,435"/>
<area shape="poly" title=" " alt="" coords="68,236,80,269,99,310,126,352,161,388,181,400,179,404,158,392,122,355,95,312,75,271,63,238"/>
<area shape="poly" title=" " alt="" coords="328,143,389,151,389,156,327,148"/>
</map>
</div>

</div>
</div>
<a id="a5a2acf003db67e7475dcb66937cc12bb" name="a5a2acf003db67e7475dcb66937cc12bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a2acf003db67e7475dcb66937cc12bb">&#9670;&#160;</a></span>free_rlimits()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void free_rlimits </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00247">247</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  247</span>                               {</div>
<div class="line"><span class="lineno">  248</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>;</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>    <span class="keywordflow">for</span> (<a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a> = 0; <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a> &lt; RLIM_NLIMITS; ++<a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>)</div>
<div class="line"><span class="lineno">  251</span>        free(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.rlimits[<a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>]);</div>
<div class="line"><span class="lineno">  252</span>}</div>
<div class="ttc" id="audebug-proto_8h_html_a1d127017fb298b889f4ba24752d08b8e"><div class="ttname"><a href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a></div><div class="ttdeci">uint8_t type</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d8f/udebug-proto_8h_source.html#l00000">udebug-proto.h:0</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, and <a class="el" href="../../dd/d8f/udebug-proto_8h_source.html#l00000">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00254">free_opts()</a>.</p>

</div>
</div>
<a id="a5064c6dcd09eae061c30cba4146bee18" name="a5064c6dcd09eae061c30cba4146bee18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5064c6dcd09eae061c30cba4146bee18">&#9670;&#160;</a></span>free_sysctl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void free_sysctl </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00216">216</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  216</span>                              {</div>
<div class="line"><span class="lineno">  217</span>    <span class="keyword">struct </span><a class="code hl_struct" href="#de/d02/structsysctl__val">sysctl_val</a> *cur;</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.sysctl)</div>
<div class="line"><span class="lineno">  220</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>    cur = *<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.sysctl;</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>    <span class="keywordflow">while</span> (cur) {</div>
<div class="line"><span class="lineno">  225</span>        free(cur-&gt;<a class="code hl_variable" href="#a1452a5b73690d8d43630e382be5c6157">entry</a>);</div>
<div class="line"><span class="lineno">  226</span>        free(cur-&gt;<a class="code hl_variable" href="#a0850680760799cb6d01d7051e98ae933">value</a>);</div>
<div class="line"><span class="lineno">  227</span>        free(cur++);</div>
<div class="line"><span class="lineno">  228</span>    }</div>
<div class="line"><span class="lineno">  229</span>    free(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.sysctl);</div>
<div class="line"><span class="lineno">  230</span>}</div>
<div class="ttc" id="ajail_8c_html_a0850680760799cb6d01d7051e98ae933"><div class="ttname"><a href="#a0850680760799cb6d01d7051e98ae933">sysctl_val::value</a></div><div class="ttdeci">char * value</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00085">jail.c:85</a></div></div>
<div class="ttc" id="ajail_8c_html_a1452a5b73690d8d43630e382be5c6157"><div class="ttname"><a href="#a1452a5b73690d8d43630e382be5c6157">sysctl_val::entry</a></div><div class="ttdeci">char * entry</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00084">jail.c:84</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l00084">sysctl_val::entry</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00085">sysctl_val::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00254">free_opts()</a>.</p>

</div>
</div>
<a id="a39b7846b508242141ff2f681fb681fdc" name="a39b7846b508242141ff2f681fb681fdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39b7846b508242141ff2f681fb681fdc">&#9670;&#160;</a></span>get_jail_root_user()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void get_jail_root_user </td>
          <td>(</td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>is_gidmap</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>container_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>host_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>size</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01944">1944</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1945</span>{</div>
<div class="line"><span class="lineno"> 1946</span>    <span class="keywordflow">if</span> (container_id == 0 &amp;&amp; size &gt;= 1)</div>
<div class="line"><span class="lineno"> 1947</span>        <span class="keywordflow">if</span> (!is_gidmap)</div>
<div class="line"><span class="lineno"> 1948</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.root_map_uid = host_id;</div>
<div class="line"><span class="lineno"> 1949</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01964">parseOCIuidgidmappings()</a>.</p>

</div>
</div>
<a id="a6f77c1e493a8d84fc93bec1de3f871de" name="a6f77c1e493a8d84fc93bec1de3f871de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f77c1e493a8d84fc93bec1de3f871de">&#9670;&#160;</a></span>get_jail_user()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void get_jail_user </td>
          <td>(</td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>user</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>user_gid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>gr_gid</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00893">893</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  894</span>{</div>
<div class="line"><span class="lineno">  895</span>    <span class="keyword">struct </span>passwd *p = NULL;</div>
<div class="line"><span class="lineno">  896</span>    <span class="keyword">struct </span>group *g = NULL;</div>
<div class="line"><span class="lineno">  897</span> </div>
<div class="line"><span class="lineno">  898</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.user) {</div>
<div class="line"><span class="lineno">  899</span>        p = getpwnam(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.user);</div>
<div class="line"><span class="lineno">  900</span>        <span class="keywordflow">if</span> (!p) {</div>
<div class="line"><span class="lineno">  901</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to get uid/gid for user %s: %d (%s)\n&quot;</span>,</div>
<div class="line"><span class="lineno">  902</span>                  <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.user, errno, strerror(errno));</div>
<div class="line"><span class="lineno">  903</span>            <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno">  904</span>        }</div>
<div class="line"><span class="lineno">  905</span>        *user = p-&gt;pw_uid;</div>
<div class="line"><span class="lineno">  906</span>        *user_gid = p-&gt;pw_gid;</div>
<div class="line"><span class="lineno">  907</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  908</span>        *user = -1;</div>
<div class="line"><span class="lineno">  909</span>        *user_gid = -1;</div>
<div class="line"><span class="lineno">  910</span>    }</div>
<div class="line"><span class="lineno">  911</span> </div>
<div class="line"><span class="lineno">  912</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.group) {</div>
<div class="line"><span class="lineno">  913</span>        g = getgrnam(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.group);</div>
<div class="line"><span class="lineno">  914</span>        <span class="keywordflow">if</span> (!g) {</div>
<div class="line"><span class="lineno">  915</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to get gid for group %s: %m\n&quot;</span>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.group);</div>
<div class="line"><span class="lineno">  916</span>            <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno">  917</span>        }</div>
<div class="line"><span class="lineno">  918</span>        *gr_gid = g-&gt;gr_gid;</div>
<div class="line"><span class="lineno">  919</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  920</span>        *gr_gid = -1;</div>
<div class="line"><span class="lineno">  921</span>    }</div>
<div class="line"><span class="lineno">  922</span>};</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00774">free_and_exit()</a>, and <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02583">main()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l01256">post_start_hook()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a6f77c1e493a8d84fc93bec1de3f871de_cgraph.png" border="0" usemap="#add/d26/jail_8c_a6f77c1e493a8d84fc93bec1de3f871de_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a6f77c1e493a8d84fc93bec1de3f871de_cgraph" id="add/d26/jail_8c_a6f77c1e493a8d84fc93bec1de3f871de_cgraph">
<area shape="rect" title=" " alt="" coords="5,203,142,236"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a0d1316d1e009899e8b8b735bb6ba70e3" title=" " alt="" coords="190,203,334,236"/>
<area shape="poly" title=" " alt="" coords="142,217,174,217,174,222,142,222"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b" title=" " alt="" coords="570,5,711,39"/>
<area shape="poly" title=" " alt="" coords="286,200,393,128,465,85,541,48,555,42,557,47,543,53,468,90,396,132,288,204"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a61855620d1a0683f786486b1722d7dfa" title=" " alt="" coords="385,203,491,236"/>
<area shape="poly" title=" " alt="" coords="334,217,369,217,369,222,334,222"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2" title=" " alt="" coords="382,345,494,379"/>
<area shape="poly" title=" " alt="" coords="286,235,406,333,403,338,283,239"/>
<area shape="poly" title=" " alt="" coords="443,201,456,169,476,127,504,85,541,48,555,39,557,44,544,52,508,88,481,130,460,171,448,203"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a7cdfa1304cca32224a444b6e84fac194" title=" " alt="" coords="572,63,709,96"/>
<area shape="poly" title=" " alt="" coords="449,201,486,153,512,127,541,105,557,97,559,102,544,110,515,131,490,157,453,204"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5127f557f43086299c2bf291618dcef5" title=" " alt="" coords="571,120,710,154"/>
<area shape="poly" title=" " alt="" coords="475,200,541,170,575,157,577,162,543,175,477,204"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a766dbc37dd9f160e1a3b8a9f19651b38" title=" " alt="" coords="823,148,971,182"/>
<area shape="poly" title=" " alt="" coords="491,211,807,173,808,178,492,216"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#abb68ed1aa9f416ea5f299d7672a3b5c1" title=" " alt="" coords="542,229,739,263"/>
<area shape="poly" title=" " alt="" coords="492,224,527,229,527,234,492,229"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5a2acf003db67e7475dcb66937cc12bb" title=" " alt="" coords="578,287,703,320"/>
<area shape="poly" title=" " alt="" coords="469,235,543,273,565,281,563,286,541,278,466,239"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5064c6dcd09eae061c30cba4146bee18" title=" " alt="" coords="581,344,700,378"/>
<area shape="poly" title=" " alt="" coords="453,235,490,283,515,309,544,331,568,342,565,347,541,335,511,313,486,286,448,238"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4b6f537dfef57c06536c73d6c7c2ff48" title=" " alt="" coords="577,401,704,435"/>
<area shape="poly" title=" " alt="" coords="450,236,494,319,521,361,544,388,564,400,561,404,541,392,517,364,490,322,446,238"/>
<area shape="poly" title=" " alt="" coords="710,142,808,152,807,158,710,147"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a7390a5f2c227d5ba53e2bd65afda1cfc" title=" " alt="" coords="557,459,724,492"/>
<area shape="poly" title=" " alt="" coords="458,377,495,412,544,445,554,450,551,455,541,450,492,416,454,381"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a58d1b624b96aa768608f45d390cc0d59" title=" " alt="" coords="824,401,970,435"/>
<area shape="poly" title=" " alt="" coords="718,455,808,435,809,440,720,461"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="814,459,980,492"/>
<area shape="poly" title=" " alt="" coords="725,473,798,473,798,478,725,478"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="787,516,1007,550"/>
<area shape="poly" title=" " alt="" coords="720,490,804,509,803,515,718,496"/>
<area shape="rect" href="../../d3/d91/uloop-epoll_8c.html#ae98d2f54596aacb1f0f176d0e565e2e2" title=" " alt="" coords="1073,401,1257,435"/>
<area shape="poly" title=" " alt="" coords="978,455,1067,436,1068,441,979,461"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#abe443fe3f794c14f0aaa0c5f18a27ddd" title=" " alt="" coords="1055,459,1274,492"/>
<area shape="poly" title=" " alt="" coords="981,473,1039,473,1039,478,981,478"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="1122,516,1207,550"/>
<area shape="poly" title=" " alt="" coords="1008,530,1106,530,1106,536,1008,536"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="1322,516,1417,550"/>
<area shape="poly" title=" " alt="" coords="1208,530,1307,530,1307,536,1208,536"/>
</map>
</div>

</div>
</div>
<a id="a3aa34193a0ba95da6ede6aa8e16d726f" name="a3aa34193a0ba95da6ede6aa8e16d726f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3aa34193a0ba95da6ede6aa8e16d726f">&#9670;&#160;</a></span>get_namespace_fd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int * get_namespace_fd </td>
          <td>(</td>
          <td class="paramtype">const unsigned int</td>          <td class="paramname"><span class="paramname"><em>nstype</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01041">1041</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1042</span>{</div>
<div class="line"><span class="lineno"> 1043</span>    <span class="keywordflow">switch</span> (nstype) {</div>
<div class="line"><span class="lineno"> 1044</span>        <span class="keywordflow">case</span> CLONE_NEWPID:</div>
<div class="line"><span class="lineno"> 1045</span>            <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.pid;</div>
<div class="line"><span class="lineno"> 1046</span>        <span class="keywordflow">case</span> CLONE_NEWNET:</div>
<div class="line"><span class="lineno"> 1047</span>            <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.net;</div>
<div class="line"><span class="lineno"> 1048</span>        <span class="keywordflow">case</span> CLONE_NEWNS:</div>
<div class="line"><span class="lineno"> 1049</span>            <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.ns;</div>
<div class="line"><span class="lineno"> 1050</span>        <span class="keywordflow">case</span> CLONE_NEWIPC:</div>
<div class="line"><span class="lineno"> 1051</span>            <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.ipc;</div>
<div class="line"><span class="lineno"> 1052</span>        <span class="keywordflow">case</span> CLONE_NEWUTS:</div>
<div class="line"><span class="lineno"> 1053</span>            <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.uts;</div>
<div class="line"><span class="lineno"> 1054</span>        <span class="keywordflow">case</span> CLONE_NEWUSER:</div>
<div class="line"><span class="lineno"> 1055</span>            <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.user;</div>
<div class="line"><span class="lineno"> 1056</span>        <span class="keywordflow">case</span> <a class="code hl_define" href="#a9d5d88148a26086567c3731e2e5e110a">CLONE_NEWCGROUP</a>:</div>
<div class="line"><span class="lineno"> 1057</span>            <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.cgroup;</div>
<div class="line"><span class="lineno"> 1058</span><span class="preprocessor">#ifdef CLONE_NEWTIME</span></div>
<div class="line"><span class="lineno"> 1059</span>        <span class="keywordflow">case</span> CLONE_NEWTIME:</div>
<div class="line"><span class="lineno"> 1060</span>            <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.time;</div>
<div class="line"><span class="lineno"> 1061</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1062</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1063</span>            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1064</span>    }</div>
<div class="line"><span class="lineno"> 1065</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l00068">CLONE_NEWCGROUP</a>, and <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01888">jail_join_ns()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01830">parseOCIlinuxns()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l01067">setns_open()</a>.</p>

</div>
</div>
<a id="a2d6c7c9ff5f0dc0ecd5af7f8c8ff2856" name="a2d6c7c9ff5f0dc0ecd5af7f8c8ff2856"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d6c7c9ff5f0dc0ecd5af7f8c8ff2856">&#9670;&#160;</a></span>handle_start()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_start </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d55/libubus_8h.html#df/d18/structubus__context">ubus_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/d00/ubusd__obj_8h.html#d6/d75/structubus__object">ubus_object</a> *</td>          <td class="paramname"><span class="paramname"><em>obj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../db/d55/libubus_8h.html#d5/d2a/structubus__request__data">ubus_request_data</a> *</td>          <td class="paramname"><span class="paramname"><em>req</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>method</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02425">2425</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2428</span>{</div>
<div class="line"><span class="lineno"> 2429</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af5e3a2bd12c4c9ed553bdacc21e97b65">jail_oci_state</a> != <a class="code hl_enumvalue" href="#a97f905ac94bfebd46e50e32c7389e6eba7d55a02065f2ef38d43d0c0858bee940">OCI_STATE_CREATED</a>)</div>
<div class="line"><span class="lineno"> 2430</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d5/d79/ubusmsg_8h.html#a99bec0c168a4d5ac338ad787dfb73312a01547e86014c16f5a948f832185ce2e7">UBUS_STATUS_INVALID_ARGUMENT</a>;</div>
<div class="line"><span class="lineno"> 2431</span> </div>
<div class="line"><span class="lineno"> 2432</span>    <a class="code hl_function" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07">uloop_timeout_add</a>(&amp;<a class="code hl_variable" href="#aed82975b7037d5fcacde3c08e54189c1">start_container_timeout</a>);</div>
<div class="line"><span class="lineno"> 2433</span> </div>
<div class="line"><span class="lineno"> 2434</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d5/d79/ubusmsg_8h.html#a99bec0c168a4d5ac338ad787dfb73312ab7a81fcac034b9ddc28cbf812d2ae6eb">UBUS_STATUS_OK</a>;</div>
<div class="line"><span class="lineno"> 2435</span>}</div>
<div class="ttc" id="ajail_8c_html_aed82975b7037d5fcacde3c08e54189c1"><div class="ttname"><a href="#aed82975b7037d5fcacde3c08e54189c1">start_container_timeout</a></div><div class="ttdeci">static struct uloop_timeout start_container_timeout</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02421">jail.c:2421</a></div></div>
<div class="ttc" id="aubusmsg_8h_html_a99bec0c168a4d5ac338ad787dfb73312ab7a81fcac034b9ddc28cbf812d2ae6eb"><div class="ttname"><a href="../../d5/d79/ubusmsg_8h.html#a99bec0c168a4d5ac338ad787dfb73312ab7a81fcac034b9ddc28cbf812d2ae6eb">UBUS_STATUS_OK</a></div><div class="ttdeci">@ UBUS_STATUS_OK</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d79/ubusmsg_8h_source.html#l00119">ubusmsg.h:119</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l02419">jail_oci_state</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02414">OCI_STATE_CREATED</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02421">start_container_timeout</a>, <a class="el" href="../../d5/d79/ubusmsg_8h_source.html#l00121">UBUS_STATUS_INVALID_ARGUMENT</a>, <a class="el" href="../../d5/d79/ubusmsg_8h_source.html#l00119">UBUS_STATUS_OK</a>, and <a class="el" href="../../d1/d08/uloop_8c_source.html#l00298">uloop_timeout_add()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a2d6c7c9ff5f0dc0ecd5af7f8c8ff2856_cgraph.png" border="0" usemap="#add/d26/jail_8c_a2d6c7c9ff5f0dc0ecd5af7f8c8ff2856_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a2d6c7c9ff5f0dc0ecd5af7f8c8ff2856_cgraph" id="add/d26/jail_8c_a2d6c7c9ff5f0dc0ecd5af7f8c8ff2856_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,142,68"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07" title=" " alt="" coords="190,35,386,68"/>
<area shape="poly" title=" " alt="" coords="142,49,174,49,174,54,142,54"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="434,5,563,39"/>
<area shape="poly" title=" " alt="" coords="386,35,418,31,419,36,387,40"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a76f33118cba0a358482528fad8c0f4cd" title=" " alt="" coords="460,63,538,96"/>
<area shape="poly" title=" " alt="" coords="387,62,445,70,444,75,386,67"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="611,5,713,39"/>
<area shape="poly" title=" " alt="" coords="564,20,596,20,596,25,564,25"/>
</map>
</div>

</div>
</div>
<a id="ac6e6d6350c1d8807003c0cbc0bab22ba" name="ac6e6d6350c1d8807003c0cbc0bab22ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6e6d6350c1d8807003c0cbc0bab22ba">&#9670;&#160;</a></span>handle_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_state </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d55/libubus_8h.html#df/d18/structubus__context">ubus_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/d00/ubusd__obj_8h.html#d6/d75/structubus__object">ubus_object</a> *</td>          <td class="paramname"><span class="paramname"><em>obj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../db/d55/libubus_8h.html#d5/d2a/structubus__request__data">ubus_request_data</a> *</td>          <td class="paramname"><span class="paramname"><em>req</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>method</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02438">2438</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2441</span>{</div>
<div class="line"><span class="lineno"> 2442</span>    <span class="keywordtype">char</span> *statusstr;</div>
<div class="line"><span class="lineno"> 2443</span> </div>
<div class="line"><span class="lineno"> 2444</span>    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="#af5e3a2bd12c4c9ed553bdacc21e97b65">jail_oci_state</a>) {</div>
<div class="line"><span class="lineno"> 2445</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a97f905ac94bfebd46e50e32c7389e6eba13f094d14b519859226de69d2baca06d">OCI_STATE_CREATING</a>:</div>
<div class="line"><span class="lineno"> 2446</span>            statusstr = <span class="stringliteral">&quot;creating&quot;</span>;</div>
<div class="line"><span class="lineno"> 2447</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2448</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a97f905ac94bfebd46e50e32c7389e6eba7d55a02065f2ef38d43d0c0858bee940">OCI_STATE_CREATED</a>:</div>
<div class="line"><span class="lineno"> 2449</span>            statusstr = <span class="stringliteral">&quot;created&quot;</span>;</div>
<div class="line"><span class="lineno"> 2450</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2451</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a97f905ac94bfebd46e50e32c7389e6eba9c098b9727e0c4f5a1c90b249cd4aacc">OCI_STATE_RUNNING</a>:</div>
<div class="line"><span class="lineno"> 2452</span>            statusstr = <span class="stringliteral">&quot;running&quot;</span>;</div>
<div class="line"><span class="lineno"> 2453</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2454</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a97f905ac94bfebd46e50e32c7389e6eba8c03b9e1abf979c0ec7b1900c86b60f1">OCI_STATE_STOPPED</a>:</div>
<div class="line"><span class="lineno"> 2455</span>            statusstr = <span class="stringliteral">&quot;stopped&quot;</span>;</div>
<div class="line"><span class="lineno"> 2456</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2457</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2458</span>            statusstr = <span class="stringliteral">&quot;unknown&quot;</span>;</div>
<div class="line"><span class="lineno"> 2459</span>    }</div>
<div class="line"><span class="lineno"> 2460</span> </div>
<div class="line"><span class="lineno"> 2461</span>    <a class="code hl_function" href="../../d4/da0/blob_8c.html#af8ca2237342df92c699fbb2ddb5f390b">blob_buf_init</a>(&amp;<a class="code hl_variable" href="#a6cb0fbfbe5b1abc05003e2609fb7bc8c">bb</a>, 0);</div>
<div class="line"><span class="lineno"> 2462</span>    <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a4bba0979961750f86b8dc9915b2fa4d6">blobmsg_add_string</a>(&amp;<a class="code hl_variable" href="#a6cb0fbfbe5b1abc05003e2609fb7bc8c">bb</a>, <span class="stringliteral">&quot;ociVersion&quot;</span>, <a class="code hl_define" href="#a1ee05432b602a194c5a7cfb5043a5824">OCI_VERSION_STRING</a>);</div>
<div class="line"><span class="lineno"> 2463</span>    <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a4bba0979961750f86b8dc9915b2fa4d6">blobmsg_add_string</a>(&amp;<a class="code hl_variable" href="#a6cb0fbfbe5b1abc05003e2609fb7bc8c">bb</a>, <span class="stringliteral">&quot;id&quot;</span>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.name);</div>
<div class="line"><span class="lineno"> 2464</span>    <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a4bba0979961750f86b8dc9915b2fa4d6">blobmsg_add_string</a>(&amp;<a class="code hl_variable" href="#a6cb0fbfbe5b1abc05003e2609fb7bc8c">bb</a>, <span class="stringliteral">&quot;status&quot;</span>, statusstr);</div>
<div class="line"><span class="lineno"> 2465</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af5e3a2bd12c4c9ed553bdacc21e97b65">jail_oci_state</a> == <a class="code hl_enumvalue" href="#a97f905ac94bfebd46e50e32c7389e6eba7d55a02065f2ef38d43d0c0858bee940">OCI_STATE_CREATED</a> ||</div>
<div class="line"><span class="lineno"> 2466</span>        <a class="code hl_variable" href="#af5e3a2bd12c4c9ed553bdacc21e97b65">jail_oci_state</a> == <a class="code hl_enumvalue" href="#a97f905ac94bfebd46e50e32c7389e6eba9c098b9727e0c4f5a1c90b249cd4aacc">OCI_STATE_RUNNING</a>)</div>
<div class="line"><span class="lineno"> 2467</span>        <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#afcf08162affe766f0f1c9dd641c7b393">blobmsg_add_u32</a>(&amp;<a class="code hl_variable" href="#a6cb0fbfbe5b1abc05003e2609fb7bc8c">bb</a>, <span class="stringliteral">&quot;pid&quot;</span>, <a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>);</div>
<div class="line"><span class="lineno"> 2468</span> </div>
<div class="line"><span class="lineno"> 2469</span>    <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a4bba0979961750f86b8dc9915b2fa4d6">blobmsg_add_string</a>(&amp;<a class="code hl_variable" href="#a6cb0fbfbe5b1abc05003e2609fb7bc8c">bb</a>, <span class="stringliteral">&quot;bundle&quot;</span>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ocibundle);</div>
<div class="line"><span class="lineno"> 2470</span> </div>
<div class="line"><span class="lineno"> 2471</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.annotations)</div>
<div class="line"><span class="lineno"> 2472</span>        <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a16c0db64a79ef15eab447db0fe22db96">blobmsg_add_blob</a>(&amp;<a class="code hl_variable" href="#a6cb0fbfbe5b1abc05003e2609fb7bc8c">bb</a>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.annotations);</div>
<div class="line"><span class="lineno"> 2473</span> </div>
<div class="line"><span class="lineno"> 2474</span>    <a class="code hl_function" href="../../d2/de5/libubus-req_8c.html#aab336677450493ac2229e8a2f70fa0e4">ubus_send_reply</a>(<a class="code hl_variable" href="../../d5/dd5/hotplug-dispatch_8c.html#a7c00b3b8999b2056f226d3cc35a83845">ctx</a>, req, <a class="code hl_variable" href="#a6cb0fbfbe5b1abc05003e2609fb7bc8c">bb</a>.<a class="code hl_variable" href="../../d8/d3c/blob_8h.html#af6065d74116605108b22c11e75ec669c">head</a>);</div>
<div class="line"><span class="lineno"> 2475</span> </div>
<div class="line"><span class="lineno"> 2476</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d5/d79/ubusmsg_8h.html#a99bec0c168a4d5ac338ad787dfb73312ab7a81fcac034b9ddc28cbf812d2ae6eb">UBUS_STATUS_OK</a>;</div>
<div class="line"><span class="lineno"> 2477</span>}</div>
<div class="ttc" id="ablob_8c_html_af8ca2237342df92c699fbb2ddb5f390b"><div class="ttname"><a href="../../d4/da0/blob_8c.html#af8ca2237342df92c699fbb2ddb5f390b">blob_buf_init</a></div><div class="ttdeci">int blob_buf_init(struct blob_buf *buf, int id)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/da0/blob_8c_source.html#l00091">blob.c:91</a></div></div>
<div class="ttc" id="ablob_8h_html_af6065d74116605108b22c11e75ec669c"><div class="ttname"><a href="../../d8/d3c/blob_8h.html#af6065d74116605108b22c11e75ec669c">blob_buf::head</a></div><div class="ttdeci">struct blob_attr * head</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d3c/blob_8h_source.html#l00065">blob.h:65</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a16c0db64a79ef15eab447db0fe22db96"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a16c0db64a79ef15eab447db0fe22db96">blobmsg_add_blob</a></div><div class="ttdeci">static int blobmsg_add_blob(struct blob_buf *buf, struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00241">blobmsg.h:241</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a4bba0979961750f86b8dc9915b2fa4d6"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a4bba0979961750f86b8dc9915b2fa4d6">blobmsg_add_string</a></div><div class="ttdeci">static int blobmsg_add_string(struct blob_buf *buf, const char *name, const char *string)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00235">blobmsg.h:235</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_afcf08162affe766f0f1c9dd641c7b393"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#afcf08162affe766f0f1c9dd641c7b393">blobmsg_add_u32</a></div><div class="ttdeci">static int blobmsg_add_u32(struct blob_buf *buf, const char *name, uint32_t val)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00221">blobmsg.h:221</a></div></div>
<div class="ttc" id="ahotplug-dispatch_8c_html_a7c00b3b8999b2056f226d3cc35a83845"><div class="ttname"><a href="../../d5/dd5/hotplug-dispatch_8c.html#a7c00b3b8999b2056f226d3cc35a83845">ctx</a></div><div class="ttdeci">struct ubus_context * ctx</div><div class="ttdef"><b>Definition</b> <a href="../../d5/dd5/hotplug-dispatch_8c_source.html#l00042">hotplug-dispatch.c:42</a></div></div>
<div class="ttc" id="ajail_8c_html_a1ee05432b602a194c5a7cfb5043a5824"><div class="ttname"><a href="#a1ee05432b602a194c5a7cfb5043a5824">OCI_VERSION_STRING</a></div><div class="ttdeci">#define OCI_VERSION_STRING</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00074">jail.c:74</a></div></div>
<div class="ttc" id="ajail_8c_html_a6cb0fbfbe5b1abc05003e2609fb7bc8c"><div class="ttname"><a href="#a6cb0fbfbe5b1abc05003e2609fb7bc8c">bb</a></div><div class="ttdeci">static struct blob_buf bb</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02437">jail.c:2437</a></div></div>
<div class="ttc" id="alibubus-req_8c_html_aab336677450493ac2229e8a2f70fa0e4"><div class="ttname"><a href="../../d2/de5/libubus-req_8c.html#aab336677450493ac2229e8a2f70fa0e4">ubus_send_reply</a></div><div class="ttdeci">int ubus_send_reply(struct ubus_context *ctx, struct ubus_request_data *req, struct blob_attr *msg)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/de5/libubus-req_8c_source.html#l00205">libubus-req.c:205</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l02437">bb</a>, <a class="el" href="../../d4/da0/blob_8c_source.html#l00091">blob_buf_init()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00241">blobmsg_add_blob()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00235">blobmsg_add_string()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00221">blobmsg_add_u32()</a>, <a class="el" href="../../d5/dd5/hotplug-dispatch_8c_source.html#l00042">ctx</a>, <a class="el" href="../../d8/d3c/blob_8h_source.html#l00065">blob_buf::head</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02419">jail_oci_state</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01107">jail_process</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02414">OCI_STATE_CREATED</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02413">OCI_STATE_CREATING</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02415">OCI_STATE_RUNNING</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02416">OCI_STATE_STOPPED</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00074">OCI_VERSION_STRING</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00087">uloop_process::pid</a>, <a class="el" href="../../d2/de5/libubus-req_8c_source.html#l00205">ubus_send_reply()</a>, and <a class="el" href="../../d5/d79/ubusmsg_8h_source.html#l00119">UBUS_STATUS_OK</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_ac6e6d6350c1d8807003c0cbc0bab22ba_cgraph.png" border="0" usemap="#add/d26/jail_8c_ac6e6d6350c1d8807003c0cbc0bab22ba_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_ac6e6d6350c1d8807003c0cbc0bab22ba_cgraph" id="add/d26/jail_8c_ac6e6d6350c1d8807003c0cbc0bab22ba_cgraph">
<area shape="rect" title=" " alt="" coords="5,531,145,564"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#af8ca2237342df92c699fbb2ddb5f390b" title=" " alt="" coords="716,277,855,311"/>
<area shape="poly" title=" " alt="" coords="124,528,720,314,722,319,126,533"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a16c0db64a79ef15eab447db0fe22db96" title=" " alt="" coords="200,645,394,679"/>
<area shape="poly" title=" " alt="" coords="97,563,139,598,194,632,206,637,204,642,191,637,136,602,93,567"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a4bba0979961750f86b8dc9915b2fa4d6" title=" " alt="" coords="193,588,401,622"/>
<area shape="poly" title=" " alt="" coords="143,562,215,581,213,586,142,567"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#afcf08162affe766f0f1c9dd641c7b393" title=" " alt="" coords="202,531,392,564"/>
<area shape="poly" title=" " alt="" coords="145,545,186,545,186,550,145,550"/>
<area shape="rect" href="../../d2/de5/libubus-req_8c.html#aab336677450493ac2229e8a2f70fa0e4" title=" " alt="" coords="209,323,385,356"/>
<area shape="poly" title=" " alt="" coords="81,529,97,496,121,455,152,411,191,373,211,361,214,365,194,378,156,415,125,457,101,499,86,531"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#af8de35ec0673663c45f2aad7c876d329" title=" " alt="" coords="1199,277,1304,311"/>
<area shape="poly" title=" " alt="" coords="856,292,1183,292,1183,297,856,297"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6f17715cbf1ce82b0981a452537b4dc6" title=" " alt="" coords="928,223,1108,256"/>
<area shape="poly" title=" " alt="" coords="855,275,928,258,929,263,856,280"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a99c424ce706ada40920b2f57259e223b" title=" " alt="" coords="1598,277,1740,311"/>
<area shape="poly" title=" " alt="" coords="1304,292,1582,292,1582,297,1304,297"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#ab4e3964334a7aec029ab29a2c724f248" title=" " alt="" coords="1394,165,1550,199"/>
<area shape="poly" title=" " alt="" coords="1277,275,1330,242,1393,208,1404,203,1406,208,1396,213,1332,247,1280,279"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a686c428a3ab7c421820e049ab2384d47" title=" " alt="" coords="1598,140,1740,174"/>
<area shape="poly" title=" " alt="" coords="1261,275,1282,246,1311,211,1349,176,1393,150,1440,137,1490,131,1538,131,1583,136,1582,141,1538,137,1490,136,1442,142,1395,155,1352,181,1315,214,1286,249,1265,278"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#abe9f6013aad507ac84630ee773b806b6" title=" " alt="" coords="1404,332,1540,366"/>
<area shape="poly" title=" " alt="" coords="1305,305,1389,326,1388,331,1304,310"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a4fb5423718fbcc165ed995360ab3ea96" title=" " alt="" coords="1422,223,1522,256"/>
<area shape="poly" title=" " alt="" coords="1304,279,1407,253,1408,258,1305,284"/>
<area shape="poly" title=" " alt="" coords="1528,197,1551,208,1597,236,1637,265,1634,270,1594,240,1548,213,1526,202"/>
<area shape="poly" title=" " alt="" coords="1550,170,1582,165,1583,171,1550,175"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a3071b18c2bb742e04d7622379ee8fd3b" title=" " alt="" coords="1598,387,1740,420"/>
<area shape="poly" title=" " alt="" coords="1536,364,1592,379,1590,385,1535,369"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a2c4753820a7472bba7b999fbba79df01" title=" " alt="" coords="1788,360,1929,394"/>
<area shape="poly" title=" " alt="" coords="1541,351,1773,368,1772,373,1540,356"/>
<area shape="poly" title=" " alt="" coords="1740,391,1772,386,1773,392,1741,396"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a9921d2b89577d3344abbb66f24773e32" title=" " alt="" coords="1977,532,2076,566"/>
<area shape="poly" title=" " alt="" coords="1878,392,2000,519,1997,523,1875,396"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5bf37ab2b48095b7fb16ac11449b08f6" title=" " alt="" coords="449,588,643,622"/>
<area shape="poly" title=" " alt="" coords="373,642,454,623,456,628,374,647"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="942,796,1094,830"/>
<area shape="poly" title=" " alt="" coords="330,677,385,705,450,732,512,751,577,766,706,789,827,802,927,808,927,814,827,807,706,794,576,772,511,756,448,737,383,710,328,682"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052" title=" " alt="" coords="691,741,880,775"/>
<area shape="poly" title=" " alt="" coords="387,677,682,735,680,740,386,682"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a6ee526c7b55debcecad8e34e3e6108d0" title=" " alt="" coords="465,645,627,679"/>
<area shape="poly" title=" " alt="" coords="395,660,450,660,450,665,395,665"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#aed178aa087a351c74f7f6cd34e56ba0c" title=" " alt="" coords="711,589,860,623"/>
<area shape="poly" title=" " alt="" coords="644,603,696,603,696,608,644,608"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="1196,600,1307,634"/>
<area shape="poly" title=" " alt="" coords="860,605,1180,613,1180,618,860,611"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#aee908e6de67c16a4d810d08f28ed1803" title=" " alt="" coords="964,383,1072,416"/>
<area shape="poly" title=" " alt="" coords="804,587,985,425,988,429,808,591"/>
<area shape="poly" title=" " alt="" coords="808,621,988,784,985,788,804,625"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ac239a83ed3c7f835e2b49f785953c934" title=" " alt="" coords="1166,685,1336,719"/>
<area shape="poly" title=" " alt="" coords="861,619,1151,679,1150,684,860,624"/>
<area shape="poly" title=" " alt="" coords="1056,380,1197,315,1199,320,1058,385"/>
<area shape="poly" title=" " alt="" coords="1072,397,1582,400,1582,406,1072,402"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#ac9fd36cdb87493b31a675621ed53a8d7" title=" " alt="" coords="1416,441,1528,475"/>
<area shape="poly" title=" " alt="" coords="1073,404,1401,446,1401,452,1072,409"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a189526712fcc12adfb6ea6a5c8eede54" title=" " alt="" coords="1162,477,1340,511"/>
<area shape="poly" title=" " alt="" coords="1065,414,1109,433,1157,456,1189,469,1187,474,1155,461,1107,438,1063,419"/>
<area shape="poly" title=" " alt="" coords="1527,440,1590,422,1592,428,1529,445"/>
<area shape="poly" title=" " alt="" coords="1078,793,1106,775,1124,750,1130,725,1137,699,1154,671,1173,654,1194,640,1197,644,1176,658,1158,675,1142,701,1136,727,1129,752,1110,779,1081,798"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="1161,743,1342,776"/>
<area shape="poly" title=" " alt="" coords="1093,793,1159,778,1160,783,1095,798"/>
<area shape="poly" title=" " alt="" coords="1070,793,1107,775,1120,763,1130,751,1139,740,1155,728,1163,723,1166,728,1157,732,1143,743,1134,755,1124,767,1109,779,1073,798"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a7613e130753e766f5d381c06b1f7b86f" title=" " alt="" coords="1156,800,1346,834"/>
<area shape="poly" title=" " alt="" coords="1094,811,1141,812,1140,818,1094,817"/>
<area shape="poly" title=" " alt="" coords="810,773,862,808,895,826,929,840,1016,863,1086,871,1250,869,1670,869,1702,866,1732,860,1789,835,1841,798,1887,754,1928,706,1961,658,2008,578,2012,581,1966,661,1932,709,1891,758,1844,802,1791,840,1733,865,1702,872,1670,874,1250,874,1086,876,1015,868,927,845,892,831,860,813,807,778"/>
<area shape="poly" title=" " alt="" coords="867,738,981,710,1107,673,1197,638,1199,643,1109,678,983,715,868,743"/>
<area shape="poly" title=" " alt="" coords="861,773,929,789,928,794,860,778"/>
<area shape="poly" title=" " alt="" coords="628,654,1180,619,1180,624,628,660"/>
<area shape="poly" title=" " alt="" coords="401,602,433,602,433,608,401,608"/>
<area shape="poly" title=" " alt="" coords="374,562,456,581,454,587,373,568"/>
<area shape="poly" title=" " alt="" coords="385,329,700,299,700,305,386,334"/>
<area shape="rect" href="../../d2/de5/libubus-req_8c.html#a0e8112f19ea399af22d957f19cf6cfc7" title=" " alt="" coords="468,432,625,466"/>
<area shape="poly" title=" " alt="" coords="338,354,493,423,491,428,336,359"/>
<area shape="rect" href="../../dc/d80/libubus-io_8c.html#a3e8e6d098f2808fa135bfefa3c0e81f8" title=" " alt="" coords="461,255,631,288"/>
<area shape="poly" title=" " alt="" coords="360,320,466,290,468,296,362,325"/>
<area shape="poly" title=" " alt="" coords="626,454,880,484,1046,507,1175,527,1304,541,1471,546,1670,546,1962,546,1962,552,1670,552,1471,551,1304,546,1174,532,1045,512,879,489,625,460"/>
<area shape="poly" title=" " alt="" coords="621,464,1181,598,1180,603,619,469"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a055e87e50f40e8a0bffc669e2a47d1eb" title=" " alt="" coords="735,383,836,416"/>
<area shape="poly" title=" " alt="" coords="624,430,719,410,720,416,626,435"/>
<area shape="poly" title=" " alt="" coords="833,414,958,466,1109,534,1209,589,1207,594,1107,539,956,471,831,419"/>
<area shape="poly" title=" " alt="" coords="837,397,948,397,948,402,837,402"/>
<area shape="poly" title=" " alt="" coords="632,277,701,283,700,289,632,282"/>
<area shape="poly" title=" " alt="" coords="569,252,641,204,748,145,811,118,878,95,947,80,1016,74,1473,74,1552,72,1616,72,1646,76,1676,86,1707,102,1742,125,1767,149,1788,176,1821,235,1842,295,1854,344,1849,345,1837,297,1816,238,1784,179,1763,152,1738,130,1705,106,1674,91,1645,82,1616,77,1553,77,1473,79,1017,79,948,85,879,100,813,123,750,150,643,209,572,256"/>
<area shape="rect" href="../../dc/d80/libubus-io_8c.html#a9a256a75cd053ed5d3443060e0a19a3f" title=" " alt="" coords="720,5,851,39"/>
<area shape="poly" title=" " alt="" coords="552,253,571,214,601,161,641,105,690,56,708,44,711,48,693,60,645,109,605,164,576,216,557,256"/>
<area shape="rect" href="../../dc/d80/libubus-io_8c.html#ad1aaffb83e802ad470cb77be9f56977c" title=" " alt="" coords="963,5,1073,39"/>
<area shape="poly" title=" " alt="" coords="851,20,948,20,948,25,851,25"/>
</map>
</div>

</div>
</div>
<a id="a0015ee3272db94af6db03ff79d543794" name="a0015ee3272db94af6db03ff79d543794"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0015ee3272db94af6db03ff79d543794">&#9670;&#160;</a></span>has_namespaces()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool has_namespaces </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00172">172</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  173</span>{</div>
<div class="line"><span class="lineno">  174</span><span class="keywordflow">return</span> ((<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.pid != -1) ||</div>
<div class="line"><span class="lineno">  175</span>    (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.net != -1) ||</div>
<div class="line"><span class="lineno">  176</span>    (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.ns != -1) ||</div>
<div class="line"><span class="lineno">  177</span>    (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.ipc != -1) ||</div>
<div class="line"><span class="lineno">  178</span>    (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.uts != -1) ||</div>
<div class="line"><span class="lineno">  179</span>    (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.user != -1) ||</div>
<div class="line"><span class="lineno">  180</span>    (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.cgroup != -1) ||</div>
<div class="line"><span class="lineno">  181</span>#ifdef CLONE_NEWTIME</div>
<div class="line"><span class="lineno">  182</span>    (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.time != -1) ||</div>
<div class="line"><span class="lineno">  183</span>#endif</div>
<div class="line"><span class="lineno">  184</span>    <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace);</div>
<div class="line"><span class="lineno">  185</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>.</p>

</div>
</div>
<a id="a71525bf218f3fe2889a36b88e7b9964d" name="a71525bf218f3fe2889a36b88e7b9964d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71525bf218f3fe2889a36b88e7b9964d">&#9670;&#160;</a></span>hook_process_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void hook_process_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dc/d56/uloop_8h.html#da/d43/structuloop__process">uloop_process</a> *</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ret</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00437">437</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  438</span>{</div>
<div class="line"><span class="lineno">  439</span>    <a class="code hl_function" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91">uloop_timeout_cancel</a>(&amp;<a class="code hl_variable" href="#a78ac6aa6bcda14a353a7bbc5d31f7d59">hook_process_timeout</a>);</div>
<div class="line"><span class="lineno">  440</span> </div>
<div class="line"><span class="lineno">  441</span>    <span class="keywordflow">if</span> (WIFEXITED(ret)) {</div>
<div class="line"><span class="lineno">  442</span>        <a class="code hl_variable" href="#af1fb066316f676461bbd8e92a073b26c">hook_return_code</a> = WEXITSTATUS(ret);</div>
<div class="line"><span class="lineno">  443</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#af1fb066316f676461bbd8e92a073b26c">hook_return_code</a>)</div>
<div class="line"><span class="lineno">  444</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;hook (%d) exited with exit: %d\n&quot;</span>, c-&gt;<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, <a class="code hl_variable" href="#af1fb066316f676461bbd8e92a073b26c">hook_return_code</a>);</div>
<div class="line"><span class="lineno">  445</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  446</span>            <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;hook (%d) exited with exit: %d\n&quot;</span>, c-&gt;<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, <a class="code hl_variable" href="#af1fb066316f676461bbd8e92a073b26c">hook_return_code</a>);</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  449</span>        <a class="code hl_variable" href="#af1fb066316f676461bbd8e92a073b26c">hook_return_code</a> = WTERMSIG(ret);</div>
<div class="line"><span class="lineno">  450</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;hook (%d) exited with signal: %d\n&quot;</span>, c-&gt;<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, <a class="code hl_variable" href="#af1fb066316f676461bbd8e92a073b26c">hook_return_code</a>);</div>
<div class="line"><span class="lineno">  451</span>    }</div>
<div class="line"><span class="lineno">  452</span>    <a class="code hl_variable" href="#a7f85aa468b522508531e8c0bece6552c">hook_running</a> = 0;</div>
<div class="line"><span class="lineno">  453</span>    ++<a class="code hl_variable" href="#aa3d0fc71d58968708478752881b119c0">current_hook</a>;</div>
<div class="line"><span class="lineno">  454</span>    <a class="code hl_function" href="#a88ee3d42d3e892d3b5dd714d89b49505">run_hooklist</a>();</div>
<div class="line"><span class="lineno">  455</span>}</div>
<div class="ttc" id="ajail_8c_html_a78ac6aa6bcda14a353a7bbc5d31f7d59"><div class="ttname"><a href="#a78ac6aa6bcda14a353a7bbc5d31f7d59">hook_process_timeout</a></div><div class="ttdeci">static struct uloop_timeout hook_process_timeout</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00432">jail.c:432</a></div></div>
<div class="ttc" id="ajail_8c_html_a7f85aa468b522508531e8c0bece6552c"><div class="ttname"><a href="#a7f85aa468b522508531e8c0bece6552c">hook_running</a></div><div class="ttdeci">static int hook_running</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00425">jail.c:425</a></div></div>
<div class="ttc" id="ajail_8c_html_a88ee3d42d3e892d3b5dd714d89b49505"><div class="ttname"><a href="#a88ee3d42d3e892d3b5dd714d89b49505">run_hooklist</a></div><div class="ttdeci">static void run_hooklist(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00467">jail.c:467</a></div></div>
<div class="ttc" id="ajail_8c_html_aa3d0fc71d58968708478752881b119c0"><div class="ttname"><a href="#aa3d0fc71d58968708478752881b119c0">current_hook</a></div><div class="ttdeci">static struct hook_execvpe ** current_hook</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00427">jail.c:427</a></div></div>
<div class="ttc" id="ajail_8c_html_af1fb066316f676461bbd8e92a073b26c"><div class="ttname"><a href="#af1fb066316f676461bbd8e92a073b26c">hook_return_code</a></div><div class="ttdeci">static int hook_return_code</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00426">jail.c:426</a></div></div>
<div class="ttc" id="auloop_8c_html_a6231184d2f54ac1bc945ecb73c517d91"><div class="ttname"><a href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91">uloop_timeout_cancel</a></div><div class="ttdeci">int uloop_timeout_cancel(struct uloop_timeout *timeout)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d08/uloop_8c_source.html#l00348">uloop.c:348</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l00427">current_hook</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00432">hook_process_timeout</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00426">hook_return_code</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00425">hook_running</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00087">uloop_process::pid</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00467">run_hooklist()</a>, and <a class="el" href="../../d1/d08/uloop_8c_source.html#l00348">uloop_timeout_cancel()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00467">run_hooklist()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a71525bf218f3fe2889a36b88e7b9964d_cgraph.png" border="0" usemap="#add/d26/jail_8c_a71525bf218f3fe2889a36b88e7b9964d_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a71525bf218f3fe2889a36b88e7b9964d_cgraph" id="add/d26/jail_8c_a71525bf218f3fe2889a36b88e7b9964d_cgraph">
<area shape="rect" title=" " alt="" coords="5,159,232,192"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a88ee3d42d3e892d3b5dd714d89b49505" title=" " alt="" coords="280,159,414,192"/>
<area shape="poly" title=" " alt="" coords="232,182,264,182,264,187,232,187"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="1241,257,1461,291"/>
<area shape="poly" title=" " alt="" coords="141,191,207,241,306,304,365,333,428,357,493,373,559,380,804,380,916,386,1005,396,1047,396,1091,390,1138,377,1192,355,1207,343,1215,329,1224,314,1239,300,1247,295,1250,300,1243,304,1228,318,1220,332,1211,346,1194,359,1140,382,1092,396,1048,401,1005,401,916,392,804,385,559,385,492,379,426,362,363,338,304,308,204,246,138,195"/>
<area shape="poly" title=" " alt="" coords="279,170,247,169,247,164,279,165"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb" title=" " alt="" coords="462,21,658,55"/>
<area shape="poly" title=" " alt="" coords="373,156,518,62,521,66,376,160"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077" title=" " alt="" coords="504,193,617,227"/>
<area shape="poly" title=" " alt="" coords="415,184,489,196,488,201,414,189"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="708,116,898,150"/>
<area shape="poly" title=" " alt="" coords="414,167,692,140,693,146,415,172"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="1287,5,1416,39"/>
<area shape="poly" title=" " alt="" coords="659,30,948,20,1271,19,1271,24,948,25,659,36"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="1542,5,1643,39"/>
<area shape="poly" title=" " alt="" coords="1416,20,1526,20,1526,25,1416,25"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a14d4e1fa83f245cd59f0c68f48c90d75" title=" " alt="" coords="706,201,900,235"/>
<area shape="poly" title=" " alt="" coords="617,209,691,212,690,217,617,215"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a18ed130af55f89035ca041f340a091f9" title=" " alt="" coords="950,144,1191,178"/>
<area shape="poly" title=" " alt="" coords="884,198,973,179,974,184,885,203"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a5d07b4993342a59a1b6327d23a771d47" title=" " alt="" coords="948,311,1193,344"/>
<area shape="poly" title=" " alt="" coords="836,233,888,261,949,289,989,303,987,308,947,294,885,266,833,238"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ab4fcc424426de9a075b7b4b6f390fd2e" title=" " alt="" coords="949,201,1192,235"/>
<area shape="poly" title=" " alt="" coords="900,216,933,216,933,221,900,221"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a1d8cdbdb1ea8dad23288f6ec0b2ff005" title=" " alt="" coords="978,420,1163,454"/>
<area shape="poly" title=" " alt="" coords="822,234,877,290,949,355,1028,409,1025,414,946,359,873,293,818,237"/>
<area shape="rect" href="../../da/d23/list_8h.html#a6ff0e5eee443d7b27def83827340634d" title=" " alt="" coords="1293,200,1409,234"/>
<area shape="poly" title=" " alt="" coords="1159,176,1279,200,1277,205,1158,181"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a76f33118cba0a358482528fad8c0f4cd" title=" " alt="" coords="1312,85,1390,119"/>
<area shape="poly" title=" " alt="" coords="1154,141,1296,111,1297,116,1155,146"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a941864296983cb342a79afe55055f8d3" title=" " alt="" coords="1275,143,1427,176"/>
<area shape="poly" title=" " alt="" coords="1192,158,1259,157,1259,163,1192,163"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a49ba044023de765e2d9d14db25d1845b" title=" " alt="" coords="1242,315,1460,348"/>
<area shape="poly" title=" " alt="" coords="1193,327,1227,327,1227,332,1193,332"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="1550,285,1635,319"/>
<area shape="poly" title=" " alt="" coords="1460,316,1535,306,1535,312,1461,321"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="1786,285,1881,319"/>
<area shape="poly" title=" " alt="" coords="1635,300,1771,300,1771,305,1635,305"/>
<area shape="poly" title=" " alt="" coords="1192,215,1277,215,1277,220,1192,220"/>
<area shape="poly" title=" " alt="" coords="1171,198,1191,188,1207,174,1215,159,1223,143,1239,128,1267,114,1296,106,1298,111,1269,119,1243,132,1228,146,1219,162,1211,177,1195,192,1173,203"/>
<area shape="poly" title=" " alt="" coords="1154,198,1259,176,1260,181,1155,203"/>
<area shape="poly" title=" " alt="" coords="1159,233,1249,251,1248,256,1158,238"/>
<area shape="poly" title=" " alt="" coords="1462,284,1535,293,1534,298,1461,290"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#abe443fe3f794c14f0aaa0c5f18a27ddd" title=" " alt="" coords="1724,428,1943,462"/>
<area shape="poly" title=" " alt="" coords="1163,435,1708,441,1708,446,1163,440"/>
<area shape="rect" href="../../d3/d91/uloop-epoll_8c.html#a596fcfcf68883d7c7977ee295adf9625" title=" " alt="" coords="1252,373,1451,407"/>
<area shape="poly" title=" " alt="" coords="1163,419,1236,407,1237,412,1164,424"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="1509,373,1676,407"/>
<area shape="poly" title=" " alt="" coords="1451,388,1494,388,1494,393,1451,393"/>
<area shape="poly" title=" " alt="" coords="1670,405,1742,421,1741,427,1669,410"/>
<area shape="rect" href="../../d3/d91/uloop-epoll_8c.html#ae98d2f54596aacb1f0f176d0e565e2e2" title=" " alt="" coords="1741,371,1926,404"/>
<area shape="poly" title=" " alt="" coords="1676,387,1726,386,1726,391,1676,392"/>
<area shape="poly" title=" " alt="" coords="898,129,948,129,1070,125,1124,125,1193,129,1260,138,1259,143,1193,134,1124,130,1071,130,948,134,898,135"/>
<area shape="poly" title=" " alt="" coords="842,148,872,165,901,187,916,204,924,219,933,233,949,245,1016,271,1088,285,1159,290,1225,288,1226,293,1159,295,1087,290,1015,276,946,250,929,237,920,222,912,207,898,191,869,170,839,153"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07" title=" " alt="" coords="972,35,1169,68"/>
<area shape="poly" title=" " alt="" coords="858,113,947,85,994,71,996,76,948,90,860,118"/>
<area shape="poly" title=" " alt="" coords="1169,39,1271,28,1271,33,1169,44"/>
<area shape="poly" title=" " alt="" coords="1168,66,1297,90,1296,95,1167,72"/>
</map>
</div>

</div>
</div>
<a id="a4c2afa94c622fb838442b3f2b631f7c0" name="a4c2afa94c622fb838442b3f2b631f7c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c2afa94c622fb838442b3f2b631f7c0">&#9670;&#160;</a></span>hook_process_timeout_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void hook_process_timeout_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a> *</td>          <td class="paramname"><span class="paramname"><em>t</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00461">461</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  462</span>{</div>
<div class="line"><span class="lineno">  463</span>    <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;hook process failed to stop, sending SIGKILL\n&quot;</span>);</div>
<div class="line"><span class="lineno">  464</span>    kill(<a class="code hl_variable" href="#a86b744573f5030d3689a980f0006e23a">hook_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, SIGKILL);</div>
<div class="line"><span class="lineno">  465</span>}</div>
<div class="ttc" id="ajail_8c_html_a86b744573f5030d3689a980f0006e23a"><div class="ttname"><a href="#a86b744573f5030d3689a980f0006e23a">hook_process</a></div><div class="ttdeci">static struct uloop_process hook_process</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00457">jail.c:457</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00457">hook_process</a>, and <a class="el" href="../../dc/d56/uloop_8h_source.html#l00087">uloop_process::pid</a>.</p>

</div>
</div>
<a id="a4d20901cfe9adbe227505e368612346d" name="a4d20901cfe9adbe227505e368612346d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d20901cfe9adbe227505e368612346d">&#9670;&#160;</a></span>jail_handle_signal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void jail_handle_signal </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>signo</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01117">1117</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1118</span>{</div>
<div class="line"><span class="lineno"> 1119</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a7f85aa468b522508531e8c0bece6552c">hook_running</a>) {</div>
<div class="line"><span class="lineno"> 1120</span>        <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;forwarding signal %d to the hook process\n&quot;</span>, signo);</div>
<div class="line"><span class="lineno"> 1121</span>        kill(<a class="code hl_variable" href="#a86b744573f5030d3689a980f0006e23a">hook_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, signo);</div>
<div class="line"><span class="lineno"> 1122</span>        <span class="comment">/* set timeout to send SIGKILL hook process in case SIGTERM doesn&#39;t succeed */</span></div>
<div class="line"><span class="lineno"> 1123</span>        <span class="keywordflow">if</span> (signo == SIGTERM)</div>
<div class="line"><span class="lineno"> 1124</span>            <a class="code hl_function" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346">uloop_timeout_set</a>(&amp;<a class="code hl_variable" href="#a78ac6aa6bcda14a353a7bbc5d31f7d59">hook_process_timeout</a>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.term_timeout * 1000);</div>
<div class="line"><span class="lineno"> 1125</span>    }</div>
<div class="line"><span class="lineno"> 1126</span> </div>
<div class="line"><span class="lineno"> 1127</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a056d6abff975f4167ecd49617b5261ee">jail_running</a>) {</div>
<div class="line"><span class="lineno"> 1128</span>        <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;forwarding signal %d to the jailed process\n&quot;</span>, signo);</div>
<div class="line"><span class="lineno"> 1129</span>        kill(<a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, signo);</div>
<div class="line"><span class="lineno"> 1130</span>        <span class="comment">/* set timeout to send SIGKILL jail process in case SIGTERM doesn&#39;t succeed */</span></div>
<div class="line"><span class="lineno"> 1131</span>        <span class="keywordflow">if</span> (signo == SIGTERM)</div>
<div class="line"><span class="lineno"> 1132</span>            <a class="code hl_function" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346">uloop_timeout_set</a>(&amp;<a class="code hl_variable" href="#aacb1a5c0057b0c69933163312d70e8fd">jail_process_timeout</a>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.term_timeout * 1000);</div>
<div class="line"><span class="lineno"> 1133</span>    }</div>
<div class="line"><span class="lineno"> 1134</span>}</div>
<div class="ttc" id="ajail_8c_html_a056d6abff975f4167ecd49617b5261ee"><div class="ttname"><a href="#a056d6abff975f4167ecd49617b5261ee">jail_running</a></div><div class="ttdeci">static int jail_running</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01085">jail.c:1085</a></div></div>
<div class="ttc" id="ajail_8c_html_aacb1a5c0057b0c69933163312d70e8fd"><div class="ttname"><a href="#aacb1a5c0057b0c69933163312d70e8fd">jail_process_timeout</a></div><div class="ttdeci">static struct uloop_timeout jail_process_timeout</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01089">jail.c:1089</a></div></div>
<div class="ttc" id="auloop_8c_html_aeae1856255dccd537fd19cdda1cba346"><div class="ttname"><a href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346">uloop_timeout_set</a></div><div class="ttdeci">int uloop_timeout_set(struct uloop_timeout *timeout, int msecs)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d08/uloop_8c_source.html#l00328">uloop.c:328</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00457">hook_process</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00432">hook_process_timeout</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00425">hook_running</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01107">jail_process</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01089">jail_process_timeout</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01085">jail_running</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00087">uloop_process::pid</a>, and <a class="el" href="../../d1/d08/uloop_8c_source.html#l00328">uloop_timeout_set()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01136">signals_init()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a4d20901cfe9adbe227505e368612346d_cgraph.png" border="0" usemap="#add/d26/jail_8c_a4d20901cfe9adbe227505e368612346d_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a4d20901cfe9adbe227505e368612346d_cgraph" id="add/d26/jail_8c_a4d20901cfe9adbe227505e368612346d_cgraph">
<area shape="rect" title=" " alt="" coords="5,63,189,96"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="237,63,426,96"/>
<area shape="poly" title=" " alt="" coords="189,77,221,77,221,82,189,82"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a941864296983cb342a79afe55055f8d3" title=" " alt="" coords="508,5,660,39"/>
<area shape="poly" title=" " alt="" coords="408,59,492,40,494,45,409,65"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07" title=" " alt="" coords="486,63,682,96"/>
<area shape="poly" title=" " alt="" coords="427,77,470,77,470,82,427,82"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="474,120,694,154"/>
<area shape="poly" title=" " alt="" coords="409,94,492,113,491,119,408,100"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="742,5,872,39"/>
<area shape="poly" title=" " alt="" coords="653,60,694,49,727,40,728,45,695,54,654,65"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a76f33118cba0a358482528fad8c0f4cd" title=" " alt="" coords="768,63,846,96"/>
<area shape="poly" title=" " alt="" coords="683,77,752,77,752,82,683,82"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="920,5,1021,39"/>
<area shape="poly" title=" " alt="" coords="872,20,904,20,904,25,872,25"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="764,120,850,154"/>
<area shape="poly" title=" " alt="" coords="695,134,749,134,749,140,695,140"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="923,120,1018,154"/>
<area shape="poly" title=" " alt="" coords="850,134,908,134,908,140,850,140"/>
</map>
</div>

</div>
</div>
<a id="a871481dd00dcac30989df45c68b2e27a" name="a871481dd00dcac30989df45c68b2e27a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a871481dd00dcac30989df45c68b2e27a">&#9670;&#160;</a></span>jail_join_ns()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int jail_join_ns </td>
          <td>(</td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>arg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01888">1888</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1889</span>{</div>
<div class="line"><span class="lineno"> 1890</span>    pid_t pid;</div>
<div class="line"><span class="lineno"> 1891</span>    <span class="keywordtype">int</span> fd;</div>
<div class="line"><span class="lineno"> 1892</span>    <span class="keywordtype">int</span> nstype;</div>
<div class="line"><span class="lineno"> 1893</span>    <span class="keywordtype">char</span> *tmp, *etmp, *nspath;</div>
<div class="line"><span class="lineno"> 1894</span>    <span class="keywordtype">int</span> *setns;</div>
<div class="line"><span class="lineno"> 1895</span> </div>
<div class="line"><span class="lineno"> 1896</span>    tmp = strchr(arg, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><span class="lineno"> 1897</span>    <span class="keywordflow">if</span> (!tmp)</div>
<div class="line"><span class="lineno"> 1898</span>        <span class="keywordflow">return</span> EINVAL;</div>
<div class="line"><span class="lineno"> 1899</span> </div>
<div class="line"><span class="lineno"> 1900</span>    *tmp = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1901</span>    pid = atoi(arg);</div>
<div class="line"><span class="lineno"> 1902</span> </div>
<div class="line"><span class="lineno"> 1903</span>    <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno"> 1904</span>        ++tmp;</div>
<div class="line"><span class="lineno"> 1905</span>        etmp = strchr(tmp, <span class="charliteral">&#39;,&#39;</span>);</div>
<div class="line"><span class="lineno"> 1906</span>        <span class="keywordflow">if</span> (etmp)</div>
<div class="line"><span class="lineno"> 1907</span>            *etmp = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1908</span> </div>
<div class="line"><span class="lineno"> 1909</span>        nstype = <a class="code hl_function" href="#a259f820c79f4b101ce41e26167ace63f">resolve_nstype</a>(tmp);</div>
<div class="line"><span class="lineno"> 1910</span>        <span class="keywordflow">if</span> (!nstype)</div>
<div class="line"><span class="lineno"> 1911</span>            <span class="keywordflow">return</span> EINVAL;</div>
<div class="line"><span class="lineno"> 1912</span> </div>
<div class="line"><span class="lineno"> 1913</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp; nstype)</div>
<div class="line"><span class="lineno"> 1914</span>            <span class="keywordflow">return</span> ENOTUNIQ;</div>
<div class="line"><span class="lineno"> 1915</span> </div>
<div class="line"><span class="lineno"> 1916</span>        setns = <a class="code hl_function" href="#a3aa34193a0ba95da6ede6aa8e16d726f">get_namespace_fd</a>(nstype);</div>
<div class="line"><span class="lineno"> 1917</span> </div>
<div class="line"><span class="lineno"> 1918</span>        <span class="keywordflow">if</span> (!setns)</div>
<div class="line"><span class="lineno"> 1919</span>            <span class="keywordflow">return</span> EFAULT;</div>
<div class="line"><span class="lineno"> 1920</span> </div>
<div class="line"><span class="lineno"> 1921</span>        <span class="keywordflow">if</span> (*setns != -1)</div>
<div class="line"><span class="lineno"> 1922</span>            <span class="keywordflow">return</span> ENOTUNIQ;</div>
<div class="line"><span class="lineno"> 1923</span> </div>
<div class="line"><span class="lineno"> 1924</span>        <span class="keywordflow">if</span> (asprintf(&amp;nspath, <span class="stringliteral">&quot;/proc/%d/ns/%s&quot;</span>, pid, tmp) &lt; 0)</div>
<div class="line"><span class="lineno"> 1925</span>            <span class="keywordflow">return</span> ENOMEM;</div>
<div class="line"><span class="lineno"> 1926</span> </div>
<div class="line"><span class="lineno"> 1927</span>        fd = open(nspath, O_RDONLY);</div>
<div class="line"><span class="lineno"> 1928</span>        free(nspath);</div>
<div class="line"><span class="lineno"> 1929</span> </div>
<div class="line"><span class="lineno"> 1930</span>        <span class="keywordflow">if</span> (fd &lt; 0)</div>
<div class="line"><span class="lineno"> 1931</span>            <span class="keywordflow">return</span> errno?:ESTALE;</div>
<div class="line"><span class="lineno"> 1932</span> </div>
<div class="line"><span class="lineno"> 1933</span>        *setns = fd;</div>
<div class="line"><span class="lineno"> 1934</span> </div>
<div class="line"><span class="lineno"> 1935</span>        <span class="keywordflow">if</span> (etmp)</div>
<div class="line"><span class="lineno"> 1936</span>            tmp = etmp;</div>
<div class="line"><span class="lineno"> 1937</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1938</span>            tmp = NULL;</div>
<div class="line"><span class="lineno"> 1939</span>    } <span class="keywordflow">while</span> (tmp);</div>
<div class="line"><span class="lineno"> 1940</span> </div>
<div class="line"><span class="lineno"> 1941</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1942</span>}</div>
<div class="ttc" id="ajail_8c_html_a259f820c79f4b101ce41e26167ace63f"><div class="ttname"><a href="#a259f820c79f4b101ce41e26167ace63f">resolve_nstype</a></div><div class="ttdeci">static int resolve_nstype(char *type)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01805">jail.c:1805</a></div></div>
<div class="ttc" id="ajail_8c_html_a3aa34193a0ba95da6ede6aa8e16d726f"><div class="ttname"><a href="#a3aa34193a0ba95da6ede6aa8e16d726f">get_namespace_fd</a></div><div class="ttdeci">static int * get_namespace_fd(const unsigned int nstype)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01041">jail.c:1041</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l01041">get_namespace_fd()</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l01805">resolve_nstype()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02583">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a871481dd00dcac30989df45c68b2e27a_cgraph.png" border="0" usemap="#add/d26/jail_8c_a871481dd00dcac30989df45c68b2e27a_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a871481dd00dcac30989df45c68b2e27a_cgraph" id="add/d26/jail_8c_a871481dd00dcac30989df45c68b2e27a_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,126,68"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a3aa34193a0ba95da6ede6aa8e16d726f" title=" " alt="" coords="174,5,368,39"/>
<area shape="poly" title=" " alt="" coords="126,40,158,36,159,41,126,46"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a259f820c79f4b101ce41e26167ace63f" title=" " alt="" coords="191,63,351,96"/>
<area shape="poly" title=" " alt="" coords="126,57,176,64,176,69,126,62"/>
</map>
</div>

</div>
</div>
<a id="a152810934f1ea2bc2a73144a121e3b27" name="a152810934f1ea2bc2a73144a121e3b27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a152810934f1ea2bc2a73144a121e3b27">&#9670;&#160;</a></span>jail_process_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void jail_process_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dc/d56/uloop_8h.html#da/d43/structuloop__process">uloop_process</a> *</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ret</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01093">1093</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1094</span>{</div>
<div class="line"><span class="lineno"> 1095</span>    <a class="code hl_function" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91">uloop_timeout_cancel</a>(&amp;<a class="code hl_variable" href="#aacb1a5c0057b0c69933163312d70e8fd">jail_process_timeout</a>);</div>
<div class="line"><span class="lineno"> 1096</span>    <span class="keywordflow">if</span> (WIFEXITED(ret)) {</div>
<div class="line"><span class="lineno"> 1097</span>        <a class="code hl_variable" href="#a176df615ae45a155128a6cc7ce716db8">jail_return_code</a> = WEXITSTATUS(ret);</div>
<div class="line"><span class="lineno"> 1098</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#ab56f6599fb46785e4265a3033ba91aa6">INFO</a>(<span class="stringliteral">&quot;jail (%d) exited with exit: %d\n&quot;</span>, c-&gt;<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, <a class="code hl_variable" href="#a176df615ae45a155128a6cc7ce716db8">jail_return_code</a>);</div>
<div class="line"><span class="lineno"> 1099</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1100</span>        <a class="code hl_variable" href="#a176df615ae45a155128a6cc7ce716db8">jail_return_code</a> = WTERMSIG(ret);</div>
<div class="line"><span class="lineno"> 1101</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#ab56f6599fb46785e4265a3033ba91aa6">INFO</a>(<span class="stringliteral">&quot;jail (%d) exited with signal: %d\n&quot;</span>, c-&gt;<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, <a class="code hl_variable" href="#a176df615ae45a155128a6cc7ce716db8">jail_return_code</a>);</div>
<div class="line"><span class="lineno"> 1102</span>    }</div>
<div class="line"><span class="lineno"> 1103</span>    <a class="code hl_variable" href="#a056d6abff975f4167ecd49617b5261ee">jail_running</a> = 0;</div>
<div class="line"><span class="lineno"> 1104</span>    <a class="code hl_function" href="#a75a14e1ea35414c049cd975fb3e3f99c">poststop</a>();</div>
<div class="line"><span class="lineno"> 1105</span>}</div>
<div class="ttc" id="ajail_8c_html_a176df615ae45a155128a6cc7ce716db8"><div class="ttname"><a href="#a176df615ae45a155128a6cc7ce716db8">jail_return_code</a></div><div class="ttdeci">static int jail_return_code</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01086">jail.c:1086</a></div></div>
<div class="ttc" id="ajail_8c_html_a75a14e1ea35414c049cd975fb3e3f99c"><div class="ttname"><a href="#a75a14e1ea35414c049cd975fb3e3f99c">poststop</a></div><div class="ttdeci">static void poststop(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l03161">jail.c:3161</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00020">INFO</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01089">jail_process_timeout</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01086">jail_return_code</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01085">jail_running</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00087">uloop_process::pid</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l03161">poststop()</a>, and <a class="el" href="../../d1/d08/uloop_8c_source.html#l00348">uloop_timeout_cancel()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a152810934f1ea2bc2a73144a121e3b27_cgraph.png" border="0" usemap="#add/d26/jail_8c_a152810934f1ea2bc2a73144a121e3b27_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a152810934f1ea2bc2a73144a121e3b27_cgraph" id="add/d26/jail_8c_a152810934f1ea2bc2a73144a121e3b27_cgraph">
<area shape="rect" title=" " alt="" coords="5,188,213,221"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a75a14e1ea35414c049cd975fb3e3f99c" title=" " alt="" coords="261,301,362,335"/>
<area shape="poly" title=" " alt="" coords="142,220,268,291,265,295,140,224"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="1161,170,1381,204"/>
<area shape="poly" title=" " alt="" coords="128,185,187,139,275,83,327,57,382,35,440,20,499,15,740,15,847,10,931,3,972,4,1014,9,1061,21,1114,41,1156,64,1194,95,1250,156,1246,160,1190,99,1153,69,1112,45,1059,26,1013,14,971,9,932,8,847,15,740,20,499,20,441,26,384,40,329,62,278,87,190,143,131,189"/>
<area shape="rect" href="../../db/d3d/netifd_8c.html#aeada94c74be21275dbafb9a8d9515e90" title=" " alt="" coords="410,350,590,384"/>
<area shape="poly" title=" " alt="" coords="363,328,419,343,418,348,362,334"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a3360eb012491304d4630403c5dc33ec9" title=" " alt="" coords="425,408,575,441"/>
<area shape="poly" title=" " alt="" coords="332,333,367,364,411,394,421,399,419,404,409,399,364,368,328,337"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a1756d87ceab7e1c79fe7caf453cb102a" title=" " alt="" coords="442,220,559,253"/>
<area shape="poly" title=" " alt="" coords="352,298,444,257,446,262,354,303"/>
<area shape="rect" href="../../db/d3d/netifd_8c.html#aecf17edd05dd1516fd1785ed6cc97d7c" title=" " alt="" coords="638,613,839,647"/>
<area shape="poly" title=" " alt="" coords="576,382,592,393,612,417,621,440,628,465,641,494,679,551,716,599,711,602,674,554,636,496,623,467,616,442,608,420,589,397,573,387"/>
<area shape="rect" href="../../db/d3d/netifd_8c.html#a71698b19f7fdbb3ae922ac51f68e9793" title=" " alt="" coords="660,449,817,483"/>
<area shape="poly" title=" " alt="" coords="562,382,591,393,692,439,690,444,589,398,560,387"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2" title=" " alt="" coords="682,350,795,384"/>
<area shape="poly" title=" " alt="" coords="591,364,667,364,667,370,591,370"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#af8ca2237342df92c699fbb2ddb5f390b" title=" " alt="" coords="1202,613,1341,647"/>
<area shape="poly" title=" " alt="" coords="762,645,817,682,851,700,887,714,950,728,1000,733,1050,728,1112,714,1146,702,1178,687,1234,653,1236,658,1181,692,1148,707,1114,719,1051,733,1000,738,949,734,886,719,849,705,814,687,759,649"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a4bba0979961750f86b8dc9915b2fa4d6" title=" " alt="" coords="896,504,1104,537"/>
<area shape="poly" title=" " alt="" coords="780,610,942,541,945,546,782,615"/>
<area shape="rect" href="../../db/d55/libubus_8h.html#ad79f9793c3835ea8691fe377025c7de7" title=" " alt="" coords="932,670,1068,704"/>
<area shape="poly" title=" " alt="" coords="819,645,917,666,916,671,818,650"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a8567c5497fc066b17da409d9b0512c54" title=" " alt="" coords="918,613,1082,647"/>
<area shape="poly" title=" " alt="" coords="839,627,903,627,903,632,839,632"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#af8de35ec0673663c45f2aad7c876d329" title=" " alt="" coords="1467,584,1572,617"/>
<area shape="poly" title=" " alt="" coords="1341,619,1451,606,1452,611,1341,624"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6f17715cbf1ce82b0981a452537b4dc6" title=" " alt="" coords="1429,641,1610,675"/>
<area shape="poly" title=" " alt="" coords="1341,635,1414,643,1413,648,1341,640"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5bf37ab2b48095b7fb16ac11449b08f6" title=" " alt="" coords="1174,409,1368,443"/>
<area shape="poly" title=" " alt="" coords="1050,500,1205,446,1207,451,1051,506"/>
<area shape="rect" href="../../d2/de5/libubus-req_8c.html#a572cdb5570d677242d1bc90d2d592852" title=" " alt="" coords="1189,517,1353,551"/>
<area shape="poly" title=" " alt="" coords="1068,675,1090,667,1112,657,1127,644,1136,630,1145,615,1159,598,1189,576,1220,556,1223,561,1192,580,1163,602,1149,618,1140,633,1131,647,1114,661,1093,672,1069,680"/>
<area shape="poly" title=" " alt="" coords="1082,627,1186,627,1186,632,1082,632"/>
<area shape="poly" title=" " alt="" coords="766,481,820,515,888,547,1008,575,1187,611,1186,616,1007,581,886,552,818,519,763,485"/>
<area shape="poly" title=" " alt="" coords="818,479,902,497,901,502,817,485"/>
<area shape="poly" title=" " alt="" coords="817,464,956,470,1035,478,1113,488,1202,509,1201,515,1113,494,1034,483,955,476,817,469"/>
<area shape="poly" title=" " alt="" coords="757,481,812,535,848,565,888,591,916,605,914,609,885,596,845,569,808,539,753,485"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a58d1b624b96aa768608f45d390cc0d59" title=" " alt="" coords="1198,326,1344,360"/>
<area shape="poly" title=" " alt="" coords="761,446,816,411,850,393,886,379,962,360,1041,348,1116,341,1182,339,1182,344,1117,347,1042,353,964,365,887,384,852,398,819,416,764,451"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a381e9943751280e58fbbdf5f59f3bec2" title=" " alt="" coords="911,394,1089,428"/>
<area shape="poly" title=" " alt="" coords="817,447,901,429,902,434,818,452"/>
<area shape="poly" title=" " alt="" coords="1090,413,1159,417,1158,422,1089,419"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a7390a5f2c227d5ba53e2bd65afda1cfc" title=" " alt="" coords="916,285,1084,319"/>
<area shape="poly" title=" " alt="" coords="795,350,914,320,915,325,796,356"/>
<area shape="poly" title=" " alt="" coords="1084,312,1183,327,1183,332,1084,317"/>
<area shape="poly" title=" " alt="" coords="1081,282,1112,271,1175,242,1230,210,1232,215,1177,246,1114,276,1082,287"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="1477,170,1562,204"/>
<area shape="poly" title=" " alt="" coords="1382,184,1461,184,1461,190,1382,190"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="1658,170,1752,204"/>
<area shape="poly" title=" " alt="" coords="1563,184,1642,184,1642,190,1563,190"/>
<area shape="poly" title=" " alt="" coords="572,404,667,381,668,387,573,410"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a61855620d1a0683f786486b1722d7dfa" title=" " alt="" coords="685,952,792,985"/>
<area shape="poly" title=" " alt="" coords="512,441,726,936,721,939,507,443"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b" title=" " alt="" coords="930,894,1070,928"/>
<area shape="poly" title=" " alt="" coords="792,954,914,927,915,932,793,959"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a7cdfa1304cca32224a444b6e84fac194" title=" " alt="" coords="932,952,1068,985"/>
<area shape="poly" title=" " alt="" coords="792,966,916,966,916,971,792,971"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5127f557f43086299c2bf291618dcef5" title=" " alt="" coords="931,1176,1069,1209"/>
<area shape="poly" title=" " alt="" coords="750,984,770,1022,800,1070,840,1120,863,1143,888,1162,917,1176,915,1181,885,1167,859,1147,836,1124,795,1073,765,1025,745,987"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a766dbc37dd9f160e1a3b8a9f19651b38" title=" " alt="" coords="1198,1090,1345,1124"/>
<area shape="poly" title=" " alt="" coords="793,977,1114,1046,1215,1082,1214,1087,1112,1051,791,982"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#abb68ed1aa9f416ea5f299d7672a3b5c1" title=" " alt="" coords="902,1061,1098,1095"/>
<area shape="poly" title=" " alt="" coords="772,983,826,1011,888,1039,925,1053,924,1058,886,1044,823,1016,770,988"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5a2acf003db67e7475dcb66937cc12bb" title=" " alt="" coords="938,1118,1062,1152"/>
<area shape="poly" title=" " alt="" coords="755,984,809,1044,846,1077,888,1105,924,1119,922,1124,885,1109,843,1081,805,1048,751,988"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5064c6dcd09eae061c30cba4146bee18" title=" " alt="" coords="940,780,1060,813"/>
<area shape="poly" title=" " alt="" coords="750,949,804,887,842,852,885,822,925,806,927,811,888,827,846,856,808,891,754,953"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4b6f537dfef57c06536c73d6c7c2ff48" title=" " alt="" coords="937,837,1063,871"/>
<area shape="poly" title=" " alt="" coords="763,949,818,914,886,879,921,867,923,872,888,884,820,918,766,953"/>
<area shape="poly" title=" " alt="" coords="1069,1174,1112,1162,1211,1127,1213,1132,1114,1167,1070,1179"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a88ee3d42d3e892d3b5dd714d89b49505" title=" " alt="" coords="671,200,806,233"/>
<area shape="poly" title=" " alt="" coords="559,229,655,221,656,226,559,234"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a71525bf218f3fe2889a36b88e7b9964d" title=" " alt="" coords="887,228,1113,261"/>
<area shape="poly" title=" " alt="" coords="806,229,872,237,871,242,806,234"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb" title=" " alt="" coords="902,170,1098,204"/>
<area shape="poly" title=" " alt="" coords="806,206,886,197,886,202,806,212"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077" title=" " alt="" coords="943,56,1057,89"/>
<area shape="poly" title=" " alt="" coords="755,197,810,148,846,121,886,98,927,83,929,88,888,103,849,125,813,152,758,201"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="905,113,1095,147"/>
<area shape="poly" title=" " alt="" coords="778,196,886,155,908,149,909,154,888,160,780,201"/>
<area shape="poly" title=" " alt="" coords="1082,224,1173,205,1174,210,1083,230"/>
<area shape="poly" title=" " alt="" coords="915,230,821,219,822,214,916,224"/>
<area shape="poly" title=" " alt="" coords="1083,145,1174,164,1173,169,1082,150"/>
</map>
</div>

</div>
</div>
<a id="ab5594c6291500b798715b5e124af342f" name="ab5594c6291500b798715b5e124af342f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5594c6291500b798715b5e124af342f">&#9670;&#160;</a></span>jail_process_timeout_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void jail_process_timeout_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a> *</td>          <td class="paramname"><span class="paramname"><em>t</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01111">1111</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1112</span>{</div>
<div class="line"><span class="lineno"> 1113</span>    <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;jail process failed to stop, sending SIGKILL\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1114</span>    kill(<a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, SIGKILL);</div>
<div class="line"><span class="lineno"> 1115</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01107">jail_process</a>, and <a class="el" href="../../dc/d56/uloop_8h_source.html#l00087">uloop_process::pid</a>.</p>

</div>
</div>
<a id="a67a452007801b15d82d00079f8e344f5" name="a67a452007801b15d82d00079f8e344f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67a452007801b15d82d00079f8e344f5">&#9670;&#160;</a></span>jail_writepid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int jail_writepid </td>
          <td>(</td>
          <td class="paramtype">pid_t</td>          <td class="paramname"><span class="paramname"><em>pid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02518">2518</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2519</span>{</div>
<div class="line"><span class="lineno"> 2520</span>    FILE *_pidfile;</div>
<div class="line"><span class="lineno"> 2521</span> </div>
<div class="line"><span class="lineno"> 2522</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.pidfile)</div>
<div class="line"><span class="lineno"> 2523</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2524</span> </div>
<div class="line"><span class="lineno"> 2525</span>    _pidfile = fopen(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.pidfile, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><span class="lineno"> 2526</span>    <span class="keywordflow">if</span> (_pidfile == NULL)</div>
<div class="line"><span class="lineno"> 2527</span>        <span class="keywordflow">return</span> errno;</div>
<div class="line"><span class="lineno"> 2528</span> </div>
<div class="line"><span class="lineno"> 2529</span>    <span class="keywordflow">if</span> (fprintf(_pidfile, <span class="stringliteral">&quot;%d\n&quot;</span>, pid) &lt; 0) {</div>
<div class="line"><span class="lineno"> 2530</span>        fclose(_pidfile);</div>
<div class="line"><span class="lineno"> 2531</span>        <span class="keywordflow">return</span> errno;</div>
<div class="line"><span class="lineno"> 2532</span>    }</div>
<div class="line"><span class="lineno"> 2533</span> </div>
<div class="line"><span class="lineno"> 2534</span>    <span class="keywordflow">if</span> (fclose(_pidfile))</div>
<div class="line"><span class="lineno"> 2535</span>        <span class="keywordflow">return</span> errno;</div>
<div class="line"><span class="lineno"> 2536</span> </div>
<div class="line"><span class="lineno"> 2537</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2538</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>.</p>

</div>
</div>
<a id="a3c04138a5bfe5d72780bb7e82a18e627" name="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c04138a5bfe5d72780bb7e82a18e627">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>argc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02583">2583</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2584</span>{</div>
<div class="line"><span class="lineno"> 2585</span>    uid_t uid = getuid();</div>
<div class="line"><span class="lineno"> 2586</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> log[] = <span class="stringliteral">&quot;/dev/log&quot;</span>;</div>
<div class="line"><span class="lineno"> 2587</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="../../d1/d96/ubus_2lua_2ubus_8c.html#a3d36b63e5e323c6a729ddcf4932944cc">ubus</a>[] = <span class="stringliteral">&quot;/var/run/ubus/ubus.sock&quot;</span>;</div>
<div class="line"><span class="lineno"> 2588</span>    <span class="keywordtype">int</span> ret = EXIT_FAILURE;</div>
<div class="line"><span class="lineno"> 2589</span>    <span class="keywordtype">int</span> ch;</div>
<div class="line"><span class="lineno"> 2590</span>    <span class="keywordtype">char</span> *tmp;</div>
<div class="line"><span class="lineno"> 2591</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../da/d23/list_8h.html#d9/d93/structlist__head">list_head</a> envl = <a class="code hl_define" href="../../da/d23/list_8h.html#a4642d4b7df28478bb762fe43c85b5c63">LIST_HEAD_INIT</a>(envl);</div>
<div class="line"><span class="lineno"> 2592</span>    <span class="keyword">struct </span><a class="code hl_struct" href="#d3/d32/structenv__e">env_e</a> *enve, *tmpenve;</div>
<div class="line"><span class="lineno"> 2593</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> envn = 0, envc = 0;</div>
<div class="line"><span class="lineno"> 2594</span> </div>
<div class="line"><span class="lineno"> 2595</span>    <span class="keywordflow">if</span> (uid) {</div>
<div class="line"><span class="lineno"> 2596</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;not root, aborting: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2597</span>        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line"><span class="lineno"> 2598</span>    }</div>
<div class="line"><span class="lineno"> 2599</span> </div>
<div class="line"><span class="lineno"> 2600</span>    <span class="comment">/* those are filehandlers, so -1 indicates unused */</span></div>
<div class="line"><span class="lineno"> 2601</span>    <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.pid = -1;</div>
<div class="line"><span class="lineno"> 2602</span>    <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.net = -1;</div>
<div class="line"><span class="lineno"> 2603</span>    <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.ns = -1;</div>
<div class="line"><span class="lineno"> 2604</span>    <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.ipc = -1;</div>
<div class="line"><span class="lineno"> 2605</span>    <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.uts = -1;</div>
<div class="line"><span class="lineno"> 2606</span>    <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.user = -1;</div>
<div class="line"><span class="lineno"> 2607</span>    <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.cgroup = -1;</div>
<div class="line"><span class="lineno"> 2608</span><span class="preprocessor">#ifdef CLONE_NEWTIME</span></div>
<div class="line"><span class="lineno"> 2609</span>    <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.time = -1;</div>
<div class="line"><span class="lineno"> 2610</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2611</span> </div>
<div class="line"><span class="lineno"> 2612</span>    <span class="comment">/* default 5 seconds timeout after SIGTERM before SIGKILL is sent */</span></div>
<div class="line"><span class="lineno"> 2613</span>    <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.term_timeout = 5;</div>
<div class="line"><span class="lineno"> 2614</span> </div>
<div class="line"><span class="lineno"> 2615</span>    umask(022);</div>
<div class="line"><span class="lineno"> 2616</span>    <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a0629849a79384a49397f97b899640cce">mount_list_init</a>();</div>
<div class="line"><span class="lineno"> 2617</span>    <a class="code hl_function" href="../../d2/da6/elf_8c.html#ab5c6746a1010af2033a89a248fc0c2d3">init_library_search</a>();</div>
<div class="line"><span class="lineno"> 2618</span>    <a class="code hl_function" href="../../db/d40/cgroups_8c.html#a4db8a13419b30acde99e30e362cea84c">cgroups_prepare</a>();</div>
<div class="line"><span class="lineno"> 2619</span>    <a class="code hl_variable" href="#a49b89154fcd9cd0089f8c4d9df354d1a">exit_from_child</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2620</span> </div>
<div class="line"><span class="lineno"> 2621</span>    <span class="keywordflow">while</span> ((ch = getopt(argc, argv, <a class="code hl_define" href="#a5f7f8ba02a5383b3b7f9dd28f8c5e8b8">OPT_ARGS</a>)) != -1) {</div>
<div class="line"><span class="lineno"> 2622</span>        <span class="keywordflow">switch</span> (ch) {</div>
<div class="line"><span class="lineno"> 2623</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:</div>
<div class="line"><span class="lineno"> 2624</span>            <a class="code hl_variable" href="#ac3e1795766a80ec63b157951b4b9a7d4">debug</a> = atoi(optarg);</div>
<div class="line"><span class="lineno"> 2625</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2626</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;e&#39;</span>:</div>
<div class="line"><span class="lineno"> 2627</span>            enve = calloc(1, <span class="keyword">sizeof</span>(*enve));</div>
<div class="line"><span class="lineno"> 2628</span>            enve-&gt;<a class="code hl_variable" href="#a080368a08334825ac605d93aa717b4dc">envarg</a> = optarg;</div>
<div class="line"><span class="lineno"> 2629</span>            <a class="code hl_function" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1">list_add_tail</a>(&amp;enve-&gt;<a class="code hl_variable" href="#a4bdac4524a242f6347c1bfe0cd88e3b4">list</a>, &amp;envl);</div>
<div class="line"><span class="lineno"> 2630</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2631</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>:</div>
<div class="line"><span class="lineno"> 2632</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace |= CLONE_NEWNS;</div>
<div class="line"><span class="lineno"> 2633</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.procfs = 1;</div>
<div class="line"><span class="lineno"> 2634</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2635</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;o&#39;</span>:</div>
<div class="line"><span class="lineno"> 2636</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace |= CLONE_NEWNS;</div>
<div class="line"><span class="lineno"> 2637</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ronly = 1;</div>
<div class="line"><span class="lineno"> 2638</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2639</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>:</div>
<div class="line"><span class="lineno"> 2640</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace |= CLONE_NEWUSER;</div>
<div class="line"><span class="lineno"> 2641</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2642</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;F&#39;</span>:</div>
<div class="line"><span class="lineno"> 2643</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace |= <a class="code hl_define" href="#a9d5d88148a26086567c3731e2e5e110a">CLONE_NEWCGROUP</a>;</div>
<div class="line"><span class="lineno"> 2644</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2645</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>:</div>
<div class="line"><span class="lineno"> 2646</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.extroot = realpath(optarg, NULL);</div>
<div class="line"><span class="lineno"> 2647</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2648</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:</div>
<div class="line"><span class="lineno"> 2649</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace |= CLONE_NEWNS;</div>
<div class="line"><span class="lineno"> 2650</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.sysfs = 1;</div>
<div class="line"><span class="lineno"> 2651</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2652</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>:</div>
<div class="line"><span class="lineno"> 2653</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.seccomp = optarg;</div>
<div class="line"><span class="lineno"> 2654</span>            <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a31752c6608fbf56bb359ba109bdc6f6f">add_mount_bind</a>(optarg, 1, -1);</div>
<div class="line"><span class="lineno"> 2655</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2656</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:</div>
<div class="line"><span class="lineno"> 2657</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.capabilities = optarg;</div>
<div class="line"><span class="lineno"> 2658</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2659</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:</div>
<div class="line"><span class="lineno"> 2660</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.no_new_privs = 1;</div>
<div class="line"><span class="lineno"> 2661</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2662</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;n&#39;</span>:</div>
<div class="line"><span class="lineno"> 2663</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.name = optarg;</div>
<div class="line"><span class="lineno"> 2664</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2665</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;N&#39;</span>:</div>
<div class="line"><span class="lineno"> 2666</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace |= CLONE_NEWNET;</div>
<div class="line"><span class="lineno"> 2667</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2668</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;h&#39;</span>:</div>
<div class="line"><span class="lineno"> 2669</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace |= CLONE_NEWUTS;</div>
<div class="line"><span class="lineno"> 2670</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hostname = strdup(optarg);</div>
<div class="line"><span class="lineno"> 2671</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2672</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;j&#39;</span>:</div>
<div class="line"><span class="lineno"> 2673</span>            <a class="code hl_function" href="#a871481dd00dcac30989df45c68b2e27a">jail_join_ns</a>(optarg);</div>
<div class="line"><span class="lineno"> 2674</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2675</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;r&#39;</span>:</div>
<div class="line"><span class="lineno"> 2676</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace |= CLONE_NEWNS;</div>
<div class="line"><span class="lineno"> 2677</span>            tmp = strchr(optarg, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><span class="lineno"> 2678</span>            <span class="keywordflow">if</span> (tmp) {</div>
<div class="line"><span class="lineno"> 2679</span>                *(tmp++) = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 2680</span>                <a class="code hl_function" href="../../d2/d5a/fs_8c.html#ac4992c3c85512f44840f4eda86df97b5">add_2paths_and_deps</a>(optarg, tmp, 1, 0, 0);</div>
<div class="line"><span class="lineno"> 2681</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2682</span>                <a class="code hl_function" href="../../df/d26/fs_8h.html#a3c2c8ec14a25736480de113e1b71f52d">add_path_and_deps</a>(optarg, 1, 0, 0);</div>
<div class="line"><span class="lineno"> 2683</span>            }</div>
<div class="line"><span class="lineno"> 2684</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2685</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;w&#39;</span>:</div>
<div class="line"><span class="lineno"> 2686</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace |= CLONE_NEWNS;</div>
<div class="line"><span class="lineno"> 2687</span>            tmp = strchr(optarg, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><span class="lineno"> 2688</span>            <span class="keywordflow">if</span> (tmp) {</div>
<div class="line"><span class="lineno"> 2689</span>                *(tmp++) = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 2690</span>                <a class="code hl_function" href="../../d2/d5a/fs_8c.html#ac4992c3c85512f44840f4eda86df97b5">add_2paths_and_deps</a>(optarg, tmp, 0, 0, 0);</div>
<div class="line"><span class="lineno"> 2691</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2692</span>                <a class="code hl_function" href="../../df/d26/fs_8h.html#a3c2c8ec14a25736480de113e1b71f52d">add_path_and_deps</a>(optarg, 0, 0, 0);</div>
<div class="line"><span class="lineno"> 2693</span>            }</div>
<div class="line"><span class="lineno"> 2694</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2695</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;u&#39;</span>:</div>
<div class="line"><span class="lineno"> 2696</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace |= CLONE_NEWNS;</div>
<div class="line"><span class="lineno"> 2697</span>            <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a31752c6608fbf56bb359ba109bdc6f6f">add_mount_bind</a>(<a class="code hl_variable" href="../../d1/d96/ubus_2lua_2ubus_8c.html#a3d36b63e5e323c6a729ddcf4932944cc">ubus</a>, 0, -1);</div>
<div class="line"><span class="lineno"> 2698</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2699</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;l&#39;</span>:</div>
<div class="line"><span class="lineno"> 2700</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace |= CLONE_NEWNS;</div>
<div class="line"><span class="lineno"> 2701</span>            <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a31752c6608fbf56bb359ba109bdc6f6f">add_mount_bind</a>(log, 0, -1);</div>
<div class="line"><span class="lineno"> 2702</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2703</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;U&#39;</span>:</div>
<div class="line"><span class="lineno"> 2704</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.user = optarg;</div>
<div class="line"><span class="lineno"> 2705</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2706</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;G&#39;</span>:</div>
<div class="line"><span class="lineno"> 2707</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.group = optarg;</div>
<div class="line"><span class="lineno"> 2708</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2709</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;O&#39;</span>:</div>
<div class="line"><span class="lineno"> 2710</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.overlaydir = realpath(optarg, NULL);</div>
<div class="line"><span class="lineno"> 2711</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2712</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>:</div>
<div class="line"><span class="lineno"> 2713</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.term_timeout = atoi(optarg);</div>
<div class="line"><span class="lineno"> 2714</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2715</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:</div>
<div class="line"><span class="lineno"> 2716</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.tmpoverlaysize = optarg;</div>
<div class="line"><span class="lineno"> 2717</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2718</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;E&#39;</span>:</div>
<div class="line"><span class="lineno"> 2719</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.require_jail = 1;</div>
<div class="line"><span class="lineno"> 2720</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2721</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;y&#39;</span>:</div>
<div class="line"><span class="lineno"> 2722</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.console = 1;</div>
<div class="line"><span class="lineno"> 2723</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2724</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;J&#39;</span>:</div>
<div class="line"><span class="lineno"> 2725</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ocibundle = optarg;</div>
<div class="line"><span class="lineno"> 2726</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2727</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;i&#39;</span>:</div>
<div class="line"><span class="lineno"> 2728</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.immediately = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2729</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2730</span>        <span class="keywordflow">case</span> <span class="charliteral">&#39;P&#39;</span>:</div>
<div class="line"><span class="lineno"> 2731</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.pidfile = optarg;</div>
<div class="line"><span class="lineno"> 2732</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2733</span>        }</div>
<div class="line"><span class="lineno"> 2734</span>    }</div>
<div class="line"><span class="lineno"> 2735</span> </div>
<div class="line"><span class="lineno"> 2736</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp;&amp; !<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ocibundle)</div>
<div class="line"><span class="lineno"> 2737</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace |= CLONE_NEWIPC | CLONE_NEWPID;</div>
<div class="line"><span class="lineno"> 2738</span> </div>
<div class="line"><span class="lineno"> 2739</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2740</span><span class="comment">     * env import from cmdline is not available for OCI containers</span></div>
<div class="line"><span class="lineno"> 2741</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2742</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ocibundle &amp;&amp; !<a class="code hl_function" href="../../da/d23/list_8h.html#a6ff0e5eee443d7b27def83827340634d">list_empty</a>(&amp;envl)) {</div>
<div class="line"><span class="lineno"> 2743</span>        ret=-ENOTSUP;</div>
<div class="line"><span class="lineno"> 2744</span>        <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2745</span>    }</div>
<div class="line"><span class="lineno"> 2746</span> </div>
<div class="line"><span class="lineno"> 2747</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2748</span><span class="comment">     * prepare list of env variables to import for slim containers</span></div>
<div class="line"><span class="lineno"> 2749</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2750</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../da/d23/list_8h.html#a6ff0e5eee443d7b27def83827340634d">list_empty</a>(&amp;envl)) {</div>
<div class="line"><span class="lineno"> 2751</span>        <a class="code hl_define" href="../../da/d23/list_8h.html#a6b4019bb70de70adc3caddbe3a024c27">list_for_each_entry</a>(enve, &amp;envl, <a class="code hl_variable" href="#a4bdac4524a242f6347c1bfe0cd88e3b4">list</a>)</div>
<div class="line"><span class="lineno"> 2752</span>            ++envn;</div>
<div class="line"><span class="lineno"> 2753</span> </div>
<div class="line"><span class="lineno"> 2754</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.envp = calloc(1 + envn, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));</div>
<div class="line"><span class="lineno"> 2755</span>        <a class="code hl_define" href="../../da/d23/list_8h.html#a698670b36c7c0ca13822698ee825ddc8">list_for_each_entry_safe</a>(enve, tmpenve, &amp;envl, <a class="code hl_variable" href="#a4bdac4524a242f6347c1bfe0cd88e3b4">list</a>) {</div>
<div class="line"><span class="lineno"> 2756</span>            tmp = getenv(enve-&gt;<a class="code hl_variable" href="#a080368a08334825ac605d93aa717b4dc">envarg</a>);</div>
<div class="line"><span class="lineno"> 2757</span>            <span class="keywordflow">if</span> (tmp) {</div>
<div class="line"><span class="lineno"> 2758</span>                ret = asprintf(&amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.envp[envc++], <span class="stringliteral">&quot;%s=%s&quot;</span>, enve-&gt;<a class="code hl_variable" href="#a080368a08334825ac605d93aa717b4dc">envarg</a>, tmp);</div>
<div class="line"><span class="lineno"> 2759</span>                <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line"><span class="lineno"> 2760</span>                    <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;filed to handle envargs %s\n&quot;</span>, tmp);</div>
<div class="line"><span class="lineno"> 2761</span>                    free(enve);</div>
<div class="line"><span class="lineno"> 2762</span>                    <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2763</span>                }</div>
<div class="line"><span class="lineno"> 2764</span>            }</div>
<div class="line"><span class="lineno"> 2765</span> </div>
<div class="line"><span class="lineno"> 2766</span>            <a class="code hl_function" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5">list_del</a>(&amp;enve-&gt;<a class="code hl_variable" href="#a4bdac4524a242f6347c1bfe0cd88e3b4">list</a>);</div>
<div class="line"><span class="lineno"> 2767</span>            free(enve);</div>
<div class="line"><span class="lineno"> 2768</span>        }</div>
<div class="line"><span class="lineno"> 2769</span> </div>
<div class="line"><span class="lineno"> 2770</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.envp[envc] = NULL;</div>
<div class="line"><span class="lineno"> 2771</span>    }</div>
<div class="line"><span class="lineno"> 2772</span> </div>
<div class="line"><span class="lineno"> 2773</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2774</span><span class="comment">     * uid in parent user namespace representing root user in new</span></div>
<div class="line"><span class="lineno"> 2775</span><span class="comment">     * user namespace, defaults to nobody unless specified in uidMappings</span></div>
<div class="line"><span class="lineno"> 2776</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2777</span>    <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.root_map_uid = 65534;</div>
<div class="line"><span class="lineno"> 2778</span> </div>
<div class="line"><span class="lineno"> 2779</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.capabilities &amp;&amp; <a class="code hl_function" href="../../d2/d61/capabilities_8c.html#a84025d2cb161afc53b5483d71b1ebab4">parseOCIcapabilities_from_file</a>(&amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.capset, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.capabilities)) {</div>
<div class="line"><span class="lineno"> 2780</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to read capabilities from file %s\n&quot;</span>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.capabilities);</div>
<div class="line"><span class="lineno"> 2781</span>        ret=-1;</div>
<div class="line"><span class="lineno"> 2782</span>        <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2783</span>    }</div>
<div class="line"><span class="lineno"> 2784</span> </div>
<div class="line"><span class="lineno"> 2785</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ocibundle) {</div>
<div class="line"><span class="lineno"> 2786</span>        <span class="keywordtype">char</span> *jsonfile;</div>
<div class="line"><span class="lineno"> 2787</span>        <span class="keywordtype">int</span> ocires;</div>
<div class="line"><span class="lineno"> 2788</span> </div>
<div class="line"><span class="lineno"> 2789</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.name) {</div>
<div class="line"><span class="lineno"> 2790</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;OCI bundle needs a named jail\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2791</span>            ret=-1;</div>
<div class="line"><span class="lineno"> 2792</span>            <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2793</span>        }</div>
<div class="line"><span class="lineno"> 2794</span>        <span class="keywordflow">if</span> (asprintf(&amp;jsonfile, <span class="stringliteral">&quot;%s/config.json&quot;</span>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ocibundle) &lt; 0) {</div>
<div class="line"><span class="lineno"> 2795</span>            ret=-ENOMEM;</div>
<div class="line"><span class="lineno"> 2796</span>            <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2797</span>        }</div>
<div class="line"><span class="lineno"> 2798</span>        ocires = <a class="code hl_function" href="#a4d6b15fa5d3ae9b608587bd11cbda9cf">parseOCI</a>(jsonfile);</div>
<div class="line"><span class="lineno"> 2799</span>        free(jsonfile);</div>
<div class="line"><span class="lineno"> 2800</span>        <span class="keywordflow">if</span> (ocires) {</div>
<div class="line"><span class="lineno"> 2801</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;parsing of OCI JSON spec has failed: %s (%d)\n&quot;</span>, strerror(ocires), ocires);</div>
<div class="line"><span class="lineno"> 2802</span>            ret=ocires;</div>
<div class="line"><span class="lineno"> 2803</span>            <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2804</span>        }</div>
<div class="line"><span class="lineno"> 2805</span>    }</div>
<div class="line"><span class="lineno"> 2806</span> </div>
<div class="line"><span class="lineno"> 2807</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp; CLONE_NEWNET) {</div>
<div class="line"><span class="lineno"> 2808</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.name) {</div>
<div class="line"><span class="lineno"> 2809</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;netns needs a named jail\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2810</span>            ret=-1;</div>
<div class="line"><span class="lineno"> 2811</span>            <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2812</span>        }</div>
<div class="line"><span class="lineno"> 2813</span>    }</div>
<div class="line"><span class="lineno"> 2814</span> </div>
<div class="line"><span class="lineno"> 2815</span> </div>
<div class="line"><span class="lineno"> 2816</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.tmpoverlaysize &amp;&amp; strlen(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.tmpoverlaysize) &gt; 8) {</div>
<div class="line"><span class="lineno"> 2817</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;size parameter too long: \&quot;%s\&quot;\n&quot;</span>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.tmpoverlaysize);</div>
<div class="line"><span class="lineno"> 2818</span>        ret=-1;</div>
<div class="line"><span class="lineno"> 2819</span>        <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2820</span>    }</div>
<div class="line"><span class="lineno"> 2821</span> </div>
<div class="line"><span class="lineno"> 2822</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.extroot &amp;&amp; <a class="code hl_function" href="#a31575d38ed43b739ca94e78c23e5b1e0">checkpath</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.extroot)) {</div>
<div class="line"><span class="lineno"> 2823</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;invalid rootfs path &#39;%s&#39;&quot;</span>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.extroot);</div>
<div class="line"><span class="lineno"> 2824</span>        ret=-1;</div>
<div class="line"><span class="lineno"> 2825</span>        <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2826</span>    }</div>
<div class="line"><span class="lineno"> 2827</span> </div>
<div class="line"><span class="lineno"> 2828</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.overlaydir &amp;&amp; <a class="code hl_function" href="#a31575d38ed43b739ca94e78c23e5b1e0">checkpath</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.overlaydir)) {</div>
<div class="line"><span class="lineno"> 2829</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;invalid rootfs overlay path &#39;%s&#39;&quot;</span>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.overlaydir);</div>
<div class="line"><span class="lineno"> 2830</span>        ret=-1;</div>
<div class="line"><span class="lineno"> 2831</span>        <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2832</span>    }</div>
<div class="line"><span class="lineno"> 2833</span> </div>
<div class="line"><span class="lineno"> 2834</span>    <span class="comment">/* no &lt;binary&gt; param found */</span></div>
<div class="line"><span class="lineno"> 2835</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ocibundle &amp;&amp; (argc - optind &lt; 1)) {</div>
<div class="line"><span class="lineno"> 2836</span>        <a class="code hl_function" href="#ad96d407a911fbb914fa8e4cfbf2faf0f">usage</a>();</div>
<div class="line"><span class="lineno"> 2837</span>        ret=EXIT_FAILURE;</div>
<div class="line"><span class="lineno"> 2838</span>        <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2839</span>    }</div>
<div class="line"><span class="lineno"> 2840</span>    <span class="keywordflow">if</span> (!(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ocibundle||<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace||<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.capabilities||<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.seccomp||</div>
<div class="line"><span class="lineno"> 2841</span>        (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.net != -1) ||</div>
<div class="line"><span class="lineno"> 2842</span>        (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.ns != -1) ||</div>
<div class="line"><span class="lineno"> 2843</span>        (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.ipc != -1) ||</div>
<div class="line"><span class="lineno"> 2844</span>        (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.uts != -1) ||</div>
<div class="line"><span class="lineno"> 2845</span>        (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.user != -1) ||</div>
<div class="line"><span class="lineno"> 2846</span>        (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.cgroup != -1))) {</div>
<div class="line"><span class="lineno"> 2847</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Not using namespaces, capabilities or seccomp !!!\n\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2848</span>        <a class="code hl_function" href="#ad96d407a911fbb914fa8e4cfbf2faf0f">usage</a>();</div>
<div class="line"><span class="lineno"> 2849</span>        ret=EXIT_FAILURE;</div>
<div class="line"><span class="lineno"> 2850</span>        <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2851</span>    }</div>
<div class="line"><span class="lineno"> 2852</span>    <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;Using namespaces(0x%08x), capabilities(%d), seccomp(%d)\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 2853</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace,</div>
<div class="line"><span class="lineno"> 2854</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.capset.apply,</div>
<div class="line"><span class="lineno"> 2855</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.seccomp != 0 || <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ociseccomp != 0);</div>
<div class="line"><span class="lineno"> 2856</span> </div>
<div class="line"><span class="lineno"> 2857</span>    <a class="code hl_function" href="../../d1/d08/uloop_8c.html#ae960d01033fb72572bc1aa539a501fe7">uloop_init</a>();</div>
<div class="line"><span class="lineno"> 2858</span>    <a class="code hl_function" href="#ab97dc72992426f87762ca05057c651b3">signals_init</a>();</div>
<div class="line"><span class="lineno"> 2859</span> </div>
<div class="line"><span class="lineno"> 2860</span>    <a class="code hl_variable" href="#a00f1e87fefda65b43a661aefc6f16566">parent_ctx</a> = <a class="code hl_function" href="../../d4/db9/libubus_8c.html#a332dc7ace8193793cad0d83b33acbc07">ubus_connect</a>(NULL);</div>
<div class="line"><span class="lineno"> 2861</span>    <a class="code hl_function" href="../../db/d55/libubus_8h.html#a8d1b8df0ddf9b9d48428688890a0ce31">ubus_add_uloop</a>(<a class="code hl_variable" href="#a00f1e87fefda65b43a661aefc6f16566">parent_ctx</a>);</div>
<div class="line"><span class="lineno"> 2862</span> </div>
<div class="line"><span class="lineno"> 2863</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ocibundle) {</div>
<div class="line"><span class="lineno"> 2864</span>        <span class="keywordtype">char</span> *objname;</div>
<div class="line"><span class="lineno"> 2865</span>        <span class="keywordflow">if</span> (asprintf(&amp;objname, <span class="stringliteral">&quot;container.%s&quot;</span>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.name) &lt; 0) {</div>
<div class="line"><span class="lineno"> 2866</span>            ret=-ENOMEM;</div>
<div class="line"><span class="lineno"> 2867</span>            <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2868</span>        }</div>
<div class="line"><span class="lineno"> 2869</span> </div>
<div class="line"><span class="lineno"> 2870</span>        <a class="code hl_variable" href="#a450e41d3094b10b8997ca48a290d437f">container_object</a>.<a class="code hl_variable" href="../../d9/d00/ubusd__obj_8h.html#afeb37cb7338d083718b26c427d7fc0f4">name</a> = objname;</div>
<div class="line"><span class="lineno"> 2871</span>        ret = <a class="code hl_function" href="../../db/dda/libubus-obj_8c.html#a91976fc505121a3ddd2c4456e730401c">ubus_add_object</a>(<a class="code hl_variable" href="#a00f1e87fefda65b43a661aefc6f16566">parent_ctx</a>, &amp;<a class="code hl_variable" href="#a450e41d3094b10b8997ca48a290d437f">container_object</a>);</div>
<div class="line"><span class="lineno"> 2872</span>        <span class="keywordflow">if</span> (ret) {</div>
<div class="line"><span class="lineno"> 2873</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;Failed to add object: %s\n&quot;</span>, <a class="code hl_function" href="../../d4/db9/libubus_8c.html#a70c6962fdc98eff62f5399893ae71b69">ubus_strerror</a>(ret));</div>
<div class="line"><span class="lineno"> 2874</span>            ret=-1;</div>
<div class="line"><span class="lineno"> 2875</span>            <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2876</span>        }</div>
<div class="line"><span class="lineno"> 2877</span>    }</div>
<div class="line"><span class="lineno"> 2878</span> </div>
<div class="line"><span class="lineno"> 2879</span>    <span class="comment">/* deliberately not using &#39;else&#39; on unrelated conditional branches */</span></div>
<div class="line"><span class="lineno"> 2880</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ocibundle) {</div>
<div class="line"><span class="lineno"> 2881</span>        <span class="comment">/* allocate NULL-terminated array for argv */</span></div>
<div class="line"><span class="lineno"> 2882</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.jail_argv = calloc(1 + argc - optind, <span class="keyword">sizeof</span>(<span class="keywordtype">void</span> *));</div>
<div class="line"><span class="lineno"> 2883</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.jail_argv) {</div>
<div class="line"><span class="lineno"> 2884</span>            ret=EXIT_FAILURE;</div>
<div class="line"><span class="lineno"> 2885</span>            <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2886</span>        }</div>
<div class="line"><span class="lineno"> 2887</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> s = optind; s &lt; argc; s++)</div>
<div class="line"><span class="lineno"> 2888</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.jail_argv[s - optind] = strdup(argv[s]);</div>
<div class="line"><span class="lineno"> 2889</span> </div>
<div class="line"><span class="lineno"> 2890</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp; CLONE_NEWUSER)</div>
<div class="line"><span class="lineno"> 2891</span>            <a class="code hl_function" href="#a6f77c1e493a8d84fc93bec1de3f871de">get_jail_user</a>(&amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.pw_uid, &amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.pw_gid, &amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.gr_gid);</div>
<div class="line"><span class="lineno"> 2892</span>    }</div>
<div class="line"><span class="lineno"> 2893</span> </div>
<div class="line"><span class="lineno"> 2894</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.extroot) {</div>
<div class="line"><span class="lineno"> 2895</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp;&amp; <a class="code hl_function" href="../../df/d26/fs_8h.html#a3c2c8ec14a25736480de113e1b71f52d">add_path_and_deps</a>(*<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.jail_argv, 1, -1, 0)) {</div>
<div class="line"><span class="lineno"> 2896</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to load dependencies\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2897</span>            ret=-1;</div>
<div class="line"><span class="lineno"> 2898</span>            <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2899</span>        }</div>
<div class="line"><span class="lineno"> 2900</span>    }</div>
<div class="line"><span class="lineno"> 2901</span> </div>
<div class="line"><span class="lineno"> 2902</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp;&amp; <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.seccomp &amp;&amp; <a class="code hl_function" href="../../df/d26/fs_8h.html#a3c2c8ec14a25736480de113e1b71f52d">add_path_and_deps</a>(<span class="stringliteral">&quot;libpreload-seccomp.so&quot;</span>, 1, -1, 1)) {</div>
<div class="line"><span class="lineno"> 2903</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to load libpreload-seccomp.so\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2904</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.seccomp = 0;</div>
<div class="line"><span class="lineno"> 2905</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.require_jail) {</div>
<div class="line"><span class="lineno"> 2906</span>            ret=-1;</div>
<div class="line"><span class="lineno"> 2907</span>            <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2908</span>        }</div>
<div class="line"><span class="lineno"> 2909</span>    }</div>
<div class="line"><span class="lineno"> 2910</span> </div>
<div class="line"><span class="lineno"> 2911</span>    <a class="code hl_function" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07">uloop_timeout_add</a>(&amp;<a class="code hl_variable" href="#a6910512e7075298176a67f026d6c25e8">post_main_timeout</a>);</div>
<div class="line"><span class="lineno"> 2912</span>    <a class="code hl_function" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077">uloop_run</a>();</div>
<div class="line"><span class="lineno"> 2913</span> </div>
<div class="line"><span class="lineno"> 2914</span>errout:</div>
<div class="line"><span class="lineno"> 2915</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ocibundle)</div>
<div class="line"><span class="lineno"> 2916</span>        <a class="code hl_function" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b">cgroups_free</a>();</div>
<div class="line"><span class="lineno"> 2917</span> </div>
<div class="line"><span class="lineno"> 2918</span>    <a class="code hl_function" href="#a61855620d1a0683f786486b1722d7dfa">free_opts</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2919</span> </div>
<div class="line"><span class="lineno"> 2920</span>    <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno"> 2921</span>}</div>
<div class="ttc" id="acapabilities_8c_html_a84025d2cb161afc53b5483d71b1ebab4"><div class="ttname"><a href="../../d2/d61/capabilities_8c.html#a84025d2cb161afc53b5483d71b1ebab4">parseOCIcapabilities_from_file</a></div><div class="ttdeci">int parseOCIcapabilities_from_file(struct jail_capset *capset, const char *file)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d61/capabilities_8c_source.html#l00218">capabilities.c:218</a></div></div>
<div class="ttc" id="acgroups_8c_html_a4db8a13419b30acde99e30e362cea84c"><div class="ttname"><a href="../../db/d40/cgroups_8c.html#a4db8a13419b30acde99e30e362cea84c">cgroups_prepare</a></div><div class="ttdeci">void cgroups_prepare(void)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d40/cgroups_8c_source.html#l00058">cgroups.c:58</a></div></div>
<div class="ttc" id="aelf_8c_html_ab5c6746a1010af2033a89a248fc0c2d3"><div class="ttname"><a href="../../d2/da6/elf_8c.html#ab5c6746a1010af2033a89a248fc0c2d3">init_library_search</a></div><div class="ttdeci">void init_library_search(void)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/da6/elf_8c_source.html#l00310">elf.c:310</a></div></div>
<div class="ttc" id="afs_8c_html_a0629849a79384a49397f97b899640cce"><div class="ttname"><a href="../../d2/d5a/fs_8c.html#a0629849a79384a49397f97b899640cce">mount_list_init</a></div><div class="ttdeci">void mount_list_init(void)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00459">fs.c:459</a></div></div>
<div class="ttc" id="afs_8c_html_a31752c6608fbf56bb359ba109bdc6f6f"><div class="ttname"><a href="../../d2/d5a/fs_8c.html#a31752c6608fbf56bb359ba109bdc6f6f">add_mount_bind</a></div><div class="ttdeci">int add_mount_bind(const char *path, int readonly, int error)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00219">fs.c:219</a></div></div>
<div class="ttc" id="afs_8c_html_ac4992c3c85512f44840f4eda86df97b5"><div class="ttname"><a href="../../d2/d5a/fs_8c.html#ac4992c3c85512f44840f4eda86df97b5">add_2paths_and_deps</a></div><div class="ttdeci">int add_2paths_and_deps(const char *path, const char *path2, int readonly, int error, int lib)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00486">fs.c:486</a></div></div>
<div class="ttc" id="afs_8h_html_a3c2c8ec14a25736480de113e1b71f52d"><div class="ttname"><a href="../../df/d26/fs_8h.html#a3c2c8ec14a25736480de113e1b71f52d">add_path_and_deps</a></div><div class="ttdeci">static int add_path_and_deps(const char *path, int readonly, int error, int lib)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d26/fs_8h_source.html#l00027">fs.h:27</a></div></div>
<div class="ttc" id="ajail_8c_html_a080368a08334825ac605d93aa717b4dc"><div class="ttname"><a href="#a080368a08334825ac605d93aa717b4dc">env_e::envarg</a></div><div class="ttdeci">char * envarg</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02580">jail.c:2580</a></div></div>
<div class="ttc" id="ajail_8c_html_a31575d38ed43b739ca94e78c23e5b1e0"><div class="ttname"><a href="#a31575d38ed43b739ca94e78c23e5b1e0">checkpath</a></div><div class="ttdeci">static int checkpath(const char *path)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02540">jail.c:2540</a></div></div>
<div class="ttc" id="ajail_8c_html_a450e41d3094b10b8997ca48a290d437f"><div class="ttname"><a href="#a450e41d3094b10b8997ca48a290d437f">container_object</a></div><div class="ttdeci">static struct ubus_object container_object</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02561">jail.c:2561</a></div></div>
<div class="ttc" id="ajail_8c_html_a4bdac4524a242f6347c1bfe0cd88e3b4"><div class="ttname"><a href="#a4bdac4524a242f6347c1bfe0cd88e3b4">env_e::list</a></div><div class="ttdeci">struct list_head list</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02579">jail.c:2579</a></div></div>
<div class="ttc" id="ajail_8c_html_a4d6b15fa5d3ae9b608587bd11cbda9cf"><div class="ttname"><a href="#a4d6b15fa5d3ae9b608587bd11cbda9cf">parseOCI</a></div><div class="ttdeci">static int parseOCI(const char *jsonfile)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02323">jail.c:2323</a></div></div>
<div class="ttc" id="ajail_8c_html_a5f7f8ba02a5383b3b7f9dd28f8c5e8b8"><div class="ttname"><a href="#a5f7f8ba02a5383b3b7f9dd28f8c5e8b8">OPT_ARGS</a></div><div class="ttdeci">#define OPT_ARGS</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00072">jail.c:72</a></div></div>
<div class="ttc" id="ajail_8c_html_a6910512e7075298176a67f026d6c25e8"><div class="ttname"><a href="#a6910512e7075298176a67f026d6c25e8">post_main_timeout</a></div><div class="ttdeci">static struct uloop_timeout post_main_timeout</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02568">jail.c:2568</a></div></div>
<div class="ttc" id="ajail_8c_html_a6f77c1e493a8d84fc93bec1de3f871de"><div class="ttname"><a href="#a6f77c1e493a8d84fc93bec1de3f871de">get_jail_user</a></div><div class="ttdeci">static void get_jail_user(int *user, int *user_gid, int *gr_gid)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00893">jail.c:893</a></div></div>
<div class="ttc" id="ajail_8c_html_a871481dd00dcac30989df45c68b2e27a"><div class="ttname"><a href="#a871481dd00dcac30989df45c68b2e27a">jail_join_ns</a></div><div class="ttdeci">static int jail_join_ns(char *arg)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01888">jail.c:1888</a></div></div>
<div class="ttc" id="ajail_8c_html_ad96d407a911fbb914fa8e4cfbf2faf0f"><div class="ttname"><a href="#ad96d407a911fbb914fa8e4cfbf2faf0f">usage</a></div><div class="ttdeci">static void usage(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01001">jail.c:1001</a></div></div>
<div class="ttc" id="ajail_8c_html_d3/d32/structenv__e"><div class="ttname"><a href="#d3/d32/structenv__e">env_e</a></div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02578">jail.c:2578</a></div></div>
<div class="ttc" id="alibubus-obj_8c_html_a91976fc505121a3ddd2c4456e730401c"><div class="ttname"><a href="../../db/dda/libubus-obj_8c.html#a91976fc505121a3ddd2c4456e730401c">ubus_add_object</a></div><div class="ttdeci">int ubus_add_object(struct ubus_context *ctx, struct ubus_object *obj)</div><div class="ttdef"><b>Definition</b> <a href="../../db/dda/libubus-obj_8c_source.html#l00209">libubus-obj.c:209</a></div></div>
<div class="ttc" id="alibubus_8c_html_a332dc7ace8193793cad0d83b33acbc07"><div class="ttname"><a href="../../d4/db9/libubus_8c.html#a332dc7ace8193793cad0d83b33acbc07">ubus_connect</a></div><div class="ttdeci">struct ubus_context * ubus_connect(const char *path)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/db9/libubus_8c_source.html#l00351">libubus.c:351</a></div></div>
<div class="ttc" id="alibubus_8c_html_a70c6962fdc98eff62f5399893ae71b69"><div class="ttname"><a href="../../d4/db9/libubus_8c.html#a70c6962fdc98eff62f5399893ae71b69">ubus_strerror</a></div><div class="ttdeci">const char * ubus_strerror(int error)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/db9/libubus_8c_source.html#l00059">libubus.c:59</a></div></div>
<div class="ttc" id="alibubus_8h_html_a8d1b8df0ddf9b9d48428688890a0ce31"><div class="ttname"><a href="../../db/d55/libubus_8h.html#a8d1b8df0ddf9b9d48428688890a0ce31">ubus_add_uloop</a></div><div class="ttdeci">static void ubus_add_uloop(struct ubus_context *ctx)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d55/libubus_8h_source.html#l00268">libubus.h:268</a></div></div>
<div class="ttc" id="alist_8h_html_a4642d4b7df28478bb762fe43c85b5c63"><div class="ttname"><a href="../../da/d23/list_8h.html#a4642d4b7df28478bb762fe43c85b5c63">LIST_HEAD_INIT</a></div><div class="ttdeci">#define LIST_HEAD_INIT(name)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d23/list_8h_source.html#l00058">list.h:58</a></div></div>
<div class="ttc" id="alist_8h_html_a5f3c4582c49b990c9fb4f5c83f8400d1"><div class="ttname"><a href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1">list_add_tail</a></div><div class="ttdeci">static void list_add_tail(struct list_head *_new, struct list_head *head)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d23/list_8h_source.html#l00165">list.h:165</a></div></div>
<div class="ttc" id="alist_8h_html_a698670b36c7c0ca13822698ee825ddc8"><div class="ttname"><a href="../../da/d23/list_8h.html#a698670b36c7c0ca13822698ee825ddc8">list_for_each_entry_safe</a></div><div class="ttdeci">#define list_for_each_entry_safe(p, n, h, field)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d23/list_8h_source.html#l00146">list.h:146</a></div></div>
<div class="ttc" id="alist_8h_html_a6b4019bb70de70adc3caddbe3a024c27"><div class="ttname"><a href="../../da/d23/list_8h.html#a6b4019bb70de70adc3caddbe3a024c27">list_for_each_entry</a></div><div class="ttdeci">#define list_for_each_entry(p, h, field)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d23/list_8h_source.html#l00132">list.h:132</a></div></div>
<div class="ttc" id="alist_8h_html_a6ff0e5eee443d7b27def83827340634d"><div class="ttname"><a href="../../da/d23/list_8h.html#a6ff0e5eee443d7b27def83827340634d">list_empty</a></div><div class="ttdeci">static bool list_empty(const struct list_head *head)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d23/list_8h_source.html#l00069">list.h:69</a></div></div>
<div class="ttc" id="alist_8h_html_ab1708206f0f7e0a56550b35372203ba5"><div class="ttname"><a href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5">list_del</a></div><div class="ttdeci">static void list_del(struct list_head *entry)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d23/list_8h_source.html#l00096">list.h:96</a></div></div>
<div class="ttc" id="alist_8h_html_d9/d93/structlist__head"><div class="ttname"><a href="../../da/d23/list_8h.html#d9/d93/structlist__head">list_head</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/d23/list_8h_source.html#l00053">list.h:53</a></div></div>
<div class="ttc" id="aubus_2lua_2ubus_8c_html_a3d36b63e5e323c6a729ddcf4932944cc"><div class="ttname"><a href="../../d1/d96/ubus_2lua_2ubus_8c.html#a3d36b63e5e323c6a729ddcf4932944cc">ubus</a></div><div class="ttdeci">static const luaL_Reg ubus[]</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d96/ubus_2lua_2ubus_8c_source.html#l00948">ubus.c:948</a></div></div>
<div class="ttc" id="aubusd__obj_8h_html_afeb37cb7338d083718b26c427d7fc0f4"><div class="ttname"><a href="../../d9/d00/ubusd__obj_8h.html#afeb37cb7338d083718b26c427d7fc0f4">ubus_object::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition</b> <a href="../../db/d55/libubus_8h_source.html#l00129">libubus.h:129</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d5a/fs_8c_source.html#l00486">add_2paths_and_deps()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00219">add_mount_bind()</a>, <a class="el" href="../../df/d26/fs_8h_source.html#l00027">add_path_and_deps()</a>, <a class="el" href="../../db/d40/cgroups_8c_source.html#l00088">cgroups_free()</a>, <a class="el" href="../../db/d40/cgroups_8c_source.html#l00058">cgroups_prepare()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02540">checkpath()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00068">CLONE_NEWCGROUP</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02561">container_object</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00163">debug</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02580">env_e::envarg</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00773">exit_from_child</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00254">free_opts()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00893">get_jail_user()</a>, <a class="el" href="../../d2/da6/elf_8c_source.html#l00310">init_library_search()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01888">jail_join_ns()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02579">env_e::list</a>, <a class="el" href="../../da/d23/list_8h_source.html#l00165">list_add_tail()</a>, <a class="el" href="../../da/d23/list_8h_source.html#l00096">list_del()</a>, <a class="el" href="../../da/d23/list_8h_source.html#l00069">list_empty()</a>, <a class="el" href="../../da/d23/list_8h_source.html#l00132">list_for_each_entry</a>, <a class="el" href="../../da/d23/list_8h_source.html#l00146">list_for_each_entry_safe</a>, <a class="el" href="../../da/d23/list_8h_source.html#l00058">LIST_HEAD_INIT</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00459">mount_list_init()</a>, <a class="el" href="../../db/d55/libubus_8h_source.html#l00129">ubus_object::name</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00072">OPT_ARGS</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00167">parent_ctx</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02323">parseOCI()</a>, <a class="el" href="../../d2/d61/capabilities_8c_source.html#l00218">parseOCIcapabilities_from_file()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02568">post_main_timeout</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01136">signals_init()</a>, <a class="el" href="../../d1/d96/ubus_2lua_2ubus_8c_source.html#l00948">ubus</a>, <a class="el" href="../../db/dda/libubus-obj_8c_source.html#l00209">ubus_add_object()</a>, <a class="el" href="../../db/d55/libubus_8h_source.html#l00268">ubus_add_uloop()</a>, <a class="el" href="../../d4/db9/libubus_8c_source.html#l00351">ubus_connect()</a>, <a class="el" href="../../d4/db9/libubus_8c_source.html#l00059">ubus_strerror()</a>, <a class="el" href="../../d1/d08/uloop_8c_source.html#l00150">uloop_init()</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00147">uloop_run()</a>, <a class="el" href="../../d1/d08/uloop_8c_source.html#l00298">uloop_timeout_add()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l01001">usage()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a3c04138a5bfe5d72780bb7e82a18e627_cgraph.png" border="0" usemap="#add/d26/jail_8c_a3c04138a5bfe5d72780bb7e82a18e627_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a3c04138a5bfe5d72780bb7e82a18e627_cgraph" id="add/d26/jail_8c_a3c04138a5bfe5d72780bb7e82a18e627_cgraph">
<area shape="rect" title=" " alt="" coords="5,956,73,990"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#ac4992c3c85512f44840f4eda86df97b5" title=" " alt="" coords="121,205,348,239"/>
<area shape="poly" title=" " alt="" coords="37,956,39,867,48,727,58,646,72,561,92,476,118,395,137,353,160,313,206,250,211,253,165,316,142,355,123,396,97,478,78,562,63,647,53,728,44,868,43,956"/>
<area shape="rect" href="../../df/d26/fs_8h.html#a3c2c8ec14a25736480de113e1b71f52d" title=" " alt="" coords="640,291,846,324"/>
<area shape="poly" title=" " alt="" coords="38,955,40,852,51,699,61,620,75,547,94,488,106,465,119,447,146,421,174,401,200,386,227,375,280,365,335,365,453,372,519,370,592,357,682,328,684,333,593,362,519,376,452,378,335,370,281,370,229,380,203,391,176,405,150,425,123,451,110,467,99,490,80,549,66,621,56,700,46,852,43,956"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a31752c6608fbf56bb359ba109bdc6f6f" title=" " alt="" coords="147,76,322,110"/>
<area shape="poly" title=" " alt="" coords="38,956,41,814,51,589,61,469,75,357,94,261,105,222,118,192,133,169,151,149,189,117,193,121,154,153,137,172,123,194,110,224,99,262,81,357,67,470,57,589,46,814,43,956"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b" title=" " alt="" coords="424,477,564,511"/>
<area shape="poly" title=" " alt="" coords="38,955,40,858,51,716,61,643,75,577,94,524,106,503,119,488,155,465,194,450,236,443,279,441,363,451,434,470,433,475,362,456,279,446,237,448,196,455,157,469,122,492,110,506,99,526,80,579,66,644,56,717,46,858,43,956"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#a4db8a13419b30acde99e30e362cea84c" title=" " alt="" coords="147,503,322,536"/>
<area shape="poly" title=" " alt="" coords="39,955,45,870,58,747,69,684,82,626,99,578,119,546,131,535,135,539,123,549,103,581,87,627,74,685,64,748,50,870,44,956"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a31575d38ed43b739ca94e78c23e5b1e0" title=" " alt="" coords="176,560,293,594"/>
<area shape="poly" title=" " alt="" coords="39,955,47,880,62,774,85,671,101,631,119,603,138,589,160,580,162,585,140,594,123,607,106,633,91,673,67,775,52,881,44,956"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a61855620d1a0683f786486b1722d7dfa" title=" " alt="" coords="181,617,288,651"/>
<area shape="poly" title=" " alt="" coords="40,955,49,890,66,802,89,717,103,683,119,660,141,645,165,636,167,641,143,650,123,664,108,686,94,718,71,803,55,891,45,956"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a6f77c1e493a8d84fc93bec1de3f871de" title=" " alt="" coords="166,675,303,708"/>
<area shape="poly" title=" " alt="" coords="38,956,41,908,52,844,62,810,77,776,95,745,119,717,150,699,153,704,122,722,99,748,81,779,67,812,57,846,46,909,43,956"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#ab5c6746a1010af2033a89a248fc0c2d3" title=" " alt="" coords="140,732,329,766"/>
<area shape="poly" title=" " alt="" coords="40,955,46,918,60,869,83,818,99,795,119,775,125,770,128,774,122,779,104,798,88,821,65,871,51,919,45,956"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a871481dd00dcac30989df45c68b2e27a" title=" " alt="" coords="174,789,295,823"/>
<area shape="poly" title=" " alt="" coords="44,955,71,899,92,867,119,840,158,819,161,824,122,844,96,871,75,901,49,957"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="430,1227,559,1260"/>
<area shape="poly" title=" " alt="" coords="48,954,76,916,96,898,119,884,183,859,237,847,264,848,291,854,319,866,350,884,388,917,419,957,443,1002,462,1049,485,1140,494,1211,488,1212,479,1141,457,1050,438,1004,414,960,384,921,346,888,317,871,289,859,263,853,238,852,184,864,122,889,99,902,80,920,52,957"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="192,899,277,932"/>
<area shape="poly" title=" " alt="" coords="72,957,120,941,176,926,177,931,121,946,74,962"/>
<area shape="rect" href="../../da/d23/list_8h.html#a6ff0e5eee443d7b27def83827340634d" title=" " alt="" coords="176,956,293,990"/>
<area shape="poly" title=" " alt="" coords="73,970,160,970,160,976,73,976"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a0629849a79384a49397f97b899640cce" title=" " alt="" coords="157,1013,312,1047"/>
<area shape="poly" title=" " alt="" coords="74,983,121,1000,145,1006,143,1011,120,1005,72,988"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a4d6b15fa5d3ae9b608587bd11cbda9cf" title=" " alt="" coords="181,1071,288,1104"/>
<area shape="poly" title=" " alt="" coords="54,989,82,1024,101,1042,122,1057,167,1075,165,1080,119,1062,98,1046,78,1028,50,992"/>
<area shape="rect" href="../../d2/d61/capabilities_8c.html#a84025d2cb161afc53b5483d71b1ebab4" title=" " alt="" coords="129,1129,340,1185"/>
<area shape="poly" title=" " alt="" coords="48,989,74,1050,95,1085,122,1115,126,1117,122,1122,119,1119,91,1088,69,1053,43,991"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#ab97dc72992426f87762ca05057c651b3" title=" " alt="" coords="172,1209,297,1243"/>
<area shape="poly" title=" " alt="" coords="44,989,49,1031,61,1087,85,1145,102,1172,122,1195,139,1207,158,1215,156,1220,136,1211,119,1199,97,1175,80,1148,56,1088,44,1032,39,990"/>
<area shape="rect" href="../../db/dda/libubus-obj_8c.html#a91976fc505121a3ddd2c4456e730401c" title=" " alt="" coords="146,1267,323,1300"/>
<area shape="poly" title=" " alt="" coords="42,990,44,1042,54,1113,64,1151,78,1188,97,1223,123,1254,134,1263,131,1267,119,1257,93,1226,73,1191,59,1153,48,1114,39,1042,37,990"/>
<area shape="rect" href="../../db/d55/libubus_8h.html#a8d1b8df0ddf9b9d48428688890a0ce31" title=" " alt="" coords="149,1324,320,1358"/>
<area shape="poly" title=" " alt="" coords="45,990,53,1060,69,1157,92,1250,107,1287,123,1311,137,1322,133,1326,119,1315,102,1289,87,1252,64,1158,48,1060,39,990"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a332dc7ace8193793cad0d83b33acbc07" title=" " alt="" coords="160,1381,309,1415"/>
<area shape="poly" title=" " alt="" coords="44,990,51,1070,65,1184,89,1296,104,1339,123,1368,147,1385,144,1389,119,1372,100,1342,84,1297,60,1185,46,1071,39,990"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a70c6962fdc98eff62f5399893ae71b69" title=" " alt="" coords="162,1439,307,1472"/>
<area shape="poly" title=" " alt="" coords="44,990,49,1081,62,1212,72,1280,85,1342,102,1392,123,1426,149,1443,146,1448,119,1429,97,1394,80,1343,67,1281,56,1213,43,1081,38,990"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae960d01033fb72572bc1aa539a501fe7" title=" " alt="" coords="179,1496,290,1530"/>
<area shape="poly" title=" " alt="" coords="43,990,47,1091,58,1240,68,1316,82,1387,100,1444,111,1467,123,1483,142,1497,165,1506,163,1511,139,1502,119,1487,106,1469,95,1446,77,1388,63,1317,53,1240,41,1091,38,990"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077" title=" " alt="" coords="178,1553,291,1587"/>
<area shape="poly" title=" " alt="" coords="43,990,45,1100,55,1266,65,1353,79,1432,98,1497,110,1522,123,1540,141,1555,164,1563,162,1568,139,1559,119,1544,105,1524,93,1499,74,1433,59,1353,49,1267,40,1101,38,990"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07" title=" " alt="" coords="136,1611,333,1644"/>
<area shape="poly" title=" " alt="" coords="43,990,43,1111,51,1294,61,1390,75,1477,96,1549,108,1577,123,1598,126,1601,122,1605,119,1601,104,1580,91,1551,70,1478,56,1390,46,1294,38,1111,37,990"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#ad96d407a911fbb914fa8e4cfbf2faf0f" title=" " alt="" coords="196,1668,273,1702"/>
<area shape="poly" title=" " alt="" coords="44,990,52,1130,68,1342,92,1545,107,1617,115,1641,123,1655,135,1666,149,1673,181,1682,179,1687,147,1678,132,1670,119,1659,110,1643,102,1618,87,1546,63,1343,47,1130,39,990"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4824ede62a9ceedb153f039c5dc212f9" title=" " alt="" coords="402,5,586,39"/>
<area shape="poly" title=" " alt="" coords="257,203,300,167,346,120,359,101,367,83,377,65,394,48,400,44,403,49,398,52,381,69,372,85,364,103,350,124,303,170,260,207"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a2b2c9415458859df2a4ed2558f53db56" title=" " alt="" coords="404,63,585,96"/>
<area shape="poly" title=" " alt="" coords="253,203,314,155,353,128,395,105,407,100,409,105,397,110,356,133,317,159,257,207"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a5601edf43bf58289cb22c5b20d17a1e9" title=" " alt="" coords="428,120,560,154"/>
<area shape="poly" title=" " alt="" coords="281,202,395,162,416,156,417,161,397,167,283,207"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#a0e08d7ee7d67ff58eeea30dd8a9356d1" title=" " alt="" coords="448,177,541,211"/>
<area shape="poly" title=" " alt="" coords="348,207,432,198,433,203,349,213"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a48837326349fc40e7a38f613d853f8f2" title=" " alt="" coords="421,235,567,268"/>
<area shape="poly" title=" " alt="" coords="349,232,406,239,405,244,348,238"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#a9ae7cc745a41248c9f0d9bbb83a86a43" title=" " alt="" coords="445,292,543,326"/>
<area shape="poly" title=" " alt="" coords="282,237,397,278,431,289,429,294,395,283,280,242"/>
<area shape="poly" title=" " alt="" coords="574,95,594,105,639,145,677,191,708,236,729,275,725,278,703,239,673,194,635,148,591,110,572,99"/>
<area shape="poly" title=" " alt="" coords="689,327,628,342,554,354,474,355,434,350,395,341,356,323,319,300,261,252,264,248,322,296,358,319,397,336,435,345,474,350,554,348,627,337,688,322"/>
<area shape="poly" title=" " alt="" coords="568,265,651,284,649,289,567,270"/>
<area shape="poly" title=" " alt="" coords="299,73,414,41,416,46,300,78"/>
<area shape="poly" title=" " alt="" coords="287,627,318,618,346,604,362,588,370,571,378,552,394,533,422,516,425,520,398,538,383,555,375,573,367,591,350,608,320,623,288,632"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a7cdfa1304cca32224a444b6e84fac194" title=" " alt="" coords="426,548,562,582"/>
<area shape="poly" title=" " alt="" coords="287,619,347,604,417,584,419,589,349,609,288,624"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5127f557f43086299c2bf291618dcef5" title=" " alt="" coords="425,605,563,639"/>
<area shape="poly" title=" " alt="" coords="288,629,410,623,410,629,288,634"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a766dbc37dd9f160e1a3b8a9f19651b38" title=" " alt="" coords="669,632,817,666"/>
<area shape="poly" title=" " alt="" coords="288,639,396,649,494,651,592,649,654,648,654,653,592,654,494,656,396,654,288,644"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#abb68ed1aa9f416ea5f299d7672a3b5c1" title=" " alt="" coords="396,715,592,748"/>
<area shape="poly" title=" " alt="" coords="289,641,349,660,374,676,397,693,426,706,423,711,395,698,371,681,347,665,287,646"/>
<area shape="poly" title=" " alt="" coords="564,627,654,637,653,642,563,632"/>
<area shape="poly" title=" " alt="" coords="331,1608,346,1597,380,1562,409,1521,432,1476,450,1430,475,1343,487,1275,492,1276,480,1344,455,1432,437,1478,413,1523,385,1565,350,1602,334,1612"/>
</map>
</div>

</div>
</div>
<a id="af49948409c11b79dd0b28ce038cdd592" name="af49948409c11b79dd0b28ce038cdd592"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af49948409c11b79dd0b28ce038cdd592">&#9670;&#160;</a></span>mount_overlay()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int mount_overlay </td>
          <td>(</td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>jail_root</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>overlaydir</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00288">288</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  288</span>                                                            {</div>
<div class="line"><span class="lineno">  289</span>    <span class="keywordtype">char</span> *upperdir, *workdir, *optsstr, *upperetc, *upperresolvconf;</div>
<div class="line"><span class="lineno">  290</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> mountoptsformat[] = <span class="stringliteral">&quot;lowerdir=%s,upperdir=%s,workdir=%s&quot;</span>;</div>
<div class="line"><span class="lineno">  291</span>    <span class="keywordtype">int</span> ret = -1, fd;</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>    <span class="keywordflow">if</span> (asprintf(&amp;upperdir, <span class="stringliteral">&quot;%s%s&quot;</span>, overlaydir, <span class="stringliteral">&quot;/upper&quot;</span>) &lt; 0)</div>
<div class="line"><span class="lineno">  294</span>        <span class="keywordflow">goto</span> out;</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>    <span class="keywordflow">if</span> (asprintf(&amp;workdir, <span class="stringliteral">&quot;%s%s&quot;</span>, overlaydir, <span class="stringliteral">&quot;/work&quot;</span>) &lt; 0)</div>
<div class="line"><span class="lineno">  297</span>        <span class="keywordflow">goto</span> upper_printf;</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>    <span class="keywordflow">if</span> (asprintf(&amp;optsstr, mountoptsformat, <a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>, upperdir, workdir) &lt; 0)</div>
<div class="line"><span class="lineno">  300</span>        <span class="keywordflow">goto</span> work_printf;</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d0/d2b/libubox_2utils_8c.html#a9fb089901b41392a5ac197f3e18cc3f7">mkdir_p</a>(upperdir, 0755) || <a class="code hl_function" href="../../d0/d2b/libubox_2utils_8c.html#a9fb089901b41392a5ac197f3e18cc3f7">mkdir_p</a>(workdir, 0755))</div>
<div class="line"><span class="lineno">  303</span>        <span class="keywordflow">goto</span> opts_printf;</div>
<div class="line"><span class="lineno">  304</span> </div>
<div class="line"><span class="lineno">  305</span><span class="comment">/*</span></div>
<div class="line"><span class="lineno">  306</span><span class="comment"> * make sure /etc/resolv.conf exists in overlay and is owned by jail userns root</span></div>
<div class="line"><span class="lineno">  307</span><span class="comment"> * this is to work-around a bug in overlayfs described in the overlayfs-userns</span></div>
<div class="line"><span class="lineno">  308</span><span class="comment"> * patch:</span></div>
<div class="line"><span class="lineno">  309</span><span class="comment"> * 3. modification of a file &#39;hithere&#39; which is in l but not yet</span></div>
<div class="line"><span class="lineno">  310</span><span class="comment"> * in u, and which is not owned by T, is not allowed, even if</span></div>
<div class="line"><span class="lineno">  311</span><span class="comment"> * writes to u are allowed.  This may be a bug in overlayfs,</span></div>
<div class="line"><span class="lineno">  312</span><span class="comment"> * but it is safe behavior.</span></div>
<div class="line"><span class="lineno">  313</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno">  314</span>    <span class="keywordflow">if</span> (asprintf(&amp;upperetc, <span class="stringliteral">&quot;%s/etc&quot;</span>, upperdir) &lt; 0)</div>
<div class="line"><span class="lineno">  315</span>        <span class="keywordflow">goto</span> opts_printf;</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d0/d2b/libubox_2utils_8c.html#a9fb089901b41392a5ac197f3e18cc3f7">mkdir_p</a>(upperetc, 0755))</div>
<div class="line"><span class="lineno">  318</span>        <span class="keywordflow">goto</span> upper_etc_printf;</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>    <span class="keywordflow">if</span> (asprintf(&amp;upperresolvconf, <span class="stringliteral">&quot;%s/resolv.conf&quot;</span>, upperetc) &lt; 0)</div>
<div class="line"><span class="lineno">  321</span>        <span class="keywordflow">goto</span> upper_etc_printf;</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>    fd = creat(upperresolvconf, 0644);</div>
<div class="line"><span class="lineno">  324</span>    <span class="keywordflow">if</span> (fd &lt; 0) {</div>
<div class="line"><span class="lineno">  325</span>        <span class="keywordflow">if</span> (errno != EEXIST)</div>
<div class="line"><span class="lineno">  326</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;creat(%s) failed: %m\n&quot;</span>, upperresolvconf);</div>
<div class="line"><span class="lineno">  327</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  328</span>        close(fd);</div>
<div class="line"><span class="lineno">  329</span>    }</div>
<div class="line"><span class="lineno">  330</span>    <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;mount -t overlay %s %s (%s)\n&quot;</span>, <a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>, <a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>, optsstr);</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="../../d2/d5a/fs_8c.html#d3/df8/structmount">mount</a>(<a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>, <a class="code hl_variable" href="#a45c79303cad1e1847d711c3946e93e85">jail_root</a>, <span class="stringliteral">&quot;overlay&quot;</span>, MS_NOATIME, optsstr))</div>
<div class="line"><span class="lineno">  333</span>        <span class="keywordflow">goto</span> upper_resolvconf_printf;</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>    ret = 0;</div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>upper_resolvconf_printf:</div>
<div class="line"><span class="lineno">  338</span>    free(upperresolvconf);</div>
<div class="line"><span class="lineno">  339</span>upper_etc_printf:</div>
<div class="line"><span class="lineno">  340</span>    free(upperetc);</div>
<div class="line"><span class="lineno">  341</span>opts_printf:</div>
<div class="line"><span class="lineno">  342</span>    free(optsstr);</div>
<div class="line"><span class="lineno">  343</span>work_printf:</div>
<div class="line"><span class="lineno">  344</span>    free(workdir);</div>
<div class="line"><span class="lineno">  345</span>upper_printf:</div>
<div class="line"><span class="lineno">  346</span>    free(upperdir);</div>
<div class="line"><span class="lineno">  347</span>out:</div>
<div class="line"><span class="lineno">  348</span>    <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno">  349</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00675">jail_root</a>, and <a class="el" href="../../d0/d2b/libubox_2utils_8c_source.html#l00161">mkdir_p()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00679">build_jail_fs()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_af49948409c11b79dd0b28ce038cdd592_cgraph.png" border="0" usemap="#add/d26/jail_8c_af49948409c11b79dd0b28ce038cdd592_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_af49948409c11b79dd0b28ce038cdd592_cgraph" id="add/d26/jail_8c_af49948409c11b79dd0b28ce038cdd592_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,164,63"/>
<area shape="rect" href="../../d0/d2b/libubox_2utils_8c.html#a9fb089901b41392a5ac197f3e18cc3f7" title=" " alt="" coords="212,29,308,63"/>
<area shape="poly" title=" " alt="" coords="164,44,196,44,196,49,164,49"/>
<area shape="poly" title=" " alt="" coords="228,30,224,20,229,11,241,5,260,3,280,5,291,12,289,16,278,10,260,8,243,10,233,15,230,20,233,28"/>
</map>
</div>

</div>
</div>
<a id="ae3f4a6a40d174160d8d1fcd78515e4ea" name="ae3f4a6a40d174160d8d1fcd78515e4ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3f4a6a40d174160d8d1fcd78515e4ea">&#9670;&#160;</a></span>ns_open_pid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ns_open_pid </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>nstype</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pid_t</td>          <td class="paramname"><span class="paramname"><em>target_ns</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01329">1329</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1330</span>{</div>
<div class="line"><span class="lineno"> 1331</span>    <span class="keywordtype">char</span> pid_pid_path[PATH_MAX];</div>
<div class="line"><span class="lineno"> 1332</span> </div>
<div class="line"><span class="lineno"> 1333</span>    snprintf(pid_pid_path, <span class="keyword">sizeof</span>(pid_pid_path), <span class="stringliteral">&quot;/proc/%u/ns/%s&quot;</span>, target_ns, nstype);</div>
<div class="line"><span class="lineno"> 1334</span> </div>
<div class="line"><span class="lineno"> 1335</span>    <span class="keywordflow">return</span> open(pid_pid_path, O_RDONLY);</div>
<div class="line"><span class="lineno"> 1336</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../db/d3d/netifd_8c_source.html#l00434">jail_network_start()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>.</p>

</div>
</div>
<a id="a4d6b15fa5d3ae9b608587bd11cbda9cf" name="a4d6b15fa5d3ae9b608587bd11cbda9cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d6b15fa5d3ae9b608587bd11cbda9cf">&#9670;&#160;</a></span>parseOCI()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parseOCI </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>jsonfile</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02323">2323</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2324</span>{</div>
<div class="line"><span class="lineno"> 2325</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *tb[<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a158774e5aaadcff6bcf7daf6db2ea105">__OCI_MAX</a>];</div>
<div class="line"><span class="lineno"> 2326</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *cur;</div>
<div class="line"><span class="lineno"> 2327</span>    <span class="keywordtype">int</span> rem;</div>
<div class="line"><span class="lineno"> 2328</span>    <span class="keywordtype">int</span> res;</div>
<div class="line"><span class="lineno"> 2329</span> </div>
<div class="line"><span class="lineno"> 2330</span>    <a class="code hl_function" href="../../d4/da0/blob_8c.html#af8ca2237342df92c699fbb2ddb5f390b">blob_buf_init</a>(&amp;<a class="code hl_variable" href="#aa04cdf4d9bc5ac87bf39574fc9845918">ocibuf</a>, 0);</div>
<div class="line"><span class="lineno"> 2331</span> </div>
<div class="line"><span class="lineno"> 2332</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../d5/d7f/blobmsg__json_8c.html#a7f16b1915ac39b6888614f5fcc0661f8">blobmsg_add_json_from_file</a>(&amp;<a class="code hl_variable" href="#aa04cdf4d9bc5ac87bf39574fc9845918">ocibuf</a>, jsonfile)) {</div>
<div class="line"><span class="lineno"> 2333</span>        res=ENOENT;</div>
<div class="line"><span class="lineno"> 2334</span>        <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2335</span>    }</div>
<div class="line"><span class="lineno"> 2336</span> </div>
<div class="line"><span class="lineno"> 2337</span>    <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#ad03397b5f24381749f1fbc6509cf6425">oci_policy</a>, <a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a158774e5aaadcff6bcf7daf6db2ea105">__OCI_MAX</a>, tb, <a class="code hl_function" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857">blob_data</a>(<a class="code hl_variable" href="#aa04cdf4d9bc5ac87bf39574fc9845918">ocibuf</a>.<a class="code hl_variable" href="../../d8/d3c/blob_8h.html#af6065d74116605108b22c11e75ec669c">head</a>), <a class="code hl_function" href="../../d8/d3c/blob_8h.html#a9921d2b89577d3344abbb66f24773e32">blob_len</a>(<a class="code hl_variable" href="#aa04cdf4d9bc5ac87bf39574fc9845918">ocibuf</a>.<a class="code hl_variable" href="../../d8/d3c/blob_8h.html#af6065d74116605108b22c11e75ec669c">head</a>));</div>
<div class="line"><span class="lineno"> 2338</span> </div>
<div class="line"><span class="lineno"> 2339</span>    <span class="keywordflow">if</span> (!tb[<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a1fe8c34674764c6ec2f2d1984072c62d">OCI_VERSION</a>]) {</div>
<div class="line"><span class="lineno"> 2340</span>        res=ENOMSG;</div>
<div class="line"><span class="lineno"> 2341</span>        <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2342</span>    }</div>
<div class="line"><span class="lineno"> 2343</span> </div>
<div class="line"><span class="lineno"> 2344</span>    <span class="keywordflow">if</span> (strncmp(<span class="stringliteral">&quot;1.0&quot;</span>, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a1fe8c34674764c6ec2f2d1984072c62d">OCI_VERSION</a>]), 3)) {</div>
<div class="line"><span class="lineno"> 2345</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;unsupported ociVersion %s\n&quot;</span>, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a1fe8c34674764c6ec2f2d1984072c62d">OCI_VERSION</a>]));</div>
<div class="line"><span class="lineno"> 2346</span>        res=ENOTSUP;</div>
<div class="line"><span class="lineno"> 2347</span>        <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2348</span>    }</div>
<div class="line"><span class="lineno"> 2349</span> </div>
<div class="line"><span class="lineno"> 2350</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2ac4dfa375741e7a69482e70cd6895ee0b">OCI_HOSTNAME</a>])</div>
<div class="line"><span class="lineno"> 2351</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hostname = strdup(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2ac4dfa375741e7a69482e70cd6895ee0b">OCI_HOSTNAME</a>]));</div>
<div class="line"><span class="lineno"> 2352</span> </div>
<div class="line"><span class="lineno"> 2353</span>    <span class="keywordflow">if</span> (!tb[<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2aeefd9fc5dfb29881871de9083a277396">OCI_PROCESS</a>]) {</div>
<div class="line"><span class="lineno"> 2354</span>        res=ENODATA;</div>
<div class="line"><span class="lineno"> 2355</span>        <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2356</span>    }</div>
<div class="line"><span class="lineno"> 2357</span> </div>
<div class="line"><span class="lineno"> 2358</span>    <span class="keywordflow">if</span> ((res = <a class="code hl_function" href="#a5c2ec1493bdd9d650372134c0bdad679">parseOCIprocess</a>(tb[<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2aeefd9fc5dfb29881871de9083a277396">OCI_PROCESS</a>])))</div>
<div class="line"><span class="lineno"> 2359</span>        <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2360</span> </div>
<div class="line"><span class="lineno"> 2361</span>    <span class="keywordflow">if</span> (!tb[<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2af6442ef34bfc169790d9429b2fd4e732">OCI_ROOT</a>]) {</div>
<div class="line"><span class="lineno"> 2362</span>        res=ENODATA;</div>
<div class="line"><span class="lineno"> 2363</span>        <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2364</span>    }</div>
<div class="line"><span class="lineno"> 2365</span>    <span class="keywordflow">if</span> ((res = <a class="code hl_function" href="#a9f891a6707cacaa8e89f16ac600cf5d2">parseOCIroot</a>(jsonfile, tb[<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2af6442ef34bfc169790d9429b2fd4e732">OCI_ROOT</a>])))</div>
<div class="line"><span class="lineno"> 2366</span>        <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2367</span> </div>
<div class="line"><span class="lineno"> 2368</span>    <span class="keywordflow">if</span> (!tb[<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a138e90c68b0f6df726b8169e93b96d08">OCI_MOUNTS</a>]) {</div>
<div class="line"><span class="lineno"> 2369</span>        res=ENODATA;</div>
<div class="line"><span class="lineno"> 2370</span>        <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2371</span>    }</div>
<div class="line"><span class="lineno"> 2372</span> </div>
<div class="line"><span class="lineno"> 2373</span>    <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, tb[<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a138e90c68b0f6df726b8169e93b96d08">OCI_MOUNTS</a>], rem)</div>
<div class="line"><span class="lineno"> 2374</span>        <span class="keywordflow">if</span> ((res = <a class="code hl_function" href="../../d2/d5a/fs_8c.html#af24351611b930a9663cd1778f19c3ce4">parseOCImount</a>(cur)))</div>
<div class="line"><span class="lineno"> 2375</span>            <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2376</span> </div>
<div class="line"><span class="lineno"> 2377</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a7dbca8874590bfff6d39937b3fa80dce">OCI_LINUX</a>] &amp;&amp; (res = <a class="code hl_function" href="#a2c489687a19450a8f1a90ec2263c7a11">parseOCIlinux</a>(tb[<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a7dbca8874590bfff6d39937b3fa80dce">OCI_LINUX</a>])))</div>
<div class="line"><span class="lineno"> 2378</span>        <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2379</span> </div>
<div class="line"><span class="lineno"> 2380</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2ae5b76fcf322dc75c322e5ce6db99448d">OCI_HOOKS</a>] &amp;&amp; (res = <a class="code hl_function" href="#a8633a124e3a74b3317a273e2aaa6c207">parseOCIhooks</a>(tb[<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2ae5b76fcf322dc75c322e5ce6db99448d">OCI_HOOKS</a>])))</div>
<div class="line"><span class="lineno"> 2381</span>        <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 2382</span> </div>
<div class="line"><span class="lineno"> 2383</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a13a552ae7da72cf7868d1e286ffc0921">OCI_ANNOTATIONS</a>])</div>
<div class="line"><span class="lineno"> 2384</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.annotations = <a class="code hl_function" href="../../d4/da0/blob_8c.html#ab136827d88751058f20b641510c93434">blob_memdup</a>(tb[<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a13a552ae7da72cf7868d1e286ffc0921">OCI_ANNOTATIONS</a>]);</div>
<div class="line"><span class="lineno"> 2385</span> </div>
<div class="line"><span class="lineno"> 2386</span>errout:</div>
<div class="line"><span class="lineno"> 2387</span>    <a class="code hl_function" href="../../d4/da0/blob_8c.html#a58d1b624b96aa768608f45d390cc0d59">blob_buf_free</a>(&amp;<a class="code hl_variable" href="#aa04cdf4d9bc5ac87bf39574fc9845918">ocibuf</a>);</div>
<div class="line"><span class="lineno"> 2388</span> </div>
<div class="line"><span class="lineno"> 2389</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno"> 2390</span>}</div>
<div class="ttc" id="ablob_8c_html_a58d1b624b96aa768608f45d390cc0d59"><div class="ttname"><a href="../../d4/da0/blob_8c.html#a58d1b624b96aa768608f45d390cc0d59">blob_buf_free</a></div><div class="ttdeci">void blob_buf_free(struct blob_buf *buf)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/da0/blob_8c_source.html#l00104">blob.c:104</a></div></div>
<div class="ttc" id="ablob_8c_html_ab136827d88751058f20b641510c93434"><div class="ttname"><a href="../../d4/da0/blob_8c.html#ab136827d88751058f20b641510c93434">blob_memdup</a></div><div class="ttdeci">struct blob_attr * blob_memdup(struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/da0/blob_8c_source.html#l00326">blob.c:326</a></div></div>
<div class="ttc" id="ablob_8h_html_a66e0b636bd2bbafbf8701a1e91bbf857"><div class="ttname"><a href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857">blob_data</a></div><div class="ttdeci">static void * blob_data(const struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d3c/blob_8h_source.html#l00075">blob.h:75</a></div></div>
<div class="ttc" id="ablob_8h_html_a9921d2b89577d3344abbb66f24773e32"><div class="ttname"><a href="../../d8/d3c/blob_8h.html#a9921d2b89577d3344abbb66f24773e32">blob_len</a></div><div class="ttdeci">static size_t blob_len(const struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d3c/blob_8h_source.html#l00100">blob.h:100</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a69a81065d5c7977bc26fbd093f21a132"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a></div><div class="ttdeci">#define blobmsg_for_each_attr(pos, attr, rem)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00364">blobmsg.h:364</a></div></div>
<div class="ttc" id="ablobmsg_8h_html_a6c1cc8e52e96bf9698f6b0f65ad48603"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a></div><div class="ttdeci">static char * blobmsg_get_string(struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00348">blobmsg.h:348</a></div></div>
<div class="ttc" id="ablobmsg__json_8c_html_a7f16b1915ac39b6888614f5fcc0661f8"><div class="ttname"><a href="../../d5/d7f/blobmsg__json_8c.html#a7f16b1915ac39b6888614f5fcc0661f8">blobmsg_add_json_from_file</a></div><div class="ttdeci">bool blobmsg_add_json_from_file(struct blob_buf *b, const char *file)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d7f/blobmsg__json_8c_source.html#l00107">blobmsg_json.c:107</a></div></div>
<div class="ttc" id="afs_8c_html_af24351611b930a9663cd1778f19c3ce4"><div class="ttname"><a href="../../d2/d5a/fs_8c.html#af24351611b930a9663cd1778f19c3ce4">parseOCImount</a></div><div class="ttdeci">int parseOCImount(struct blob_attr *msg)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00388">fs.c:388</a></div></div>
<div class="ttc" id="ajail_8c_html_a2c489687a19450a8f1a90ec2263c7a11"><div class="ttname"><a href="#a2c489687a19450a8f1a90ec2263c7a11">parseOCIlinux</a></div><div class="ttdeci">static int parseOCIlinux(struct blob_attr *msg)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02198">jail.c:2198</a></div></div>
<div class="ttc" id="ajail_8c_html_a5c2ec1493bdd9d650372134c0bdad679"><div class="ttname"><a href="#a5c2ec1493bdd9d650372134c0bdad679">parseOCIprocess</a></div><div class="ttdeci">static int parseOCIprocess(struct blob_attr *msg)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01742">jail.c:1742</a></div></div>
<div class="ttc" id="ajail_8c_html_a8633a124e3a74b3317a273e2aaa6c207"><div class="ttname"><a href="#a8633a124e3a74b3317a273e2aaa6c207">parseOCIhooks</a></div><div class="ttdeci">static int parseOCIhooks(struct blob_attr *msg)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01518">jail.c:1518</a></div></div>
<div class="ttc" id="ajail_8c_html_a9f891a6707cacaa8e89f16ac600cf5d2"><div class="ttname"><a href="#a9f891a6707cacaa8e89f16ac600cf5d2">parseOCIroot</a></div><div class="ttdeci">static int parseOCIroot(const char *jsonfile, struct blob_attr *msg)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01376">jail.c:1376</a></div></div>
<div class="ttc" id="ajail_8c_html_aa04cdf4d9bc5ac87bf39574fc9845918"><div class="ttname"><a href="#aa04cdf4d9bc5ac87bf39574fc9845918">ocibuf</a></div><div class="ttdeci">static struct blob_buf ocibuf</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00159">jail.c:159</a></div></div>
<div class="ttc" id="ajail_8c_html_ad03397b5f24381749f1fbc6509cf6425"><div class="ttname"><a href="#ad03397b5f24381749f1fbc6509cf6425">oci_policy</a></div><div class="ttdeci">static const struct blobmsg_policy oci_policy[]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02312">jail.c:2312</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l02309">__OCI_MAX</a>, <a class="el" href="../../d4/da0/blob_8c_source.html#l00104">blob_buf_free()</a>, <a class="el" href="../../d4/da0/blob_8c_source.html#l00091">blob_buf_init()</a>, <a class="el" href="../../d8/d3c/blob_8h_source.html#l00075">blob_data()</a>, <a class="el" href="../../d8/d3c/blob_8h_source.html#l00100">blob_len()</a>, <a class="el" href="../../d4/da0/blob_8c_source.html#l00326">blob_memdup()</a>, <a class="el" href="../../d5/d7f/blobmsg__json_8c_source.html#l00107">blobmsg_add_json_from_file()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00364">blobmsg_for_each_attr</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00348">blobmsg_get_string()</a>, <a class="el" href="../../d1/d30/blobmsg_8c_source.html#l00166">blobmsg_parse()</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../d8/d3c/blob_8h_source.html#l00065">blob_buf::head</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02308">OCI_ANNOTATIONS</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02306">OCI_HOOKS</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02302">OCI_HOSTNAME</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02307">OCI_LINUX</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02305">OCI_MOUNTS</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02312">oci_policy</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02303">OCI_PROCESS</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02304">OCI_ROOT</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02301">OCI_VERSION</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00159">ocibuf</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01518">parseOCIhooks()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02198">parseOCIlinux()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00388">parseOCImount()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01742">parseOCIprocess()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l01376">parseOCIroot()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02583">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a4d6b15fa5d3ae9b608587bd11cbda9cf_cgraph.png" border="0" usemap="#add/d26/jail_8c_a4d6b15fa5d3ae9b608587bd11cbda9cf_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a4d6b15fa5d3ae9b608587bd11cbda9cf_cgraph" id="add/d26/jail_8c_a4d6b15fa5d3ae9b608587bd11cbda9cf_cgraph">
<area shape="rect" title=" " alt="" coords="5,341,113,375"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a58d1b624b96aa768608f45d390cc0d59" title=" " alt="" coords="228,5,375,39"/>
<area shape="poly" title=" " alt="" coords="58,341,61,284,75,205,88,162,105,120,129,82,159,48,184,32,212,23,214,28,186,37,162,52,133,85,110,123,93,164,80,206,67,285,63,341"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#af8ca2237342df92c699fbb2ddb5f390b" title=" " alt="" coords="232,63,371,96"/>
<area shape="poly" title=" " alt="" coords="60,341,67,295,85,234,114,169,134,139,159,113,186,96,216,85,218,90,188,101,162,118,138,143,119,172,90,236,73,296,65,342"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="1577,412,1688,446"/>
<area shape="poly" title=" " alt="" coords="61,340,70,301,88,250,117,199,136,176,159,157,200,140,253,129,316,124,383,123,617,132,1170,132,1207,134,1243,140,1313,163,1380,196,1441,237,1496,281,1543,325,1610,398,1606,402,1539,329,1492,285,1438,241,1377,201,1311,168,1242,145,1206,139,1170,137,617,137,383,129,316,130,254,135,201,145,162,162,140,180,121,202,93,252,75,303,66,342"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a9921d2b89577d3344abbb66f24773e32" title=" " alt="" coords="252,172,351,206"/>
<area shape="poly" title=" " alt="" coords="65,340,99,278,126,243,159,215,197,198,236,189,237,194,198,203,162,219,130,247,103,281,70,342"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#ab136827d88751058f20b641510c93434" title=" " alt="" coords="225,229,378,263"/>
<area shape="poly" title=" " alt="" coords="74,339,111,304,159,272,209,255,210,260,162,277,114,308,78,343"/>
<area shape="rect" href="../../d5/d7f/blobmsg__json_8c.html#a7f16b1915ac39b6888614f5fcc0661f8" title=" " alt="" coords="161,287,442,320"/>
<area shape="poly" title=" " alt="" coords="112,344,208,322,209,327,114,349"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603" title=" " alt="" coords="795,1140,999,1174"/>
<area shape="poly" title=" " alt="" coords="64,375,72,571,91,885,105,1047,121,1190,141,1300,151,1337,163,1359,181,1378,207,1396,273,1428,354,1455,444,1476,535,1488,620,1491,693,1484,722,1475,746,1464,780,1437,808,1404,831,1367,850,1328,876,1250,889,1188,894,1189,881,1252,855,1330,836,1370,812,1407,783,1441,749,1468,724,1480,694,1489,620,1497,534,1494,443,1481,353,1461,271,1433,204,1400,178,1382,159,1362,146,1339,135,1301,116,1191,99,1047,86,885,67,571,58,375"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed" title=" " alt="" coords="816,639,978,672"/>
<area shape="poly" title=" " alt="" coords="113,355,257,357,444,366,538,374,624,387,696,403,749,425,776,445,800,469,840,523,869,578,888,623,883,626,864,580,835,526,796,472,772,449,746,430,695,408,623,392,537,380,443,371,257,362,113,360"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a8633a124e3a74b3317a273e2aaa6c207" title=" " alt="" coords="220,419,383,452"/>
<area shape="poly" title=" " alt="" coords="114,373,232,411,231,416,112,378"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a2c489687a19450a8f1a90ec2263c7a11" title=" " alt="" coords="225,876,378,910"/>
<area shape="poly" title=" " alt="" coords="70,374,289,861,284,863,66,376"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#af24351611b930a9663cd1778f19c3ce4" title=" " alt="" coords="218,1315,385,1348"/>
<area shape="poly" title=" " alt="" coords="65,375,97,595,126,756,163,922,195,1032,231,1139,290,1299,285,1301,225,1141,190,1033,158,923,121,757,92,596,60,376"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5c2ec1493bdd9d650372134c0bdad679" title=" " alt="" coords="530,1529,708,1563"/>
<area shape="poly" title=" " alt="" coords="63,375,68,599,82,963,95,1150,112,1316,135,1442,148,1484,163,1508,186,1523,220,1535,262,1543,311,1549,415,1552,514,1550,514,1555,415,1558,310,1554,262,1549,219,1540,184,1528,159,1512,143,1486,130,1444,107,1317,90,1151,77,963,62,599,58,375"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a9f891a6707cacaa8e89f16ac600cf5d2" title=" " alt="" coords="547,1587,690,1620"/>
<area shape="poly" title=" " alt="" coords="63,376,67,608,81,987,94,1183,111,1357,134,1488,148,1532,163,1558,202,1589,246,1611,294,1625,345,1633,395,1635,445,1633,533,1621,534,1627,445,1638,395,1640,344,1638,293,1630,244,1616,199,1593,159,1561,143,1534,129,1490,106,1358,88,1184,76,988,62,608,58,376"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#af8de35ec0673663c45f2aad7c876d329" title=" " alt="" coords="566,63,671,96"/>
<area shape="poly" title=" " alt="" coords="371,77,550,77,550,82,371,82"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6f17715cbf1ce82b0981a452537b4dc6" title=" " alt="" coords="529,5,709,39"/>
<area shape="poly" title=" " alt="" coords="371,64,513,39,513,44,372,70"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a3071b18c2bb742e04d7622379ee8fd3b" title=" " alt="" coords="548,172,690,206"/>
<area shape="poly" title=" " alt="" coords="378,230,532,202,533,207,379,235"/>
<area shape="rect" href="../../d5/d7f/blobmsg__json_8c.html#a05a8f001d9418fdd31cf08aad8dd0cca" title=" " alt="" coords="514,229,724,263"/>
<area shape="poly" title=" " alt="" coords="398,283,506,264,507,269,399,289"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="1338,825,1489,859"/>
<area shape="poly" title=" " alt="" coords="999,1156,1069,1151,1145,1137,1220,1112,1256,1095,1288,1073,1312,1052,1332,1028,1365,974,1388,919,1402,874,1407,875,1393,921,1370,976,1337,1031,1316,1056,1292,1078,1258,1099,1222,1117,1146,1142,1069,1156,999,1162"/>
<area shape="poly" title=" " alt="" coords="1419,824,1479,664,1535,530,1566,489,1599,455,1603,458,1570,492,1540,533,1484,666,1424,826"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="1542,544,1723,578"/>
<area shape="poly" title=" " alt="" coords="1423,823,1470,752,1535,662,1601,587,1605,591,1539,665,1475,755,1428,826"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a7613e130753e766f5d381c06b1f7b86f" title=" " alt="" coords="1537,676,1728,710"/>
<area shape="poly" title=" " alt="" coords="1439,823,1592,716,1595,721,1442,827"/>
<area shape="poly" title=" " alt="" coords="908,636,930,607,961,570,1000,533,1045,504,1112,476,1182,455,1253,439,1324,429,1456,420,1561,421,1561,427,1456,426,1325,434,1254,444,1183,460,1114,481,1048,509,1003,537,965,574,934,610,912,640"/>
<area shape="poly" title=" " alt="" coords="912,636,967,585,1004,559,1046,540,1112,522,1180,511,1249,507,1318,508,1445,519,1548,538,1547,543,1444,525,1317,513,1250,512,1181,517,1113,527,1048,545,1007,564,970,589,915,640"/>
<area shape="poly" title=" " alt="" coords="923,636,978,605,1011,590,1046,580,1170,551,1222,542,1270,538,1318,538,1369,545,1426,558,1490,578,1525,595,1558,616,1608,663,1605,666,1554,621,1523,599,1488,583,1424,563,1368,550,1318,544,1270,543,1222,548,1171,556,1047,585,1013,595,980,610,926,640"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#ac79cacbc6a47f754832dc10bafa3b761" title=" " alt="" coords="1370,593,1457,627"/>
<area shape="poly" title=" " alt="" coords="938,636,989,617,1046,604,1130,595,1214,593,1355,601,1355,606,1214,598,1130,600,1047,609,991,623,940,641"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5a5283071ac5677652515d9a8460e655" title=" " alt="" coords="1047,619,1290,652"/>
<area shape="poly" title=" " alt="" coords="978,647,1031,643,1031,648,979,652"/>
<area shape="poly" title=" " alt="" coords="1255,651,1292,669,1328,701,1358,739,1400,810,1396,812,1354,742,1324,705,1288,674,1253,655"/>
<area shape="poly" title=" " alt="" coords="1290,620,1354,614,1355,619,1291,626"/>
<area shape="poly" title=" " alt="" coords="366,415,486,390,562,378,645,369,733,365,823,368,913,379,999,400,1094,435,1131,454,1163,475,1224,529,1292,604,1331,657,1363,713,1404,810,1399,812,1358,716,1326,660,1288,608,1220,533,1160,480,1128,459,1092,440,998,405,912,384,823,373,733,371,646,375,563,383,487,395,367,421"/>
<area shape="poly" title=" " alt="" coords="365,450,491,484,530,491,565,495,626,497,654,500,684,507,715,520,749,541,766,560,774,580,782,599,797,618,815,629,812,634,794,621,777,602,769,582,762,563,746,546,712,525,682,513,653,506,625,503,565,500,529,497,489,489,364,456"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5" title=" " alt="" coords="828,931,966,964"/>
<area shape="poly" title=" " alt="" coords="312,452,334,502,372,571,396,607,425,642,456,674,491,701,526,719,558,727,588,729,618,727,648,725,679,727,713,734,749,752,801,817,876,916,872,920,797,820,746,756,711,739,679,732,648,731,618,732,588,734,557,732,524,724,489,706,453,678,421,646,392,610,367,573,329,504,307,454"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5127f557f43086299c2bf291618dcef5" title=" " alt="" coords="828,415,966,448"/>
<area shape="poly" title=" " alt="" coords="383,429,490,425,747,425,812,426,812,432,747,430,490,430,383,434"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a75b0745dc9e409dbd1fd5a222db877ea" title=" " alt="" coords="543,440,695,474"/>
<area shape="poly" title=" " alt="" coords="383,438,527,448,527,453,383,444"/>
<area shape="poly" title=" " alt="" coords="646,472,700,519,728,551,750,586,771,642,782,691,784,736,782,779,778,868,783,919,798,976,815,1018,835,1059,877,1126,872,1129,831,1062,810,1021,793,978,778,919,773,868,777,779,779,736,776,692,766,643,745,589,723,554,696,523,643,476"/>
<area shape="poly" title=" " alt="" coords="686,472,748,493,878,550,1000,624,1024,644,1048,663,1114,694,1168,711,1224,728,1291,757,1338,785,1379,813,1376,818,1335,789,1289,762,1222,733,1167,716,1112,699,1045,667,1021,648,997,628,876,555,746,498,685,477"/>
<area shape="poly" title=" " alt="" coords="696,463,724,474,749,491,763,507,770,523,775,555,779,587,785,602,797,618,812,629,809,633,793,621,780,605,773,588,769,556,765,525,758,510,746,495,722,479,694,468"/>
<area shape="poly" title=" " alt="" coords="643,472,695,521,724,552,750,586,783,651,822,744,887,915,882,917,817,746,778,653,745,589,720,555,692,524,640,476"/>
<area shape="poly" title=" " alt="" coords="695,447,812,436,813,442,696,453"/>
<area shape="poly" title=" " alt="" coords="312,909,334,959,371,1025,395,1059,424,1092,456,1121,491,1144,529,1160,568,1171,650,1183,730,1182,801,1174,801,1179,730,1187,649,1188,567,1177,527,1165,489,1149,452,1125,420,1096,391,1063,367,1028,329,961,307,911"/>
<area shape="poly" title=" " alt="" coords="378,876,490,861,725,845,958,838,1323,838,1323,843,959,843,725,851,490,866,378,881"/>
<area shape="poly" title=" " alt="" coords="304,875,323,815,358,734,383,691,413,650,448,614,489,585,524,568,556,557,586,552,615,551,676,563,748,585,763,592,774,600,797,617,826,630,824,635,794,622,770,604,761,596,746,590,674,568,615,557,587,557,558,562,526,573,491,590,451,618,417,654,387,694,363,736,328,817,310,876"/>
<area shape="poly" title=" " alt="" coords="378,904,490,920,662,934,812,942,812,947,662,939,490,925,378,909"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2" title=" " alt="" coords="556,1209,681,1243"/>
<area shape="poly" title=" " alt="" coords="311,909,332,963,370,1039,394,1080,423,1119,455,1156,492,1188,516,1202,542,1212,540,1217,513,1207,488,1192,451,1160,419,1123,390,1083,365,1042,327,966,306,911"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#a6edb1973984f6c2bb76124150b29e7d2" title=" " alt="" coords="552,767,685,800"/>
<area shape="poly" title=" " alt="" coords="343,873,489,817,536,802,538,808,491,822,345,878"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#aba4a3f4d1a6a966987122b98d06e256f" title=" " alt="" coords="530,876,707,910"/>
<area shape="poly" title=" " alt="" coords="378,890,515,890,515,896,378,896"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#a3b4929a62218f8af6eddf6408480c60f" title=" " alt="" coords="506,600,732,634"/>
<area shape="poly" title=" " alt="" coords="308,874,332,827,371,764,423,698,455,668,489,643,496,638,499,643,491,647,458,672,427,702,375,767,337,830,313,877"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a78940dcf91ed274ccd9183c4ac526998" title=" " alt="" coords="532,985,706,1019"/>
<area shape="poly" title=" " alt="" coords="345,908,491,964,537,978,535,983,489,969,343,913"/>
<area shape="rect" href="../../d8/da1/seccomp-oci_8c.html#ac693b398071b4ee41b25e6b9d117803c" title=" " alt="" coords="502,1043,736,1076"/>
<area shape="poly" title=" " alt="" coords="322,908,393,968,440,1001,491,1029,505,1035,503,1040,489,1034,437,1006,390,972,319,912"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a553876759c42a12a39f61a93d27b27ef" title=" " alt="" coords="539,1100,699,1134"/>
<area shape="poly" title=" " alt="" coords="316,909,343,946,383,995,433,1045,491,1087,524,1100,522,1105,489,1091,430,1049,379,999,339,950,312,912"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a8ba489d2464ce8b1fb4a3ba5df1e22dc" title=" " alt="" coords="490,657,747,691"/>
<area shape="poly" title=" " alt="" coords="323,873,488,752,574,697,576,702,492,756,326,878"/>
<area shape="poly" title=" " alt="" coords="655,908,701,935,749,971,788,1010,824,1052,879,1126,874,1129,820,1055,784,1013,746,975,699,940,653,912"/>
<area shape="poly" title=" " alt="" coords="707,889,969,880,1129,871,1290,858,1322,854,1323,860,1290,863,1129,877,969,886,708,894"/>
<area shape="poly" title=" " alt="" coords="651,873,697,846,746,811,816,744,870,683,874,686,820,748,749,815,700,850,654,878"/>
<area shape="poly" title=" " alt="" coords="708,908,813,928,812,934,707,913"/>
<area shape="poly" title=" " alt="" coords="722,632,749,642,764,652,773,663,783,673,797,682,867,714,928,734,984,746,1037,754,1150,767,1215,778,1291,797,1353,817,1351,822,1289,802,1214,783,1149,772,1037,759,983,751,927,739,865,719,794,687,779,677,769,667,760,657,746,647,720,637"/>
<area shape="poly" title=" " alt="" coords="732,630,801,639,800,645,732,635"/>
<area shape="poly" title=" " alt="" coords="733,632,749,643,772,669,781,696,786,725,798,758,881,916,876,918,793,761,781,726,776,697,767,672,746,647,730,636"/>
<area shape="poly" title=" " alt="" coords="707,1013,748,1028,785,1050,819,1075,872,1126,869,1130,815,1080,782,1054,746,1033,705,1018"/>
<area shape="poly" title=" " alt="" coords="706,1000,844,994,922,986,998,974,1082,955,1145,934,1289,881,1346,862,1348,867,1291,886,1147,939,1083,960,999,979,922,991,845,999,707,1005"/>
<area shape="poly" title=" " alt="" coords="657,982,702,956,745,920,792,861,831,796,861,735,882,686,887,688,866,737,836,799,797,864,749,924,705,960,659,987"/>
<area shape="poly" title=" " alt="" coords="706,982,812,961,813,967,707,988"/>
<area shape="poly" title=" " alt="" coords="712,1074,748,1085,803,1107,852,1130,850,1135,801,1112,746,1090,710,1080"/>
<area shape="poly" title=" " alt="" coords="736,1064,857,1063,999,1051,1073,1039,1147,1021,1220,998,1289,968,1320,947,1348,922,1391,870,1395,874,1352,926,1323,952,1291,973,1222,1003,1149,1026,1074,1044,999,1056,857,1068,736,1069"/>
<area shape="poly" title=" " alt="" coords="730,1040,745,1030,803,890,881,686,886,688,808,892,749,1033,733,1044"/>
<area shape="poly" title=" " alt="" coords="714,1040,746,1029,805,1001,856,971,859,975,808,1006,748,1034,715,1045"/>
<area shape="poly" title=" " alt="" coords="700,1126,780,1137,779,1143,699,1131"/>
<area shape="poly" title=" " alt="" coords="707,689,749,708,764,721,773,734,782,746,797,757,865,787,926,804,981,813,1035,814,1148,812,1214,813,1290,821,1323,826,1323,831,1290,826,1214,819,1148,817,1035,820,981,818,925,810,864,792,794,762,778,750,769,737,760,724,746,712,704,694"/>
<area shape="poly" title=" " alt="" coords="748,663,800,659,800,665,748,668"/>
<area shape="poly" title=" " alt="" coords="718,689,749,708,769,732,779,755,785,780,798,809,837,867,874,917,870,920,832,870,793,811,780,782,773,757,765,735,746,712,715,694"/>
<area shape="poly" title=" " alt="" coords="355,1346,435,1366,535,1381,589,1382,643,1378,696,1367,746,1348,771,1333,793,1315,831,1272,860,1226,880,1187,885,1189,865,1229,835,1275,796,1319,774,1337,749,1353,698,1372,644,1383,589,1387,535,1386,434,1372,354,1352"/>
<area shape="poly" title=" " alt="" coords="310,1348,328,1406,363,1486,388,1528,417,1567,452,1603,491,1631,521,1644,560,1655,658,1670,775,1677,901,1676,1025,1667,1138,1649,1229,1624,1263,1608,1288,1591,1307,1568,1324,1538,1352,1457,1373,1357,1388,1246,1405,1028,1409,875,1415,875,1410,1029,1394,1246,1378,1357,1357,1458,1329,1540,1311,1571,1292,1595,1266,1613,1231,1629,1139,1654,1026,1672,901,1682,775,1683,657,1675,559,1660,520,1649,489,1635,448,1607,413,1571,383,1531,359,1488,323,1408,305,1350"/>
<area shape="poly" title=" " alt="" coords="385,1315,746,1253,761,1227,772,1190,781,1094,785,994,787,951,793,918,813,851,836,787,879,685,884,687,841,789,818,853,798,919,793,952,790,994,787,1094,777,1191,766,1229,749,1258,386,1320"/>
<area shape="poly" title=" " alt="" coords="386,1334,482,1336,589,1334,684,1322,720,1311,746,1297,764,1279,774,1261,779,1242,780,1222,781,1178,785,1153,793,1127,834,1043,874,976,879,979,838,1046,798,1128,790,1154,786,1178,786,1222,784,1243,779,1263,768,1282,749,1302,722,1316,685,1327,589,1339,482,1342,385,1339"/>
<area shape="poly" title=" " alt="" coords="346,1312,489,1260,540,1244,542,1249,491,1265,348,1317"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a26cdf624337a8578902d903d2ed76b6c" title=" " alt="" coords="515,1420,722,1454"/>
<area shape="poly" title=" " alt="" coords="348,1346,491,1398,539,1413,537,1418,489,1403,346,1351"/>
<area shape="poly" title=" " alt="" coords="712,1417,745,1399,875,1186,880,1189,749,1403,714,1422"/>
<area shape="poly" title=" " alt="" coords="707,1532,728,1522,745,1508,763,1487,773,1466,777,1445,779,1424,780,1378,784,1352,793,1324,832,1247,872,1185,877,1188,837,1250,798,1326,789,1353,785,1379,784,1424,783,1446,778,1467,767,1489,749,1512,731,1527,709,1537"/>
<area shape="poly" title=" " alt="" coords="695,1526,746,1508,916,1434,985,1404,1048,1372,1106,1335,1164,1290,1223,1232,1288,1158,1313,1123,1334,1085,1368,1006,1391,932,1404,874,1409,875,1396,933,1373,1008,1339,1088,1317,1126,1292,1161,1227,1236,1167,1294,1109,1339,1050,1376,987,1408,918,1439,748,1513,697,1531"/>
<area shape="poly" title=" " alt="" coords="667,1526,710,1501,729,1485,745,1465,764,1417,775,1353,781,1278,782,1198,783,1039,785,971,793,918,811,851,835,787,878,685,883,687,840,789,816,853,798,919,791,972,788,1039,788,1198,786,1278,781,1354,769,1418,750,1467,733,1488,713,1506,669,1531"/>
<area shape="poly" title=" " alt="" coords="666,1526,709,1501,729,1485,745,1465,769,1420,780,1379,783,1341,782,1303,776,1223,780,1178,793,1127,810,1084,831,1043,872,976,877,979,836,1045,815,1086,798,1128,785,1179,782,1223,787,1303,789,1341,786,1380,774,1422,750,1468,733,1488,712,1506,668,1531"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#adfbec0b532211a1442310392496a45f2" title=" " alt="" coords="803,1529,991,1563"/>
<area shape="poly" title=" " alt="" coords="708,1544,787,1544,787,1549,708,1549"/>
<area shape="poly" title=" " alt="" coords="984,1526,1059,1504,1141,1470,1182,1448,1221,1423,1257,1394,1288,1361,1310,1322,1330,1267,1349,1200,1365,1127,1391,982,1406,874,1411,875,1396,983,1370,1128,1354,1202,1336,1269,1315,1324,1292,1364,1260,1398,1224,1427,1185,1453,1143,1475,1061,1509,986,1531"/>
<area shape="poly" title=" " alt="" coords="690,1598,720,1589,746,1574,768,1546,790,1504,831,1394,864,1278,886,1188,891,1189,869,1279,836,1396,794,1506,772,1549,749,1577,722,1594,691,1603"/>
<area shape="poly" title=" " alt="" coords="691,1602,838,1600,1018,1589,1105,1578,1183,1562,1246,1541,1270,1528,1288,1514,1304,1493,1319,1465,1344,1392,1364,1303,1380,1205,1400,1013,1408,874,1414,875,1405,1013,1385,1206,1369,1304,1349,1394,1324,1467,1309,1496,1292,1517,1273,1533,1248,1546,1184,1568,1106,1584,1018,1595,839,1606,691,1607"/>
<area shape="poly" title=" " alt="" coords="690,1601,720,1592,745,1574,753,1559,760,1534,770,1459,781,1253,785,1043,788,964,793,918,811,851,834,786,878,685,883,687,839,788,816,853,798,919,793,965,791,1043,786,1253,775,1460,765,1535,758,1561,749,1577,723,1597,691,1606"/>
<area shape="poly" title=" " alt="" coords="690,1601,720,1592,745,1574,756,1558,765,1538,776,1487,781,1426,782,1359,782,1227,785,1171,793,1127,810,1084,830,1043,872,976,876,978,835,1045,814,1086,798,1128,790,1171,787,1227,788,1359,787,1426,781,1488,770,1540,761,1561,749,1577,723,1596,691,1606"/>
<area shape="poly" title=" " alt="" coords="690,1586,796,1564,797,1569,692,1591"/>
</map>
</div>

</div>
</div>
<a id="aba4a3f4d1a6a966987122b98d06e256f" name="aba4a3f4d1a6a966987122b98d06e256f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba4a3f4d1a6a966987122b98d06e256f">&#9670;&#160;</a></span>parseOCIdevices()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parseOCIdevices </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02053">2053</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2054</span>{</div>
<div class="line"><span class="lineno"> 2055</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *tb[<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da147df77312a8c562a8d21b33365448ee">__OCI_DEVICES_MAX</a>];</div>
<div class="line"><span class="lineno"> 2056</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *cur;</div>
<div class="line"><span class="lineno"> 2057</span>    <span class="keywordtype">int</span> rem;</div>
<div class="line"><span class="lineno"> 2058</span>    <span class="keywordtype">size_t</span> cnt = 0;</div>
<div class="line"><span class="lineno"> 2059</span>    <span class="keyword">struct </span><a class="code hl_struct" href="#d5/db5/structmknod__args">mknod_args</a> *tmp;</div>
<div class="line"><span class="lineno"> 2060</span> </div>
<div class="line"><span class="lineno"> 2061</span>    <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, msg, rem)</div>
<div class="line"><span class="lineno"> 2062</span>        ++cnt;</div>
<div class="line"><span class="lineno"> 2063</span> </div>
<div class="line"><span class="lineno"> 2064</span>    <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.devices = calloc(cnt + 1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="#d5/db5/structmknod__args">mknod_args</a> *));</div>
<div class="line"><span class="lineno"> 2065</span> </div>
<div class="line"><span class="lineno"> 2066</span>    cnt = 0;</div>
<div class="line"><span class="lineno"> 2067</span>    <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, msg, rem) {</div>
<div class="line"><span class="lineno"> 2068</span>        <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#a20d3f1675d8e9e1f654efa2c1f974a91">oci_devices_policy</a>, <a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da147df77312a8c562a8d21b33365448ee">__OCI_DEVICES_MAX</a>, tb, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a>(cur));</div>
<div class="line"><span class="lineno"> 2069</span>        <span class="keywordflow">if</span> (!tb[<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da7552d79964c15ae667f2506ef74f8201">OCI_DEVICES_TYPE</a>] ||</div>
<div class="line"><span class="lineno"> 2070</span>            !tb[<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5dabaa93214e7a6d28b48d2196358fd1123">OCI_DEVICES_PATH</a>])</div>
<div class="line"><span class="lineno"> 2071</span>            <span class="keywordflow">return</span> ENODATA;</div>
<div class="line"><span class="lineno"> 2072</span> </div>
<div class="line"><span class="lineno"> 2073</span>        tmp = calloc(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="#d5/db5/structmknod__args">mknod_args</a>));</div>
<div class="line"><span class="lineno"> 2074</span>        <span class="keywordflow">if</span> (!tmp)</div>
<div class="line"><span class="lineno"> 2075</span>            <span class="keywordflow">return</span> ENOMEM;</div>
<div class="line"><span class="lineno"> 2076</span> </div>
<div class="line"><span class="lineno"> 2077</span>        tmp-&gt;<a class="code hl_variable" href="#a3b9b0f5b6acc5a3df5e4c7eb0f686ef6">mode</a> = <a class="code hl_function" href="#abbfe748be98e9279f2002f167442f9b2">resolve_devtype</a>(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da7552d79964c15ae667f2506ef74f8201">OCI_DEVICES_TYPE</a>]));</div>
<div class="line"><span class="lineno"> 2078</span>        <span class="keywordflow">if</span> (!tmp-&gt;<a class="code hl_variable" href="#a3b9b0f5b6acc5a3df5e4c7eb0f686ef6">mode</a>) {</div>
<div class="line"><span class="lineno"> 2079</span>            free(tmp);</div>
<div class="line"><span class="lineno"> 2080</span>            <span class="keywordflow">return</span> EINVAL;</div>
<div class="line"><span class="lineno"> 2081</span>        }</div>
<div class="line"><span class="lineno"> 2082</span> </div>
<div class="line"><span class="lineno"> 2083</span>        <span class="keywordflow">if</span> (tmp-&gt;<a class="code hl_variable" href="#a3b9b0f5b6acc5a3df5e4c7eb0f686ef6">mode</a> != S_IFIFO) {</div>
<div class="line"><span class="lineno"> 2084</span>            <span class="keywordflow">if</span> (!tb[<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5dadf9c76ed009a9d7998f869ddf0371767">OCI_DEVICES_MAJOR</a>] || !tb[<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da1841510f8919dcaed8f7e150611e6acf">OCI_DEVICES_MINOR</a>]) {</div>
<div class="line"><span class="lineno"> 2085</span>                free(tmp);</div>
<div class="line"><span class="lineno"> 2086</span>                <span class="keywordflow">return</span> ENODATA;</div>
<div class="line"><span class="lineno"> 2087</span>            }</div>
<div class="line"><span class="lineno"> 2088</span> </div>
<div class="line"><span class="lineno"> 2089</span>            tmp-&gt;<a class="code hl_variable" href="#a1e856bfa3ae2ac3a7c555a66140bea42">dev</a> = <a class="code hl_define" href="#aa031dc6712613a6c64f5d8b26eb1baae">makedev</a>(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5dadf9c76ed009a9d7998f869ddf0371767">OCI_DEVICES_MAJOR</a>]),</div>
<div class="line"><span class="lineno"> 2090</span>                       <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da1841510f8919dcaed8f7e150611e6acf">OCI_DEVICES_MINOR</a>]));</div>
<div class="line"><span class="lineno"> 2091</span>        }</div>
<div class="line"><span class="lineno"> 2092</span> </div>
<div class="line"><span class="lineno"> 2093</span>        <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da726450a129ef116d29282fe043688c00">OCI_DEVICES_FILEMODE</a>]) {</div>
<div class="line"><span class="lineno"> 2094</span>            <span class="keywordflow">if</span> (~(S_IRWXU|S_IRWXG|S_IRWXO) &amp; <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da726450a129ef116d29282fe043688c00">OCI_DEVICES_FILEMODE</a>])) {</div>
<div class="line"><span class="lineno"> 2095</span>                free(tmp);</div>
<div class="line"><span class="lineno"> 2096</span>                <span class="keywordflow">return</span> EINVAL;</div>
<div class="line"><span class="lineno"> 2097</span>            }</div>
<div class="line"><span class="lineno"> 2098</span> </div>
<div class="line"><span class="lineno"> 2099</span>            tmp-&gt;<a class="code hl_variable" href="#a3b9b0f5b6acc5a3df5e4c7eb0f686ef6">mode</a> |= <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da726450a129ef116d29282fe043688c00">OCI_DEVICES_FILEMODE</a>]);</div>
<div class="line"><span class="lineno"> 2100</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2101</span>            tmp-&gt;<a class="code hl_variable" href="#a3b9b0f5b6acc5a3df5e4c7eb0f686ef6">mode</a> |= (S_IRUSR|S_IWUSR); <span class="comment">/* 0600 */</span></div>
<div class="line"><span class="lineno"> 2102</span>        }</div>
<div class="line"><span class="lineno"> 2103</span> </div>
<div class="line"><span class="lineno"> 2104</span>        tmp-&gt;<a class="code hl_variable" href="#ad0d8de31878303df1c911492dfade935">path</a> = strdup(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5dabaa93214e7a6d28b48d2196358fd1123">OCI_DEVICES_PATH</a>]));</div>
<div class="line"><span class="lineno"> 2105</span> </div>
<div class="line"><span class="lineno"> 2106</span>        <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da5b0d2d05d0ce566724d25dc7e751899d">OCI_DEVICES_UID</a>])</div>
<div class="line"><span class="lineno"> 2107</span>            tmp-&gt;<a class="code hl_variable" href="#a12ad74a7a8c429f2cbd4341dbc0fcea7">uid</a> = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da5b0d2d05d0ce566724d25dc7e751899d">OCI_DEVICES_UID</a>]);</div>
<div class="line"><span class="lineno"> 2108</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2109</span>            tmp-&gt;<a class="code hl_variable" href="#a12ad74a7a8c429f2cbd4341dbc0fcea7">uid</a> = -1;</div>
<div class="line"><span class="lineno"> 2110</span> </div>
<div class="line"><span class="lineno"> 2111</span>        <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da1201076fb774af33b8c73c518dcc1dfb">OCI_DEVICES_GID</a>])</div>
<div class="line"><span class="lineno"> 2112</span>            tmp-&gt;<a class="code hl_variable" href="#a5d2aa9579d69f85c4762141947bdb3e1">gid</a> = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da1201076fb774af33b8c73c518dcc1dfb">OCI_DEVICES_GID</a>]);</div>
<div class="line"><span class="lineno"> 2113</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2114</span>            tmp-&gt;<a class="code hl_variable" href="#a5d2aa9579d69f85c4762141947bdb3e1">gid</a> = -1;</div>
<div class="line"><span class="lineno"> 2115</span> </div>
<div class="line"><span class="lineno"> 2116</span>        <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;read device %s (%s)\n&quot;</span>, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5dabaa93214e7a6d28b48d2196358fd1123">OCI_DEVICES_PATH</a>]), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da7552d79964c15ae667f2506ef74f8201">OCI_DEVICES_TYPE</a>]));</div>
<div class="line"><span class="lineno"> 2117</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.devices[cnt++] = tmp;</div>
<div class="line"><span class="lineno"> 2118</span>    }</div>
<div class="line"><span class="lineno"> 2119</span> </div>
<div class="line"><span class="lineno"> 2120</span>    <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.devices[cnt] = NULL;</div>
<div class="line"><span class="lineno"> 2121</span> </div>
<div class="line"><span class="lineno"> 2122</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2123</span>}</div>
<div class="ttc" id="ablobmsg_8h_html_a2646be9952a62787018f5760ce95fdd5"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a></div><div class="ttdeci">static size_t blobmsg_len(const struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00108">blobmsg.h:108</a></div></div>
<div class="ttc" id="ajail_8c_html_a20d3f1675d8e9e1f654efa2c1f974a91"><div class="ttname"><a href="#a20d3f1675d8e9e1f654efa2c1f974a91">oci_devices_policy</a></div><div class="ttdeci">static const struct blobmsg_policy oci_devices_policy[]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02030">jail.c:2030</a></div></div>
<div class="ttc" id="ajail_8c_html_aa031dc6712613a6c64f5d8b26eb1baae"><div class="ttname"><a href="#aa031dc6712613a6c64f5d8b26eb1baae">makedev</a></div><div class="ttdeci">#define makedev(x, y)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00575">jail.c:575</a></div></div>
<div class="ttc" id="ajail_8c_html_abbfe748be98e9279f2002f167442f9b2"><div class="ttname"><a href="#abbfe748be98e9279f2002f167442f9b2">resolve_devtype</a></div><div class="ttdeci">static mode_t resolve_devtype(char *tstr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02040">jail.c:2040</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l02027">__OCI_DEVICES_MAX</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00078">blobmsg_data()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00364">blobmsg_for_each_attr</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00348">blobmsg_get_string()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00293">blobmsg_get_u32()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00108">blobmsg_len()</a>, <a class="el" href="../../d1/d30/blobmsg_8c_source.html#l00166">blobmsg_parse()</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00091">mknod_args::dev</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00093">mknod_args::gid</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00575">makedev</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00090">mknod_args::mode</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02024">OCI_DEVICES_FILEMODE</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02026">OCI_DEVICES_GID</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02022">OCI_DEVICES_MAJOR</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02023">OCI_DEVICES_MINOR</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02021">OCI_DEVICES_PATH</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02030">oci_devices_policy</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02020">OCI_DEVICES_TYPE</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02025">OCI_DEVICES_UID</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00089">mknod_args::path</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02040">resolve_devtype()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00092">mknod_args::uid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02198">parseOCIlinux()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_aba4a3f4d1a6a966987122b98d06e256f_cgraph.png" border="0" usemap="#add/d26/jail_8c_aba4a3f4d1a6a966987122b98d06e256f_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_aba4a3f4d1a6a966987122b98d06e256f_cgraph" id="add/d26/jail_8c_aba4a3f4d1a6a966987122b98d06e256f_cgraph">
<area shape="rect" title=" " alt="" coords="5,317,183,351"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="1029,388,1180,421"/>
<area shape="poly" title=" " alt="" coords="161,314,230,299,388,275,594,255,699,252,797,256,881,269,916,279,945,293,963,310,971,329,978,348,993,366,1016,380,1013,384,990,370,974,351,966,331,959,313,942,297,914,284,880,274,796,261,699,257,595,261,389,281,231,304,162,319"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603" title=" " alt="" coords="484,289,687,323"/>
<area shape="poly" title=" " alt="" coords="183,326,469,310,469,315,183,331"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f" title=" " alt="" coords="231,180,416,213"/>
<area shape="poly" title=" " alt="" coords="113,314,164,273,229,230,256,217,258,222,232,235,167,278,116,319"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5" title=" " alt="" coords="517,529,655,563"/>
<area shape="poly" title=" " alt="" coords="135,349,231,387,284,401,327,406,368,415,417,438,433,451,443,463,452,476,466,489,523,520,520,525,462,493,448,480,438,467,429,454,415,443,367,420,326,412,283,406,230,392,133,354"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed" title=" " alt="" coords="242,344,405,377"/>
<area shape="poly" title=" " alt="" coords="183,341,227,347,226,352,183,347"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#abbfe748be98e9279f2002f167442f9b2" title=" " alt="" coords="238,453,409,487"/>
<area shape="poly" title=" " alt="" coords="117,349,168,389,232,431,258,444,256,449,229,436,164,394,114,353"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="1305,525,1416,559"/>
<area shape="poly" title=" " alt="" coords="1181,414,1218,430,1235,444,1244,459,1253,474,1267,489,1307,515,1304,520,1263,493,1248,477,1240,462,1231,448,1216,435,1179,419"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="1270,330,1451,364"/>
<area shape="poly" title=" " alt="" coords="1180,385,1267,365,1268,370,1181,390"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ac239a83ed3c7f835e2b49f785953c934" title=" " alt="" coords="1275,445,1445,479"/>
<area shape="poly" title=" " alt="" coords="1181,419,1268,438,1267,444,1180,424"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a7613e130753e766f5d381c06b1f7b86f" title=" " alt="" coords="1265,388,1455,421"/>
<area shape="poly" title=" " alt="" coords="1181,402,1250,402,1250,407,1181,407"/>
<area shape="poly" title=" " alt="" coords="688,299,811,303,879,311,944,325,1009,348,1064,377,1062,382,1007,353,943,330,878,316,811,308,688,304"/>
<area shape="poly" title=" " alt="" coords="416,179,527,168,663,168,735,174,807,185,878,204,945,230,991,260,1031,298,1064,338,1088,373,1083,376,1060,341,1028,302,988,264,942,235,876,209,806,191,734,179,663,173,528,174,417,184"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052" title=" " alt="" coords="755,557,944,591"/>
<area shape="poly" title=" " alt="" coords="656,550,740,559,739,565,655,556"/>
<area shape="poly" title=" " alt="" coords="927,554,942,544,953,530,960,517,965,488,970,459,977,445,990,430,1013,416,1016,421,993,435,982,448,975,461,970,489,965,518,958,533,945,548,930,559"/>
<area shape="poly" title=" " alt="" coords="944,565,1289,544,1289,549,944,571"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a9921d2b89577d3344abbb66f24773e32" title=" " alt="" coords="1311,650,1409,684"/>
<area shape="poly" title=" " alt="" coords="944,588,1296,653,1295,658,944,594"/>
<area shape="poly" title=" " alt="" coords="352,376,386,403,418,439,429,459,434,478,437,512,443,544,451,559,466,573,494,590,528,603,569,612,614,618,717,622,828,617,941,606,1048,592,1217,566,1289,553,1290,558,1217,571,1049,598,941,612,828,623,717,628,614,624,568,618,527,608,491,595,462,577,447,562,438,546,432,513,429,479,424,461,414,442,383,407,349,380"/>
<area shape="poly" title=" " alt="" coords="335,342,372,290,414,225,425,196,431,172,441,149,462,129,565,72,660,32,749,10,837,3,925,12,1016,37,1113,76,1218,129,1245,146,1268,168,1306,218,1334,270,1351,315,1347,317,1329,272,1302,221,1264,171,1241,150,1216,133,1111,81,1014,42,924,18,837,9,750,15,661,37,567,77,466,133,445,152,436,173,430,198,418,227,376,293,340,345"/>
<area shape="poly" title=" " alt="" coords="344,341,395,305,428,287,463,274,534,257,596,248,651,245,702,248,809,266,944,293,1101,330,1284,380,1283,386,1100,335,943,298,808,272,702,254,651,250,596,253,536,262,465,279,431,292,398,309,347,345"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#ac79cacbc6a47f754832dc10bafa3b761" title=" " alt="" coords="806,340,893,373"/>
<area shape="poly" title=" " alt="" coords="405,357,790,354,790,360,405,363"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5a5283071ac5677652515d9a8460e655" title=" " alt="" coords="464,445,707,479"/>
<area shape="poly" title=" " alt="" coords="370,375,527,436,525,441,368,380"/>
<area shape="poly" title=" " alt="" coords="708,446,1013,412,1014,417,708,451"/>
<area shape="poly" title=" " alt="" coords="630,477,709,514,732,529,757,543,770,549,768,554,754,548,730,534,706,519,628,482"/>
<area shape="poly" title=" " alt="" coords="628,442,754,390,790,376,792,381,756,395,630,447"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6b6c429265d86411d05951d2fae7289a" title=" " alt="" coords="762,500,937,533"/>
<area shape="poly" title=" " alt="" coords="671,477,750,493,749,499,670,482"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a2c4753820a7472bba7b999fbba79df01" title=" " alt="" coords="779,678,920,712"/>
<area shape="poly" title=" " alt="" coords="645,477,678,493,709,515,727,536,736,557,744,578,758,602,787,636,818,666,815,670,784,640,753,605,739,580,731,559,722,539,706,518,676,497,643,482"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a131936c081164c18e6241d79f3b276d1" title=" " alt="" coords="992,445,1217,479"/>
<area shape="poly" title=" " alt="" coords="708,459,976,459,976,464,708,464"/>
<area shape="poly" title=" " alt="" coords="921,693,1058,691,1217,683,1295,674,1296,680,1217,688,1058,696,921,698"/>
<area shape="poly" title=" " alt="" coords="1161,477,1290,517,1289,522,1160,482"/>
<area shape="poly" title=" " alt="" coords="1195,442,1215,432,1230,418,1239,403,1248,388,1263,373,1270,369,1273,373,1267,377,1252,391,1243,406,1235,421,1219,436,1197,447"/>
<area shape="poly" title=" " alt="" coords="1217,459,1259,459,1259,464,1217,464"/>
<area shape="poly" title=" " alt="" coords="1182,442,1267,423,1268,428,1183,447"/>
<area shape="poly" title=" " alt="" coords="1128,477,1328,638,1324,642,1125,481"/>
</map>
</div>

</div>
</div>
<a id="adddfc616a062dd8a8ba8d4fbd3929cbe" name="adddfc616a062dd8a8ba8d4fbd3929cbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adddfc616a062dd8a8ba8d4fbd3929cbe">&#9670;&#160;</a></span>parseOCIenvarray()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parseOCIenvarray </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char ***</td>          <td class="paramname"><span class="paramname"><em>envp</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01338">1338</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1339</span>{</div>
<div class="line"><span class="lineno"> 1340</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *cur;</div>
<div class="line"><span class="lineno"> 1341</span>    <span class="keywordtype">int</span> sz = 0, rem;</div>
<div class="line"><span class="lineno"> 1342</span> </div>
<div class="line"><span class="lineno"> 1343</span>    <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, msg, rem)</div>
<div class="line"><span class="lineno"> 1344</span>        ++sz;</div>
<div class="line"><span class="lineno"> 1345</span> </div>
<div class="line"><span class="lineno"> 1346</span>    <span class="keywordflow">if</span> (sz &gt; 0) {</div>
<div class="line"><span class="lineno"> 1347</span>        *envp = calloc(1 + sz, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));</div>
<div class="line"><span class="lineno"> 1348</span>        <span class="keywordflow">if</span> (!(*envp))</div>
<div class="line"><span class="lineno"> 1349</span>            <span class="keywordflow">return</span> ENOMEM;</div>
<div class="line"><span class="lineno"> 1350</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1351</span>        *envp = NULL;</div>
<div class="line"><span class="lineno"> 1352</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1353</span>    }</div>
<div class="line"><span class="lineno"> 1354</span> </div>
<div class="line"><span class="lineno"> 1355</span>    sz = 0;</div>
<div class="line"><span class="lineno"> 1356</span>    <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, msg, rem)</div>
<div class="line"><span class="lineno"> 1357</span>        (*envp)[sz++] = strdup(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(cur));</div>
<div class="line"><span class="lineno"> 1358</span> </div>
<div class="line"><span class="lineno"> 1359</span>    <span class="keywordflow">if</span> (sz)</div>
<div class="line"><span class="lineno"> 1360</span>        (*envp)[sz] = NULL;</div>
<div class="line"><span class="lineno"> 1361</span> </div>
<div class="line"><span class="lineno"> 1362</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1363</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00364">blobmsg_for_each_attr</a>, and <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00348">blobmsg_get_string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01432">parseOCIhook()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l01742">parseOCIprocess()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_adddfc616a062dd8a8ba8d4fbd3929cbe_cgraph.png" border="0" usemap="#add/d26/jail_8c_adddfc616a062dd8a8ba8d4fbd3929cbe_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_adddfc616a062dd8a8ba8d4fbd3929cbe_cgraph" id="add/d26/jail_8c_adddfc616a062dd8a8ba8d4fbd3929cbe_cgraph">
<area shape="rect" title=" " alt="" coords="5,92,195,126"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603" title=" " alt="" coords="243,92,446,126"/>
<area shape="poly" title=" " alt="" coords="195,106,227,106,227,112,195,112"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="494,92,645,126"/>
<area shape="poly" title=" " alt="" coords="447,106,479,106,479,112,447,112"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="733,5,844,39"/>
<area shape="poly" title=" " alt="" coords="602,89,692,48,717,39,719,44,694,53,605,94"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="698,63,879,96"/>
<area shape="poly" title=" " alt="" coords="646,96,682,91,683,96,646,101"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ac239a83ed3c7f835e2b49f785953c934" title=" " alt="" coords="703,120,874,154"/>
<area shape="poly" title=" " alt="" coords="646,116,688,121,687,127,646,121"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a7613e130753e766f5d381c06b1f7b86f" title=" " alt="" coords="693,177,884,211"/>
<area shape="poly" title=" " alt="" coords="606,124,694,164,711,170,709,175,692,169,604,129"/>
</map>
</div>

</div>
</div>
<a id="a75b0745dc9e409dbd1fd5a222db877ea" name="a75b0745dc9e409dbd1fd5a222db877ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75b0745dc9e409dbd1fd5a222db877ea">&#9670;&#160;</a></span>parseOCIhook()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parseOCIhook </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="#da/d60/structhook__execvpe">hook_execvpe</a> ***</td>          <td class="paramname"><span class="paramname"><em>hooklist</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01432">1432</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1433</span>{</div>
<div class="line"><span class="lineno"> 1434</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *tb[<a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2a54921720b398badc128a50954e58f14b">__OCI_HOOK_MAX</a>];</div>
<div class="line"><span class="lineno"> 1435</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *cur;</div>
<div class="line"><span class="lineno"> 1436</span>    <span class="keywordtype">int</span> rem, ret = 0;</div>
<div class="line"><span class="lineno"> 1437</span>    <span class="keywordtype">int</span> idx = 0;</div>
<div class="line"><span class="lineno"> 1438</span> </div>
<div class="line"><span class="lineno"> 1439</span>    <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, msg, rem)</div>
<div class="line"><span class="lineno"> 1440</span>        ++idx;</div>
<div class="line"><span class="lineno"> 1441</span> </div>
<div class="line"><span class="lineno"> 1442</span>    <span class="keywordflow">if</span> (!idx)</div>
<div class="line"><span class="lineno"> 1443</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1444</span> </div>
<div class="line"><span class="lineno"> 1445</span>    *hooklist = calloc(idx + 1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="#da/d60/structhook__execvpe">hook_execvpe</a> *));</div>
<div class="line"><span class="lineno"> 1446</span>    idx = 0;</div>
<div class="line"><span class="lineno"> 1447</span> </div>
<div class="line"><span class="lineno"> 1448</span>    <span class="keywordflow">if</span> (!(*hooklist))</div>
<div class="line"><span class="lineno"> 1449</span>        <span class="keywordflow">return</span> ENOMEM;</div>
<div class="line"><span class="lineno"> 1450</span> </div>
<div class="line"><span class="lineno"> 1451</span>    <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, msg, rem) {</div>
<div class="line"><span class="lineno"> 1452</span>        <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#af55a6af095425b7521be3888c90b3e21">oci_hook_policy</a>, <a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2a54921720b398badc128a50954e58f14b">__OCI_HOOK_MAX</a>, tb, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a>(cur));</div>
<div class="line"><span class="lineno"> 1453</span> </div>
<div class="line"><span class="lineno"> 1454</span>        <span class="keywordflow">if</span> (!tb[<a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2ab8282160b544f18b6b51d625957979a5">OCI_HOOK_PATH</a>]) {</div>
<div class="line"><span class="lineno"> 1455</span>            ret = EINVAL;</div>
<div class="line"><span class="lineno"> 1456</span>            <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 1457</span>        }</div>
<div class="line"><span class="lineno"> 1458</span> </div>
<div class="line"><span class="lineno"> 1459</span>        (*hooklist)[idx] = calloc(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="#da/d60/structhook__execvpe">hook_execvpe</a>));</div>
<div class="line"><span class="lineno"> 1460</span>        <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2a95599181fee35581a14f13681c2cf66b">OCI_HOOK_ARGS</a>]) {</div>
<div class="line"><span class="lineno"> 1461</span>            ret = <a class="code hl_function" href="#adddfc616a062dd8a8ba8d4fbd3929cbe">parseOCIenvarray</a>(tb[<a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2a95599181fee35581a14f13681c2cf66b">OCI_HOOK_ARGS</a>], &amp;((*hooklist)[idx]-&gt;argv));</div>
<div class="line"><span class="lineno"> 1462</span>            <span class="keywordflow">if</span> (ret)</div>
<div class="line"><span class="lineno"> 1463</span>                <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 1464</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1465</span>            (*hooklist)[idx]-&gt;argv = calloc(2, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span> *));</div>
<div class="line"><span class="lineno"> 1466</span>            ((*hooklist)[idx]-&gt;argv)[0] = strdup(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2ab8282160b544f18b6b51d625957979a5">OCI_HOOK_PATH</a>]));</div>
<div class="line"><span class="lineno"> 1467</span>            ((*hooklist)[idx]-&gt;argv)[1] = NULL;</div>
<div class="line"><span class="lineno"> 1468</span>        };</div>
<div class="line"><span class="lineno"> 1469</span> </div>
<div class="line"><span class="lineno"> 1470</span> </div>
<div class="line"><span class="lineno"> 1471</span>        <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2a36845abacde1267489e7ef578cee4460">OCI_HOOK_ENV</a>]) {</div>
<div class="line"><span class="lineno"> 1472</span>            ret = <a class="code hl_function" href="#adddfc616a062dd8a8ba8d4fbd3929cbe">parseOCIenvarray</a>(tb[<a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2a36845abacde1267489e7ef578cee4460">OCI_HOOK_ENV</a>], &amp;((*hooklist)[idx]-&gt;envp));</div>
<div class="line"><span class="lineno"> 1473</span>            <span class="keywordflow">if</span> (ret)</div>
<div class="line"><span class="lineno"> 1474</span>                <span class="keywordflow">goto</span> errout;</div>
<div class="line"><span class="lineno"> 1475</span>        }</div>
<div class="line"><span class="lineno"> 1476</span> </div>
<div class="line"><span class="lineno"> 1477</span>        <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2abb5b45a58a6262ff75e12bd0fe9d888d">OCI_HOOK_TIMEOUT</a>])</div>
<div class="line"><span class="lineno"> 1478</span>            (*hooklist)[idx]-&gt;timeout = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2abb5b45a58a6262ff75e12bd0fe9d888d">OCI_HOOK_TIMEOUT</a>]);</div>
<div class="line"><span class="lineno"> 1479</span> </div>
<div class="line"><span class="lineno"> 1480</span>        (*hooklist)[idx]-&gt;file = strdup(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2ab8282160b544f18b6b51d625957979a5">OCI_HOOK_PATH</a>]));</div>
<div class="line"><span class="lineno"> 1481</span> </div>
<div class="line"><span class="lineno"> 1482</span>        ++idx;</div>
<div class="line"><span class="lineno"> 1483</span>    }</div>
<div class="line"><span class="lineno"> 1484</span> </div>
<div class="line"><span class="lineno"> 1485</span>    (*hooklist)[idx] = NULL;</div>
<div class="line"><span class="lineno"> 1486</span> </div>
<div class="line"><span class="lineno"> 1487</span>    <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;added %d hooks\n&quot;</span>, idx);</div>
<div class="line"><span class="lineno"> 1488</span> </div>
<div class="line"><span class="lineno"> 1489</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1490</span> </div>
<div class="line"><span class="lineno"> 1491</span>errout:</div>
<div class="line"><span class="lineno"> 1492</span>    <a class="code hl_function" href="#a5127f557f43086299c2bf291618dcef5">free_hooklist</a>(*hooklist);</div>
<div class="line"><span class="lineno"> 1493</span>    *hooklist = NULL;</div>
<div class="line"><span class="lineno"> 1494</span> </div>
<div class="line"><span class="lineno"> 1495</span>    <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno"> 1496</span>};</div>
<div class="ttc" id="ajail_8c_html_adddfc616a062dd8a8ba8d4fbd3929cbe"><div class="ttname"><a href="#adddfc616a062dd8a8ba8d4fbd3929cbe">parseOCIenvarray</a></div><div class="ttdeci">static int parseOCIenvarray(struct blob_attr *msg, char ***envp)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01338">jail.c:1338</a></div></div>
<div class="ttc" id="ajail_8c_html_af55a6af095425b7521be3888c90b3e21"><div class="ttname"><a href="#af55a6af095425b7521be3888c90b3e21">oci_hook_policy</a></div><div class="ttdeci">static const struct blobmsg_policy oci_hook_policy[]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01424">jail.c:1424</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l01421">__OCI_HOOK_MAX</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00078">blobmsg_data()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00364">blobmsg_for_each_attr</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00348">blobmsg_get_string()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00293">blobmsg_get_u32()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00108">blobmsg_len()</a>, <a class="el" href="../../d1/d30/blobmsg_8c_source.html#l00166">blobmsg_parse()</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00199">free_hooklist()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01418">OCI_HOOK_ARGS</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01419">OCI_HOOK_ENV</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01417">OCI_HOOK_PATH</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01424">oci_hook_policy</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01420">OCI_HOOK_TIMEOUT</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l01338">parseOCIenvarray()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01518">parseOCIhooks()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a75b0745dc9e409dbd1fd5a222db877ea_cgraph.png" border="0" usemap="#add/d26/jail_8c_a75b0745dc9e409dbd1fd5a222db877ea_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a75b0745dc9e409dbd1fd5a222db877ea_cgraph" id="add/d26/jail_8c_a75b0745dc9e409dbd1fd5a222db877ea_cgraph">
<area shape="rect" title=" " alt="" coords="5,216,158,250"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="1008,275,1159,308"/>
<area shape="poly" title=" " alt="" coords="90,214,107,186,133,153,166,120,204,96,308,54,400,24,485,8,566,3,647,12,732,33,823,67,924,113,971,144,1011,183,1044,224,1067,260,1063,263,1039,227,1007,187,967,148,921,118,821,72,730,38,646,17,566,9,485,13,401,29,309,59,207,100,169,124,137,156,112,189,94,217"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603" title=" " alt="" coords="463,111,666,144"/>
<area shape="poly" title=" " alt="" coords="157,214,468,146,469,151,158,219"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f" title=" " alt="" coords="736,163,921,196"/>
<area shape="poly" title=" " alt="" coords="158,225,720,184,720,190,158,230"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5" title=" " alt="" coords="496,243,634,276"/>
<area shape="poly" title=" " alt="" coords="158,243,206,249,351,257,480,258,480,263,351,262,205,254,158,248"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed" title=" " alt="" coords="219,424,382,458"/>
<area shape="poly" title=" " alt="" coords="103,248,272,412,269,415,99,252"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5127f557f43086299c2bf291618dcef5" title=" " alt="" coords="231,585,370,619"/>
<area shape="poly" title=" " alt="" coords="93,249,139,344,208,469,279,571,274,574,203,472,135,346,88,251"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#adddfc616a062dd8a8ba8d4fbd3929cbe" title=" " alt="" coords="206,111,395,144"/>
<area shape="poly" title=" " alt="" coords="110,213,204,161,235,148,237,153,207,166,112,218"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="1284,224,1395,258"/>
<area shape="poly" title=" " alt="" coords="1159,274,1268,252,1269,257,1160,279"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="1249,357,1430,391"/>
<area shape="poly" title=" " alt="" coords="1139,306,1271,349,1269,355,1137,311"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ac239a83ed3c7f835e2b49f785953c934" title=" " alt="" coords="1254,288,1424,322"/>
<area shape="poly" title=" " alt="" coords="1160,293,1239,297,1238,302,1159,298"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a7613e130753e766f5d381c06b1f7b86f" title=" " alt="" coords="1244,415,1434,448"/>
<area shape="poly" title=" " alt="" coords="1130,306,1164,323,1198,345,1213,361,1222,375,1231,388,1246,401,1252,405,1249,410,1242,406,1227,392,1217,378,1208,364,1194,350,1162,328,1128,311"/>
<area shape="poly" title=" " alt="" coords="667,114,726,113,792,117,859,127,924,148,966,171,1004,200,1061,260,1058,264,1000,204,963,175,922,153,858,133,792,122,726,118,667,119"/>
<area shape="poly" title=" " alt="" coords="894,194,924,205,986,234,1042,264,1039,269,984,239,922,210,892,199"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052" title=" " alt="" coords="734,220,923,254"/>
<area shape="poly" title=" " alt="" coords="634,251,718,244,719,249,635,256"/>
<area shape="poly" title=" " alt="" coords="911,252,993,269,992,275,910,257"/>
<area shape="poly" title=" " alt="" coords="923,235,1268,238,1268,243,923,240"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a9921d2b89577d3344abbb66f24773e32" title=" " alt="" coords="1290,645,1388,679"/>
<area shape="poly" title=" " alt="" coords="856,252,890,280,925,315,940,340,948,361,957,382,973,404,1010,443,1051,480,1138,545,1222,598,1290,635,1288,640,1219,602,1135,549,1048,484,1007,447,969,408,952,384,944,363,935,342,921,318,887,284,853,256"/>
<area shape="poly" title=" " alt="" coords="333,421,442,369,480,356,514,349,573,341,601,336,628,327,655,311,684,287,697,270,703,253,705,216,708,181,717,163,733,148,767,127,804,112,842,102,882,96,962,98,1043,111,1120,134,1190,161,1297,214,1295,219,1188,166,1118,139,1042,117,962,103,882,102,843,107,806,117,770,132,736,152,721,167,713,182,710,217,708,254,702,272,688,291,658,316,630,332,602,341,574,347,515,354,481,361,444,374,335,426"/>
<area shape="poly" title=" " alt="" coords="341,456,390,475,444,492,576,526,682,548,733,552,788,551,850,545,922,533,973,521,1015,507,1084,474,1153,438,1243,400,1261,394,1263,399,1245,405,1155,443,1087,479,1017,512,975,526,923,538,851,550,788,557,733,557,681,553,575,531,442,497,388,480,340,461"/>
<area shape="poly" title=" " alt="" coords="315,457,335,485,365,519,401,552,444,577,514,598,605,613,709,622,820,625,931,622,1035,613,1125,598,1195,577,1234,554,1268,523,1296,490,1318,460,1322,463,1301,493,1272,527,1237,558,1197,582,1126,603,1036,619,931,628,820,630,709,627,604,618,513,603,442,582,398,557,361,523,331,489,310,460"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#ac79cacbc6a47f754832dc10bafa3b761" title=" " alt="" coords="785,489,872,523"/>
<area shape="poly" title=" " alt="" coords="382,448,770,496,769,502,382,453"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5a5283071ac5677652515d9a8460e655" title=" " alt="" coords="443,384,686,418"/>
<area shape="poly" title=" " alt="" coords="382,426,434,418,435,423,382,431"/>
<area shape="poly" title=" " alt="" coords="591,381,654,346,693,328,734,314,800,300,868,291,992,286,992,291,869,296,801,305,735,319,695,333,657,350,594,386"/>
<area shape="poly" title=" " alt="" coords="604,381,644,359,685,331,699,315,707,301,717,286,733,271,753,258,756,263,736,275,721,289,712,303,703,318,688,335,647,364,607,386"/>
<area shape="poly" title=" " alt="" coords="609,416,735,468,771,482,769,487,733,473,607,421"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6b6c429265d86411d05951d2fae7289a" title=" " alt="" coords="741,329,916,363"/>
<area shape="poly" title=" " alt="" coords="649,381,728,364,729,369,650,386"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a2c4753820a7472bba7b999fbba79df01" title=" " alt="" coords="1013,700,1154,734"/>
<area shape="poly" title=" " alt="" coords="687,393,748,398,811,412,872,437,900,454,925,475,944,500,952,526,953,552,951,578,948,603,949,629,956,654,973,679,1000,698,997,703,969,683,951,656,943,630,943,603,945,577,948,552,947,527,939,503,921,479,896,458,869,441,810,417,747,404,686,398"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a131936c081164c18e6241d79f3b276d1" title=" " alt="" coords="971,360,1196,394"/>
<area shape="poly" title=" " alt="" coords="687,392,955,380,955,385,687,398"/>
<area shape="poly" title=" " alt="" coords="1154,699,1274,673,1275,678,1155,704"/>
<area shape="poly" title=" " alt="" coords="1125,357,1160,340,1194,319,1218,296,1228,285,1243,273,1268,260,1270,265,1245,278,1231,289,1222,299,1198,323,1162,344,1127,362"/>
<area shape="poly" title=" " alt="" coords="1196,373,1233,373,1233,378,1196,378"/>
<area shape="poly" title=" " alt="" coords="1145,357,1262,324,1263,329,1147,362"/>
<area shape="poly" title=" " alt="" coords="1166,392,1243,408,1242,413,1165,397"/>
<area shape="poly" title=" " alt="" coords="1102,392,1315,632,1311,635,1098,396"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a766dbc37dd9f160e1a3b8a9f19651b38" title=" " alt="" coords="491,649,638,683"/>
<area shape="poly" title=" " alt="" coords="371,616,478,643,477,648,369,621"/>
<area shape="poly" title=" " alt="" coords="395,125,448,125,448,130,395,130"/>
</map>
</div>

</div>
</div>
<a id="a8633a124e3a74b3317a273e2aaa6c207" name="a8633a124e3a74b3317a273e2aaa6c207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8633a124e3a74b3317a273e2aaa6c207">&#9670;&#160;</a></span>parseOCIhooks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parseOCIhooks </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01518">1518</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1519</span>{</div>
<div class="line"><span class="lineno"> 1520</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *tb[<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a0bdad5a576873f1be7eab59337d40892">__OCI_HOOKS_MAX</a>];</div>
<div class="line"><span class="lineno"> 1521</span>    <span class="keywordtype">int</span> ret;</div>
<div class="line"><span class="lineno"> 1522</span> </div>
<div class="line"><span class="lineno"> 1523</span>    <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#afb41c6cf00c1c377b5cfbad669347e5f">oci_hooks_policy</a>, <a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a0bdad5a576873f1be7eab59337d40892">__OCI_HOOKS_MAX</a>, tb, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(msg), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a>(msg));</div>
<div class="line"><span class="lineno"> 1524</span> </div>
<div class="line"><span class="lineno"> 1525</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266af862a8090db6d0f4c881c11e44f62f5c">OCI_HOOKS_PRESTART</a>])</div>
<div class="line"><span class="lineno"> 1526</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#ab56f6599fb46785e4265a3033ba91aa6">INFO</a>(<span class="stringliteral">&quot;warning: ignoring deprecated prestart hook\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1527</span> </div>
<div class="line"><span class="lineno"> 1528</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a7cbf2aaa3aff3ed3c5619f1586102654">OCI_HOOKS_CREATERUNTIME</a>]) {</div>
<div class="line"><span class="lineno"> 1529</span>        ret = <a class="code hl_function" href="#a75b0745dc9e409dbd1fd5a222db877ea">parseOCIhook</a>(&amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.createRuntime, tb[<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a7cbf2aaa3aff3ed3c5619f1586102654">OCI_HOOKS_CREATERUNTIME</a>]);</div>
<div class="line"><span class="lineno"> 1530</span>        <span class="keywordflow">if</span> (ret)</div>
<div class="line"><span class="lineno"> 1531</span>            <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno"> 1532</span>    }</div>
<div class="line"><span class="lineno"> 1533</span> </div>
<div class="line"><span class="lineno"> 1534</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a81b8b437bed6d97716be572758d636f7">OCI_HOOKS_CREATECONTAINER</a>]) {</div>
<div class="line"><span class="lineno"> 1535</span>        ret = <a class="code hl_function" href="#a75b0745dc9e409dbd1fd5a222db877ea">parseOCIhook</a>(&amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.createContainer, tb[<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a81b8b437bed6d97716be572758d636f7">OCI_HOOKS_CREATECONTAINER</a>]);</div>
<div class="line"><span class="lineno"> 1536</span>        <span class="keywordflow">if</span> (ret)</div>
<div class="line"><span class="lineno"> 1537</span>            <span class="keywordflow">goto</span> out_createruntime;</div>
<div class="line"><span class="lineno"> 1538</span>    }</div>
<div class="line"><span class="lineno"> 1539</span> </div>
<div class="line"><span class="lineno"> 1540</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a19b67b62f1e805e385a650b7a667ab2f">OCI_HOOKS_STARTCONTAINER</a>]) {</div>
<div class="line"><span class="lineno"> 1541</span>        ret = <a class="code hl_function" href="#a75b0745dc9e409dbd1fd5a222db877ea">parseOCIhook</a>(&amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.startContainer, tb[<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a19b67b62f1e805e385a650b7a667ab2f">OCI_HOOKS_STARTCONTAINER</a>]);</div>
<div class="line"><span class="lineno"> 1542</span>        <span class="keywordflow">if</span> (ret)</div>
<div class="line"><span class="lineno"> 1543</span>            <span class="keywordflow">goto</span> out_createcontainer;</div>
<div class="line"><span class="lineno"> 1544</span>    }</div>
<div class="line"><span class="lineno"> 1545</span> </div>
<div class="line"><span class="lineno"> 1546</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a81b23e202b544376a4150805e7032081">OCI_HOOKS_POSTSTART</a>]) {</div>
<div class="line"><span class="lineno"> 1547</span>        ret = <a class="code hl_function" href="#a75b0745dc9e409dbd1fd5a222db877ea">parseOCIhook</a>(&amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.poststart, tb[<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a81b23e202b544376a4150805e7032081">OCI_HOOKS_POSTSTART</a>]);</div>
<div class="line"><span class="lineno"> 1548</span>        <span class="keywordflow">if</span> (ret)</div>
<div class="line"><span class="lineno"> 1549</span>            <span class="keywordflow">goto</span> out_startcontainer;</div>
<div class="line"><span class="lineno"> 1550</span>    }</div>
<div class="line"><span class="lineno"> 1551</span> </div>
<div class="line"><span class="lineno"> 1552</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a038ea885ca857034d8682acb2ef0aa74">OCI_HOOKS_POSTSTOP</a>]) {</div>
<div class="line"><span class="lineno"> 1553</span>        ret = <a class="code hl_function" href="#a75b0745dc9e409dbd1fd5a222db877ea">parseOCIhook</a>(&amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.poststop, tb[<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a038ea885ca857034d8682acb2ef0aa74">OCI_HOOKS_POSTSTOP</a>]);</div>
<div class="line"><span class="lineno"> 1554</span>        <span class="keywordflow">if</span> (ret)</div>
<div class="line"><span class="lineno"> 1555</span>            <span class="keywordflow">goto</span> out_poststart;</div>
<div class="line"><span class="lineno"> 1556</span>    }</div>
<div class="line"><span class="lineno"> 1557</span> </div>
<div class="line"><span class="lineno"> 1558</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1559</span> </div>
<div class="line"><span class="lineno"> 1560</span>out_poststart:</div>
<div class="line"><span class="lineno"> 1561</span>    <a class="code hl_function" href="#a5127f557f43086299c2bf291618dcef5">free_hooklist</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.poststart);</div>
<div class="line"><span class="lineno"> 1562</span>out_startcontainer:</div>
<div class="line"><span class="lineno"> 1563</span>    <a class="code hl_function" href="#a5127f557f43086299c2bf291618dcef5">free_hooklist</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.startContainer);</div>
<div class="line"><span class="lineno"> 1564</span>out_createcontainer:</div>
<div class="line"><span class="lineno"> 1565</span>    <a class="code hl_function" href="#a5127f557f43086299c2bf291618dcef5">free_hooklist</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.createContainer);</div>
<div class="line"><span class="lineno"> 1566</span>out_createruntime:</div>
<div class="line"><span class="lineno"> 1567</span>    <a class="code hl_function" href="#a5127f557f43086299c2bf291618dcef5">free_hooklist</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.createRuntime);</div>
<div class="line"><span class="lineno"> 1568</span> </div>
<div class="line"><span class="lineno"> 1569</span>    <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno"> 1570</span>};</div>
<div class="ttc" id="ajail_8c_html_a75b0745dc9e409dbd1fd5a222db877ea"><div class="ttname"><a href="#a75b0745dc9e409dbd1fd5a222db877ea">parseOCIhook</a></div><div class="ttdeci">static int parseOCIhook(struct hook_execvpe ***hooklist, struct blob_attr *msg)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01432">jail.c:1432</a></div></div>
<div class="ttc" id="ajail_8c_html_afb41c6cf00c1c377b5cfbad669347e5f"><div class="ttname"><a href="#afb41c6cf00c1c377b5cfbad669347e5f">oci_hooks_policy</a></div><div class="ttdeci">static const struct blobmsg_policy oci_hooks_policy[]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01509">jail.c:1509</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l01506">__OCI_HOOKS_MAX</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00078">blobmsg_data()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00108">blobmsg_len()</a>, <a class="el" href="../../d1/d30/blobmsg_8c_source.html#l00166">blobmsg_parse()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00199">free_hooklist()</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00020">INFO</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01502">OCI_HOOKS_CREATECONTAINER</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01501">OCI_HOOKS_CREATERUNTIME</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01509">oci_hooks_policy</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01504">OCI_HOOKS_POSTSTART</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01505">OCI_HOOKS_POSTSTOP</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01500">OCI_HOOKS_PRESTART</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01503">OCI_HOOKS_STARTCONTAINER</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l01432">parseOCIhook()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02323">parseOCI()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a8633a124e3a74b3317a273e2aaa6c207_cgraph.png" border="0" usemap="#add/d26/jail_8c_a8633a124e3a74b3317a273e2aaa6c207_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a8633a124e3a74b3317a273e2aaa6c207_cgraph" id="add/d26/jail_8c_a8633a124e3a74b3317a273e2aaa6c207_cgraph">
<area shape="rect" title=" " alt="" coords="5,304,168,338"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="1218,241,1369,275"/>
<area shape="poly" title=" " alt="" coords="104,301,154,257,227,200,317,141,365,115,415,94,520,57,613,29,698,11,779,3,859,7,943,24,1033,54,1134,98,1178,126,1217,160,1249,195,1274,227,1270,230,1245,199,1213,164,1175,130,1132,103,1031,59,941,29,859,13,779,9,699,16,615,34,522,62,417,99,368,120,319,146,230,204,157,262,108,305"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5" title=" " alt="" coords="442,304,580,338"/>
<area shape="poly" title=" " alt="" coords="168,318,426,318,426,323,168,323"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed" title=" " alt="" coords="430,361,592,395"/>
<area shape="poly" title=" " alt="" coords="168,329,414,363,414,368,168,334"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5127f557f43086299c2bf291618dcef5" title=" " alt="" coords="442,419,580,452"/>
<area shape="poly" title=" " alt="" coords="140,336,216,360,427,414,426,419,215,365,138,341"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a75b0745dc9e409dbd1fd5a222db877ea" title=" " alt="" coords="216,249,368,283"/>
<area shape="poly" title=" " alt="" coords="152,301,210,285,212,290,153,306"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="1494,299,1605,332"/>
<area shape="poly" title=" " alt="" coords="1371,272,1479,297,1478,302,1369,278"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="1459,413,1640,447"/>
<area shape="poly" title=" " alt="" coords="1311,274,1370,335,1411,370,1456,400,1465,404,1462,409,1453,404,1408,374,1367,339,1307,277"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ac239a83ed3c7f835e2b49f785953c934" title=" " alt="" coords="1464,356,1635,390"/>
<area shape="poly" title=" " alt="" coords="1324,273,1383,307,1455,342,1470,348,1468,353,1453,347,1381,312,1321,278"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a7613e130753e766f5d381c06b1f7b86f" title=" " alt="" coords="1454,241,1645,275"/>
<area shape="poly" title=" " alt="" coords="1370,255,1439,255,1439,261,1370,261"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052" title=" " alt="" coords="945,296,1133,330"/>
<area shape="poly" title=" " alt="" coords="580,317,929,312,929,317,580,322"/>
<area shape="poly" title=" " alt="" coords="1120,293,1203,275,1204,280,1121,298"/>
<area shape="poly" title=" " alt="" coords="1133,311,1478,312,1478,318,1133,316"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a9921d2b89577d3344abbb66f24773e32" title=" " alt="" coords="1500,597,1599,631"/>
<area shape="poly" title=" " alt="" coords="1064,328,1099,356,1135,391,1158,424,1167,438,1183,453,1259,503,1340,543,1419,574,1486,595,1485,600,1417,579,1338,548,1256,508,1179,458,1163,442,1153,427,1131,395,1095,360,1061,332"/>
<area shape="poly" title=" " alt="" coords="592,371,1133,339,1478,317,1479,323,1133,345,593,376"/>
<area shape="poly" title=" " alt="" coords="593,393,607,404,622,423,629,441,631,478,634,514,641,531,655,548,713,594,767,626,820,645,874,653,931,652,991,644,1132,616,1187,601,1242,583,1347,539,1439,492,1507,453,1509,458,1441,497,1350,544,1244,588,1189,606,1134,621,992,650,931,657,874,658,819,650,765,631,709,599,651,552,637,534,629,516,626,479,624,443,617,425,603,408,589,398"/>
<area shape="poly" title=" " alt="" coords="569,358,605,348,699,316,773,290,847,267,944,245,1010,234,1062,230,1181,226,1294,221,1343,221,1407,226,1464,235,1463,240,1406,231,1343,227,1294,226,1181,231,1062,235,1011,240,945,250,848,272,774,295,701,322,606,353,571,363"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#ac79cacbc6a47f754832dc10bafa3b761" title=" " alt="" coords="995,572,1083,606"/>
<area shape="poly" title=" " alt="" coords="584,393,607,404,622,415,632,427,641,438,655,449,731,491,795,514,861,533,945,558,981,570,979,575,944,563,860,538,793,519,729,496,652,454,637,442,627,430,618,419,604,408,582,398"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5a5283071ac5677652515d9a8460e655" title=" " alt="" coords="653,405,897,439"/>
<area shape="poly" title=" " alt="" coords="593,389,656,400,655,405,592,394"/>
<area shape="poly" title=" " alt="" coords="788,403,814,375,851,341,895,307,944,281,1009,261,1077,250,1143,247,1203,247,1203,253,1144,252,1078,256,1010,266,946,286,897,312,854,345,818,379,792,407"/>
<area shape="poly" title=" " alt="" coords="817,402,981,334,983,338,819,407"/>
<area shape="poly" title=" " alt="" coords="802,437,898,512,921,537,946,559,981,574,979,579,943,563,918,541,895,516,799,441"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6b6c429265d86411d05951d2fae7289a" title=" " alt="" coords="952,405,1126,439"/>
<area shape="poly" title=" " alt="" coords="897,419,936,419,936,425,897,425"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a2c4753820a7472bba7b999fbba79df01" title=" " alt="" coords="968,515,1110,548"/>
<area shape="poly" title=" " alt="" coords="816,437,946,493,978,506,976,511,944,498,814,442"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a131936c081164c18e6241d79f3b276d1" title=" " alt="" coords="1181,409,1406,443"/>
<area shape="poly" title=" " alt="" coords="860,437,945,449,1039,454,1133,449,1183,443,1184,448,1133,454,1039,459,944,454,860,442"/>
<area shape="poly" title=" " alt="" coords="1111,544,1135,557,1151,577,1158,597,1166,615,1182,631,1219,646,1259,656,1299,660,1340,660,1419,650,1485,633,1486,639,1420,655,1341,665,1299,665,1258,661,1218,651,1180,635,1161,618,1153,599,1147,579,1131,561,1108,549"/>
<area shape="poly" title=" " alt="" coords="1355,406,1405,384,1419,373,1428,363,1438,352,1453,341,1478,330,1480,335,1456,346,1442,356,1432,366,1422,377,1408,388,1358,411"/>
<area shape="poly" title=" " alt="" coords="1407,425,1443,426,1443,431,1407,431"/>
<area shape="poly" title=" " alt="" coords="1377,406,1450,391,1451,396,1378,411"/>
<area shape="poly" title=" " alt="" coords="1308,407,1367,347,1408,313,1453,284,1462,279,1465,284,1456,288,1412,317,1371,351,1312,411"/>
<area shape="poly" title=" " alt="" coords="1320,441,1515,586,1512,590,1317,446"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a766dbc37dd9f160e1a3b8a9f19651b38" title=" " alt="" coords="701,681,849,715"/>
<area shape="poly" title=" " alt="" coords="520,452,537,494,565,550,605,609,628,636,655,660,688,678,686,683,652,664,625,640,600,613,561,553,532,496,515,454"/>
<area shape="poly" title=" " alt="" coords="309,247,354,210,384,193,415,180,471,165,528,154,645,143,762,144,876,155,983,172,1080,193,1228,234,1227,239,1079,198,982,177,876,160,762,150,645,148,529,159,472,170,417,185,386,198,357,215,313,251"/>
<area shape="poly" title=" " alt="" coords="363,281,427,297,426,302,362,286"/>
<area shape="poly" title=" " alt="" coords="316,281,361,315,417,348,429,353,427,358,415,352,358,319,313,286"/>
<area shape="poly" title=" " alt="" coords="306,282,349,342,381,376,417,405,429,412,426,416,415,410,377,380,345,346,301,285"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603" title=" " alt="" coords="673,195,877,228"/>
<area shape="poly" title=" " alt="" coords="368,259,480,251,605,238,667,229,668,234,606,243,481,256,369,265"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f" title=" " alt="" coords="682,85,868,119"/>
<area shape="poly" title=" " alt="" coords="302,247,346,190,378,160,415,136,477,112,543,99,607,92,667,91,667,97,608,98,543,104,478,118,417,140,381,164,349,194,306,250"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#adddfc616a062dd8a8ba8d4fbd3929cbe" title=" " alt="" coords="416,195,605,228"/>
<area shape="poly" title=" " alt="" coords="362,246,425,230,427,235,363,251"/>
<area shape="poly" title=" " alt="" coords="877,216,1133,237,1203,244,1202,250,1133,242,877,221"/>
<area shape="poly" title=" " alt="" coords="868,95,929,97,997,103,1067,115,1134,136,1173,155,1210,179,1267,228,1264,232,1206,183,1170,160,1132,141,1065,120,996,108,929,102,868,101"/>
<area shape="poly" title=" " alt="" coords="606,209,658,209,658,214,606,214"/>
</map>
</div>

</div>
</div>
<a id="a2c489687a19450a8f1a90ec2263c7a11" name="a2c489687a19450a8f1a90ec2263c7a11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c489687a19450a8f1a90ec2263c7a11">&#9670;&#160;</a></span>parseOCIlinux()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parseOCIlinux </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02198">2198</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2199</span>{</div>
<div class="line"><span class="lineno"> 2200</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002aa8e03afa65029fb9a01906fe0a12fb79">__OCI_LINUX_MAX</a>];</div>
<div class="line"><span class="lineno"> 2201</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *cur;</div>
<div class="line"><span class="lineno"> 2202</span>    <span class="keywordtype">int</span> rem;</div>
<div class="line"><span class="lineno"> 2203</span>    <span class="keywordtype">int</span> res = 0;</div>
<div class="line"><span class="lineno"> 2204</span>    <span class="keywordtype">char</span> *cgpath;</div>
<div class="line"><span class="lineno"> 2205</span>    <span class="keywordtype">char</span> cgfullpath[256] = <span class="stringliteral">&quot;/sys/fs/cgroup&quot;</span>;</div>
<div class="line"><span class="lineno"> 2206</span> </div>
<div class="line"><span class="lineno"> 2207</span>    <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#aaa2a41087e75522879f336667608dcf2">oci_linux_policy</a>, <a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002aa8e03afa65029fb9a01906fe0a12fb79">__OCI_LINUX_MAX</a>, tb, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(msg), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a>(msg));</div>
<div class="line"><span class="lineno"> 2208</span> </div>
<div class="line"><span class="lineno"> 2209</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a8a3a158fe5d2f0a652ef86cda72ab655">OCI_LINUX_NAMESPACES</a>]) {</div>
<div class="line"><span class="lineno"> 2210</span>        <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a8a3a158fe5d2f0a652ef86cda72ab655">OCI_LINUX_NAMESPACES</a>], rem) {</div>
<div class="line"><span class="lineno"> 2211</span>            res = <a class="code hl_function" href="#a78940dcf91ed274ccd9183c4ac526998">parseOCIlinuxns</a>(cur);</div>
<div class="line"><span class="lineno"> 2212</span>            <span class="keywordflow">if</span> (res)</div>
<div class="line"><span class="lineno"> 2213</span>                <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno"> 2214</span>        }</div>
<div class="line"><span class="lineno"> 2215</span>    }</div>
<div class="line"><span class="lineno"> 2216</span> </div>
<div class="line"><span class="lineno"> 2217</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a9d6ef21b01ed6532bff2ac2c28c5a075">OCI_LINUX_UIDMAPPINGS</a>]) {</div>
<div class="line"><span class="lineno"> 2218</span>        res = <a class="code hl_function" href="#a8ba489d2464ce8b1fb4a3ba5df1e22dc">parseOCIuidgidmappings</a>(tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a9d6ef21b01ed6532bff2ac2c28c5a075">OCI_LINUX_UIDMAPPINGS</a>], 0);</div>
<div class="line"><span class="lineno"> 2219</span>        <span class="keywordflow">if</span> (res)</div>
<div class="line"><span class="lineno"> 2220</span>            <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno"> 2221</span>    }</div>
<div class="line"><span class="lineno"> 2222</span> </div>
<div class="line"><span class="lineno"> 2223</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002afd9a8d6225d58630adfdd9b127bd2b75">OCI_LINUX_GIDMAPPINGS</a>]) {</div>
<div class="line"><span class="lineno"> 2224</span>        res = <a class="code hl_function" href="#a8ba489d2464ce8b1fb4a3ba5df1e22dc">parseOCIuidgidmappings</a>(tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002afd9a8d6225d58630adfdd9b127bd2b75">OCI_LINUX_GIDMAPPINGS</a>], 1);</div>
<div class="line"><span class="lineno"> 2225</span>        <span class="keywordflow">if</span> (res)</div>
<div class="line"><span class="lineno"> 2226</span>            <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno"> 2227</span>    }</div>
<div class="line"><span class="lineno"> 2228</span> </div>
<div class="line"><span class="lineno"> 2229</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a99685949d7e12300cde9533b69faec9d">OCI_LINUX_READONLYPATHS</a>]) {</div>
<div class="line"><span class="lineno"> 2230</span>        <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a99685949d7e12300cde9533b69faec9d">OCI_LINUX_READONLYPATHS</a>], rem) {</div>
<div class="line"><span class="lineno"> 2231</span>            res = <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2">add_mount</a>(NULL, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(cur), NULL, MS_BIND | MS_REC | MS_RDONLY, 0, NULL, 0);</div>
<div class="line"><span class="lineno"> 2232</span>            <span class="keywordflow">if</span> (res)</div>
<div class="line"><span class="lineno"> 2233</span>                <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno"> 2234</span>        }</div>
<div class="line"><span class="lineno"> 2235</span>    }</div>
<div class="line"><span class="lineno"> 2236</span> </div>
<div class="line"><span class="lineno"> 2237</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002af04b23cc25d65aa924674451e37742b5">OCI_LINUX_MASKEDPATHS</a>]) {</div>
<div class="line"><span class="lineno"> 2238</span>        <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002af04b23cc25d65aa924674451e37742b5">OCI_LINUX_MASKEDPATHS</a>], rem) {</div>
<div class="line"><span class="lineno"> 2239</span>            res = <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2">add_mount</a>((<span class="keywordtype">void</span> *)(-1), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(cur), NULL, 0, 0, NULL, 0);</div>
<div class="line"><span class="lineno"> 2240</span>            <span class="keywordflow">if</span> (res)</div>
<div class="line"><span class="lineno"> 2241</span>                <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno"> 2242</span>        }</div>
<div class="line"><span class="lineno"> 2243</span>    }</div>
<div class="line"><span class="lineno"> 2244</span> </div>
<div class="line"><span class="lineno"> 2245</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002ad9d5c35f112531b3441718b70580ad3b">OCI_LINUX_SYSCTL</a>]) {</div>
<div class="line"><span class="lineno"> 2246</span>        res = <a class="code hl_function" href="#a553876759c42a12a39f61a93d27b27ef">parseOCIsysctl</a>(tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002ad9d5c35f112531b3441718b70580ad3b">OCI_LINUX_SYSCTL</a>]);</div>
<div class="line"><span class="lineno"> 2247</span>        <span class="keywordflow">if</span> (res)</div>
<div class="line"><span class="lineno"> 2248</span>            <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno"> 2249</span>    }</div>
<div class="line"><span class="lineno"> 2250</span> </div>
<div class="line"><span class="lineno"> 2251</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002abaa0938b58a04b3660a37c8708610f7f">OCI_LINUX_SECCOMP</a>]) {</div>
<div class="line"><span class="lineno"> 2252</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ociseccomp = <a class="code hl_function" href="../../d8/da1/seccomp-oci_8c.html#ac693b398071b4ee41b25e6b9d117803c">parseOCIlinuxseccomp</a>(tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002abaa0938b58a04b3660a37c8708610f7f">OCI_LINUX_SECCOMP</a>]);</div>
<div class="line"><span class="lineno"> 2253</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ociseccomp)</div>
<div class="line"><span class="lineno"> 2254</span>            <span class="keywordflow">return</span> EINVAL;</div>
<div class="line"><span class="lineno"> 2255</span>    }</div>
<div class="line"><span class="lineno"> 2256</span> </div>
<div class="line"><span class="lineno"> 2257</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a1307500651c21f2451f25555fe3f45c9">OCI_LINUX_DEVICES</a>]) {</div>
<div class="line"><span class="lineno"> 2258</span>        res = <a class="code hl_function" href="#aba4a3f4d1a6a966987122b98d06e256f">parseOCIdevices</a>(tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a1307500651c21f2451f25555fe3f45c9">OCI_LINUX_DEVICES</a>]);</div>
<div class="line"><span class="lineno"> 2259</span>        <span class="keywordflow">if</span> (res)</div>
<div class="line"><span class="lineno"> 2260</span>            <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno"> 2261</span>    }</div>
<div class="line"><span class="lineno"> 2262</span> </div>
<div class="line"><span class="lineno"> 2263</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a4c337c6cf54ff1755a2cc9145bcb29ba">OCI_LINUX_CGROUPSPATH</a>]) {</div>
<div class="line"><span class="lineno"> 2264</span>        cgpath = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a4c337c6cf54ff1755a2cc9145bcb29ba">OCI_LINUX_CGROUPSPATH</a>]);</div>
<div class="line"><span class="lineno"> 2265</span>        <span class="keywordflow">if</span> (cgpath[0] == <span class="charliteral">&#39;/&#39;</span>) {</div>
<div class="line"><span class="lineno"> 2266</span>            <span class="keywordflow">if</span> (strlen(cgpath) + 1 &gt;= (<span class="keyword">sizeof</span>(cgfullpath) - strlen(cgfullpath)))</div>
<div class="line"><span class="lineno"> 2267</span>                <span class="keywordflow">return</span> E2BIG;</div>
<div class="line"><span class="lineno"> 2268</span> </div>
<div class="line"><span class="lineno"> 2269</span>            strcat(cgfullpath, cgpath);</div>
<div class="line"><span class="lineno"> 2270</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2271</span>            strcat(cgfullpath, <span class="stringliteral">&quot;/containers/&quot;</span>);</div>
<div class="line"><span class="lineno"> 2272</span>            <span class="keywordflow">if</span> (strlen(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.name) + strlen(cgpath) + 2 &gt;= (<span class="keyword">sizeof</span>(cgfullpath) - strlen(cgfullpath)))</div>
<div class="line"><span class="lineno"> 2273</span>                <span class="keywordflow">return</span> E2BIG;</div>
<div class="line"><span class="lineno"> 2274</span> </div>
<div class="line"><span class="lineno"> 2275</span>            strcat(cgfullpath, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.name); <span class="comment">/* should be container name rather than jail name */</span></div>
<div class="line"><span class="lineno"> 2276</span>            strcat(cgfullpath, <span class="stringliteral">&quot;/&quot;</span>);</div>
<div class="line"><span class="lineno"> 2277</span>            strcat(cgfullpath, cgpath);</div>
<div class="line"><span class="lineno"> 2278</span>        }</div>
<div class="line"><span class="lineno"> 2279</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2280</span>        strcat(cgfullpath, <span class="stringliteral">&quot;/containers/&quot;</span>);</div>
<div class="line"><span class="lineno"> 2281</span>        <span class="keywordflow">if</span> (2 * strlen(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.name) + 2 &gt;= (<span class="keyword">sizeof</span>(cgfullpath) - strlen(cgfullpath)))</div>
<div class="line"><span class="lineno"> 2282</span>            <span class="keywordflow">return</span> E2BIG;</div>
<div class="line"><span class="lineno"> 2283</span> </div>
<div class="line"><span class="lineno"> 2284</span>        strcat(cgfullpath, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.name); <span class="comment">/* should be container name rather than jail name */</span></div>
<div class="line"><span class="lineno"> 2285</span>        strcat(cgfullpath, <span class="stringliteral">&quot;/&quot;</span>);</div>
<div class="line"><span class="lineno"> 2286</span>        strcat(cgfullpath, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.name); <span class="comment">/* should be container instance name rather than jail name */</span></div>
<div class="line"><span class="lineno"> 2287</span>    }</div>
<div class="line"><span class="lineno"> 2288</span> </div>
<div class="line"><span class="lineno"> 2289</span>    <a class="code hl_function" href="../../db/d40/cgroups_8c.html#a6edb1973984f6c2bb76124150b29e7d2">cgroups_init</a>(cgfullpath);</div>
<div class="line"><span class="lineno"> 2290</span> </div>
<div class="line"><span class="lineno"> 2291</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a6ed87e24d333274bcf07394e12eb0334">OCI_LINUX_RESOURCES</a>]) {</div>
<div class="line"><span class="lineno"> 2292</span>        res = <a class="code hl_function" href="../../db/d40/cgroups_8c.html#a3b4929a62218f8af6eddf6408480c60f">parseOCIlinuxcgroups</a>(tb[<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a6ed87e24d333274bcf07394e12eb0334">OCI_LINUX_RESOURCES</a>]);</div>
<div class="line"><span class="lineno"> 2293</span>        <span class="keywordflow">if</span> (res)</div>
<div class="line"><span class="lineno"> 2294</span>            <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno"> 2295</span>    }</div>
<div class="line"><span class="lineno"> 2296</span> </div>
<div class="line"><span class="lineno"> 2297</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2298</span>}</div>
<div class="ttc" id="acgroups_8c_html_a3b4929a62218f8af6eddf6408480c60f"><div class="ttname"><a href="../../db/d40/cgroups_8c.html#a3b4929a62218f8af6eddf6408480c60f">parseOCIlinuxcgroups</a></div><div class="ttdeci">int parseOCIlinuxcgroups(struct blob_attr *msg)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d40/cgroups_8c_source.html#l00813">cgroups.c:813</a></div></div>
<div class="ttc" id="acgroups_8c_html_a6edb1973984f6c2bb76124150b29e7d2"><div class="ttname"><a href="../../db/d40/cgroups_8c.html#a6edb1973984f6c2bb76124150b29e7d2">cgroups_init</a></div><div class="ttdeci">void cgroups_init(const char *p)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d40/cgroups_8c_source.html#l00062">cgroups.c:62</a></div></div>
<div class="ttc" id="afs_8c_html_a16e2b60a1b30b2a7791960d7c8ce15b2"><div class="ttname"><a href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2">add_mount</a></div><div class="ttdeci">int add_mount(const char *source, const char *target, const char *filesystemtype, unsigned long mountflags, unsigned long propflags, const char *optstr, int error)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00197">fs.c:197</a></div></div>
<div class="ttc" id="ajail_8c_html_a553876759c42a12a39f61a93d27b27ef"><div class="ttname"><a href="#a553876759c42a12a39f61a93d27b27ef">parseOCIsysctl</a></div><div class="ttdeci">static int parseOCIsysctl(struct blob_attr *msg)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02125">jail.c:2125</a></div></div>
<div class="ttc" id="ajail_8c_html_a78940dcf91ed274ccd9183c4ac526998"><div class="ttname"><a href="#a78940dcf91ed274ccd9183c4ac526998">parseOCIlinuxns</a></div><div class="ttdeci">static int parseOCIlinuxns(struct blob_attr *msg)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01830">jail.c:1830</a></div></div>
<div class="ttc" id="ajail_8c_html_a8ba489d2464ce8b1fb4a3ba5df1e22dc"><div class="ttname"><a href="#a8ba489d2464ce8b1fb4a3ba5df1e22dc">parseOCIuidgidmappings</a></div><div class="ttdeci">static int parseOCIuidgidmappings(struct blob_attr *msg, bool is_gidmap)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01964">jail.c:1964</a></div></div>
<div class="ttc" id="ajail_8c_html_aaa2a41087e75522879f336667608dcf2"><div class="ttname"><a href="#aaa2a41087e75522879f336667608dcf2">oci_linux_policy</a></div><div class="ttdeci">static const struct blobmsg_policy oci_linux_policy[]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02184">jail.c:2184</a></div></div>
<div class="ttc" id="ajail_8c_html_aba4a3f4d1a6a966987122b98d06e256f"><div class="ttname"><a href="#aba4a3f4d1a6a966987122b98d06e256f">parseOCIdevices</a></div><div class="ttdeci">static int parseOCIdevices(struct blob_attr *msg)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02053">jail.c:2053</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_ac693b398071b4ee41b25e6b9d117803c"><div class="ttname"><a href="../../d8/da1/seccomp-oci_8c.html#ac693b398071b4ee41b25e6b9d117803c">parseOCIlinuxseccomp</a></div><div class="ttdeci">struct sock_fprog * parseOCIlinuxseccomp(struct blob_attr *msg)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00199">seccomp-oci.c:199</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l02181">__OCI_LINUX_MAX</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00197">add_mount()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00078">blobmsg_data()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00364">blobmsg_for_each_attr</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00348">blobmsg_get_string()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00108">blobmsg_len()</a>, <a class="el" href="../../d1/d30/blobmsg_8c_source.html#l00166">blobmsg_parse()</a>, <a class="el" href="../../db/d40/cgroups_8c_source.html#l00062">cgroups_init()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02170">OCI_LINUX_CGROUPSPATH</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02175">OCI_LINUX_DEVICES</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02177">OCI_LINUX_GIDMAPPINGS</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02178">OCI_LINUX_MASKEDPATHS</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02174">OCI_LINUX_NAMESPACES</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02184">oci_linux_policy</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02179">OCI_LINUX_READONLYPATHS</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02171">OCI_LINUX_RESOURCES</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02172">OCI_LINUX_SECCOMP</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02173">OCI_LINUX_SYSCTL</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02176">OCI_LINUX_UIDMAPPINGS</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02053">parseOCIdevices()</a>, <a class="el" href="../../db/d40/cgroups_8c_source.html#l00813">parseOCIlinuxcgroups()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01830">parseOCIlinuxns()</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00199">parseOCIlinuxseccomp()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02125">parseOCIsysctl()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l01964">parseOCIuidgidmappings()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02323">parseOCI()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a2c489687a19450a8f1a90ec2263c7a11_cgraph.png" border="0" usemap="#add/d26/jail_8c_a2c489687a19450a8f1a90ec2263c7a11_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a2c489687a19450a8f1a90ec2263c7a11_cgraph" id="add/d26/jail_8c_a2c489687a19450a8f1a90ec2263c7a11_cgraph">
<area shape="rect" title=" " alt="" coords="5,804,158,838"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2" title=" " alt="" coords="256,5,382,39"/>
<area shape="poly" title=" " alt="" coords="81,804,87,661,105,437,121,318,142,209,169,119,185,83,204,56,221,42,240,32,243,37,224,46,208,60,190,86,174,121,147,211,126,319,110,437,92,661,86,804"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="1564,724,1716,758"/>
<area shape="poly" title=" " alt="" coords="83,803,97,740,122,642,161,524,214,397,247,335,284,276,326,221,372,173,423,132,479,101,541,81,607,74,1160,74,1273,79,1321,87,1364,100,1403,119,1442,146,1479,182,1518,227,1558,287,1588,353,1610,422,1625,491,1635,557,1640,617,1642,708,1637,708,1635,618,1630,558,1620,492,1605,424,1583,355,1553,290,1514,230,1476,185,1438,150,1401,124,1362,105,1320,92,1273,84,1160,79,607,79,542,86,481,106,426,137,375,177,330,225,288,279,252,338,219,399,166,525,127,644,102,741,89,804"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603" title=" " alt="" coords="785,1093,989,1127"/>
<area shape="poly" title=" " alt="" coords="88,837,101,926,126,1052,142,1116,161,1174,183,1220,207,1249,240,1260,301,1267,469,1272,638,1265,701,1258,736,1249,753,1237,762,1223,770,1207,783,1188,847,1134,850,1138,787,1192,774,1209,766,1226,756,1241,738,1254,702,1263,639,1270,469,1277,301,1273,239,1265,204,1254,179,1223,156,1176,137,1118,120,1053,96,927,82,838"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5" title=" " alt="" coords="818,873,956,907"/>
<area shape="poly" title=" " alt="" coords="98,836,152,899,240,986,293,1031,352,1074,415,1111,481,1140,554,1165,615,1179,644,1180,673,1174,703,1161,736,1140,753,1123,762,1106,766,1088,766,1068,767,1026,772,1003,783,979,813,943,846,914,849,918,816,947,788,982,777,1005,772,1027,772,1069,771,1088,767,1108,757,1127,739,1144,706,1166,674,1179,644,1185,614,1185,552,1170,479,1145,413,1116,349,1078,290,1035,236,990,148,903,94,840"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed" title=" " alt="" coords="806,797,968,831"/>
<area shape="poly" title=" " alt="" coords="158,820,415,823,737,820,790,817,790,823,737,825,415,828,158,825"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#a6edb1973984f6c2bb76124150b29e7d2" title=" " alt="" coords="252,776,386,810"/>
<area shape="poly" title=" " alt="" coords="157,809,236,800,237,805,158,815"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#aba4a3f4d1a6a966987122b98d06e256f" title=" " alt="" coords="520,295,697,328"/>
<area shape="poly" title=" " alt="" coords="84,803,98,754,122,685,157,608,179,571,204,537,267,464,325,416,391,378,479,337,504,328,506,333,481,342,394,382,328,420,271,468,208,540,183,574,162,611,127,687,103,755,89,804"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#a3b4929a62218f8af6eddf6408480c60f" title=" " alt="" coords="206,701,432,735"/>
<area shape="poly" title=" " alt="" coords="118,801,205,761,258,739,260,744,207,766,120,806"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a78940dcf91ed274ccd9183c4ac526998" title=" " alt="" coords="522,1365,696,1399"/>
<area shape="poly" title=" " alt="" coords="87,838,97,945,119,1103,135,1184,155,1257,179,1317,193,1339,207,1355,243,1379,282,1396,323,1406,366,1412,451,1411,526,1400,527,1405,452,1416,366,1417,322,1412,280,1401,240,1383,204,1359,189,1342,175,1319,150,1259,130,1185,114,1103,92,945,81,839"/>
<area shape="rect" href="../../d8/da1/seccomp-oci_8c.html#ac693b398071b4ee41b25e6b9d117803c" title=" " alt="" coords="492,1205,726,1239"/>
<area shape="poly" title=" " alt="" coords="85,838,89,905,104,1000,119,1052,141,1101,170,1146,207,1184,240,1206,276,1222,315,1233,354,1240,433,1244,505,1239,505,1244,433,1249,353,1245,313,1238,275,1227,238,1210,204,1188,166,1150,136,1104,114,1053,99,1002,83,906,80,838"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a553876759c42a12a39f61a93d27b27ef" title=" " alt="" coords="239,1311,399,1344"/>
<area shape="poly" title=" " alt="" coords="88,837,102,931,127,1067,144,1137,163,1201,185,1254,208,1290,227,1304,223,1309,204,1293,180,1257,158,1203,139,1139,122,1068,96,932,82,838"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a8ba489d2464ce8b1fb4a3ba5df1e22dc" title=" " alt="" coords="480,352,737,386"/>
<area shape="poly" title=" " alt="" coords="93,802,147,732,235,629,289,572,349,515,412,462,479,415,531,389,533,394,481,419,415,466,352,519,293,576,239,632,151,735,97,805"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a6a335418ee05d0ecbda2094c55408404" title=" " alt="" coords="542,5,676,39"/>
<area shape="poly" title=" " alt="" coords="382,20,526,20,526,25,382,25"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="1803,899,1915,932"/>
<area shape="poly" title=" " alt="" coords="1665,756,1826,887,1823,891,1661,760"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="1768,1128,1950,1162"/>
<area shape="poly" title=" " alt="" coords="1653,757,1843,1113,1839,1115,1648,759"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ac239a83ed3c7f835e2b49f785953c934" title=" " alt="" coords="1774,724,1944,758"/>
<area shape="poly" title=" " alt="" coords="1716,738,1758,738,1758,744,1716,744"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a7613e130753e766f5d381c06b1f7b86f" title=" " alt="" coords="1764,645,1954,679"/>
<area shape="poly" title=" " alt="" coords="1688,721,1795,682,1797,687,1690,726"/>
<area shape="poly" title=" " alt="" coords="989,1116,1126,1124,1281,1124,1355,1120,1421,1112,1476,1099,1515,1080,1548,1049,1575,1011,1596,969,1611,925,1629,840,1635,773,1641,774,1635,841,1616,927,1601,971,1580,1014,1552,1052,1518,1084,1478,1104,1422,1117,1355,1126,1281,1130,1126,1129,989,1121"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052" title=" " alt="" coords="1328,899,1516,932"/>
<area shape="poly" title=" " alt="" coords="956,891,1313,908,1313,913,956,896"/>
<area shape="poly" title=" " alt="" coords="1480,896,1515,877,1546,852,1574,824,1617,769,1621,772,1578,827,1549,856,1518,882,1482,900"/>
<area shape="poly" title=" " alt="" coords="1517,913,1788,913,1788,918,1517,918"/>
<area shape="poly" title=" " alt="" coords="928,829,990,858,1013,872,1038,884,1167,924,1221,936,1272,943,1379,947,1516,942,1661,933,1787,921,1788,926,1662,938,1516,947,1379,952,1272,949,1220,941,1166,930,1036,889,1011,877,987,863,926,834"/>
<area shape="poly" title=" " alt="" coords="944,829,968,842,991,859,1007,883,1014,907,1021,929,1038,950,1123,1005,1216,1049,1314,1083,1412,1108,1509,1125,1600,1136,1753,1144,1752,1149,1600,1141,1508,1130,1411,1113,1312,1088,1214,1054,1121,1010,1035,953,1016,931,1009,908,1003,885,987,863,965,847,941,834"/>
<area shape="poly" title=" " alt="" coords="968,799,1748,677,1749,682,969,804"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#ac79cacbc6a47f754832dc10bafa3b761" title=" " alt="" coords="1379,789,1466,823"/>
<area shape="poly" title=" " alt="" coords="969,810,1363,804,1363,810,969,816"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5a5283071ac5677652515d9a8460e655" title=" " alt="" coords="1037,840,1280,874"/>
<area shape="poly" title=" " alt="" coords="969,824,1032,834,1032,840,968,830"/>
<area shape="poly" title=" " alt="" coords="1281,864,1337,864,1397,860,1457,850,1515,833,1543,820,1568,803,1611,767,1614,771,1572,807,1545,825,1517,838,1458,855,1397,865,1337,869,1281,870"/>
<area shape="poly" title=" " alt="" coords="1238,872,1329,892,1328,897,1237,877"/>
<area shape="poly" title=" " alt="" coords="1249,837,1362,815,1364,820,1250,842"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#af44d4960ede7f23f071bf00e360bc23d" title=" " alt="" coords="844,427,930,460"/>
<area shape="poly" title=" " alt="" coords="385,776,410,764,430,746,443,726,451,707,458,669,455,630,447,592,440,554,439,517,450,481,462,464,478,447,504,433,541,424,586,420,636,419,739,424,828,433,828,438,739,429,636,424,586,425,542,429,506,438,482,451,466,467,455,484,444,518,445,554,452,591,460,630,463,669,456,709,448,729,434,749,413,768,387,781"/>
<area shape="rect" href="../../d2/d66/avl-cmp_8c.html#ae22a4fecfc8234279efe5ce4f38838f0" title=" " alt="" coords="548,1096,669,1130"/>
<area shape="poly" title=" " alt="" coords="327,809,343,863,373,937,394,977,419,1016,448,1051,482,1081,506,1095,534,1104,532,1109,504,1100,478,1086,444,1055,415,1019,389,980,368,940,338,865,322,811"/>
<area shape="poly" title=" " alt="" coords="628,292,694,244,738,219,785,201,841,188,886,185,932,190,989,201,1152,230,1219,244,1280,261,1338,284,1396,316,1455,361,1518,420,1546,454,1570,492,1605,572,1626,648,1637,708,1632,709,1621,649,1600,573,1565,494,1542,457,1514,424,1451,365,1393,320,1336,289,1279,266,1218,249,1151,236,988,206,931,195,886,190,842,193,786,206,740,224,697,248,631,296"/>
<area shape="poly" title=" " alt="" coords="699,313,721,322,739,338,754,359,765,387,778,453,783,533,782,619,777,790,779,863,788,919,804,964,825,1008,867,1079,863,1082,821,1010,799,966,783,920,774,863,772,790,777,619,778,533,773,454,760,388,749,362,735,341,718,327,696,318"/>
<area shape="poly" title=" " alt="" coords="699,313,721,323,739,338,752,357,761,381,770,441,771,512,768,589,764,666,764,738,770,798,777,823,787,842,811,864,808,868,783,845,772,825,765,799,758,738,759,666,762,589,766,512,765,441,756,382,747,359,735,341,718,327,697,318"/>
<area shape="poly" title=" " alt="" coords="699,314,720,323,739,338,769,380,783,421,786,461,781,501,774,542,770,586,773,632,788,683,803,711,821,739,859,784,855,788,817,742,798,714,783,684,768,633,765,586,769,542,776,500,780,461,778,422,765,382,735,341,718,328,697,319"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f" title=" " alt="" coords="1066,477,1251,511"/>
<area shape="poly" title=" " alt="" coords="698,314,764,321,838,333,915,351,990,376,1029,395,1067,418,1128,465,1125,469,1064,423,1027,400,988,381,914,356,837,338,763,326,698,319"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#abbfe748be98e9279f2002f167442f9b2" title=" " alt="" coords="801,216,973,250"/>
<area shape="poly" title=" " alt="" coords="670,291,810,252,811,257,672,297"/>
<area shape="poly" title=" " alt="" coords="1251,479,1314,477,1384,482,1453,498,1487,511,1518,528,1541,546,1562,567,1594,616,1618,666,1633,708,1628,710,1613,668,1590,619,1557,571,1537,550,1515,532,1484,516,1452,503,1383,487,1314,482,1251,484"/>
<area shape="poly" title=" " alt="" coords="319,701,329,625,354,514,375,452,401,390,436,332,478,280,527,234,572,198,616,171,660,151,708,138,760,130,886,125,1160,125,1223,128,1277,137,1324,153,1366,175,1404,204,1440,239,1518,333,1550,379,1576,430,1596,483,1612,537,1631,635,1640,708,1634,709,1626,636,1606,538,1591,485,1571,432,1545,382,1514,336,1436,243,1400,208,1363,179,1322,157,1276,142,1223,133,1160,130,886,130,760,135,709,143,662,156,618,175,575,202,530,238,482,284,440,335,406,393,379,454,359,515,334,626,324,701"/>
<area shape="poly" title=" " alt="" coords="393,733,415,745,434,762,450,787,457,813,454,863,452,887,454,909,463,931,482,951,524,975,572,986,622,987,672,979,721,966,767,949,843,913,845,917,769,954,723,971,673,985,622,992,571,991,523,980,478,955,458,934,449,911,447,887,449,863,451,813,445,789,430,765,412,750,390,738"/>
<area shape="poly" title=" " alt="" coords="356,698,429,670,525,645,579,638,633,636,687,643,738,658,781,683,817,716,847,751,870,783,865,786,843,754,814,720,778,688,736,663,686,648,633,642,579,643,526,650,430,675,358,703"/>
<area shape="rect" href="../../d3/dd8/cgroups-bpf_8c.html#abeafda4e224ee582cbbb0cfb41842ef4" title=" " alt="" coords="496,673,722,729"/>
<area shape="poly" title=" " alt="" coords="432,709,480,706,480,711,433,714"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#a07346cecb29af69b052bb73bb04387e5" title=" " alt="" coords="496,461,722,517"/>
<area shape="poly" title=" " alt="" coords="328,699,351,664,385,618,428,570,478,528,487,522,490,527,482,532,432,573,389,621,355,667,332,702"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#a513d245ee2d1e17e4bb8de92340f0446" title=" " alt="" coords="496,754,722,811"/>
<area shape="poly" title=" " alt="" coords="399,733,481,751,480,756,398,738"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#abccb79c84fdb64cf0470f28fac0c4698" title=" " alt="" coords="496,885,722,941"/>
<area shape="poly" title=" " alt="" coords="380,733,407,745,434,761,450,776,459,790,468,805,482,820,550,874,547,878,478,824,464,808,455,793,445,780,430,766,405,750,378,738"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#a9c348dca47565d5e6a785b7f308832aa" title=" " alt="" coords="496,542,722,599"/>
<area shape="poly" title=" " alt="" coords="343,698,403,658,479,614,506,602,508,607,481,619,406,662,346,703"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#a077d69588e2141099157a98ebbfac45d" title=" " alt="" coords="496,1015,722,1072"/>
<area shape="poly" title=" " alt="" coords="394,733,416,745,434,762,453,793,461,823,461,852,458,881,455,909,456,938,463,966,482,995,491,1004,487,1008,478,999,458,968,450,938,450,909,453,880,456,852,456,823,448,795,430,765,412,749,391,738"/>
<area shape="poly" title=" " alt="" coords="722,701,1077,712,1516,730,1549,732,1549,737,1516,735,1076,717,722,706"/>
<area shape="poly" title=" " alt="" coords="724,728,739,740,757,762,767,783,774,824,776,868,780,892,788,919,829,1007,869,1078,865,1081,824,1009,783,920,774,893,770,868,769,825,762,785,752,765,735,744,721,732"/>
<area shape="poly" title=" " alt="" coords="722,728,739,740,758,766,765,791,771,816,787,842,819,864,816,868,783,845,766,819,760,793,753,768,735,744,719,732"/>
<area shape="poly" title=" " alt="" coords="705,727,738,740,841,787,839,792,736,745,703,732"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a8f13b26eaebcdf626e534b33f887925c" title=" " alt="" coords="790,637,984,671"/>
<area shape="poly" title=" " alt="" coords="722,679,774,670,775,676,723,684"/>
<area shape="poly" title=" " alt="" coords="916,634,1113,517,1116,522,919,639"/>
<area shape="poly" title=" " alt="" coords="723,499,881,521,1082,557,1301,607,1411,638,1517,673,1561,692,1600,713,1597,718,1558,697,1515,678,1409,643,1300,612,1081,562,881,526,722,504"/>
<area shape="poly" title=" " alt="" coords="724,514,739,528,765,569,774,608,773,647,766,685,760,723,758,762,765,801,787,842,812,864,809,868,783,845,760,803,752,762,754,723,761,684,768,647,769,609,760,571,735,532,720,518"/>
<area shape="poly" title=" " alt="" coords="724,516,739,528,755,547,764,566,770,602,774,640,778,660,788,682,823,738,861,784,857,787,819,741,783,685,773,662,768,640,765,602,759,567,750,550,735,532,721,520"/>
<area shape="poly" title=" " alt="" coords="722,468,828,450,829,456,723,473"/>
<area shape="poly" title=" " alt="" coords="722,487,1050,490,1050,496,722,493"/>
<area shape="poly" title=" " alt="" coords="712,515,739,528,787,566,856,625,853,629,784,570,736,532,710,520"/>
<area shape="poly" title=" " alt="" coords="722,775,1549,742,1549,747,722,780"/>
<area shape="poly" title=" " alt="" coords="661,809,701,837,739,871,783,924,821,981,874,1079,869,1081,816,984,779,927,735,875,698,841,658,813"/>
<area shape="poly" title=" " alt="" coords="685,809,828,865,826,870,683,814"/>
<area shape="poly" title=" " alt="" coords="722,793,791,800,790,806,722,798"/>
<area shape="poly" title=" " alt="" coords="706,751,736,738,795,708,846,677,849,682,797,713,738,743,708,756"/>
<area shape="poly" title=" " alt="" coords="691,939,763,961,852,984,954,1004,1065,1018,1180,1023,1297,1014,1354,1003,1409,988,1463,968,1515,943,1538,927,1558,907,1590,861,1613,813,1628,772,1633,773,1618,815,1595,864,1562,911,1541,931,1518,947,1466,973,1411,993,1355,1009,1297,1019,1180,1028,1064,1024,953,1010,851,989,761,966,689,944"/>
<area shape="poly" title=" " alt="" coords="722,901,802,894,802,900,722,906"/>
<area shape="poly" title=" " alt="" coords="690,881,822,834,823,839,692,886"/>
<area shape="poly" title=" " alt="" coords="723,581,1078,631,1297,666,1517,708,1560,717,1558,722,1516,713,1296,671,1077,636,722,586"/>
<area shape="poly" title=" " alt="" coords="669,597,707,624,739,659,753,685,760,709,762,754,764,797,772,819,787,842,815,864,811,868,783,845,767,821,759,798,756,754,755,710,748,687,735,662,703,628,666,601"/>
<area shape="poly" title=" " alt="" coords="709,597,739,615,756,631,766,646,788,682,865,784,861,787,783,685,762,649,752,634,736,619,706,601"/>
<area shape="poly" title=" " alt="" coords="706,597,815,630,813,635,704,602"/>
<area shape="poly" title=" " alt="" coords="723,1068,799,1087,798,1092,721,1073"/>
<area shape="poly" title=" " alt="" coords="696,1366,906,1332,1164,1284,1287,1258,1393,1233,1472,1208,1498,1196,1514,1186,1536,1155,1556,1110,1574,1054,1591,992,1616,868,1632,772,1637,773,1621,869,1596,993,1580,1056,1561,1112,1541,1158,1518,1189,1501,1201,1474,1213,1394,1238,1288,1264,1165,1289,907,1337,697,1371"/>
<area shape="poly" title=" " alt="" coords="695,1368,717,1358,735,1344,750,1326,758,1308,763,1271,765,1232,771,1211,783,1189,810,1158,841,1134,844,1138,814,1162,788,1192,776,1213,771,1233,768,1272,764,1310,755,1329,739,1348,720,1363,698,1373"/>
<area shape="poly" title=" " alt="" coords="631,1363,684,1316,711,1284,735,1250,755,1206,763,1168,768,1128,783,1080,824,991,865,919,869,922,829,994,788,1082,774,1129,768,1168,760,1207,740,1253,716,1288,687,1319,635,1367"/>
<area shape="poly" title=" " alt="" coords="633,1363,687,1316,714,1285,735,1250,754,1195,760,1144,756,1096,748,1050,742,1005,742,959,754,911,783,859,808,837,812,841,787,862,759,913,748,960,748,1005,754,1050,761,1096,765,1144,760,1196,740,1253,718,1288,691,1320,637,1367"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a3aa34193a0ba95da6ede6aa8e16d726f" title=" " alt="" coords="790,1427,984,1460"/>
<area shape="poly" title=" " alt="" coords="689,1397,793,1420,792,1425,688,1402"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a259f820c79f4b101ce41e26167ace63f" title=" " alt="" coords="807,1369,967,1403"/>
<area shape="poly" title=" " alt="" coords="697,1381,792,1382,792,1387,696,1386"/>
<area shape="poly" title=" " alt="" coords="696,1202,785,1188,858,1183,950,1183,1164,1187,1272,1185,1371,1176,1454,1157,1488,1144,1515,1127,1552,1089,1580,1045,1602,996,1617,945,1627,895,1633,848,1637,773,1642,773,1639,849,1633,896,1622,947,1607,998,1585,1048,1556,1093,1518,1131,1490,1148,1456,1162,1372,1181,1272,1190,1164,1192,950,1189,858,1188,786,1193,697,1207"/>
<area shape="poly" title=" " alt="" coords="690,1202,736,1184,750,1174,760,1165,784,1144,811,1131,814,1135,787,1148,763,1168,754,1178,739,1189,692,1207"/>
<area shape="poly" title=" " alt="" coords="708,1203,736,1184,750,1167,759,1150,766,1116,769,1079,783,1036,821,971,860,918,864,921,825,974,788,1038,775,1080,771,1117,764,1152,755,1170,739,1188,711,1207"/>
<area shape="poly" title=" " alt="" coords="655,1202,698,1177,718,1161,735,1141,754,1103,761,1068,761,1034,756,1000,752,966,753,932,762,897,783,859,809,836,813,841,787,863,767,899,758,933,758,966,762,999,766,1033,766,1068,759,1105,740,1144,722,1164,701,1182,657,1207"/>
<area shape="poly" title=" " alt="" coords="705,1203,736,1184,754,1160,762,1135,767,1109,783,1079,810,1050,836,1028,887,999,936,969,961,947,986,918,1017,856,1061,744,1143,525,1148,526,1066,746,1021,858,991,921,965,951,939,973,889,1003,839,1033,814,1054,788,1082,772,1111,767,1137,759,1162,739,1188,708,1207"/>
<area shape="poly" title=" " alt="" coords="656,1202,699,1177,719,1161,735,1141,759,1093,770,1050,772,1009,768,969,763,928,761,884,767,837,783,784,798,754,816,726,855,681,859,684,821,730,802,757,788,786,772,838,767,884,769,927,773,968,777,1009,775,1051,764,1095,740,1144,723,1164,702,1182,658,1207"/>
<area shape="rect" href="../../d1/da1/seccomp-syscalls-helpers_8h.html#a36bb0594e5fe07e7d3f864680bc00bc0" title=" " alt="" coords="823,1260,951,1294"/>
<area shape="poly" title=" " alt="" coords="698,1237,808,1259,807,1264,697,1242"/>
<area shape="rect" href="../../d8/da1/seccomp-oci_8c.html#aa5c3a75ac3e60404d1158734452a4f66" title=" " alt="" coords="811,1203,963,1236"/>
<area shape="poly" title=" " alt="" coords="726,1218,795,1218,796,1223,726,1224"/>
<area shape="poly" title=" " alt="" coords="399,1328,489,1329,588,1325,677,1314,711,1305,736,1293,748,1282,756,1271,763,1246,768,1219,783,1189,812,1159,843,1134,846,1138,815,1163,788,1192,773,1220,768,1248,761,1273,752,1286,739,1298,713,1310,678,1320,588,1331,489,1334,399,1333"/>
<area shape="poly" title=" " alt="" coords="713,349,790,340,882,333,985,332,1094,338,1206,354,1317,382,1371,402,1422,425,1472,453,1518,485,1544,509,1566,537,1600,598,1622,658,1635,708,1630,709,1617,660,1595,600,1561,540,1540,513,1515,490,1469,457,1420,430,1369,406,1316,387,1205,359,1094,343,985,337,882,339,790,345,713,354"/>
<area shape="poly" title=" " alt="" coords="658,384,702,409,723,427,740,447,755,475,765,502,773,553,769,602,761,649,752,695,750,742,760,791,771,816,787,842,812,864,808,867,783,845,766,818,755,792,745,743,747,695,755,648,764,601,768,553,760,503,750,477,735,450,719,430,699,414,656,388"/>
<area shape="poly" title=" " alt="" coords="656,384,701,409,722,427,740,447,757,479,767,508,770,536,770,563,770,618,776,649,788,682,822,738,860,784,856,787,817,742,783,685,770,650,765,619,765,563,765,536,762,509,753,481,735,450,718,431,698,414,654,388"/>
<area shape="poly" title=" " alt="" coords="738,371,861,385,926,396,989,412,1057,437,1116,467,1114,472,1055,442,988,417,925,401,860,390,738,376"/>
</map>
</div>

</div>
</div>
<a id="a78940dcf91ed274ccd9183c4ac526998" name="a78940dcf91ed274ccd9183c4ac526998"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78940dcf91ed274ccd9183c4ac526998">&#9670;&#160;</a></span>parseOCIlinuxns()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parseOCIlinuxns </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01830">1830</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1831</span>{</div>
<div class="line"><span class="lineno"> 1832</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *tb[<a class="code hl_enumvalue" href="#a4efaf4e07364d6302f598569aa7e55dcab6f129898be13c23b13a69ca66e29d04">__OCI_LINUX_NAMESPACE_MAX</a>];</div>
<div class="line"><span class="lineno"> 1833</span>    <span class="keywordtype">int</span> nstype;</div>
<div class="line"><span class="lineno"> 1834</span>    <span class="keywordtype">int</span> *setns;</div>
<div class="line"><span class="lineno"> 1835</span>    <span class="keywordtype">int</span> fd;</div>
<div class="line"><span class="lineno"> 1836</span> </div>
<div class="line"><span class="lineno"> 1837</span>    <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#a14e8ea04063c41eec6c731c6db2f83ea">oci_linux_namespace_policy</a>, <a class="code hl_enumvalue" href="#a4efaf4e07364d6302f598569aa7e55dcab6f129898be13c23b13a69ca66e29d04">__OCI_LINUX_NAMESPACE_MAX</a>, tb, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(msg), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a>(msg));</div>
<div class="line"><span class="lineno"> 1838</span> </div>
<div class="line"><span class="lineno"> 1839</span>    <span class="keywordflow">if</span> (!tb[<a class="code hl_enumvalue" href="#a4efaf4e07364d6302f598569aa7e55dca3c772ed4692c1a6ee8cfd749e8f288b6">OCI_LINUX_NAMESPACE_TYPE</a>])</div>
<div class="line"><span class="lineno"> 1840</span>        <span class="keywordflow">return</span> EINVAL;</div>
<div class="line"><span class="lineno"> 1841</span> </div>
<div class="line"><span class="lineno"> 1842</span>    nstype = <a class="code hl_function" href="#a259f820c79f4b101ce41e26167ace63f">resolve_nstype</a>(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#a4efaf4e07364d6302f598569aa7e55dca3c772ed4692c1a6ee8cfd749e8f288b6">OCI_LINUX_NAMESPACE_TYPE</a>]));</div>
<div class="line"><span class="lineno"> 1843</span>    <span class="keywordflow">if</span> (!nstype)</div>
<div class="line"><span class="lineno"> 1844</span>        <span class="keywordflow">return</span> EINVAL;</div>
<div class="line"><span class="lineno"> 1845</span> </div>
<div class="line"><span class="lineno"> 1846</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp; nstype)</div>
<div class="line"><span class="lineno"> 1847</span>        <span class="keywordflow">return</span> ENOTUNIQ;</div>
<div class="line"><span class="lineno"> 1848</span> </div>
<div class="line"><span class="lineno"> 1849</span>    setns = <a class="code hl_function" href="#a3aa34193a0ba95da6ede6aa8e16d726f">get_namespace_fd</a>(nstype);</div>
<div class="line"><span class="lineno"> 1850</span> </div>
<div class="line"><span class="lineno"> 1851</span>    <span class="keywordflow">if</span> (!setns)</div>
<div class="line"><span class="lineno"> 1852</span>        <span class="keywordflow">return</span> EFAULT;</div>
<div class="line"><span class="lineno"> 1853</span> </div>
<div class="line"><span class="lineno"> 1854</span>    <span class="keywordflow">if</span> (*setns != -1)</div>
<div class="line"><span class="lineno"> 1855</span>        <span class="keywordflow">return</span> ENOTUNIQ;</div>
<div class="line"><span class="lineno"> 1856</span> </div>
<div class="line"><span class="lineno"> 1857</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a4efaf4e07364d6302f598569aa7e55dca9f981c7082417182bd81726ea9348830">OCI_LINUX_NAMESPACE_PATH</a>]) {</div>
<div class="line"><span class="lineno"> 1858</span>        <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;opening existing %s namespace from path %s\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1859</span>            <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#a4efaf4e07364d6302f598569aa7e55dca3c772ed4692c1a6ee8cfd749e8f288b6">OCI_LINUX_NAMESPACE_TYPE</a>]),</div>
<div class="line"><span class="lineno"> 1860</span>            <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#a4efaf4e07364d6302f598569aa7e55dca9f981c7082417182bd81726ea9348830">OCI_LINUX_NAMESPACE_PATH</a>]));</div>
<div class="line"><span class="lineno"> 1861</span> </div>
<div class="line"><span class="lineno"> 1862</span>        fd = open(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#a4efaf4e07364d6302f598569aa7e55dca9f981c7082417182bd81726ea9348830">OCI_LINUX_NAMESPACE_PATH</a>]), O_RDONLY);</div>
<div class="line"><span class="lineno"> 1863</span>        <span class="keywordflow">if</span> (fd &lt; 0)</div>
<div class="line"><span class="lineno"> 1864</span>            <span class="keywordflow">return</span> errno?:ESTALE;</div>
<div class="line"><span class="lineno"> 1865</span> </div>
<div class="line"><span class="lineno"> 1866</span>        <span class="keywordflow">if</span> (ioctl(fd, NS_GET_NSTYPE) != nstype) {</div>
<div class="line"><span class="lineno"> 1867</span>            close(fd);</div>
<div class="line"><span class="lineno"> 1868</span>            <span class="keywordflow">return</span> EINVAL;</div>
<div class="line"><span class="lineno"> 1869</span>        }</div>
<div class="line"><span class="lineno"> 1870</span> </div>
<div class="line"><span class="lineno"> 1871</span>        <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;opened existing %s namespace got filehandler %u\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1872</span>            <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#a4efaf4e07364d6302f598569aa7e55dca3c772ed4692c1a6ee8cfd749e8f288b6">OCI_LINUX_NAMESPACE_TYPE</a>]),</div>
<div class="line"><span class="lineno"> 1873</span>            fd);</div>
<div class="line"><span class="lineno"> 1874</span> </div>
<div class="line"><span class="lineno"> 1875</span>        *setns = fd;</div>
<div class="line"><span class="lineno"> 1876</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1877</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace |= nstype;</div>
<div class="line"><span class="lineno"> 1878</span>    }</div>
<div class="line"><span class="lineno"> 1879</span> </div>
<div class="line"><span class="lineno"> 1880</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1881</span>}</div>
<div class="ttc" id="ajail_8c_html_a14e8ea04063c41eec6c731c6db2f83ea"><div class="ttname"><a href="#a14e8ea04063c41eec6c731c6db2f83ea">oci_linux_namespace_policy</a></div><div class="ttdeci">static const struct blobmsg_policy oci_linux_namespace_policy[]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01800">jail.c:1800</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l01797">__OCI_LINUX_NAMESPACE_MAX</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00078">blobmsg_data()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00348">blobmsg_get_string()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00108">blobmsg_len()</a>, <a class="el" href="../../d1/d30/blobmsg_8c_source.html#l00166">blobmsg_parse()</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01041">get_namespace_fd()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01796">OCI_LINUX_NAMESPACE_PATH</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01800">oci_linux_namespace_policy</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01795">OCI_LINUX_NAMESPACE_TYPE</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l01805">resolve_nstype()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02198">parseOCIlinux()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a78940dcf91ed274ccd9183c4ac526998_cgraph.png" border="0" usemap="#add/d26/jail_8c_a78940dcf91ed274ccd9183c4ac526998_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a78940dcf91ed274ccd9183c4ac526998_cgraph" id="add/d26/jail_8c_a78940dcf91ed274ccd9183c4ac526998_cgraph">
<area shape="rect" title=" " alt="" coords="5,232,180,266"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="1035,252,1186,286"/>
<area shape="poly" title=" " alt="" coords="111,229,161,192,193,172,227,157,332,122,425,96,509,80,589,74,669,78,753,92,845,117,951,153,989,171,1025,193,1082,239,1079,243,1022,197,986,175,949,158,844,122,752,98,668,83,589,79,510,85,426,101,334,127,229,162,195,177,164,196,115,234"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603" title=" " alt="" coords="490,149,693,183"/>
<area shape="poly" title=" " alt="" coords="125,229,172,207,227,189,290,177,354,169,475,162,475,167,355,174,291,182,228,194,174,212,127,234"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5" title=" " alt="" coords="523,584,661,618"/>
<area shape="poly" title=" " alt="" coords="180,249,250,254,321,263,383,278,407,287,424,299,448,331,457,365,456,398,451,431,445,465,444,498,451,530,472,563,489,577,509,587,506,592,486,582,468,567,446,533,438,498,440,464,446,430,451,397,452,365,443,334,420,303,404,292,381,283,320,268,249,259,180,254"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed" title=" " alt="" coords="244,204,406,238"/>
<area shape="poly" title=" " alt="" coords="180,236,228,230,229,235,180,241"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a3aa34193a0ba95da6ede6aa8e16d726f" title=" " alt="" coords="228,313,422,347"/>
<area shape="poly" title=" " alt="" coords="144,264,261,305,259,310,142,269"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a259f820c79f4b101ce41e26167ace63f" title=" " alt="" coords="245,371,405,404"/>
<area shape="poly" title=" " alt="" coords="112,264,162,310,194,336,229,357,239,362,237,367,226,362,191,340,158,314,108,268"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="1311,452,1422,486"/>
<area shape="poly" title=" " alt="" coords="1188,275,1207,283,1225,295,1238,310,1246,325,1251,356,1256,387,1262,402,1273,418,1305,443,1301,447,1269,421,1257,405,1251,388,1246,357,1241,327,1234,313,1221,299,1205,288,1186,280"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="1276,195,1457,228"/>
<area shape="poly" title=" " alt="" coords="1186,249,1273,230,1274,235,1187,255"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ac239a83ed3c7f835e2b49f785953c934" title=" " alt="" coords="1281,309,1451,343"/>
<area shape="poly" title=" " alt="" coords="1187,283,1274,303,1273,308,1186,289"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a7613e130753e766f5d381c06b1f7b86f" title=" " alt="" coords="1271,252,1461,286"/>
<area shape="poly" title=" " alt="" coords="1187,266,1256,266,1256,272,1187,272"/>
<area shape="poly" title=" " alt="" coords="694,159,818,163,885,171,950,185,1016,210,1072,241,1069,246,1014,215,949,190,884,176,817,168,694,164"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052" title=" " alt="" coords="761,475,950,508"/>
<area shape="poly" title=" " alt="" coords="633,581,798,512,800,517,635,586"/>
<area shape="poly" title=" " alt="" coords="934,472,948,462,963,442,970,422,971,380,972,337,980,316,996,295,1019,279,1022,284,999,299,984,319,977,338,976,380,975,422,967,444,952,465,938,476"/>
<area shape="poly" title=" " alt="" coords="950,485,1295,469,1295,475,950,490"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a9921d2b89577d3344abbb66f24773e32" title=" " alt="" coords="1317,373,1415,407"/>
<area shape="poly" title=" " alt="" coords="934,472,997,458,1222,420,1301,403,1302,408,1224,425,998,464,935,477"/>
<area shape="poly" title=" " alt="" coords="392,236,424,256,442,280,449,303,456,326,472,350,540,416,601,460,670,491,762,518,834,533,908,539,983,539,1056,534,1190,513,1295,488,1296,493,1191,518,1057,539,983,544,908,545,833,538,761,524,668,496,599,465,537,420,468,353,451,328,444,305,437,283,420,260,389,241"/>
<area shape="poly" title=" " alt="" coords="336,202,358,176,389,144,426,113,469,91,578,52,675,24,762,8,846,3,929,9,1017,25,1114,53,1224,90,1260,108,1293,132,1343,181,1340,185,1289,136,1257,113,1222,95,1112,58,1016,31,929,14,846,8,763,13,676,29,580,57,471,95,429,118,392,148,362,179,340,206"/>
<area shape="poly" title=" " alt="" coords="355,201,469,134,541,118,602,109,657,106,709,109,815,127,950,153,1109,192,1293,245,1291,250,1107,197,949,158,815,132,708,114,657,111,603,114,542,123,471,139,357,206"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#ac79cacbc6a47f754832dc10bafa3b761" title=" " alt="" coords="812,200,899,234"/>
<area shape="poly" title=" " alt="" coords="406,218,796,215,796,220,406,223"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5a5283071ac5677652515d9a8460e655" title=" " alt="" coords="470,305,713,339"/>
<area shape="poly" title=" " alt="" coords="374,236,423,254,532,297,531,302,421,259,372,241"/>
<area shape="poly" title=" " alt="" coords="714,307,1019,276,1020,281,714,312"/>
<area shape="poly" title=" " alt="" coords="611,338,674,398,716,432,763,461,772,466,770,471,760,466,713,436,670,402,607,342"/>
<area shape="poly" title=" " alt="" coords="634,302,760,250,796,236,798,241,762,255,636,307"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6b6c429265d86411d05951d2fae7289a" title=" " alt="" coords="768,360,943,394"/>
<area shape="poly" title=" " alt="" coords="677,337,756,354,755,359,676,342"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a2c4753820a7472bba7b999fbba79df01" title=" " alt="" coords="785,417,926,451"/>
<area shape="poly" title=" " alt="" coords="625,337,688,370,762,404,778,410,776,415,760,409,685,375,623,342"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a131936c081164c18e6241d79f3b276d1" title=" " alt="" coords="998,309,1223,343"/>
<area shape="poly" title=" " alt="" coords="714,321,982,323,982,328,714,326"/>
<area shape="poly" title=" " alt="" coords="926,426,1301,393,1302,398,927,431"/>
<area shape="poly" title=" " alt="" coords="1142,341,1272,417,1319,442,1316,447,1270,422,1139,346"/>
<area shape="poly" title=" " alt="" coords="1201,307,1221,296,1236,282,1245,268,1254,252,1269,238,1276,233,1279,238,1273,242,1258,256,1249,271,1241,286,1225,300,1203,311"/>
<area shape="poly" title=" " alt="" coords="1223,324,1265,324,1265,329,1223,329"/>
<area shape="poly" title=" " alt="" coords="1188,306,1273,287,1274,292,1189,311"/>
<area shape="poly" title=" " alt="" coords="1181,341,1303,372,1301,377,1180,346"/>
</map>
</div>

</div>
</div>
<a id="a5c2ec1493bdd9d650372134c0bdad679" name="a5c2ec1493bdd9d650372134c0bdad679"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c2ec1493bdd9d650372134c0bdad679">&#9670;&#160;</a></span>parseOCIprocess()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parseOCIprocess </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01742">1742</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1743</span>{</div>
<div class="line"><span class="lineno"> 1744</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *tb[<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8aa1cab4d55ca40e13a53fba6cd6925491">__OCI_PROCESS_MAX</a>], *cur;</div>
<div class="line"><span class="lineno"> 1745</span>    <span class="keywordtype">int</span> rem, res;</div>
<div class="line"><span class="lineno"> 1746</span> </div>
<div class="line"><span class="lineno"> 1747</span>    <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#a1b6d333d023b819f033d8012b14a51b2">oci_process_policy</a>, <a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8aa1cab4d55ca40e13a53fba6cd6925491">__OCI_PROCESS_MAX</a>, tb, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(msg), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a>(msg));</div>
<div class="line"><span class="lineno"> 1748</span> </div>
<div class="line"><span class="lineno"> 1749</span>    <span class="keywordflow">if</span> (!tb[<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a9d41d59732df8b5db30de6d8b498664c">OCI_PROCESS_ARGS</a>])</div>
<div class="line"><span class="lineno"> 1750</span>        <span class="keywordflow">return</span> ENOENT;</div>
<div class="line"><span class="lineno"> 1751</span> </div>
<div class="line"><span class="lineno"> 1752</span>    res = <a class="code hl_function" href="#adddfc616a062dd8a8ba8d4fbd3929cbe">parseOCIenvarray</a>(tb[<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a9d41d59732df8b5db30de6d8b498664c">OCI_PROCESS_ARGS</a>], &amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.jail_argv);</div>
<div class="line"><span class="lineno"> 1753</span>    <span class="keywordflow">if</span> (res)</div>
<div class="line"><span class="lineno"> 1754</span>        <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno"> 1755</span> </div>
<div class="line"><span class="lineno"> 1756</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8ab48a2bacf241c851a118f8282a271e4d">OCI_PROCESS_TERMINAL</a>])</div>
<div class="line"><span class="lineno"> 1757</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.console = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#adfbec0b532211a1442310392496a45f2">blobmsg_get_bool</a>(tb[<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8ab48a2bacf241c851a118f8282a271e4d">OCI_PROCESS_TERMINAL</a>]);</div>
<div class="line"><span class="lineno"> 1758</span> </div>
<div class="line"><span class="lineno"> 1759</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a7c18000948947c83ebfd4fab57779357">OCI_PROCESS_NONEWPRIVILEGES</a>])</div>
<div class="line"><span class="lineno"> 1760</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.no_new_privs = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#adfbec0b532211a1442310392496a45f2">blobmsg_get_bool</a>(tb[<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a7c18000948947c83ebfd4fab57779357">OCI_PROCESS_NONEWPRIVILEGES</a>]);</div>
<div class="line"><span class="lineno"> 1761</span> </div>
<div class="line"><span class="lineno"> 1762</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a841ee5b5a8bc29fc281504adf23332a5">OCI_PROCESS_CWD</a>])</div>
<div class="line"><span class="lineno"> 1763</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.cwd = strdup(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a841ee5b5a8bc29fc281504adf23332a5">OCI_PROCESS_CWD</a>]));</div>
<div class="line"><span class="lineno"> 1764</span> </div>
<div class="line"><span class="lineno"> 1765</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a1be2ada84df5442b9f201c6dc52b3068">OCI_PROCESS_ENV</a>]) {</div>
<div class="line"><span class="lineno"> 1766</span>        res = <a class="code hl_function" href="#adddfc616a062dd8a8ba8d4fbd3929cbe">parseOCIenvarray</a>(tb[<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a1be2ada84df5442b9f201c6dc52b3068">OCI_PROCESS_ENV</a>], &amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.envp);</div>
<div class="line"><span class="lineno"> 1767</span>        <span class="keywordflow">if</span> (res)</div>
<div class="line"><span class="lineno"> 1768</span>            <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno"> 1769</span>    }</div>
<div class="line"><span class="lineno"> 1770</span> </div>
<div class="line"><span class="lineno"> 1771</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8ac638d97c005c1bae4270639b35443a6b">OCI_PROCESS_USER</a>] &amp;&amp; (res = <a class="code hl_function" href="#a43c8017e92544b5ba06a553fd5c9b8b6">parseOCIprocessuser</a>(tb[<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8ac638d97c005c1bae4270639b35443a6b">OCI_PROCESS_USER</a>])))</div>
<div class="line"><span class="lineno"> 1772</span>        <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno"> 1773</span> </div>
<div class="line"><span class="lineno"> 1774</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a71f60125a3d09ac0376911a3e0b0a6a4">OCI_PROCESS_CAPABILITIES</a>] &amp;&amp;</div>
<div class="line"><span class="lineno"> 1775</span>        (res = <a class="code hl_function" href="../../d2/d61/capabilities_8c.html#a6cf3bdf4e38686e49a288ad2248a5317">parseOCIcapabilities</a>(&amp;<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.capset, tb[<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a71f60125a3d09ac0376911a3e0b0a6a4">OCI_PROCESS_CAPABILITIES</a>])))</div>
<div class="line"><span class="lineno"> 1776</span>        <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno"> 1777</span> </div>
<div class="line"><span class="lineno"> 1778</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a43e16b4cc6c2d437a14b0bc14554127e">OCI_PROCESS_RLIMITS</a>]) {</div>
<div class="line"><span class="lineno"> 1779</span>        <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, tb[<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a43e16b4cc6c2d437a14b0bc14554127e">OCI_PROCESS_RLIMITS</a>], rem) {</div>
<div class="line"><span class="lineno"> 1780</span>            res = <a class="code hl_function" href="#a7e7ceb5ee690aa943096b3398fe195f9">parseOCIrlimit</a>(cur);</div>
<div class="line"><span class="lineno"> 1781</span>            <span class="keywordflow">if</span> (res)</div>
<div class="line"><span class="lineno"> 1782</span>                <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno"> 1783</span>        }</div>
<div class="line"><span class="lineno"> 1784</span>    }</div>
<div class="line"><span class="lineno"> 1785</span> </div>
<div class="line"><span class="lineno"> 1786</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8ac9d842b5fe7888be2ebaa9505332f6df">OCI_PROCESS_OOMSCOREADJ</a>]) {</div>
<div class="line"><span class="lineno"> 1787</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.oom_score_adj = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8ac9d842b5fe7888be2ebaa9505332f6df">OCI_PROCESS_OOMSCOREADJ</a>]);</div>
<div class="line"><span class="lineno"> 1788</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.set_oom_score_adj = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1789</span>    }</div>
<div class="line"><span class="lineno"> 1790</span> </div>
<div class="line"><span class="lineno"> 1791</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1792</span>}</div>
<div class="ttc" id="ablobmsg_8h_html_adfbec0b532211a1442310392496a45f2"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#adfbec0b532211a1442310392496a45f2">blobmsg_get_bool</a></div><div class="ttdeci">static bool blobmsg_get_bool(struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00283">blobmsg.h:283</a></div></div>
<div class="ttc" id="acapabilities_8c_html_a6cf3bdf4e38686e49a288ad2248a5317"><div class="ttname"><a href="../../d2/d61/capabilities_8c.html#a6cf3bdf4e38686e49a288ad2248a5317">parseOCIcapabilities</a></div><div class="ttdeci">int parseOCIcapabilities(struct jail_capset *capset, struct blob_attr *msg)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d61/capabilities_8c_source.html#l00078">capabilities.c:78</a></div></div>
<div class="ttc" id="ajail_8c_html_a1b6d333d023b819f033d8012b14a51b2"><div class="ttname"><a href="#a1b6d333d023b819f033d8012b14a51b2">oci_process_policy</a></div><div class="ttdeci">static const struct blobmsg_policy oci_process_policy[]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01729">jail.c:1729</a></div></div>
<div class="ttc" id="ajail_8c_html_a43c8017e92544b5ba06a553fd5c9b8b6"><div class="ttname"><a href="#a43c8017e92544b5ba06a553fd5c9b8b6">parseOCIprocessuser</a></div><div class="ttdeci">static int parseOCIprocessuser(struct blob_attr *msg)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01588">jail.c:1588</a></div></div>
<div class="ttc" id="ajail_8c_html_a7e7ceb5ee690aa943096b3398fe195f9"><div class="ttname"><a href="#a7e7ceb5ee690aa943096b3398fe195f9">parseOCIrlimit</a></div><div class="ttdeci">static int parseOCIrlimit(struct blob_attr *msg)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01686">jail.c:1686</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l01726">__OCI_PROCESS_MAX</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00078">blobmsg_data()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00364">blobmsg_for_each_attr</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00283">blobmsg_get_bool()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00348">blobmsg_get_string()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00293">blobmsg_get_u32()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00108">blobmsg_len()</a>, <a class="el" href="../../d1/d30/blobmsg_8c_source.html#l00166">blobmsg_parse()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01717">OCI_PROCESS_ARGS</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01718">OCI_PROCESS_CAPABILITIES</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01719">OCI_PROCESS_CWD</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01720">OCI_PROCESS_ENV</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01722">OCI_PROCESS_NONEWPRIVILEGES</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01721">OCI_PROCESS_OOMSCOREADJ</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01729">oci_process_policy</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01723">OCI_PROCESS_RLIMITS</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01724">OCI_PROCESS_TERMINAL</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01725">OCI_PROCESS_USER</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="../../d2/d61/capabilities_8c_source.html#l00078">parseOCIcapabilities()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01338">parseOCIenvarray()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01588">parseOCIprocessuser()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l01686">parseOCIrlimit()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02323">parseOCI()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a5c2ec1493bdd9d650372134c0bdad679_cgraph.png" border="0" usemap="#add/d26/jail_8c_a5c2ec1493bdd9d650372134c0bdad679_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a5c2ec1493bdd9d650372134c0bdad679_cgraph" id="add/d26/jail_8c_a5c2ec1493bdd9d650372134c0bdad679_cgraph">
<area shape="rect" title=" " alt="" coords="5,668,184,702"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="1274,637,1425,671"/>
<area shape="poly" title=" " alt="" coords="179,665,231,657,447,636,615,628,1001,622,1095,619,1189,622,1259,632,1258,637,1189,627,1095,624,1001,627,615,633,447,641,232,662,180,670"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#adfbec0b532211a1442310392496a45f2" title=" " alt="" coords="737,1148,925,1182"/>
<area shape="poly" title=" " alt="" coords="98,702,100,778,106,831,116,889,133,949,157,1007,190,1061,233,1105,291,1143,354,1169,421,1186,489,1195,557,1198,622,1195,735,1182,735,1188,622,1201,557,1203,489,1200,420,1191,352,1174,288,1147,230,1110,186,1064,152,1010,128,951,111,890,101,832,95,778,93,702"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603" title=" " alt="" coords="729,1069,933,1103"/>
<area shape="poly" title=" " alt="" coords="101,702,111,760,134,842,152,886,174,930,201,970,233,1006,287,1044,346,1073,410,1093,476,1105,542,1111,605,1111,719,1103,719,1108,606,1117,541,1116,475,1110,409,1098,344,1078,284,1049,230,1009,197,973,169,932,147,888,129,843,106,761,95,703"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f" title=" " alt="" coords="1002,637,1188,671"/>
<area shape="poly" title=" " alt="" coords="184,679,987,655,987,660,184,685"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5" title=" " alt="" coords="511,376,649,410"/>
<area shape="poly" title=" " alt="" coords="97,667,110,619,136,555,153,521,175,488,200,458,230,433,261,415,294,402,364,385,433,379,496,380,495,385,433,384,365,390,296,407,263,420,233,438,204,462,179,491,158,523,140,557,115,621,102,668"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed" title=" " alt="" coords="499,433,661,467"/>
<area shape="poly" title=" " alt="" coords="98,667,114,625,140,571,179,516,203,492,230,472,260,457,292,446,358,432,424,429,484,432,483,437,424,434,359,438,293,451,262,462,233,476,206,496,183,519,145,574,119,627,103,669"/>
<area shape="rect" href="../../d2/d61/capabilities_8c.html#a6cf3bdf4e38686e49a288ad2248a5317" title=" " alt="" coords="236,695,447,728"/>
<area shape="poly" title=" " alt="" coords="185,692,220,696,220,701,184,697"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#adddfc616a062dd8a8ba8d4fbd3929cbe" title=" " alt="" coords="247,961,436,995"/>
<area shape="poly" title=" " alt="" coords="112,701,318,947,314,951,108,704"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a43c8017e92544b5ba06a553fd5c9b8b6" title=" " alt="" coords="232,487,451,520"/>
<area shape="poly" title=" " alt="" coords="105,666,155,604,190,568,230,537,255,524,258,529,233,542,194,572,159,607,110,669"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a7e7ceb5ee690aa943096b3398fe195f9" title=" " alt="" coords="264,800,419,834"/>
<area shape="poly" title=" " alt="" coords="129,700,296,790,294,795,126,704"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="1550,247,1661,280"/>
<area shape="poly" title=" " alt="" coords="1355,636,1375,583,1408,507,1453,422,1508,340,1535,312,1564,288,1568,292,1539,316,1512,344,1458,425,1413,509,1380,585,1359,638"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="1515,439,1696,472"/>
<area shape="poly" title=" " alt="" coords="1371,635,1569,480,1572,484,1375,639"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ac239a83ed3c7f835e2b49f785953c934" title=" " alt="" coords="1520,355,1691,388"/>
<area shape="poly" title=" " alt="" coords="1357,635,1414,540,1457,480,1509,424,1551,394,1554,398,1512,428,1462,483,1418,542,1362,638"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a7613e130753e766f5d381c06b1f7b86f" title=" " alt="" coords="1510,637,1701,671"/>
<area shape="poly" title=" " alt="" coords="1426,652,1495,652,1495,657,1426,657"/>
<area shape="poly" title=" " alt="" coords="925,1156,989,1145,1059,1127,1127,1097,1159,1078,1187,1055,1225,1013,1257,965,1283,913,1303,861,1330,761,1342,686,1348,687,1335,762,1308,862,1287,916,1262,968,1230,1016,1191,1059,1162,1082,1130,1102,1061,1132,991,1151,926,1161"/>
<area shape="poly" title=" " alt="" coords="933,1068,995,1052,1062,1029,1128,998,1187,956,1218,925,1245,891,1288,815,1319,743,1338,685,1343,687,1324,745,1293,818,1249,894,1222,929,1191,960,1131,1002,1064,1034,996,1057,934,1073"/>
<area shape="poly" title=" " alt="" coords="1188,652,1259,652,1259,657,1188,657"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052" title=" " alt="" coords="1001,165,1189,199"/>
<area shape="poly" title=" " alt="" coords="591,374,637,317,670,286,708,260,776,229,848,208,920,194,985,185,985,190,921,199,850,213,778,234,711,264,674,290,641,321,595,377"/>
<area shape="poly" title=" " alt="" coords="1124,197,1158,225,1191,261,1256,414,1339,622,1334,624,1251,416,1187,264,1155,229,1121,202"/>
<area shape="poly" title=" " alt="" coords="1190,194,1535,250,1534,255,1189,200"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a9921d2b89577d3344abbb66f24773e32" title=" " alt="" coords="1556,165,1655,199"/>
<area shape="poly" title=" " alt="" coords="1189,180,1541,180,1541,185,1189,185"/>
<area shape="poly" title=" " alt="" coords="646,431,659,420,674,401,681,382,683,342,685,302,692,281,707,260,742,227,774,204,806,187,839,176,911,163,1000,150,1070,139,1131,134,1184,135,1234,140,1336,164,1463,202,1555,238,1554,243,1461,207,1335,169,1233,145,1184,140,1131,140,1071,145,1001,155,911,169,840,181,808,192,777,208,745,232,711,264,697,284,690,303,688,343,686,383,678,403,663,424,649,435"/>
<area shape="poly" title=" " alt="" coords="662,448,1499,452,1499,458,662,453"/>
<area shape="poly" title=" " alt="" coords="591,466,625,557,664,682,671,723,672,762,665,829,665,859,670,888,685,917,711,946,769,988,825,1015,879,1027,933,1027,990,1018,1050,1002,1188,956,1251,931,1312,898,1370,861,1423,821,1514,743,1577,681,1580,684,1518,747,1427,826,1373,866,1315,903,1253,935,1190,961,1052,1007,991,1023,934,1033,878,1032,823,1020,767,993,708,949,680,920,665,890,660,860,660,829,666,761,666,724,659,683,620,559,586,468"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#ac79cacbc6a47f754832dc10bafa3b761" title=" " alt="" coords="1051,384,1139,418"/>
<area shape="poly" title=" " alt="" coords="662,438,709,433,1035,403,1036,408,710,438,662,443"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5a5283071ac5677652515d9a8460e655" title=" " alt="" coords="709,275,953,308"/>
<area shape="poly" title=" " alt="" coords="638,430,660,420,685,402,708,381,793,316,796,320,711,386,688,406,663,424,640,435"/>
<area shape="poly" title=" " alt="" coords="929,306,1089,339,1154,355,1190,369,1222,397,1249,428,1293,498,1324,566,1342,622,1337,623,1319,568,1288,500,1245,431,1218,400,1188,374,1153,360,1087,344,928,312"/>
<area shape="poly" title=" " alt="" coords="870,272,1000,216,1032,203,1034,208,1002,221,872,276"/>
<area shape="poly" title=" " alt="" coords="872,307,1002,362,1038,377,1036,382,1000,367,870,311"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6b6c429265d86411d05951d2fae7289a" title=" " alt="" coords="1008,275,1182,308"/>
<area shape="poly" title=" " alt="" coords="953,289,992,289,992,294,953,294"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a2c4753820a7472bba7b999fbba79df01" title=" " alt="" coords="1279,5,1420,39"/>
<area shape="poly" title=" " alt="" coords="847,272,911,214,954,181,999,151,1068,115,1139,85,1268,41,1270,46,1141,90,1070,120,1002,155,957,185,914,218,851,276"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a131936c081164c18e6241d79f3b276d1" title=" " alt="" coords="1237,327,1462,360"/>
<area shape="poly" title=" " alt="" coords="897,271,959,259,1032,250,1112,249,1190,260,1224,270,1256,284,1312,316,1310,320,1254,289,1222,275,1188,265,1111,254,1033,256,959,264,898,277"/>
<area shape="poly" title=" " alt="" coords="1421,37,1464,56,1498,78,1529,103,1580,152,1577,156,1526,107,1494,82,1461,61,1419,42"/>
<area shape="poly" title=" " alt="" coords="1405,324,1534,283,1536,288,1407,329"/>
<area shape="poly" title=" " alt="" coords="1392,359,1552,430,1550,435,1389,363"/>
<area shape="poly" title=" " alt="" coords="1463,353,1505,358,1505,363,1462,359"/>
<area shape="poly" title=" " alt="" coords="1367,359,1583,623,1578,627,1363,362"/>
<area shape="poly" title=" " alt="" coords="1373,324,1509,232,1556,204,1559,209,1512,236,1376,328"/>
<area shape="poly" title=" " alt="" coords="421,726,499,738,605,744,713,743,820,737,924,727,1113,700,1258,672,1259,677,1114,705,925,733,820,743,713,749,605,749,499,743,420,732"/>
<area shape="poly" title=" " alt="" coords="352,693,396,623,449,532,461,499,467,472,476,446,497,419,500,417,503,421,501,423,481,448,472,473,466,501,453,534,401,626,357,696"/>
<area shape="poly" title=" " alt="" coords="356,693,551,477,555,480,360,696"/>
<area shape="rect" href="../../d8/d14/capabilities_8h.html#abf7e4e3c4c0bc644ea5e76a5e3326108" title=" " alt="" coords="539,695,621,728"/>
<area shape="poly" title=" " alt="" coords="448,709,524,709,524,714,448,714"/>
<area shape="rect" href="../../d2/d61/capabilities_8c.html#ad0fb23bf33f9f7df641deb75cd8ff9ef" title=" " alt="" coords="510,855,650,888"/>
<area shape="poly" title=" " alt="" coords="370,727,543,844,540,848,367,731"/>
<area shape="poly" title=" " alt="" coords="604,887,634,915,664,950,678,978,685,1003,692,1026,711,1048,729,1060,726,1065,708,1052,688,1028,679,1005,673,980,659,953,630,919,601,891"/>
<area shape="rect" href="../../d2/d61/capabilities_8c.html#ae10fea5ba855f937d374385dee24e20e" title=" " alt="" coords="746,844,916,878"/>
<area shape="poly" title=" " alt="" coords="651,866,730,862,730,868,651,871"/>
<area shape="poly" title=" " alt="" coords="372,993,429,1024,500,1052,553,1064,609,1073,714,1082,713,1088,608,1078,552,1069,498,1057,427,1029,369,998"/>
<area shape="poly" title=" " alt="" coords="451,498,631,495,844,497,1046,509,1128,520,1190,536,1229,553,1265,576,1323,624,1319,628,1262,581,1226,558,1188,541,1127,526,1045,515,844,503,631,500,451,503"/>
<area shape="poly" title=" " alt="" coords="430,518,993,631,991,636,429,524"/>
<area shape="poly" title=" " alt="" coords="371,484,429,452,498,418,510,413,512,418,500,423,431,457,373,489"/>
<area shape="poly" title=" " alt="" coords="419,483,487,468,488,473,421,489"/>
<area shape="poly" title=" " alt="" coords="419,814,564,809,757,795,973,768,1082,748,1188,722,1249,701,1302,676,1305,681,1251,706,1190,727,1083,753,974,773,757,800,564,814,420,819"/>
<area shape="poly" title=" " alt="" coords="359,833,453,947,474,981,484,995,500,1008,531,1019,586,1033,726,1063,725,1068,585,1038,529,1024,498,1012,480,998,470,984,449,950,355,836"/>
<area shape="poly" title=" " alt="" coords="381,797,418,773,435,757,449,739,468,696,475,655,473,615,466,577,461,539,461,500,471,460,497,419,497,419,501,422,501,422,476,462,466,501,466,538,472,576,478,615,480,655,474,697,453,742,439,761,421,777,383,802"/>
<area shape="poly" title=" " alt="" coords="375,797,413,772,449,739,493,673,528,602,552,535,568,482,573,483,558,536,533,604,498,676,453,743,417,777,378,802"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a8f13b26eaebcdf626e534b33f887925c" title=" " alt="" coords="734,901,928,935"/>
<area shape="poly" title=" " alt="" coords="368,832,426,867,462,885,500,898,555,910,611,918,719,922,718,927,611,923,554,916,498,903,460,890,424,872,365,836"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a403387af16adfc17ce1cb6f14b82afb1" title=" " alt="" coords="508,964,652,998"/>
<area shape="poly" title=" " alt="" coords="362,832,422,885,500,943,522,955,520,959,498,947,418,889,359,836"/>
<area shape="poly" title=" " alt="" coords="927,902,951,888,971,865,979,841,985,815,998,784,1034,729,1068,682,1072,685,1038,732,1003,786,990,816,985,843,976,868,954,892,930,907"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a38fb5688af8a7f3e9eae5c653ed2bb50" title=" " alt="" coords="1002,797,1188,831"/>
<area shape="poly" title=" " alt="" coords="927,899,951,888,966,877,975,865,984,852,999,840,1007,835,1010,840,1002,844,988,856,979,868,970,881,954,892,929,904"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab631ab3a5e71a8742449cd374a63ecec" title=" " alt="" coords="1002,855,1188,888"/>
<area shape="poly" title=" " alt="" coords="928,898,986,888,987,893,929,904"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#af2c32f6db6f49388da60dda520d86c4d" title=" " alt="" coords="1008,912,1182,946"/>
<area shape="poly" title=" " alt="" coords="928,919,993,922,992,927,928,925"/>
<area shape="poly" title=" " alt="" coords="1148,794,1188,776,1259,727,1317,679,1321,683,1262,732,1190,780,1150,799"/>
<area shape="poly" title=" " alt="" coords="1168,852,1188,841,1233,805,1272,762,1305,719,1329,682,1333,685,1309,722,1277,765,1236,809,1190,846,1170,856"/>
<area shape="poly" title=" " alt="" coords="1170,909,1187,899,1214,875,1239,849,1281,790,1313,732,1334,685,1339,687,1318,735,1286,793,1243,852,1218,879,1191,903,1172,914"/>
</map>
</div>

</div>
</div>
<a id="a43c8017e92544b5ba06a553fd5c9b8b6" name="a43c8017e92544b5ba06a553fd5c9b8b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43c8017e92544b5ba06a553fd5c9b8b6">&#9670;&#160;</a></span>parseOCIprocessuser()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parseOCIprocessuser </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01588">1588</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1588</span>                                                      {</div>
<div class="line"><span class="lineno"> 1589</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *tb[<a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004a9b36524395a911eb0d37dfbf132f5f10">__OCI_PROCESS_USER_MAX</a>];</div>
<div class="line"><span class="lineno"> 1590</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *cur;</div>
<div class="line"><span class="lineno"> 1591</span>    <span class="keywordtype">int</span> rem;</div>
<div class="line"><span class="lineno"> 1592</span>    <span class="keywordtype">int</span> has_gid = 0;</div>
<div class="line"><span class="lineno"> 1593</span> </div>
<div class="line"><span class="lineno"> 1594</span>    <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#a196324f45ead47d07841d5d61cae0d86">oci_process_user_policy</a>, <a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004a9b36524395a911eb0d37dfbf132f5f10">__OCI_PROCESS_USER_MAX</a>, tb, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(msg), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a>(msg));</div>
<div class="line"><span class="lineno"> 1595</span> </div>
<div class="line"><span class="lineno"> 1596</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004a727b3caff3f4f9c0226fde9a4add449b">OCI_PROCESS_USER_UID</a>])</div>
<div class="line"><span class="lineno"> 1597</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.pw_uid = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004a727b3caff3f4f9c0226fde9a4add449b">OCI_PROCESS_USER_UID</a>]);</div>
<div class="line"><span class="lineno"> 1598</span> </div>
<div class="line"><span class="lineno"> 1599</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004aaa9867bd15bf6df72a6afbbca29bb0ea">OCI_PROCESS_USER_GID</a>]) {</div>
<div class="line"><span class="lineno"> 1600</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.pw_gid = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004aaa9867bd15bf6df72a6afbbca29bb0ea">OCI_PROCESS_USER_GID</a>]);</div>
<div class="line"><span class="lineno"> 1601</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.gr_gid = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004aaa9867bd15bf6df72a6afbbca29bb0ea">OCI_PROCESS_USER_GID</a>]);</div>
<div class="line"><span class="lineno"> 1602</span>        has_gid = 1;</div>
<div class="line"><span class="lineno"> 1603</span>    }</div>
<div class="line"><span class="lineno"> 1604</span> </div>
<div class="line"><span class="lineno"> 1605</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004a65c968275ec1a7c4233995f829810b73">OCI_PROCESS_USER_ADDITIONALGIDS</a>]) {</div>
<div class="line"><span class="lineno"> 1606</span>        <span class="keywordtype">size_t</span> gidcnt = 0;</div>
<div class="line"><span class="lineno"> 1607</span> </div>
<div class="line"><span class="lineno"> 1608</span>        <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, tb[<a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004a65c968275ec1a7c4233995f829810b73">OCI_PROCESS_USER_ADDITIONALGIDS</a>], rem) {</div>
<div class="line"><span class="lineno"> 1609</span>            ++gidcnt;</div>
<div class="line"><span class="lineno"> 1610</span>            <span class="keywordflow">if</span> (has_gid &amp;&amp; (<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(cur) == <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.gr_gid))</div>
<div class="line"><span class="lineno"> 1611</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1612</span>        }</div>
<div class="line"><span class="lineno"> 1613</span> </div>
<div class="line"><span class="lineno"> 1614</span>        <span class="keywordflow">if</span> (gidcnt) {</div>
<div class="line"><span class="lineno"> 1615</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.additional_gids = calloc(gidcnt + has_gid, <span class="keyword">sizeof</span>(gid_t));</div>
<div class="line"><span class="lineno"> 1616</span>            gidcnt = 0;</div>
<div class="line"><span class="lineno"> 1617</span> </div>
<div class="line"><span class="lineno"> 1618</span>            <span class="comment">/* always add primary GID to set of GIDs if set */</span></div>
<div class="line"><span class="lineno"> 1619</span>            <span class="keywordflow">if</span> (has_gid)</div>
<div class="line"><span class="lineno"> 1620</span>                <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.additional_gids[gidcnt++] = <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.gr_gid;</div>
<div class="line"><span class="lineno"> 1621</span> </div>
<div class="line"><span class="lineno"> 1622</span>            <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, tb[<a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004a65c968275ec1a7c4233995f829810b73">OCI_PROCESS_USER_ADDITIONALGIDS</a>], rem) {</div>
<div class="line"><span class="lineno"> 1623</span>                <span class="keywordflow">if</span> (has_gid &amp;&amp; (<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(cur) == <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.gr_gid))</div>
<div class="line"><span class="lineno"> 1624</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1625</span>                <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.additional_gids[gidcnt++] = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(cur);</div>
<div class="line"><span class="lineno"> 1626</span>            }</div>
<div class="line"><span class="lineno"> 1627</span>            <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.num_additional_gids = gidcnt;</div>
<div class="line"><span class="lineno"> 1628</span>        }</div>
<div class="line"><span class="lineno"> 1629</span>        <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;read %zu additional groups\n&quot;</span>, gidcnt);</div>
<div class="line"><span class="lineno"> 1630</span>    }</div>
<div class="line"><span class="lineno"> 1631</span> </div>
<div class="line"><span class="lineno"> 1632</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004abebde02748010be1f45e9986546d7d0c">OCI_PROCESS_USER_UMASK</a>]) {</div>
<div class="line"><span class="lineno"> 1633</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.umask = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004abebde02748010be1f45e9986546d7d0c">OCI_PROCESS_USER_UMASK</a>]);</div>
<div class="line"><span class="lineno"> 1634</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.set_umask = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1635</span>    }</div>
<div class="line"><span class="lineno"> 1636</span> </div>
<div class="line"><span class="lineno"> 1637</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1638</span>}</div>
<div class="ttc" id="ajail_8c_html_a196324f45ead47d07841d5d61cae0d86"><div class="ttname"><a href="#a196324f45ead47d07841d5d61cae0d86">oci_process_user_policy</a></div><div class="ttdeci">static const struct blobmsg_policy oci_process_user_policy[]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01581">jail.c:1581</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l01578">__OCI_PROCESS_USER_MAX</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00078">blobmsg_data()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00364">blobmsg_for_each_attr</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00293">blobmsg_get_u32()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00108">blobmsg_len()</a>, <a class="el" href="../../d1/d30/blobmsg_8c_source.html#l00166">blobmsg_parse()</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01577">OCI_PROCESS_USER_ADDITIONALGIDS</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01575">OCI_PROCESS_USER_GID</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01581">oci_process_user_policy</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01574">OCI_PROCESS_USER_UID</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01576">OCI_PROCESS_USER_UMASK</a>, and <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01742">parseOCIprocess()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a43c8017e92544b5ba06a553fd5c9b8b6_cgraph.png" border="0" usemap="#add/d26/jail_8c_a43c8017e92544b5ba06a553fd5c9b8b6_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a43c8017e92544b5ba06a553fd5c9b8b6_cgraph" id="add/d26/jail_8c_a43c8017e92544b5ba06a553fd5c9b8b6_cgraph">
<area shape="rect" title=" " alt="" coords="5,199,225,232"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="1071,276,1222,310"/>
<area shape="poly" title=" " alt="" coords="151,195,207,172,272,154,473,117,557,105,635,100,712,103,794,115,883,139,987,174,1025,193,1061,216,1119,263,1115,267,1058,220,1023,197,985,179,882,144,792,121,712,108,635,105,557,110,474,122,273,159,209,178,153,200"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f" title=" " alt="" coords="273,169,458,203"/>
<area shape="poly" title=" " alt="" coords="225,200,257,196,258,201,226,205"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5" title=" " alt="" coords="559,608,697,642"/>
<area shape="poly" title=" " alt="" coords="131,231,185,297,271,393,324,445,382,497,443,545,507,586,545,603,543,608,505,591,440,549,378,501,320,449,267,397,181,301,127,234"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed" title=" " alt="" coords="284,227,447,260"/>
<area shape="poly" title=" " alt="" coords="226,225,269,230,268,235,225,230"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="1347,476,1458,510"/>
<area shape="poly" title=" " alt="" coords="1224,299,1243,307,1261,319,1274,334,1282,349,1287,380,1292,411,1298,426,1309,442,1341,466,1337,470,1305,445,1293,428,1287,412,1282,381,1277,351,1270,337,1257,323,1241,311,1222,304"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="1312,219,1493,252"/>
<area shape="poly" title=" " alt="" coords="1222,273,1309,254,1310,259,1223,278"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ac239a83ed3c7f835e2b49f785953c934" title=" " alt="" coords="1317,333,1487,367"/>
<area shape="poly" title=" " alt="" coords="1223,307,1310,327,1309,332,1222,312"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a7613e130753e766f5d381c06b1f7b86f" title=" " alt="" coords="1307,276,1497,310"/>
<area shape="poly" title=" " alt="" coords="1223,290,1292,290,1292,295,1223,295"/>
<area shape="poly" title=" " alt="" coords="458,175,567,170,700,171,844,182,916,193,986,209,1052,234,1108,265,1106,270,1050,239,985,214,915,198,843,187,699,176,567,175,458,180"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052" title=" " alt="" coords="797,499,986,532"/>
<area shape="poly" title=" " alt="" coords="669,605,834,536,836,541,671,610"/>
<area shape="poly" title=" " alt="" coords="970,496,984,486,999,465,1006,445,1007,403,1008,361,1016,340,1032,319,1055,303,1058,308,1035,323,1020,342,1013,362,1012,404,1011,446,1003,468,988,489,974,500"/>
<area shape="poly" title=" " alt="" coords="986,509,1331,493,1331,498,986,514"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a9921d2b89577d3344abbb66f24773e32" title=" " alt="" coords="1353,397,1451,431"/>
<area shape="poly" title=" " alt="" coords="970,495,1033,482,1258,443,1337,426,1338,432,1260,449,1034,487,971,500"/>
<area shape="poly" title=" " alt="" coords="384,259,444,320,540,402,598,445,661,484,728,518,798,542,870,557,944,563,1019,563,1092,558,1226,537,1331,511,1332,517,1227,542,1093,563,1019,568,944,568,869,562,797,547,726,523,659,489,595,449,537,407,440,323,380,262"/>
<area shape="poly" title=" " alt="" coords="441,224,456,213,467,202,473,189,478,163,484,138,492,125,504,115,606,59,698,23,742,12,786,6,871,5,958,17,1049,41,1260,114,1296,132,1329,155,1379,205,1376,209,1325,160,1293,136,1258,119,1048,46,957,22,871,10,786,11,744,18,700,28,608,63,508,119,496,129,489,140,483,164,478,191,471,205,460,217,444,228"/>
<area shape="poly" title=" " alt="" coords="446,228,506,221,640,208,746,200,851,199,986,209,1064,218,1124,230,1260,261,1304,270,1302,275,1258,266,1122,235,1063,224,985,214,851,205,746,205,641,213,506,226,447,233"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#ac79cacbc6a47f754832dc10bafa3b761" title=" " alt="" coords="848,224,935,258"/>
<area shape="poly" title=" " alt="" coords="447,240,832,238,832,244,447,246"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5a5283071ac5677652515d9a8460e655" title=" " alt="" coords="506,329,749,363"/>
<area shape="poly" title=" " alt="" coords="412,258,569,321,567,326,410,263"/>
<area shape="poly" title=" " alt="" coords="750,331,1055,299,1056,305,750,336"/>
<area shape="poly" title=" " alt="" coords="647,362,710,422,752,456,799,485,808,490,806,495,796,490,749,460,706,426,643,365"/>
<area shape="poly" title=" " alt="" coords="670,326,796,274,832,260,834,265,798,279,672,331"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6b6c429265d86411d05951d2fae7289a" title=" " alt="" coords="804,384,979,418"/>
<area shape="poly" title=" " alt="" coords="713,361,792,378,791,383,712,366"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a2c4753820a7472bba7b999fbba79df01" title=" " alt="" coords="821,441,962,475"/>
<area shape="poly" title=" " alt="" coords="661,361,724,394,798,428,814,433,812,438,796,433,721,399,659,366"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a131936c081164c18e6241d79f3b276d1" title=" " alt="" coords="1034,333,1259,367"/>
<area shape="poly" title=" " alt="" coords="750,344,1018,346,1018,352,750,350"/>
<area shape="poly" title=" " alt="" coords="962,449,1337,417,1338,422,963,455"/>
<area shape="poly" title=" " alt="" coords="1178,365,1308,441,1355,466,1352,471,1306,446,1175,370"/>
<area shape="poly" title=" " alt="" coords="1237,330,1257,320,1272,306,1281,292,1290,276,1305,261,1312,257,1315,262,1309,265,1294,280,1285,294,1277,310,1261,324,1239,335"/>
<area shape="poly" title=" " alt="" coords="1259,347,1301,347,1301,353,1259,353"/>
<area shape="poly" title=" " alt="" coords="1224,330,1309,311,1310,316,1225,335"/>
<area shape="poly" title=" " alt="" coords="1217,365,1339,396,1337,401,1216,370"/>
</map>
</div>

</div>
</div>
<a id="a7e7ceb5ee690aa943096b3398fe195f9" name="a7e7ceb5ee690aa943096b3398fe195f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e7ceb5ee690aa943096b3398fe195f9">&#9670;&#160;</a></span>parseOCIrlimit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parseOCIrlimit </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01686">1686</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1687</span>{</div>
<div class="line"><span class="lineno"> 1688</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *tb[<a class="code hl_enumvalue" href="#afb24d298ddd4bc4ff61aa333f07a574aa14fdf8fb6dafa566ba443a7c41296bab">__OCI_PROCESS_RLIMIT_MAX</a>];</div>
<div class="line"><span class="lineno"> 1689</span>    <span class="keywordtype">int</span> limtype = -1;</div>
<div class="line"><span class="lineno"> 1690</span>    <span class="keyword">struct </span>rlimit *curlim;</div>
<div class="line"><span class="lineno"> 1691</span> </div>
<div class="line"><span class="lineno"> 1692</span>    <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#ab2016d906e4123e8386859e6fca23ce6">oci_process_rlimit_policy</a>, <a class="code hl_enumvalue" href="#afb24d298ddd4bc4ff61aa333f07a574aa14fdf8fb6dafa566ba443a7c41296bab">__OCI_PROCESS_RLIMIT_MAX</a>, tb, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(msg), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a>(msg));</div>
<div class="line"><span class="lineno"> 1693</span> </div>
<div class="line"><span class="lineno"> 1694</span>    <span class="keywordflow">if</span> (!tb[<a class="code hl_enumvalue" href="#afb24d298ddd4bc4ff61aa333f07a574aa82cefaa500e6667fae114a7a427a70e8">OCI_PROCESS_RLIMIT_TYPE</a>] ||</div>
<div class="line"><span class="lineno"> 1695</span>        !tb[<a class="code hl_enumvalue" href="#afb24d298ddd4bc4ff61aa333f07a574aa54aef840a8921bd694bd098d26909f5b">OCI_PROCESS_RLIMIT_SOFT</a>] ||</div>
<div class="line"><span class="lineno"> 1696</span>        !tb[<a class="code hl_enumvalue" href="#afb24d298ddd4bc4ff61aa333f07a574aa7c4a1dc8832ab814f8153330af5c53c0">OCI_PROCESS_RLIMIT_HARD</a>])</div>
<div class="line"><span class="lineno"> 1697</span>        <span class="keywordflow">return</span> ENODATA;</div>
<div class="line"><span class="lineno"> 1698</span> </div>
<div class="line"><span class="lineno"> 1699</span>    limtype = <a class="code hl_function" href="#a403387af16adfc17ce1cb6f14b82afb1">resolve_rlimit</a>(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#afb24d298ddd4bc4ff61aa333f07a574aa82cefaa500e6667fae114a7a427a70e8">OCI_PROCESS_RLIMIT_TYPE</a>]));</div>
<div class="line"><span class="lineno"> 1700</span> </div>
<div class="line"><span class="lineno"> 1701</span>    <span class="keywordflow">if</span> (limtype &lt; 0)</div>
<div class="line"><span class="lineno"> 1702</span>        <span class="keywordflow">return</span> EINVAL;</div>
<div class="line"><span class="lineno"> 1703</span> </div>
<div class="line"><span class="lineno"> 1704</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.rlimits[limtype])</div>
<div class="line"><span class="lineno"> 1705</span>        <span class="keywordflow">return</span> ENOTUNIQ;</div>
<div class="line"><span class="lineno"> 1706</span> </div>
<div class="line"><span class="lineno"> 1707</span>    curlim = malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> rlimit));</div>
<div class="line"><span class="lineno"> 1708</span>    curlim-&gt;rlim_cur = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a8f13b26eaebcdf626e534b33f887925c">blobmsg_cast_u64</a>(tb[<a class="code hl_enumvalue" href="#afb24d298ddd4bc4ff61aa333f07a574aa54aef840a8921bd694bd098d26909f5b">OCI_PROCESS_RLIMIT_SOFT</a>]);</div>
<div class="line"><span class="lineno"> 1709</span>    curlim-&gt;rlim_max = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a8f13b26eaebcdf626e534b33f887925c">blobmsg_cast_u64</a>(tb[<a class="code hl_enumvalue" href="#afb24d298ddd4bc4ff61aa333f07a574aa7c4a1dc8832ab814f8153330af5c53c0">OCI_PROCESS_RLIMIT_HARD</a>]);</div>
<div class="line"><span class="lineno"> 1710</span> </div>
<div class="line"><span class="lineno"> 1711</span>    <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.rlimits[limtype] = curlim;</div>
<div class="line"><span class="lineno"> 1712</span> </div>
<div class="line"><span class="lineno"> 1713</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1714</span>};</div>
<div class="ttc" id="ablobmsg_8h_html_a8f13b26eaebcdf626e534b33f887925c"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a8f13b26eaebcdf626e534b33f887925c">blobmsg_cast_u64</a></div><div class="ttdeci">static uint64_t blobmsg_cast_u64(struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00306">blobmsg.h:306</a></div></div>
<div class="ttc" id="ajail_8c_html_a403387af16adfc17ce1cb6f14b82afb1"><div class="ttname"><a href="#a403387af16adfc17ce1cb6f14b82afb1">resolve_rlimit</a></div><div class="ttdeci">static int resolve_rlimit(char *type)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01673">jail.c:1673</a></div></div>
<div class="ttc" id="ajail_8c_html_ab2016d906e4123e8386859e6fca23ce6"><div class="ttname"><a href="#ab2016d906e4123e8386859e6fca23ce6">oci_process_rlimit_policy</a></div><div class="ttdeci">static const struct blobmsg_policy oci_process_rlimit_policy[]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01647">jail.c:1647</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l01644">__OCI_PROCESS_RLIMIT_MAX</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00306">blobmsg_cast_u64()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00078">blobmsg_data()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00348">blobmsg_get_string()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00108">blobmsg_len()</a>, <a class="el" href="../../d1/d30/blobmsg_8c_source.html#l00166">blobmsg_parse()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01643">OCI_PROCESS_RLIMIT_HARD</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01647">oci_process_rlimit_policy</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01642">OCI_PROCESS_RLIMIT_SOFT</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01641">OCI_PROCESS_RLIMIT_TYPE</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l01673">resolve_rlimit()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01742">parseOCIprocess()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a7e7ceb5ee690aa943096b3398fe195f9_cgraph.png" border="0" usemap="#add/d26/jail_8c_a7e7ceb5ee690aa943096b3398fe195f9_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a7e7ceb5ee690aa943096b3398fe195f9_cgraph" id="add/d26/jail_8c_a7e7ceb5ee690aa943096b3398fe195f9_cgraph">
<area shape="rect" title=" " alt="" coords="5,344,161,378"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a8f13b26eaebcdf626e534b33f887925c" title=" " alt="" coords="485,148,678,182"/>
<area shape="poly" title=" " alt="" coords="98,342,145,299,175,275,207,256,273,228,341,206,469,177,470,182,342,211,274,233,210,261,178,280,148,303,102,345"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="1025,283,1176,316"/>
<area shape="poly" title=" " alt="" coords="111,341,155,318,208,300,317,278,411,267,493,264,571,267,733,282,828,289,940,293,1009,294,1009,300,940,298,828,294,733,287,571,273,493,270,411,272,318,283,209,305,157,323,113,346"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603" title=" " alt="" coords="209,315,412,348"/>
<area shape="poly" title=" " alt="" coords="161,348,192,344,193,349,161,353"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5" title=" " alt="" coords="513,795,651,828"/>
<area shape="poly" title=" " alt="" coords="118,376,210,416,241,424,269,427,320,427,344,428,367,434,390,446,414,467,429,486,440,506,449,545,447,584,440,622,432,660,430,698,438,736,448,755,462,774,479,788,499,798,497,803,476,792,458,777,443,757,433,738,425,698,427,659,434,621,442,583,443,545,435,508,425,489,410,471,387,450,365,439,343,433,320,432,269,432,240,429,208,421,116,381"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed" title=" " alt="" coords="229,372,392,406"/>
<area shape="poly" title=" " alt="" coords="161,368,214,374,213,380,161,373"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a403387af16adfc17ce1cb6f14b82afb1" title=" " alt="" coords="238,481,383,515"/>
<area shape="poly" title=" " alt="" coords="103,376,149,417,210,460,237,473,235,478,207,464,146,422,100,380"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a38fb5688af8a7f3e9eae5c653ed2bb50" title=" " alt="" coords="753,205,938,239"/>
<area shape="poly" title=" " alt="" coords="663,180,751,199,749,204,662,185"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f" title=" " alt="" coords="753,33,938,67"/>
<area shape="poly" title=" " alt="" coords="611,145,674,111,750,76,765,70,767,75,752,81,677,116,614,150"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab631ab3a5e71a8742449cd374a63ecec" title=" " alt="" coords="753,91,938,124"/>
<area shape="poly" title=" " alt="" coords="662,145,749,126,751,131,663,150"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#af2c32f6db6f49388da60dda520d86c4d" title=" " alt="" coords="759,148,932,182"/>
<area shape="poly" title=" " alt="" coords="679,162,743,162,743,168,679,168"/>
<area shape="poly" title=" " alt="" coords="904,237,1028,275,1027,280,903,242"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="1301,661,1412,695"/>
<area shape="poly" title=" " alt="" coords="1129,315,1174,352,1196,377,1215,405,1229,437,1235,466,1236,519,1235,544,1238,570,1246,596,1263,625,1277,639,1294,652,1291,656,1274,643,1259,628,1241,598,1233,571,1230,544,1230,519,1230,466,1224,438,1211,407,1192,381,1170,356,1125,319"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="1266,281,1447,315"/>
<area shape="poly" title=" " alt="" coords="1177,296,1250,296,1250,301,1177,302"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ac239a83ed3c7f835e2b49f785953c934" title=" " alt="" coords="1271,339,1441,372"/>
<area shape="poly" title=" " alt="" coords="1177,313,1262,332,1261,337,1176,319"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a7613e130753e766f5d381c06b1f7b86f" title=" " alt="" coords="1261,396,1451,430"/>
<area shape="poly" title=" " alt="" coords="1135,314,1262,382,1277,388,1275,393,1260,387,1133,319"/>
<area shape="poly" title=" " alt="" coords="922,65,941,76,991,121,1032,173,1065,225,1087,268,1083,270,1060,227,1028,176,987,124,938,80,920,70"/>
<area shape="poly" title=" " alt="" coords="920,123,941,133,984,164,1022,201,1080,268,1076,272,1019,204,980,168,938,138,917,127"/>
<area shape="poly" title=" " alt="" coords="914,180,941,190,1010,230,1067,271,1064,275,1007,234,939,195,912,185"/>
<area shape="poly" title=" " alt="" coords="412,325,1009,300,1009,306,413,330"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052" title=" " alt="" coords="751,685,940,719"/>
<area shape="poly" title=" " alt="" coords="623,792,788,723,790,728,625,797"/>
<area shape="poly" title=" " alt="" coords="860,683,898,634,937,570,953,525,959,487,966,449,985,405,1021,360,1061,324,1064,328,1025,363,990,408,971,451,964,488,958,526,942,573,903,637,864,686"/>
<area shape="poly" title=" " alt="" coords="940,695,1285,679,1285,684,940,700"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a9921d2b89577d3344abbb66f24773e32" title=" " alt="" coords="1307,580,1405,614"/>
<area shape="poly" title=" " alt="" coords="926,682,987,669,1212,624,1292,607,1293,612,1214,629,988,674,927,687"/>
<area shape="poly" title=" " alt="" coords="387,404,414,423,428,442,436,460,440,497,443,533,450,551,462,570,496,608,527,637,557,660,589,678,660,704,752,729,824,743,899,749,973,748,1046,743,1180,722,1285,697,1286,702,1181,727,1047,748,974,753,898,754,824,748,751,734,658,710,586,683,554,665,523,641,492,611,458,573,445,553,438,534,435,497,431,462,424,444,410,427,384,409"/>
<area shape="poly" title=" " alt="" coords="390,373,410,359,429,332,437,305,438,277,435,250,432,222,432,193,439,164,458,134,491,99,523,74,555,57,587,46,660,32,751,18,804,8,846,3,888,6,940,18,1002,41,1062,70,1119,104,1173,140,1264,211,1328,268,1325,272,1261,215,1170,144,1116,108,1060,75,1000,46,939,23,888,11,846,9,805,13,752,23,661,37,589,51,557,62,526,79,495,103,462,137,444,166,437,194,437,221,440,249,443,277,442,306,434,334,414,363,394,378"/>
<area shape="poly" title=" " alt="" coords="392,387,748,392,1213,404,1246,405,1246,410,1213,409,748,397,392,392"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#ac79cacbc6a47f754832dc10bafa3b761" title=" " alt="" coords="802,416,889,450"/>
<area shape="poly" title=" " alt="" coords="392,393,787,425,786,431,392,398"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5a5283071ac5677652515d9a8460e655" title=" " alt="" coords="460,525,703,559"/>
<area shape="poly" title=" " alt="" coords="370,404,413,422,488,468,549,513,546,518,485,472,411,427,367,409"/>
<area shape="poly" title=" " alt="" coords="674,522,835,489,902,472,938,460,954,448,964,435,986,404,1067,325,1071,329,990,408,968,438,958,452,941,465,903,478,836,494,675,527"/>
<area shape="poly" title=" " alt="" coords="604,557,668,608,753,664,779,677,777,681,750,668,665,613,601,561"/>
<area shape="poly" title=" " alt="" coords="621,522,750,466,786,452,788,457,752,471,623,527"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6b6c429265d86411d05951d2fae7289a" title=" " alt="" coords="758,525,933,559"/>
<area shape="poly" title=" " alt="" coords="704,540,743,540,743,545,704,545"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a2c4753820a7472bba7b999fbba79df01" title=" " alt="" coords="1030,580,1171,614"/>
<area shape="poly" title=" " alt="" coords="614,557,676,588,714,602,752,613,820,622,889,623,956,618,1014,611,1015,616,956,624,890,628,820,627,751,618,712,607,674,593,612,562"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a131936c081164c18e6241d79f3b276d1" title=" " alt="" coords="988,419,1213,452"/>
<area shape="poly" title=" " alt="" coords="635,557,698,573,775,585,858,586,899,580,939,569,980,548,1018,520,1050,490,1074,463,1078,466,1053,494,1021,524,983,553,941,574,900,585,858,591,774,590,696,578,633,562"/>
<area shape="poly" title=" " alt="" coords="1172,594,1291,594,1291,600,1172,600"/>
<area shape="poly" title=" " alt="" coords="1119,451,1215,566,1237,597,1263,624,1304,651,1301,656,1259,628,1233,600,1211,569,1114,455"/>
<area shape="poly" title=" " alt="" coords="1121,416,1181,371,1220,346,1260,324,1272,318,1274,323,1262,329,1222,350,1184,375,1124,420"/>
<area shape="poly" title=" " alt="" coords="1153,416,1260,381,1281,375,1282,380,1262,386,1155,421"/>
<area shape="poly" title=" " alt="" coords="1213,423,1245,420,1246,425,1214,428"/>
<area shape="poly" title=" " alt="" coords="1130,451,1317,569,1314,574,1127,455"/>
</map>
</div>

</div>
</div>
<a id="a9f891a6707cacaa8e89f16ac600cf5d2" name="a9f891a6707cacaa8e89f16ac600cf5d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f891a6707cacaa8e89f16ac600cf5d2">&#9670;&#160;</a></span>parseOCIroot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parseOCIroot </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>jsonfile</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01376">1376</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1377</span>{</div>
<div class="line"><span class="lineno"> 1378</span>    <span class="keywordtype">char</span> extroot[PATH_MAX] = { 0 };</div>
<div class="line"><span class="lineno"> 1379</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *tb[<a class="code hl_enumvalue" href="#afeaa6456e370d2eb59f5e139d9f8b00ca1736cc68a5a38e1186ffbffd828bb798">__OCI_ROOT_MAX</a>];</div>
<div class="line"><span class="lineno"> 1380</span>    <span class="keywordtype">char</span> *cur;</div>
<div class="line"><span class="lineno"> 1381</span>    <span class="keywordtype">char</span> *root_path;</div>
<div class="line"><span class="lineno"> 1382</span> </div>
<div class="line"><span class="lineno"> 1383</span>    <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#a6d120785be2672cecbeb820a30617ca3">oci_root_policy</a>, <a class="code hl_enumvalue" href="#afeaa6456e370d2eb59f5e139d9f8b00ca1736cc68a5a38e1186ffbffd828bb798">__OCI_ROOT_MAX</a>, tb, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(msg), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a>(msg));</div>
<div class="line"><span class="lineno"> 1384</span> </div>
<div class="line"><span class="lineno"> 1385</span>    <span class="keywordflow">if</span> (!tb[<a class="code hl_enumvalue" href="#afeaa6456e370d2eb59f5e139d9f8b00ca19d90db86bae071a8aa290b4aa7bbb1a">OCI_ROOT_PATH</a>])</div>
<div class="line"><span class="lineno"> 1386</span>        <span class="keywordflow">return</span> ENODATA;</div>
<div class="line"><span class="lineno"> 1387</span> </div>
<div class="line"><span class="lineno"> 1388</span>    root_path = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(tb[<a class="code hl_enumvalue" href="#afeaa6456e370d2eb59f5e139d9f8b00ca19d90db86bae071a8aa290b4aa7bbb1a">OCI_ROOT_PATH</a>]);</div>
<div class="line"><span class="lineno"> 1389</span> </div>
<div class="line"><span class="lineno"> 1390</span>    <span class="comment">/* prepend bundle directory in case of relative paths */</span></div>
<div class="line"><span class="lineno"> 1391</span>    <span class="keywordflow">if</span> (root_path[0] != <span class="charliteral">&#39;/&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1392</span>        strncpy(extroot, jsonfile, PATH_MAX - 1);</div>
<div class="line"><span class="lineno"> 1393</span> </div>
<div class="line"><span class="lineno"> 1394</span>        cur = strrchr(extroot, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno"> 1395</span> </div>
<div class="line"><span class="lineno"> 1396</span>        <span class="keywordflow">if</span> (!cur)</div>
<div class="line"><span class="lineno"> 1397</span>            <span class="keywordflow">return</span> ENOTDIR;</div>
<div class="line"><span class="lineno"> 1398</span> </div>
<div class="line"><span class="lineno"> 1399</span>        *(++cur) = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1400</span>    }</div>
<div class="line"><span class="lineno"> 1401</span> </div>
<div class="line"><span class="lineno"> 1402</span>    strncat(extroot, root_path, PATH_MAX - (strlen(extroot) + 1));</div>
<div class="line"><span class="lineno"> 1403</span> </div>
<div class="line"><span class="lineno"> 1404</span>    <span class="comment">/* follow symbolic link(s) */</span></div>
<div class="line"><span class="lineno"> 1405</span>    <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.extroot = realpath(extroot, NULL);</div>
<div class="line"><span class="lineno"> 1406</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.extroot)</div>
<div class="line"><span class="lineno"> 1407</span>        <span class="keywordflow">return</span> errno;</div>
<div class="line"><span class="lineno"> 1408</span> </div>
<div class="line"><span class="lineno"> 1409</span>    <span class="keywordflow">if</span> (tb[<a class="code hl_enumvalue" href="#afeaa6456e370d2eb59f5e139d9f8b00ca5de1f8b436ee1fcb78d7aa9a8e2c5990">OCI_ROOT_READONLY</a>])</div>
<div class="line"><span class="lineno"> 1410</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ronly = <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#adfbec0b532211a1442310392496a45f2">blobmsg_get_bool</a>(tb[<a class="code hl_enumvalue" href="#afeaa6456e370d2eb59f5e139d9f8b00ca5de1f8b436ee1fcb78d7aa9a8e2c5990">OCI_ROOT_READONLY</a>]);</div>
<div class="line"><span class="lineno"> 1411</span> </div>
<div class="line"><span class="lineno"> 1412</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1413</span>}</div>
<div class="ttc" id="ajail_8c_html_a6d120785be2672cecbeb820a30617ca3"><div class="ttname"><a href="#a6d120785be2672cecbeb820a30617ca3">oci_root_policy</a></div><div class="ttdeci">static const struct blobmsg_policy oci_root_policy[]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01371">jail.c:1371</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l01368">__OCI_ROOT_MAX</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00078">blobmsg_data()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00283">blobmsg_get_bool()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00348">blobmsg_get_string()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00108">blobmsg_len()</a>, <a class="el" href="../../d1/d30/blobmsg_8c_source.html#l00166">blobmsg_parse()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01366">OCI_ROOT_PATH</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01371">oci_root_policy</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01367">OCI_ROOT_READONLY</a>, and <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02323">parseOCI()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a9f891a6707cacaa8e89f16ac600cf5d2_cgraph.png" border="0" usemap="#add/d26/jail_8c_a9f891a6707cacaa8e89f16ac600cf5d2_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a9f891a6707cacaa8e89f16ac600cf5d2_cgraph" id="add/d26/jail_8c_a9f891a6707cacaa8e89f16ac600cf5d2_cgraph">
<area shape="rect" title=" " alt="" coords="5,289,149,323"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="1013,388,1164,421"/>
<area shape="poly" title=" " alt="" coords="149,291,196,284,359,267,570,251,678,249,777,254,863,268,899,279,929,293,947,310,955,329,962,348,977,366,1000,380,997,384,974,370,958,351,950,331,943,313,926,297,897,284,862,273,777,259,678,255,571,257,360,273,197,290,149,296"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#adfbec0b532211a1442310392496a45f2" title=" " alt="" coords="476,289,664,323"/>
<area shape="poly" title=" " alt="" coords="149,303,460,303,460,308,149,308"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603" title=" " alt="" coords="197,180,400,213"/>
<area shape="poly" title=" " alt="" coords="101,286,144,258,195,230,227,217,229,222,198,235,147,263,104,291"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5" title=" " alt="" coords="501,529,639,563"/>
<area shape="poly" title=" " alt="" coords="101,321,145,354,198,387,278,428,361,465,504,521,502,526,359,470,276,433,195,392,142,358,98,325"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed" title=" " alt="" coords="217,344,380,377"/>
<area shape="poly" title=" " alt="" coords="149,321,213,337,212,342,147,326"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="1289,525,1400,559"/>
<area shape="poly" title=" " alt="" coords="1165,414,1202,430,1219,444,1228,459,1237,474,1251,489,1291,515,1288,520,1247,493,1232,477,1224,462,1215,448,1200,435,1163,419"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="1254,330,1435,364"/>
<area shape="poly" title=" " alt="" coords="1164,385,1251,365,1252,370,1165,390"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ac239a83ed3c7f835e2b49f785953c934" title=" " alt="" coords="1259,445,1429,479"/>
<area shape="poly" title=" " alt="" coords="1165,419,1252,438,1251,444,1164,424"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a7613e130753e766f5d381c06b1f7b86f" title=" " alt="" coords="1249,388,1439,421"/>
<area shape="poly" title=" " alt="" coords="1165,402,1234,402,1234,407,1165,407"/>
<area shape="poly" title=" " alt="" coords="664,299,791,303,860,311,928,325,993,348,1048,377,1046,382,991,353,927,330,859,316,790,308,664,304"/>
<area shape="poly" title=" " alt="" coords="400,177,513,167,648,167,720,174,792,185,862,204,929,230,975,260,1015,298,1048,338,1072,373,1067,376,1044,341,1012,301,972,264,926,235,860,209,791,191,719,179,648,173,513,173,401,183"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052" title=" " alt="" coords="739,557,928,591"/>
<area shape="poly" title=" " alt="" coords="640,550,724,559,723,565,639,556"/>
<area shape="poly" title=" " alt="" coords="911,554,926,544,937,530,944,517,949,488,954,459,961,445,974,430,997,416,1000,421,977,435,966,448,959,461,954,489,949,518,942,533,929,548,914,559"/>
<area shape="poly" title=" " alt="" coords="928,565,1273,544,1273,549,928,571"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a9921d2b89577d3344abbb66f24773e32" title=" " alt="" coords="1295,650,1393,684"/>
<area shape="poly" title=" " alt="" coords="928,588,1280,653,1279,658,928,594"/>
<area shape="poly" title=" " alt="" coords="308,377,326,419,355,473,396,529,421,553,449,573,502,600,557,621,615,636,674,646,733,652,793,654,912,648,1025,631,1127,609,1215,584,1283,562,1284,567,1216,589,1128,614,1026,636,912,653,793,659,733,658,673,652,614,641,556,626,500,605,447,577,418,557,392,532,351,476,321,421,303,379"/>
<area shape="poly" title=" " alt="" coords="312,342,352,290,398,224,410,197,416,172,425,149,446,129,549,72,644,32,733,10,821,3,909,12,1000,37,1097,76,1202,129,1229,146,1252,168,1290,218,1318,270,1335,315,1331,317,1313,272,1286,221,1248,171,1225,150,1200,133,1095,81,998,42,908,18,821,9,734,15,645,37,551,77,450,133,429,152,421,173,415,198,402,227,356,293,316,345"/>
<area shape="poly" title=" " alt="" coords="320,341,376,305,410,287,447,274,519,258,580,249,635,246,687,249,793,267,928,293,1085,330,1268,380,1267,386,1084,335,927,298,793,272,686,255,635,252,581,254,520,263,449,279,413,292,378,309,323,345"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#ac79cacbc6a47f754832dc10bafa3b761" title=" " alt="" coords="790,340,877,373"/>
<area shape="poly" title=" " alt="" coords="380,357,774,354,774,360,380,363"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5a5283071ac5677652515d9a8460e655" title=" " alt="" coords="448,445,691,479"/>
<area shape="poly" title=" " alt="" coords="347,375,509,437,507,442,345,380"/>
<area shape="poly" title=" " alt="" coords="692,446,997,412,998,417,692,451"/>
<area shape="poly" title=" " alt="" coords="614,477,693,514,716,529,741,543,754,549,752,554,738,548,714,534,690,519,612,482"/>
<area shape="poly" title=" " alt="" coords="612,442,738,390,774,376,776,381,740,395,614,447"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6b6c429265d86411d05951d2fae7289a" title=" " alt="" coords="746,500,921,533"/>
<area shape="poly" title=" " alt="" coords="655,477,734,493,733,499,654,482"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a2c4753820a7472bba7b999fbba79df01" title=" " alt="" coords="763,678,904,712"/>
<area shape="poly" title=" " alt="" coords="629,477,662,493,693,515,711,536,720,557,728,578,742,602,771,636,802,666,799,670,768,640,737,605,723,580,715,559,706,539,690,518,660,497,627,482"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a131936c081164c18e6241d79f3b276d1" title=" " alt="" coords="976,445,1201,479"/>
<area shape="poly" title=" " alt="" coords="692,459,960,459,960,464,692,464"/>
<area shape="poly" title=" " alt="" coords="905,693,1042,691,1201,683,1279,674,1280,680,1201,688,1042,696,905,698"/>
<area shape="poly" title=" " alt="" coords="1145,477,1274,517,1273,522,1144,482"/>
<area shape="poly" title=" " alt="" coords="1179,442,1199,432,1214,418,1223,403,1232,388,1247,373,1254,369,1257,373,1251,377,1236,391,1227,406,1219,421,1203,436,1181,447"/>
<area shape="poly" title=" " alt="" coords="1201,459,1243,459,1243,464,1201,464"/>
<area shape="poly" title=" " alt="" coords="1166,442,1251,423,1252,428,1167,447"/>
<area shape="poly" title=" " alt="" coords="1112,477,1312,638,1308,642,1109,481"/>
</map>
</div>

</div>
</div>
<a id="a553876759c42a12a39f61a93d27b27ef" name="a553876759c42a12a39f61a93d27b27ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a553876759c42a12a39f61a93d27b27ef">&#9670;&#160;</a></span>parseOCIsysctl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parseOCIsysctl </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02125">2125</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2126</span>{</div>
<div class="line"><span class="lineno"> 2127</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *cur;</div>
<div class="line"><span class="lineno"> 2128</span>    <span class="keywordtype">int</span> rem;</div>
<div class="line"><span class="lineno"> 2129</span>    <span class="keywordtype">char</span> *tmp, *tc;</div>
<div class="line"><span class="lineno"> 2130</span>    <span class="keywordtype">size_t</span> cnt = 0;</div>
<div class="line"><span class="lineno"> 2131</span> </div>
<div class="line"><span class="lineno"> 2132</span>    <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, msg, rem) {</div>
<div class="line"><span class="lineno"> 2133</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6ee526c7b55debcecad8e34e3e6108d0">blobmsg_name</a>(cur) || !<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(cur))</div>
<div class="line"><span class="lineno"> 2134</span>            <span class="keywordflow">return</span> EINVAL;</div>
<div class="line"><span class="lineno"> 2135</span> </div>
<div class="line"><span class="lineno"> 2136</span>        ++cnt;</div>
<div class="line"><span class="lineno"> 2137</span>    }</div>
<div class="line"><span class="lineno"> 2138</span> </div>
<div class="line"><span class="lineno"> 2139</span>    <span class="keywordflow">if</span> (!cnt)</div>
<div class="line"><span class="lineno"> 2140</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2141</span> </div>
<div class="line"><span class="lineno"> 2142</span>    <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.sysctl = calloc(cnt + 1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="#de/d02/structsysctl__val">sysctl_val</a> *));</div>
<div class="line"><span class="lineno"> 2143</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.sysctl)</div>
<div class="line"><span class="lineno"> 2144</span>        <span class="keywordflow">return</span> ENOMEM;</div>
<div class="line"><span class="lineno"> 2145</span> </div>
<div class="line"><span class="lineno"> 2146</span>    cnt = 0;</div>
<div class="line"><span class="lineno"> 2147</span>    <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, msg, rem) {</div>
<div class="line"><span class="lineno"> 2148</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.sysctl[cnt] = malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="#de/d02/structsysctl__val">sysctl_val</a>));</div>
<div class="line"><span class="lineno"> 2149</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.sysctl[cnt])</div>
<div class="line"><span class="lineno"> 2150</span>            <span class="keywordflow">return</span> ENOMEM;</div>
<div class="line"><span class="lineno"> 2151</span> </div>
<div class="line"><span class="lineno"> 2152</span>        <span class="comment">/* replace &#39;.&#39; with &#39;/&#39; in entry name */</span></div>
<div class="line"><span class="lineno"> 2153</span>        tc = tmp = strdup(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6ee526c7b55debcecad8e34e3e6108d0">blobmsg_name</a>(cur));</div>
<div class="line"><span class="lineno"> 2154</span>        <span class="keywordflow">while</span> ((tc = strchr(tc, <span class="charliteral">&#39;.&#39;</span>)))</div>
<div class="line"><span class="lineno"> 2155</span>            *tc = <span class="charliteral">&#39;/&#39;</span>;</div>
<div class="line"><span class="lineno"> 2156</span> </div>
<div class="line"><span class="lineno"> 2157</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.sysctl[cnt]-&gt;value = strdup(<a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603">blobmsg_get_string</a>(cur));</div>
<div class="line"><span class="lineno"> 2158</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.sysctl[cnt]-&gt;entry = tmp;</div>
<div class="line"><span class="lineno"> 2159</span> </div>
<div class="line"><span class="lineno"> 2160</span>        ++cnt;</div>
<div class="line"><span class="lineno"> 2161</span>    }</div>
<div class="line"><span class="lineno"> 2162</span> </div>
<div class="line"><span class="lineno"> 2163</span>    <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.sysctl[cnt] = NULL;</div>
<div class="line"><span class="lineno"> 2164</span> </div>
<div class="line"><span class="lineno"> 2165</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2166</span>}</div>
<div class="ttc" id="ablobmsg_8h_html_a6ee526c7b55debcecad8e34e3e6108d0"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a6ee526c7b55debcecad8e34e3e6108d0">blobmsg_name</a></div><div class="ttdeci">static const char * blobmsg_name(const struct blob_attr *attr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00062">blobmsg.h:62</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00364">blobmsg_for_each_attr</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00348">blobmsg_get_string()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00062">blobmsg_name()</a>, and <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02198">parseOCIlinux()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a553876759c42a12a39f61a93d27b27ef_cgraph.png" border="0" usemap="#add/d26/jail_8c_a553876759c42a12a39f61a93d27b27ef_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a553876759c42a12a39f61a93d27b27ef_cgraph" id="add/d26/jail_8c_a553876759c42a12a39f61a93d27b27ef_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,166,68"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a6c1cc8e52e96bf9698f6b0f65ad48603" title=" " alt="" coords="214,61,417,95"/>
<area shape="poly" title=" " alt="" coords="167,58,198,62,198,67,166,63"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a6ee526c7b55debcecad8e34e3e6108d0" title=" " alt="" coords="465,5,627,39"/>
<area shape="poly" title=" " alt="" coords="166,44,449,26,450,31,166,49"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="471,63,622,96"/>
<area shape="poly" title=" " alt="" coords="417,76,455,76,455,82,417,81"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="715,5,826,39"/>
<area shape="poly" title=" " alt="" coords="614,60,699,38,700,43,615,65"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="680,63,861,96"/>
<area shape="poly" title=" " alt="" coords="622,77,664,77,664,82,622,82"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ac239a83ed3c7f835e2b49f785953c934" title=" " alt="" coords="685,120,856,154"/>
<area shape="poly" title=" " alt="" coords="615,94,688,113,686,118,614,99"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a7613e130753e766f5d381c06b1f7b86f" title=" " alt="" coords="675,177,866,211"/>
<area shape="poly" title=" " alt="" coords="570,95,617,129,677,164,688,169,686,174,674,169,614,134,567,99"/>
<area shape="poly" title=" " alt="" coords="628,20,699,20,699,25,628,25"/>
</map>
</div>

</div>
</div>
<a id="a8ba489d2464ce8b1fb4a3ba5df1e22dc" name="a8ba489d2464ce8b1fb4a3ba5df1e22dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ba489d2464ce8b1fb4a3ba5df1e22dc">&#9670;&#160;</a></span>parseOCIuidgidmappings()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int parseOCIuidgidmappings </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>is_gidmap</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01964">1964</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1965</span>{</div>
<div class="line"><span class="lineno"> 1966</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *tb[<a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a95e8d0d6c43c4f8cdf24c665d45834a1">__OCI_LINUX_UIDGIDMAP_MAX</a>];</div>
<div class="line"><span class="lineno"> 1967</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#dc/dd9/structblob__attr">blob_attr</a> *cur;</div>
<div class="line"><span class="lineno"> 1968</span>    <span class="keywordtype">int</span> rem;</div>
<div class="line"><span class="lineno"> 1969</span>    <span class="keywordtype">char</span> *map;</div>
<div class="line"><span class="lineno"> 1970</span>    <span class="keywordtype">size_t</span> len, pos, totallen = 0;</div>
<div class="line"><span class="lineno"> 1971</span> </div>
<div class="line"><span class="lineno"> 1972</span>    <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, msg, rem) {</div>
<div class="line"><span class="lineno"> 1973</span>        <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#a387d39c38022d5a883597493a72e4dc6">oci_linux_uidgidmap_policy</a>, <a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a95e8d0d6c43c4f8cdf24c665d45834a1">__OCI_LINUX_UIDGIDMAP_MAX</a>, tb, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a>(cur));</div>
<div class="line"><span class="lineno"> 1974</span> </div>
<div class="line"><span class="lineno"> 1975</span>        <span class="keywordflow">if</span> (!tb[<a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a7be3c350b969aa7e666feec5231a0619">OCI_LINUX_UIDGIDMAP_CONTAINERID</a>] ||</div>
<div class="line"><span class="lineno"> 1976</span>            !tb[<a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a9d04002b30779f94d79d2998244f6ff2">OCI_LINUX_UIDGIDMAP_HOSTID</a>] ||</div>
<div class="line"><span class="lineno"> 1977</span>            !tb[<a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9af62eeb729d82816dca12d392f7c0242c">OCI_LINUX_UIDGIDMAP_SIZE</a>])</div>
<div class="line"><span class="lineno"> 1978</span>            <span class="keywordflow">return</span> EINVAL;</div>
<div class="line"><span class="lineno"> 1979</span> </div>
<div class="line"><span class="lineno"> 1980</span>        <span class="comment">/* count length */</span></div>
<div class="line"><span class="lineno"> 1981</span>        totallen += snprintf(NULL, 0, <span class="stringliteral">&quot;%d %d %d\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1982</span>             <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a7be3c350b969aa7e666feec5231a0619">OCI_LINUX_UIDGIDMAP_CONTAINERID</a>]),</div>
<div class="line"><span class="lineno"> 1983</span>             <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a9d04002b30779f94d79d2998244f6ff2">OCI_LINUX_UIDGIDMAP_HOSTID</a>]),</div>
<div class="line"><span class="lineno"> 1984</span>             <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9af62eeb729d82816dca12d392f7c0242c">OCI_LINUX_UIDGIDMAP_SIZE</a>]));</div>
<div class="line"><span class="lineno"> 1985</span>    }</div>
<div class="line"><span class="lineno"> 1986</span> </div>
<div class="line"><span class="lineno"> 1987</span>    <span class="comment">/* allocate combined mapping string */</span></div>
<div class="line"><span class="lineno"> 1988</span>    map = malloc(totallen + 1);</div>
<div class="line"><span class="lineno"> 1989</span>    <span class="keywordflow">if</span> (!map)</div>
<div class="line"><span class="lineno"> 1990</span>        <span class="keywordflow">return</span> ENOMEM;</div>
<div class="line"><span class="lineno"> 1991</span> </div>
<div class="line"><span class="lineno"> 1992</span>    pos = 0;</div>
<div class="line"><span class="lineno"> 1993</span>    <a class="code hl_define" href="../../dd/dad/blobmsg_8h.html#a69a81065d5c7977bc26fbd093f21a132">blobmsg_for_each_attr</a>(cur, msg, rem) {</div>
<div class="line"><span class="lineno"> 1994</span>        <a class="code hl_function" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed">blobmsg_parse</a>(<a class="code hl_variable" href="#a387d39c38022d5a883597493a72e4dc6">oci_linux_uidgidmap_policy</a>, <a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a95e8d0d6c43c4f8cdf24c665d45834a1">__OCI_LINUX_UIDGIDMAP_MAX</a>, tb, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20">blobmsg_data</a>(cur), <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5">blobmsg_len</a>(cur));</div>
<div class="line"><span class="lineno"> 1995</span> </div>
<div class="line"><span class="lineno"> 1996</span>        <a class="code hl_function" href="#a39b7846b508242141ff2f681fb681fdc">get_jail_root_user</a>(is_gidmap, <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a7be3c350b969aa7e666feec5231a0619">OCI_LINUX_UIDGIDMAP_CONTAINERID</a>]),</div>
<div class="line"><span class="lineno"> 1997</span>             <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a9d04002b30779f94d79d2998244f6ff2">OCI_LINUX_UIDGIDMAP_HOSTID</a>]),</div>
<div class="line"><span class="lineno"> 1998</span>             <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9af62eeb729d82816dca12d392f7c0242c">OCI_LINUX_UIDGIDMAP_SIZE</a>]));</div>
<div class="line"><span class="lineno"> 1999</span> </div>
<div class="line"><span class="lineno"> 2000</span>        <span class="comment">/* write mapping line into pre-allocated string */</span></div>
<div class="line"><span class="lineno"> 2001</span>        len = snprintf(&amp;map[pos], totallen + 1, <span class="stringliteral">&quot;%d %d %d\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 2002</span>             <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a7be3c350b969aa7e666feec5231a0619">OCI_LINUX_UIDGIDMAP_CONTAINERID</a>]),</div>
<div class="line"><span class="lineno"> 2003</span>             <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a9d04002b30779f94d79d2998244f6ff2">OCI_LINUX_UIDGIDMAP_HOSTID</a>]),</div>
<div class="line"><span class="lineno"> 2004</span>             <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f">blobmsg_get_u32</a>(tb[<a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9af62eeb729d82816dca12d392f7c0242c">OCI_LINUX_UIDGIDMAP_SIZE</a>]));</div>
<div class="line"><span class="lineno"> 2005</span>        pos += len;</div>
<div class="line"><span class="lineno"> 2006</span>        totallen -= len;</div>
<div class="line"><span class="lineno"> 2007</span>    }</div>
<div class="line"><span class="lineno"> 2008</span> </div>
<div class="line"><span class="lineno"> 2009</span>    assert(totallen == 0);</div>
<div class="line"><span class="lineno"> 2010</span> </div>
<div class="line"><span class="lineno"> 2011</span>    <span class="keywordflow">if</span> (is_gidmap)</div>
<div class="line"><span class="lineno"> 2012</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.gidmap = map;</div>
<div class="line"><span class="lineno"> 2013</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2014</span>        <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.uidmap = map;</div>
<div class="line"><span class="lineno"> 2015</span> </div>
<div class="line"><span class="lineno"> 2016</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2017</span>}</div>
<div class="ttc" id="ajail_8c_html_a387d39c38022d5a883597493a72e4dc6"><div class="ttname"><a href="#a387d39c38022d5a883597493a72e4dc6">oci_linux_uidgidmap_policy</a></div><div class="ttdeci">static const struct blobmsg_policy oci_linux_uidgidmap_policy[]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01958">jail.c:1958</a></div></div>
<div class="ttc" id="ajail_8c_html_a39b7846b508242141ff2f681fb681fdc"><div class="ttname"><a href="#a39b7846b508242141ff2f681fb681fdc">get_jail_root_user</a></div><div class="ttdeci">static void get_jail_root_user(bool is_gidmap, uint32_t container_id, uint32_t host_id, uint32_t size)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01944">jail.c:1944</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l01955">__OCI_LINUX_UIDGIDMAP_MAX</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00078">blobmsg_data()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00364">blobmsg_for_each_attr</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00293">blobmsg_get_u32()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00108">blobmsg_len()</a>, <a class="el" href="../../d1/d30/blobmsg_8c_source.html#l00166">blobmsg_parse()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01944">get_jail_root_user()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01952">OCI_LINUX_UIDGIDMAP_CONTAINERID</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01953">OCI_LINUX_UIDGIDMAP_HOSTID</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01958">oci_linux_uidgidmap_policy</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01954">OCI_LINUX_UIDGIDMAP_SIZE</a>, and <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02198">parseOCIlinux()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a8ba489d2464ce8b1fb4a3ba5df1e22dc_cgraph.png" border="0" usemap="#add/d26/jail_8c_a8ba489d2464ce8b1fb4a3ba5df1e22dc_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a8ba489d2464ce8b1fb4a3ba5df1e22dc_cgraph" id="add/d26/jail_8c_a8ba489d2464ce8b1fb4a3ba5df1e22dc_cgraph">
<area shape="rect" title=" " alt="" coords="5,206,263,239"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ab788ffb2ae75d047fa39be6e79571d20" title=" " alt="" coords="1105,254,1256,287"/>
<area shape="poly" title=" " alt="" coords="179,203,241,181,310,162,509,118,592,102,669,93,746,92,828,101,917,121,1021,155,1059,172,1095,195,1152,241,1149,245,1092,199,1056,177,1019,160,916,126,827,106,746,97,670,98,593,107,510,123,311,168,242,186,181,208"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a856562b4d96007d3ce1a052998451a0f" title=" " alt="" coords="569,151,754,185"/>
<area shape="poly" title=" " alt="" coords="229,202,310,190,436,178,553,170,553,176,437,184,311,196,230,208"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a2646be9952a62787018f5760ce95fdd5" title=" " alt="" coords="593,586,731,619"/>
<area shape="poly" title=" " alt="" coords="240,237,397,268,460,285,494,300,517,334,526,367,525,401,520,434,514,467,513,500,521,532,542,565,559,579,579,588,576,593,556,583,538,568,516,534,508,500,509,466,515,433,520,400,521,368,512,336,490,304,458,290,396,273,239,242"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#afb56b36905412b6618a529c171e833ed" title=" " alt="" coords="320,206,483,239"/>
<area shape="poly" title=" " alt="" coords="263,220,305,220,305,225,263,225"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a39b7846b508242141ff2f681fb681fdc" title=" " alt="" coords="311,315,492,349"/>
<area shape="poly" title=" " alt="" coords="178,237,312,293,343,306,341,311,310,298,176,242"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a66e0b636bd2bbafbf8701a1e91bbf857" title=" " alt="" coords="1381,454,1492,487"/>
<area shape="poly" title=" " alt="" coords="1258,276,1277,284,1295,296,1308,312,1316,327,1321,357,1326,388,1332,404,1343,419,1375,444,1371,448,1339,423,1327,406,1321,390,1316,358,1311,329,1304,315,1291,300,1275,289,1256,281"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a673de80167cf18faad1b4a21670d0cf3" title=" " alt="" coords="1346,196,1527,230"/>
<area shape="poly" title=" " alt="" coords="1256,251,1343,231,1344,236,1257,256"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#ac239a83ed3c7f835e2b49f785953c934" title=" " alt="" coords="1351,311,1521,345"/>
<area shape="poly" title=" " alt="" coords="1257,285,1344,304,1343,310,1256,290"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a7613e130753e766f5d381c06b1f7b86f" title=" " alt="" coords="1341,254,1531,287"/>
<area shape="poly" title=" " alt="" coords="1257,268,1326,268,1326,273,1257,273"/>
<area shape="poly" title=" " alt="" coords="755,160,882,164,952,172,1020,187,1086,212,1142,243,1139,247,1084,217,1019,192,951,177,882,169,755,166"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a065ed993444c3173838a480ba4aac052" title=" " alt="" coords="831,476,1020,510"/>
<area shape="poly" title=" " alt="" coords="703,583,868,514,870,519,705,588"/>
<area shape="poly" title=" " alt="" coords="1004,474,1018,463,1033,443,1040,423,1041,381,1042,339,1050,317,1066,296,1089,281,1092,285,1069,300,1054,320,1047,340,1046,381,1045,424,1037,446,1022,467,1008,478"/>
<area shape="poly" title=" " alt="" coords="1020,486,1365,471,1365,476,1020,492"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a9921d2b89577d3344abbb66f24773e32" title=" " alt="" coords="1387,375,1485,409"/>
<area shape="poly" title=" " alt="" coords="1004,473,1067,460,1292,421,1371,404,1372,409,1294,426,1068,465,1005,478"/>
<area shape="poly" title=" " alt="" coords="464,237,494,256,512,281,519,304,526,327,542,351,610,418,671,462,740,492,832,520,904,534,978,541,1053,541,1126,535,1260,514,1365,489,1366,494,1261,519,1127,541,1053,546,978,546,903,540,831,525,738,497,669,466,607,422,538,355,521,329,514,306,507,283,490,260,461,242"/>
<area shape="poly" title=" " alt="" coords="412,204,433,177,462,145,498,115,539,92,648,52,744,24,832,8,915,3,999,9,1087,26,1184,54,1294,92,1330,110,1363,133,1413,183,1410,186,1359,137,1327,114,1292,97,1182,59,1086,32,998,15,915,8,832,13,745,29,650,57,541,97,501,119,465,149,437,181,416,207"/>
<area shape="poly" title=" " alt="" coords="432,203,490,168,513,150,539,136,610,117,671,107,726,105,778,108,885,127,1020,154,1179,194,1363,246,1361,251,1177,199,1019,160,884,133,777,113,726,110,672,113,611,123,541,141,516,154,494,173,435,207"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#ac79cacbc6a47f754832dc10bafa3b761" title=" " alt="" coords="882,202,969,235"/>
<area shape="poly" title=" " alt="" coords="483,219,866,216,866,222,483,224"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5a5283071ac5677652515d9a8460e655" title=" " alt="" coords="540,307,783,341"/>
<area shape="poly" title=" " alt="" coords="448,237,603,298,601,303,446,242"/>
<area shape="poly" title=" " alt="" coords="784,309,1089,277,1090,282,784,314"/>
<area shape="poly" title=" " alt="" coords="681,339,744,399,786,433,833,463,842,467,840,472,830,467,783,438,740,403,677,343"/>
<area shape="poly" title=" " alt="" coords="704,304,830,252,866,238,868,243,832,257,706,309"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6b6c429265d86411d05951d2fae7289a" title=" " alt="" coords="838,362,1013,395"/>
<area shape="poly" title=" " alt="" coords="747,339,826,355,825,360,746,344"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#a2c4753820a7472bba7b999fbba79df01" title=" " alt="" coords="855,419,996,453"/>
<area shape="poly" title=" " alt="" coords="695,339,758,372,832,405,848,411,846,416,830,410,755,376,693,344"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a131936c081164c18e6241d79f3b276d1" title=" " alt="" coords="1068,311,1293,345"/>
<area shape="poly" title=" " alt="" coords="784,322,1052,324,1052,329,784,327"/>
<area shape="poly" title=" " alt="" coords="996,427,1371,395,1372,400,997,432"/>
<area shape="poly" title=" " alt="" coords="1212,343,1342,419,1389,444,1386,448,1340,423,1209,347"/>
<area shape="poly" title=" " alt="" coords="1271,308,1291,298,1306,284,1315,269,1324,254,1339,239,1346,235,1349,239,1343,243,1328,257,1319,272,1311,287,1295,302,1273,313"/>
<area shape="poly" title=" " alt="" coords="1293,325,1335,325,1335,330,1293,330"/>
<area shape="poly" title=" " alt="" coords="1258,308,1343,289,1344,294,1259,313"/>
<area shape="poly" title=" " alt="" coords="1251,343,1373,373,1371,378,1250,348"/>
</map>
</div>

</div>
</div>
<a id="ab8805304877ae73abf20f1016d21de70" name="ab8805304877ae73abf20f1016d21de70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8805304877ae73abf20f1016d21de70">&#9670;&#160;</a></span>pass_console()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void pass_console </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>console_fd</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00351">351</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  352</span>{</div>
<div class="line"><span class="lineno">  353</span>    <span class="keyword">struct </span><a class="code hl_struct" href="../../db/d55/libubus_8h.html#df/d18/structubus__context">ubus_context</a> *child_ctx = <a class="code hl_function" href="../../d4/db9/libubus_8c.html#a332dc7ace8193793cad0d83b33acbc07">ubus_connect</a>(NULL);</div>
<div class="line"><span class="lineno">  354</span>    <span class="keyword">static</span> <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/d3c/blob_8h.html#d3/dcb/structblob__buf">blob_buf</a> req;</div>
<div class="line"><span class="lineno">  355</span>    uint32_t <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#abaabdc509cdaba7df9f56c6c76f3ae19">id</a>;</div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span>    <span class="keywordflow">if</span> (!child_ctx)</div>
<div class="line"><span class="lineno">  358</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span>    <a class="code hl_function" href="../../d4/da0/blob_8c.html#af8ca2237342df92c699fbb2ddb5f390b">blob_buf_init</a>(&amp;req, 0);</div>
<div class="line"><span class="lineno">  361</span>    <a class="code hl_function" href="../../dd/dad/blobmsg_8h.html#a4bba0979961750f86b8dc9915b2fa4d6">blobmsg_add_string</a>(&amp;req, <span class="stringliteral">&quot;name&quot;</span>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.name);</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d4/db9/libubus_8c.html#a8567c5497fc066b17da409d9b0512c54">ubus_lookup_id</a>(child_ctx, <span class="stringliteral">&quot;container&quot;</span>, &amp;<span class="keywordtype">id</span>) ||</div>
<div class="line"><span class="lineno">  364</span>        <a class="code hl_function" href="../../d2/de5/libubus-req_8c.html#a572cdb5570d677242d1bc90d2d592852">ubus_invoke_fd</a>(child_ctx, <span class="keywordtype">id</span>, <span class="stringliteral">&quot;console_set&quot;</span>, req.head, NULL, NULL, 3000, <a class="code hl_variable" href="#a9942f1401f46e915dbfecc403324f562">console_fd</a>))</div>
<div class="line"><span class="lineno">  365</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#ab56f6599fb46785e4265a3033ba91aa6">INFO</a>(<span class="stringliteral">&quot;ubus request failed\n&quot;</span>);</div>
<div class="line"><span class="lineno">  366</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  367</span>        close(<a class="code hl_variable" href="#a9942f1401f46e915dbfecc403324f562">console_fd</a>);</div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span>    <a class="code hl_function" href="../../d4/da0/blob_8c.html#a58d1b624b96aa768608f45d390cc0d59">blob_buf_free</a>(&amp;req);</div>
<div class="line"><span class="lineno">  370</span>    <a class="code hl_function" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2">ubus_free</a>(child_ctx);</div>
<div class="line"><span class="lineno">  371</span>}</div>
<div class="ttc" id="ablob_8h_html_d3/dcb/structblob__buf"><div class="ttname"><a href="../../d8/d3c/blob_8h.html#d3/dcb/structblob__buf">blob_buf</a></div><div class="ttdef"><b>Definition</b> <a href="../../d8/d3c/blob_8h_source.html#l00064">blob.h:64</a></div></div>
<div class="ttc" id="alibubus-req_8c_html_a572cdb5570d677242d1bc90d2d592852"><div class="ttname"><a href="../../d2/de5/libubus-req_8c.html#a572cdb5570d677242d1bc90d2d592852">ubus_invoke_fd</a></div><div class="ttdeci">int ubus_invoke_fd(struct ubus_context *ctx, uint32_t obj, const char *method, struct blob_attr *msg, ubus_data_handler_t cb, void *priv, int timeout, int fd)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/de5/libubus-req_8c_source.html#l00236">libubus-req.c:236</a></div></div>
<div class="ttc" id="alibubus_8c_html_a8567c5497fc066b17da409d9b0512c54"><div class="ttname"><a href="../../d4/db9/libubus_8c.html#a8567c5497fc066b17da409d9b0512c54">ubus_lookup_id</a></div><div class="ttdeci">int ubus_lookup_id(struct ubus_context *ctx, const char *path, uint32_t *id)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/db9/libubus_8c_source.html#l00192">libubus.c:192</a></div></div>
<div class="ttc" id="alibubus_8h_html_df/d18/structubus__context"><div class="ttname"><a href="../../db/d55/libubus_8h.html#df/d18/structubus__context">ubus_context</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/d55/libubus_8h_source.html#l00157">libubus.h:157</a></div></div>
<div class="ttc" id="audebug-proto_8h_html_abaabdc509cdaba7df9f56c6c76f3ae19"><div class="ttname"><a href="../../dd/d8f/udebug-proto_8h.html#abaabdc509cdaba7df9f56c6c76f3ae19">id</a></div><div class="ttdeci">uint32_t id</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d8f/udebug-proto_8h_source.html#l00002">udebug-proto.h:2</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/da0/blob_8c_source.html#l00104">blob_buf_free()</a>, <a class="el" href="../../d4/da0/blob_8c_source.html#l00091">blob_buf_init()</a>, <a class="el" href="../../dd/dad/blobmsg_8h_source.html#l00235">blobmsg_add_string()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00169">console_fd</a>, <a class="el" href="../../d8/d3c/blob_8h_source.html#l00065">blob_buf::head</a>, <a class="el" href="../../dd/d8f/udebug-proto_8h_source.html#l00002">id</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00020">INFO</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="../../d4/db9/libubus_8c_source.html#l00351">ubus_connect()</a>, <a class="el" href="../../d4/db9/libubus_8c_source.html#l00378">ubus_free()</a>, <a class="el" href="../../d2/de5/libubus-req_8c_source.html#l00236">ubus_invoke_fd()</a>, and <a class="el" href="../../d4/db9/libubus_8c_source.html#l00192">ubus_lookup_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00373">create_dev_console()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_ab8805304877ae73abf20f1016d21de70_cgraph.png" border="0" usemap="#add/d26/jail_8c_ab8805304877ae73abf20f1016d21de70_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_ab8805304877ae73abf20f1016d21de70_cgraph" id="add/d26/jail_8c_ab8805304877ae73abf20f1016d21de70_cgraph">
<area shape="rect" title=" " alt="" coords="5,459,149,492"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a58d1b624b96aa768608f45d390cc0d59" title=" " alt="" coords="815,5,961,39"/>
<area shape="poly" title=" " alt="" coords="77,458,86,403,106,327,121,285,141,244,165,206,195,172,228,144,263,120,340,80,421,50,505,30,588,18,667,12,799,12,799,18,667,18,589,24,506,36,423,55,342,84,266,124,231,149,199,176,169,209,145,247,126,287,111,328,91,404,83,458"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#af8ca2237342df92c699fbb2ddb5f390b" title=" " alt="" coords="818,683,958,716"/>
<area shape="poly" title=" " alt="" coords="149,466,283,456,444,453,523,456,594,464,653,478,695,499,713,519,721,540,723,562,721,585,721,629,728,650,743,670,771,687,804,696,803,702,769,692,740,673,723,652,715,630,716,584,718,562,716,541,708,521,692,503,651,483,593,469,523,461,444,458,283,462,149,471"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a4bba0979961750f86b8dc9915b2fa4d6" title=" " alt="" coords="197,848,405,882"/>
<area shape="poly" title=" " alt="" coords="86,492,125,606,158,681,199,754,234,799,270,836,267,840,230,802,194,757,153,684,120,608,81,494"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a332dc7ace8193793cad0d83b33acbc07" title=" " alt="" coords="226,400,376,434"/>
<area shape="poly" title=" " alt="" coords="143,455,218,436,220,441,145,461"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2" title=" " alt="" coords="245,187,357,220"/>
<area shape="poly" title=" " alt="" coords="90,456,274,231,278,234,95,460"/>
<area shape="rect" href="../../d2/de5/libubus-req_8c.html#a572cdb5570d677242d1bc90d2d592852" title=" " alt="" coords="219,543,383,576"/>
<area shape="poly" title=" " alt="" coords="125,490,241,534,239,539,123,495"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a8567c5497fc066b17da409d9b0512c54" title=" " alt="" coords="219,709,383,743"/>
<area shape="poly" title=" " alt="" coords="96,491,276,696,272,699,92,494"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#af8de35ec0673663c45f2aad7c876d329" title=" " alt="" coords="1120,655,1226,688"/>
<area shape="poly" title=" " alt="" coords="958,690,1105,675,1105,681,958,695"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6f17715cbf1ce82b0981a452537b4dc6" title=" " alt="" coords="1083,712,1263,746"/>
<area shape="poly" title=" " alt="" coords="958,704,1068,715,1067,721,958,709"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a99c424ce706ada40920b2f57259e223b" title=" " alt="" coords="1514,559,1657,592"/>
<area shape="poly" title=" " alt="" coords="1193,652,1244,616,1276,599,1310,585,1358,574,1407,568,1499,566,1499,571,1408,573,1359,579,1312,590,1278,603,1247,621,1196,656"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#ab4e3964334a7aec029ab29a2c724f248" title=" " alt="" coords="1311,600,1466,634"/>
<area shape="poly" title=" " alt="" coords="1225,656,1304,635,1305,641,1226,661"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a686c428a3ab7c421820e049ab2384d47" title=" " alt="" coords="1514,629,1657,663"/>
<area shape="poly" title=" " alt="" coords="1226,666,1499,649,1499,654,1226,671"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#abe9f6013aad507ac84630ee773b806b6" title=" " alt="" coords="1321,709,1457,743"/>
<area shape="poly" title=" " alt="" coords="1226,682,1306,703,1305,708,1225,687"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a4fb5423718fbcc165ed995360ab3ea96" title=" " alt="" coords="1339,767,1438,800"/>
<area shape="poly" title=" " alt="" coords="1227,680,1264,697,1280,712,1289,726,1298,740,1313,753,1326,761,1323,766,1309,758,1294,743,1285,729,1276,715,1262,702,1225,685"/>
<area shape="poly" title=" " alt="" coords="1466,598,1499,591,1500,596,1467,603"/>
<area shape="poly" title=" " alt="" coords="1467,626,1500,631,1499,636,1466,631"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5bf37ab2b48095b7fb16ac11449b08f6" title=" " alt="" coords="476,904,670,938"/>
<area shape="poly" title=" " alt="" coords="387,880,474,898,473,903,386,885"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#aed178aa087a351c74f7f6cd34e56ba0c" title=" " alt="" coords="814,904,962,938"/>
<area shape="poly" title=" " alt="" coords="671,918,799,918,799,924,671,924"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a7af2a1ce52064d2c84b5bc1d97244acd" title=" " alt="" coords="480,396,666,430"/>
<area shape="poly" title=" " alt="" coords="376,413,464,412,464,417,376,418"/>
<area shape="rect" href="../../df/dc2/avl_8c.html#af44d4960ede7f23f071bf00e360bc23d" title=" " alt="" coords="845,229,931,263"/>
<area shape="poly" title=" " alt="" coords="590,394,652,338,694,306,740,280,785,263,829,252,830,257,786,268,742,285,697,311,656,342,593,398"/>
<area shape="rect" href="../../da/d23/list_8h.html#aea85dd50b9129ddaa3e3c67ed55804e4" title=" " alt="" coords="1089,257,1257,291"/>
<area shape="poly" title=" " alt="" coords="599,393,662,357,700,339,741,324,827,302,915,287,999,278,1073,273,1073,279,1000,283,916,293,828,307,742,329,702,344,664,362,602,398"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a036f33fcd35d949bef89d33b8615cdac" title=" " alt="" coords="817,339,959,372"/>
<area shape="poly" title=" " alt="" coords="666,393,801,369,802,374,667,398"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#aad66bdeaeb9fd01138f3956eff30c69b" title=" " alt="" coords="741,396,1035,430"/>
<area shape="poly" title=" " alt="" coords="667,410,726,410,726,416,667,416"/>
<area shape="rect" href="../../dc/d80/libubus-io_8c.html#aa0791c7960dffbb35e38a4f32001c331" title=" " alt="" coords="793,453,983,487"/>
<area shape="poly" title=" " alt="" coords="667,427,779,448,778,453,666,432"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#af261be039e78f42c48f896232e2c2c62" title=" " alt="" coords="747,511,1029,544"/>
<area shape="poly" title=" " alt="" coords="636,428,695,455,709,466,719,477,728,488,743,497,754,502,752,507,740,502,725,492,715,481,706,470,692,459,633,433"/>
<area shape="rect" href="../../dc/d80/libubus-io_8c.html#ac9d684a5b03a2819e0ea9780975a44e1" title=" " alt="" coords="804,172,972,206"/>
<area shape="poly" title=" " alt="" coords="581,394,604,356,639,307,685,257,712,234,740,214,788,196,790,201,743,219,715,238,689,260,644,310,609,359,586,397"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae960d01033fb72572bc1aa539a501fe7" title=" " alt="" coords="833,568,943,602"/>
<area shape="poly" title=" " alt="" coords="650,428,674,439,695,455,706,468,713,481,719,507,725,532,732,544,743,555,779,573,818,582,817,587,777,578,740,559,727,547,720,534,714,509,708,483,702,471,692,459,671,444,647,433"/>
<area shape="poly" title=" " alt="" coords="932,248,1074,262,1073,267,931,253"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="1090,145,1256,179"/>
<area shape="poly" title=" " alt="" coords="972,178,1074,169,1074,174,972,184"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a7390a5f2c227d5ba53e2bd65afda1cfc" title=" " alt="" coords="490,103,657,136"/>
<area shape="poly" title=" " alt="" coords="357,184,501,139,502,144,358,189"/>
<area shape="poly" title=" " alt="" coords="609,100,670,73,741,48,799,33,800,39,742,53,672,78,611,105"/>
<area shape="poly" title=" " alt="" coords="657,123,1074,153,1074,158,657,128"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="778,63,998,96"/>
<area shape="poly" title=" " alt="" coords="657,106,762,93,763,98,658,112"/>
<area shape="rect" href="../../d1/d5c/rcS_8c.html#a49473a90e2fe9252f856e10246252554" title=" " alt="" coords="554,513,592,547"/>
<area shape="poly" title=" " alt="" coords="383,548,538,531,539,536,384,553"/>
<area shape="rect" href="../../d2/de5/libubus-req_8c.html#a42b839aa1a2ef9dd5abdba7c25400b4b" title=" " alt="" coords="453,628,693,662"/>
<area shape="poly" title=" " alt="" coords="344,574,454,614,478,621,476,626,452,619,342,579"/>
<area shape="rect" href="../../d2/de5/libubus-req_8c.html#a50302440f98786d5bcc4770a627bf8dc" title=" " alt="" coords="460,571,687,604"/>
<area shape="poly" title=" " alt="" coords="384,565,444,572,444,577,383,571"/>
<area shape="rect" href="../../d1/d5c/rcS_8c.html#a1b150f4e4c92035b2ecebc171a115a19" title=" " alt="" coords="864,625,912,659"/>
<area shape="poly" title=" " alt="" coords="593,528,641,535,669,544,695,556,711,570,720,585,728,599,743,612,769,624,796,632,849,639,848,644,795,637,767,629,740,616,724,603,715,588,707,573,692,560,667,548,640,541,592,534"/>
<area shape="poly" title=" " alt="" coords="673,603,695,613,711,627,720,642,728,656,743,669,772,682,804,691,803,696,771,687,740,674,724,660,715,645,707,631,692,618,671,607"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#ac8502f265053dcc41bf8b5ea1fd2dd33" title=" " alt="" coords="806,793,970,827"/>
<area shape="poly" title=" " alt="" coords="679,603,695,613,708,627,716,641,722,670,727,698,733,712,743,727,782,760,826,784,823,789,779,764,739,731,728,715,722,700,717,671,711,643,704,630,692,618,676,607"/>
<area shape="poly" title=" " alt="" coords="383,720,802,701,803,706,383,725"/>
<area shape="poly" title=" " alt="" coords="359,706,499,664,500,669,361,711"/>
<area shape="poly" title=" " alt="" coords="319,741,375,793,412,819,454,838,501,851,549,857,599,859,647,858,739,846,815,829,817,834,740,851,648,863,599,865,549,863,500,856,452,843,410,823,371,797,315,745"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#ad9a92a327d8621e1eee7014bac19bc2b" title=" " alt="" coords="476,737,670,771"/>
<area shape="poly" title=" " alt="" coords="383,732,461,740,460,745,383,737"/>
<area shape="rect" href="../../d2/de5/libubus-req_8c.html#a4cba0d855e6f3ed0fac6a0c6c41c8f49" title=" " alt="" coords="474,795,672,828"/>
<area shape="poly" title=" " alt="" coords="344,741,454,781,478,788,476,793,452,786,342,746"/>
</map>
</div>

</div>
</div>
<a id="a44e8c7d9c78045cd28f81b95fb3f2cf3" name="a44e8c7d9c78045cd28f81b95fb3f2cf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44e8c7d9c78045cd28f81b95fb3f2cf3">&#9670;&#160;</a></span>pipe_send_start_container()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void pipe_send_start_container </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a> *</td>          <td class="paramname"><span class="paramname"><em>t</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l03132">3132</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3133</span>{</div>
<div class="line"><span class="lineno"> 3134</span>    <span class="keywordtype">char</span> sig_buf[1];</div>
<div class="line"><span class="lineno"> 3135</span> </div>
<div class="line"><span class="lineno"> 3136</span>    <a class="code hl_variable" href="#af5e3a2bd12c4c9ed553bdacc21e97b65">jail_oci_state</a> = <a class="code hl_enumvalue" href="#a97f905ac94bfebd46e50e32c7389e6eba9c098b9727e0c4f5a1c90b249cd4aacc">OCI_STATE_RUNNING</a>;</div>
<div class="line"><span class="lineno"> 3137</span>    sig_buf[0] = <span class="charliteral">&#39;!&#39;</span>;</div>
<div class="line"><span class="lineno"> 3138</span>    <span class="keywordflow">if</span> (write(<a class="code hl_variable" href="#a541f86a9c230bc87b5e7e2c83e2a6d34">pipes</a>[3], sig_buf, 1) &lt; 0) {</div>
<div class="line"><span class="lineno"> 3139</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;can&#39;t write to child\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 3140</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(-1);</div>
<div class="line"><span class="lineno"> 3141</span>    }</div>
<div class="line"><span class="lineno"> 3142</span>    close(<a class="code hl_variable" href="#a541f86a9c230bc87b5e7e2c83e2a6d34">pipes</a>[3]);</div>
<div class="line"><span class="lineno"> 3143</span> </div>
<div class="line"><span class="lineno"> 3144</span>    <a class="code hl_function" href="#a1756d87ceab7e1c79fe7caf453cb102a">run_hooks</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.poststart, <a class="code hl_function" href="#ab539f0664e4eb2dda9be701742add492">post_poststart</a>);</div>
<div class="line"><span class="lineno"> 3145</span>}</div>
<div class="ttc" id="ajail_8c_html_ab539f0664e4eb2dda9be701742add492"><div class="ttname"><a href="#ab539f0664e4eb2dda9be701742add492">post_poststart</a></div><div class="ttdeci">static void post_poststart(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l03147">jail.c:3147</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00774">free_and_exit()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02419">jail_oci_state</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02415">OCI_STATE_RUNNING</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01160">pipes</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l03147">post_poststart()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00512">run_hooks()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l03115">post_create_runtime()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a44e8c7d9c78045cd28f81b95fb3f2cf3_cgraph.png" border="0" usemap="#add/d26/jail_8c_a44e8c7d9c78045cd28f81b95fb3f2cf3_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a44e8c7d9c78045cd28f81b95fb3f2cf3_cgraph" id="add/d26/jail_8c_a44e8c7d9c78045cd28f81b95fb3f2cf3_cgraph">
<area shape="rect" title=" " alt="" coords="5,753,269,787"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a0d1316d1e009899e8b8b735bb6ba70e3" title=" " alt="" coords="685,404,830,438"/>
<area shape="poly" title=" " alt="" coords="168,751,711,443,714,448,170,755"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#ab539f0664e4eb2dda9be701742add492" title=" " alt="" coords="317,753,470,787"/>
<area shape="poly" title=" " alt="" coords="269,768,301,768,301,773,269,773"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a1756d87ceab7e1c79fe7caf453cb102a" title=" " alt="" coords="699,849,816,883"/>
<area shape="poly" title=" " alt="" coords="243,785,317,797,684,853,683,858,316,802,243,790"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b" title=" " alt="" coords="1188,5,1328,39"/>
<area shape="poly" title=" " alt="" coords="769,402,820,334,904,236,956,183,1014,133,1077,86,1143,48,1171,36,1173,41,1145,53,1080,91,1017,137,960,187,908,240,824,337,773,405"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a61855620d1a0683f786486b1722d7dfa" title=" " alt="" coords="943,264,1049,298"/>
<area shape="poly" title=" " alt="" coords="787,401,951,304,953,308,790,406"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2" title=" " alt="" coords="940,625,1052,659"/>
<area shape="poly" title=" " alt="" coords="769,437,787,474,814,521,852,570,897,612,926,627,923,631,894,616,848,574,810,524,782,476,764,439"/>
<area shape="poly" title=" " alt="" coords="1006,262,1094,127,1106,104,1113,84,1124,66,1142,48,1171,33,1174,38,1146,52,1128,69,1118,87,1110,106,1098,130,1011,265"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a7cdfa1304cca32224a444b6e84fac194" title=" " alt="" coords="1190,292,1326,326"/>
<area shape="poly" title=" " alt="" coords="1050,284,1174,297,1174,303,1049,289"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5127f557f43086299c2bf291618dcef5" title=" " alt="" coords="1189,349,1327,383"/>
<area shape="poly" title=" " alt="" coords="1039,296,1145,336,1174,344,1173,349,1143,341,1037,301"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a766dbc37dd9f160e1a3b8a9f19651b38" title=" " alt="" coords="1456,376,1603,410"/>
<area shape="poly" title=" " alt="" coords="1014,296,1067,347,1104,374,1145,393,1221,411,1299,417,1374,414,1440,407,1441,412,1374,420,1299,422,1220,416,1143,398,1102,378,1064,352,1010,300"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#abb68ed1aa9f416ea5f299d7672a3b5c1" title=" " alt="" coords="1160,63,1356,96"/>
<area shape="poly" title=" " alt="" coords="1004,262,1025,228,1056,186,1096,142,1143,105,1150,101,1153,105,1145,110,1100,146,1060,189,1030,231,1009,265"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5a2acf003db67e7475dcb66937cc12bb" title=" " alt="" coords="1196,120,1320,154"/>
<area shape="poly" title=" " alt="" coords="1012,261,1067,212,1104,185,1143,162,1180,149,1182,154,1145,167,1106,190,1071,216,1016,265"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5064c6dcd09eae061c30cba4146bee18" title=" " alt="" coords="1198,177,1317,211"/>
<area shape="poly" title=" " alt="" coords="1036,261,1143,220,1182,208,1184,213,1145,225,1037,266"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4b6f537dfef57c06536c73d6c7c2ff48" title=" " alt="" coords="1195,235,1321,268"/>
<area shape="poly" title=" " alt="" coords="1049,272,1179,258,1179,263,1050,278"/>
<area shape="poly" title=" " alt="" coords="1328,370,1441,381,1440,387,1327,376"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a7390a5f2c227d5ba53e2bd65afda1cfc" title=" " alt="" coords="1174,625,1341,659"/>
<area shape="poly" title=" " alt="" coords="1052,640,1158,640,1158,645,1052,645"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a58d1b624b96aa768608f45d390cc0d59" title=" " alt="" coords="1456,659,1603,692"/>
<area shape="poly" title=" " alt="" coords="1342,650,1441,662,1440,667,1342,655"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="1446,595,1613,628"/>
<area shape="poly" title=" " alt="" coords="1342,630,1431,620,1431,625,1342,635"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="1419,728,1640,762"/>
<area shape="poly" title=" " alt="" coords="1343,656,1373,668,1397,685,1421,703,1459,720,1457,725,1418,707,1394,689,1370,673,1341,661"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a75a14e1ea35414c049cd975fb3e3f99c" title=" " alt="" coords="518,712,619,746"/>
<area shape="poly" title=" " alt="" coords="467,750,502,742,504,747,468,755"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077" title=" " alt="" coords="1201,964,1314,998"/>
<area shape="poly" title=" " alt="" coords="426,785,531,839,598,869,668,893,810,927,953,951,1083,966,1186,974,1185,980,1082,971,952,956,809,933,667,898,597,874,529,844,424,790"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="1163,792,1352,826"/>
<area shape="poly" title=" " alt="" coords="470,771,1147,801,1147,807,470,776"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ac0bcdd57d004a600844745bd38e83a2d" title=" " alt="" coords="932,568,1060,602"/>
<area shape="poly" title=" " alt="" coords="415,751,459,719,519,680,591,641,667,610,731,594,797,585,917,579,917,585,798,590,732,600,668,615,593,646,522,684,462,723,418,755"/>
<area shape="rect" href="../../db/d3d/netifd_8c.html#aeada94c74be21275dbafb9a8d9515e90" title=" " alt="" coords="667,712,848,746"/>
<area shape="poly" title=" " alt="" coords="620,726,652,726,652,732,620,732"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a3360eb012491304d4630403c5dc33ec9" title=" " alt="" coords="682,625,833,659"/>
<area shape="poly" title=" " alt="" coords="606,709,704,663,707,668,608,714"/>
<area shape="poly" title=" " alt="" coords="595,744,722,838,719,842,592,748"/>
<area shape="poly" title=" " alt="" coords="794,709,895,668,924,658,925,663,897,673,797,714"/>
<area shape="rect" href="../../db/d3d/netifd_8c.html#aecf17edd05dd1516fd1785ed6cc97d7c" title=" " alt="" coords="896,740,1096,774"/>
<area shape="poly" title=" " alt="" coords="849,737,881,741,880,746,848,742"/>
<area shape="rect" href="../../db/d3d/netifd_8c.html#a71698b19f7fdbb3ae922ac51f68e9793" title=" " alt="" coords="918,683,1074,716"/>
<area shape="poly" title=" " alt="" coords="848,715,902,708,903,714,849,720"/>
<area shape="poly" title=" " alt="" coords="1070,714,1144,726,1258,736,1308,735,1371,726,1413,715,1467,696,1469,701,1414,720,1372,731,1308,740,1258,741,1144,731,1070,720"/>
<area shape="poly" title=" " alt="" coords="768,623,973,309,977,312,772,626"/>
<area shape="poly" title=" " alt="" coords="833,640,924,640,924,645,833,645"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a88ee3d42d3e892d3b5dd714d89b49505" title=" " alt="" coords="929,849,1063,883"/>
<area shape="poly" title=" " alt="" coords="816,864,913,864,913,869,816,869"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a71525bf218f3fe2889a36b88e7b9964d" title=" " alt="" coords="1145,849,1371,883"/>
<area shape="poly" title=" " alt="" coords="1064,871,1129,872,1129,878,1064,877"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb" title=" " alt="" coords="1160,907,1356,940"/>
<area shape="poly" title=" " alt="" coords="1064,878,1163,900,1162,905,1063,883"/>
<area shape="poly" title=" " alt="" coords="1060,881,1097,900,1113,913,1122,926,1131,939,1145,951,1187,967,1185,972,1143,955,1127,943,1118,930,1109,917,1095,904,1058,886"/>
<area shape="poly" title=" " alt="" coords="1063,849,1162,827,1163,832,1064,854"/>
<area shape="poly" title=" " alt="" coords="1349,847,1370,836,1385,822,1393,806,1402,790,1418,775,1433,766,1435,771,1421,779,1406,794,1398,809,1389,825,1373,840,1352,851"/>
<area shape="poly" title=" " alt="" coords="1144,860,1078,860,1078,855,1144,855"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a14d4e1fa83f245cd59f0c68f48c90d75" title=" " alt="" coords="1433,964,1626,998"/>
<area shape="poly" title=" " alt="" coords="1315,978,1417,978,1417,984,1315,984"/>
<area shape="poly" title=" " alt="" coords="1332,789,1439,763,1441,768,1333,794"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a941864296983cb342a79afe55055f8d3" title=" " alt="" coords="1453,847,1606,880"/>
<area shape="poly" title=" " alt="" coords="1345,824,1439,843,1438,848,1344,829"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07" title=" " alt="" coords="1431,789,1628,823"/>
<area shape="poly" title=" " alt="" coords="1353,805,1416,805,1416,810,1353,811"/>
<area shape="poly" title=" " alt="" coords="1060,585,1431,604,1431,609,1060,591"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a13ca20f7af9aa4aa3057b1114e23e7f1" title=" " alt="" coords="1144,459,1371,492"/>
<area shape="poly" title=" " alt="" coords="1022,565,1076,533,1143,501,1160,495,1162,500,1145,506,1079,538,1025,570"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#afe30e87975d460220899f69103f90d0d" title=" " alt="" coords="1150,683,1366,716"/>
<area shape="poly" title=" " alt="" coords="1061,594,1097,611,1113,626,1122,641,1131,656,1146,669,1153,674,1150,678,1142,674,1126,659,1118,644,1109,629,1095,615,1059,599"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a28e87c6264a681dc2a422d32794416c5" title=" " alt="" coords="1154,516,1361,550"/>
<area shape="poly" title=" " alt="" coords="1059,570,1154,551,1155,556,1060,575"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a49ba044023de765e2d9d14db25d1845b" title=" " alt="" coords="1420,459,1639,492"/>
<area shape="poly" title=" " alt="" coords="1372,473,1405,473,1405,478,1372,478"/>
<area shape="poly" title=" " alt="" coords="1363,714,1410,722,1409,728,1362,720"/>
</map>
</div>

</div>
</div>
<a id="a607ba83d17934834c11576f3761ac577" name="a607ba83d17934834c11576f3761ac577"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a607ba83d17934834c11576f3761ac577">&#9670;&#160;</a></span>pivot_root()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int pivot_root </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>new_root</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>put_old</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00788">enter_jail_fs()</a>.</p>

</div>
</div>
<a id="a67b89ffa3ccdcc917716e1c48ed5d90c" name="a67b89ffa3ccdcc917716e1c48ed5d90c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67b89ffa3ccdcc917716e1c48ed5d90c">&#9670;&#160;</a></span>post_create_runtime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void post_create_runtime </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l03115">3115</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3116</span>{</div>
<div class="line"><span class="lineno"> 3117</span>    <span class="keywordtype">char</span> sig_buf[1];</div>
<div class="line"><span class="lineno"> 3118</span> </div>
<div class="line"><span class="lineno"> 3119</span>    sig_buf[0] = <span class="charliteral">&#39;O&#39;</span>;</div>
<div class="line"><span class="lineno"> 3120</span>    <span class="keywordflow">if</span> (write(<a class="code hl_variable" href="#a541f86a9c230bc87b5e7e2c83e2a6d34">pipes</a>[3], sig_buf, 1) &lt; 0) {</div>
<div class="line"><span class="lineno"> 3121</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;can&#39;t write to child\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 3122</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(-1);</div>
<div class="line"><span class="lineno"> 3123</span>    }</div>
<div class="line"><span class="lineno"> 3124</span> </div>
<div class="line"><span class="lineno"> 3125</span>    <a class="code hl_variable" href="#af5e3a2bd12c4c9ed553bdacc21e97b65">jail_oci_state</a> = <a class="code hl_enumvalue" href="#a97f905ac94bfebd46e50e32c7389e6eba7d55a02065f2ef38d43d0c0858bee940">OCI_STATE_CREATED</a>;</div>
<div class="line"><span class="lineno"> 3126</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ocibundle &amp;&amp; !<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.immediately)</div>
<div class="line"><span class="lineno"> 3127</span>        <a class="code hl_function" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077">uloop_run</a>(); <span class="comment">/* wait for &#39;start&#39; command via ubus */</span></div>
<div class="line"><span class="lineno"> 3128</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3129</span>        <a class="code hl_function" href="#a44e8c7d9c78045cd28f81b95fb3f2cf3">pipe_send_start_container</a>(NULL);</div>
<div class="line"><span class="lineno"> 3130</span>}</div>
<div class="ttc" id="ajail_8c_html_a44e8c7d9c78045cd28f81b95fb3f2cf3"><div class="ttname"><a href="#a44e8c7d9c78045cd28f81b95fb3f2cf3">pipe_send_start_container</a></div><div class="ttdeci">static void pipe_send_start_container(struct uloop_timeout *t)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l03132">jail.c:3132</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00774">free_and_exit()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02419">jail_oci_state</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02414">OCI_STATE_CREATED</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l03132">pipe_send_start_container()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01160">pipes</a>, and <a class="el" href="../../dc/d56/uloop_8h_source.html#l00147">uloop_run()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a67b89ffa3ccdcc917716e1c48ed5d90c_cgraph.png" border="0" usemap="#add/d26/jail_8c_a67b89ffa3ccdcc917716e1c48ed5d90c_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a67b89ffa3ccdcc917716e1c48ed5d90c_cgraph" id="add/d26/jail_8c_a67b89ffa3ccdcc917716e1c48ed5d90c_cgraph">
<area shape="rect" title=" " alt="" coords="5,527,215,560"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a0d1316d1e009899e8b8b735bb6ba70e3" title=" " alt="" coords="943,361,1087,395"/>
<area shape="poly" title=" " alt="" coords="189,523,449,469,775,408,927,386,928,391,776,413,450,474,190,529"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a44e8c7d9c78045cd28f81b95fb3f2cf3" title=" " alt="" coords="263,527,526,560"/>
<area shape="poly" title=" " alt="" coords="215,541,247,541,247,546,215,546"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077" title=" " alt="" coords="1377,657,1490,691"/>
<area shape="poly" title=" " alt="" coords="192,558,263,570,456,591,649,596,1016,596,1153,596,1213,602,1288,617,1337,631,1382,648,1380,653,1335,636,1287,622,1212,608,1153,602,1016,601,649,601,455,596,262,575,191,564"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b" title=" " alt="" coords="1363,5,1504,39"/>
<area shape="poly" title=" " alt="" coords="1026,359,1069,300,1139,216,1230,126,1280,84,1334,48,1348,41,1350,45,1337,52,1284,88,1233,130,1143,220,1074,303,1030,362"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a61855620d1a0683f786486b1722d7dfa" title=" " alt="" coords="1167,259,1273,292"/>
<area shape="poly" title=" " alt="" coords="1049,358,1170,297,1172,302,1052,363"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2" title=" " alt="" coords="1164,445,1276,479"/>
<area shape="poly" title=" " alt="" coords="1077,393,1106,404,1175,435,1172,440,1104,409,1075,398"/>
<area shape="poly" title=" " alt="" coords="1227,257,1282,140,1312,80,1333,48,1348,39,1351,43,1337,52,1317,83,1287,142,1232,259"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a7cdfa1304cca32224a444b6e84fac194" title=" " alt="" coords="1365,63,1502,96"/>
<area shape="poly" title=" " alt="" coords="1227,257,1266,188,1297,148,1334,113,1354,101,1357,105,1337,118,1301,152,1271,191,1232,260"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5127f557f43086299c2bf291618dcef5" title=" " alt="" coords="1364,172,1503,206"/>
<area shape="poly" title=" " alt="" coords="1250,256,1334,214,1350,208,1352,213,1336,219,1252,261"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a766dbc37dd9f160e1a3b8a9f19651b38" title=" " alt="" coords="1620,144,1767,178"/>
<area shape="poly" title=" " alt="" coords="1230,257,1270,205,1300,178,1334,157,1368,145,1403,137,1474,130,1543,132,1604,139,1604,145,1543,137,1474,135,1404,143,1369,150,1336,162,1303,182,1274,208,1234,260"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#abb68ed1aa9f416ea5f299d7672a3b5c1" title=" " alt="" coords="1335,229,1532,263"/>
<area shape="poly" title=" " alt="" coords="1273,266,1319,259,1320,264,1274,271"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5a2acf003db67e7475dcb66937cc12bb" title=" " alt="" coords="1371,287,1496,320"/>
<area shape="poly" title=" " alt="" coords="1274,280,1356,291,1356,296,1273,285"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5064c6dcd09eae061c30cba4146bee18" title=" " alt="" coords="1374,344,1493,378"/>
<area shape="poly" title=" " alt="" coords="1253,291,1336,330,1360,339,1358,344,1334,335,1251,295"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4b6f537dfef57c06536c73d6c7c2ff48" title=" " alt="" coords="1370,401,1497,435"/>
<area shape="poly" title=" " alt="" coords="1236,291,1277,339,1305,365,1337,388,1357,398,1355,403,1334,392,1302,370,1273,343,1232,294"/>
<area shape="poly" title=" " alt="" coords="1503,179,1604,168,1605,173,1503,184"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a7390a5f2c227d5ba53e2bd65afda1cfc" title=" " alt="" coords="1350,459,1517,492"/>
<area shape="poly" title=" " alt="" coords="1277,463,1335,467,1334,472,1277,468"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a58d1b624b96aa768608f45d390cc0d59" title=" " alt="" coords="1620,349,1767,383"/>
<area shape="poly" title=" " alt="" coords="1508,456,1530,445,1545,434,1554,423,1563,412,1578,400,1606,386,1608,391,1581,404,1567,415,1558,427,1548,438,1533,450,1510,461"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="1610,459,1777,492"/>
<area shape="poly" title=" " alt="" coords="1518,473,1595,473,1595,478,1518,478"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="2148,595,2369,628"/>
<area shape="poly" title=" " alt="" coords="1506,455,1579,444,1694,433,1744,435,1807,444,1924,472,2036,510,2135,550,2210,585,2208,590,2133,555,2034,515,1922,477,1807,449,1743,440,1694,438,1580,449,1507,461"/>
<area shape="poly" title=" " alt="" coords="460,524,933,397,935,402,461,529"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#ab539f0664e4eb2dda9be701742add492" title=" " alt="" coords="574,527,727,560"/>
<area shape="poly" title=" " alt="" coords="527,541,559,541,559,546,527,546"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a1756d87ceab7e1c79fe7caf453cb102a" title=" " alt="" coords="956,687,1074,720"/>
<area shape="poly" title=" " alt="" coords="441,558,589,611,682,640,776,665,861,682,941,693,941,698,860,687,775,670,680,645,587,616,440,563"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a75a14e1ea35414c049cd975fb3e3f99c" title=" " alt="" coords="775,476,877,510"/>
<area shape="poly" title=" " alt="" coords="711,524,760,509,761,514,712,529"/>
<area shape="poly" title=" " alt="" coords="728,554,1362,660,1361,665,727,559"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="1339,741,1528,775"/>
<area shape="poly" title=" " alt="" coords="671,559,712,597,772,645,846,693,885,714,926,730,976,745,1028,756,1134,768,1235,771,1323,767,1324,772,1235,776,1134,773,1027,761,975,750,924,735,883,719,843,698,769,650,709,601,667,563"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ac0bcdd57d004a600844745bd38e83a2d" title=" " alt="" coords="1370,531,1497,564"/>
<area shape="poly" title=" " alt="" coords="728,541,1354,544,1354,550,728,547"/>
<area shape="rect" href="../../db/d3d/netifd_8c.html#aeada94c74be21275dbafb9a8d9515e90" title=" " alt="" coords="925,476,1105,510"/>
<area shape="poly" title=" " alt="" coords="877,490,909,490,909,496,877,496"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a3360eb012491304d4630403c5dc33ec9" title=" " alt="" coords="940,419,1090,452"/>
<area shape="poly" title=" " alt="" coords="876,475,942,455,944,460,878,480"/>
<area shape="poly" title=" " alt="" coords="845,508,990,673,986,676,841,512"/>
<area shape="poly" title=" " alt="" coords="1105,477,1148,470,1149,475,1106,482"/>
<area shape="poly" title=" " alt="" coords="1084,416,1104,405,1133,382,1158,356,1198,304,1202,307,1162,359,1136,386,1106,410,1086,421"/>
<area shape="poly" title=" " alt="" coords="1091,443,1149,450,1149,456,1090,448"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a88ee3d42d3e892d3b5dd714d89b49505" title=" " alt="" coords="1153,687,1287,720"/>
<area shape="poly" title=" " alt="" coords="1074,701,1137,701,1137,706,1074,706"/>
<area shape="poly" title=" " alt="" coords="1287,692,1361,681,1361,687,1288,697"/>
<area shape="poly" title=" " alt="" coords="1288,718,1351,734,1349,739,1287,723"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a14d4e1fa83f245cd59f0c68f48c90d75" title=" " alt="" coords="1597,736,1790,770"/>
<area shape="poly" title=" " alt="" coords="1486,689,1580,720,1612,729,1611,734,1579,725,1484,694"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a18ed130af55f89035ca041f340a091f9" title=" " alt="" coords="1857,736,2098,770"/>
<area shape="poly" title=" " alt="" coords="1790,750,1841,750,1841,756,1790,756"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a5d07b4993342a59a1b6327d23a771d47" title=" " alt="" coords="1855,793,2100,827"/>
<area shape="poly" title=" " alt="" coords="1781,768,1876,787,1875,792,1780,773"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ab4fcc424426de9a075b7b4b6f390fd2e" title=" " alt="" coords="1857,679,2099,712"/>
<area shape="poly" title=" " alt="" coords="1780,733,1875,713,1876,719,1781,738"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a1d8cdbdb1ea8dad23288f6ec0b2ff005" title=" " alt="" coords="1886,851,2070,884"/>
<area shape="poly" title=" " alt="" coords="1723,768,1783,803,1856,837,1874,843,1872,848,1854,842,1780,807,1720,773"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a941864296983cb342a79afe55055f8d3" title=" " alt="" coords="2182,736,2335,770"/>
<area shape="poly" title=" " alt="" coords="2099,750,2166,750,2166,756,2099,756"/>
<area shape="poly" title=" " alt="" coords="2060,676,2100,665,2198,632,2199,637,2101,670,2061,681"/>
<area shape="poly" title=" " alt="" coords="2064,710,2168,732,2166,737,2063,716"/>
<area shape="poly" title=" " alt="" coords="1468,739,1530,701,1553,680,1563,670,1578,661,1648,633,1721,613,1795,599,1870,590,2012,586,2133,593,2133,598,2012,591,1870,595,1796,604,1722,618,1650,638,1581,666,1566,675,1557,684,1533,706,1470,743"/>
<area shape="poly" title=" " alt="" coords="1465,773,1571,828,1646,860,1730,888,1821,910,1915,922,1962,922,2009,918,2055,909,2099,894,2141,872,2179,842,2210,810,2234,781,2238,784,2214,813,2182,846,2144,876,2101,899,2056,914,2010,923,1962,927,1915,927,1820,916,1728,894,1644,865,1569,833,1462,778"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07" title=" " alt="" coords="1595,960,1792,994"/>
<area shape="poly" title=" " alt="" coords="1446,774,1466,809,1497,853,1535,899,1581,939,1604,951,1601,956,1578,943,1532,903,1492,856,1462,812,1442,777"/>
<area shape="poly" title=" " alt="" coords="1489,527,1579,501,1605,494,1606,499,1580,506,1491,533"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a13ca20f7af9aa4aa3057b1114e23e7f1" title=" " alt="" coords="1580,516,1807,550"/>
<area shape="poly" title=" " alt="" coords="1498,541,1564,537,1564,543,1498,547"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#afe30e87975d460220899f69103f90d0d" title=" " alt="" coords="1870,621,2086,655"/>
<area shape="poly" title=" " alt="" coords="1498,555,1858,616,1857,621,1497,561"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a28e87c6264a681dc2a422d32794416c5" title=" " alt="" coords="1590,676,1797,710"/>
<area shape="poly" title=" " alt="" coords="1455,563,1510,608,1544,633,1581,654,1612,668,1610,673,1578,659,1541,637,1506,612,1452,567"/>
<area shape="poly" title=" " alt="" coords="2086,625,2133,621,2133,626,2086,631"/>
</map>
</div>

</div>
</div>
<a id="ab88c4a768e1c297fb6b3757942876398" name="ab88c4a768e1c297fb6b3757942876398"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab88c4a768e1c297fb6b3757942876398">&#9670;&#160;</a></span>post_jail_fs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void post_jail_fs </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01239">1239</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1240</span>{</div>
<div class="line"><span class="lineno"> 1241</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>[1];</div>
<div class="line"><span class="lineno"> 1242</span> </div>
<div class="line"><span class="lineno"> 1243</span>    <span class="keywordflow">if</span> (read(<a class="code hl_variable" href="#a541f86a9c230bc87b5e7e2c83e2a6d34">pipes</a>[2], <a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>, 1) &lt; 1) {</div>
<div class="line"><span class="lineno"> 1244</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;can&#39;t read from parent\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1245</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1246</span>    }</div>
<div class="line"><span class="lineno"> 1247</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d7/d9a/mkdev_8c.html#a024e65f7d9664cdc767f51c283fd8353">buf</a>[0] != <span class="charliteral">&#39;!&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1248</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;parent had an error, child exiting\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1249</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1250</span>    }</div>
<div class="line"><span class="lineno"> 1251</span>    close(<a class="code hl_variable" href="#a541f86a9c230bc87b5e7e2c83e2a6d34">pipes</a>[2]);</div>
<div class="line"><span class="lineno"> 1252</span> </div>
<div class="line"><span class="lineno"> 1253</span>    <a class="code hl_function" href="#a1756d87ceab7e1c79fe7caf453cb102a">run_hooks</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.startContainer, <a class="code hl_function" href="#a292407d99b98bbc178b7760e2107725d">post_start_hook</a>);</div>
<div class="line"><span class="lineno"> 1254</span>}</div>
<div class="ttc" id="ajail_8c_html_a292407d99b98bbc178b7760e2107725d"><div class="ttname"><a href="#a292407d99b98bbc178b7760e2107725d">post_start_hook</a></div><div class="ttdeci">static void post_start_hook(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01256">jail.c:1256</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d9a/mkdev_8c_source.html#l00034">buf</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00774">free_and_exit()</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01160">pipes</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01256">post_start_hook()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00512">run_hooks()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00788">enter_jail_fs()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l01228">pre_exec_jail()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_ab88c4a768e1c297fb6b3757942876398_cgraph.png" border="0" usemap="#add/d26/jail_8c_ab88c4a768e1c297fb6b3757942876398_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_ab88c4a768e1c297fb6b3757942876398_cgraph" id="add/d26/jail_8c_ab88c4a768e1c297fb6b3757942876398_cgraph">
<area shape="rect" title=" " alt="" coords="5,570,128,603"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a0d1316d1e009899e8b8b735bb6ba70e3" title=" " alt="" coords="672,400,817,434"/>
<area shape="poly" title=" " alt="" coords="128,587,246,591,391,591,528,582,583,572,623,559,657,536,685,507,708,475,726,447,730,449,713,478,689,510,660,540,626,564,584,578,529,587,391,597,246,597,128,593"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a292407d99b98bbc178b7760e2107725d" title=" " alt="" coords="176,346,343,379"/>
<area shape="poly" title=" " alt="" coords="80,568,232,389,236,393,84,571"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a1756d87ceab7e1c79fe7caf453cb102a" title=" " alt="" coords="201,624,318,658"/>
<area shape="poly" title=" " alt="" coords="129,601,187,618,185,623,127,606"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b" title=" " alt="" coords="1090,398,1230,431"/>
<area shape="poly" title=" " alt="" coords="817,414,1074,412,1074,418,817,419"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a61855620d1a0683f786486b1722d7dfa" title=" " alt="" coords="879,204,985,238"/>
<area shape="poly" title=" " alt="" coords="770,398,815,361,867,303,908,249,912,252,871,306,819,365,773,402"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2" title=" " alt="" coords="876,454,988,487"/>
<area shape="poly" title=" " alt="" coords="807,432,862,448,860,453,806,437"/>
<area shape="poly" title=" " alt="" coords="942,237,957,269,980,309,1011,350,1049,384,1077,399,1074,403,1045,389,1007,354,976,312,953,272,938,239"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a7cdfa1304cca32224a444b6e84fac194" title=" " alt="" coords="1092,340,1228,374"/>
<area shape="poly" title=" " alt="" coords="949,237,990,282,1018,307,1048,327,1078,340,1076,345,1046,332,1014,311,986,286,945,241"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5127f557f43086299c2bf291618dcef5" title=" " alt="" coords="1091,54,1229,87"/>
<area shape="poly" title=" " alt="" coords="942,202,983,150,1012,121,1046,96,1075,83,1077,88,1048,101,1016,125,987,153,946,206"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a766dbc37dd9f160e1a3b8a9f19651b38" title=" " alt="" coords="1358,27,1505,61"/>
<area shape="poly" title=" " alt="" coords="935,203,948,167,970,121,1002,75,1022,55,1046,39,1084,22,1124,11,1165,5,1207,3,1287,8,1356,20,1355,26,1286,13,1207,8,1166,10,1125,16,1085,27,1048,44,1026,59,1006,78,975,123,953,169,940,205"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#abb68ed1aa9f416ea5f299d7672a3b5c1" title=" " alt="" coords="1062,111,1258,145"/>
<area shape="poly" title=" " alt="" coords="957,202,998,177,1046,153,1063,147,1065,152,1048,158,1001,182,960,206"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5a2acf003db67e7475dcb66937cc12bb" title=" " alt="" coords="1098,168,1222,202"/>
<area shape="poly" title=" " alt="" coords="985,210,1082,195,1083,200,986,216"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5064c6dcd09eae061c30cba4146bee18" title=" " alt="" coords="1101,226,1220,259"/>
<area shape="poly" title=" " alt="" coords="986,224,1085,233,1085,238,985,229"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4b6f537dfef57c06536c73d6c7c2ff48" title=" " alt="" coords="1097,283,1223,317"/>
<area shape="poly" title=" " alt="" coords="969,236,1048,269,1083,280,1081,285,1046,274,967,241"/>
<area shape="poly" title=" " alt="" coords="1230,61,1342,50,1343,55,1230,66"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a7390a5f2c227d5ba53e2bd65afda1cfc" title=" " alt="" coords="1077,455,1244,489"/>
<area shape="poly" title=" " alt="" coords="988,468,1061,469,1061,474,988,474"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a58d1b624b96aa768608f45d390cc0d59" title=" " alt="" coords="1358,398,1505,431"/>
<area shape="poly" title=" " alt="" coords="1243,452,1343,431,1344,436,1244,457"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="1348,455,1515,489"/>
<area shape="poly" title=" " alt="" coords="1244,469,1333,469,1333,475,1244,475"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="1321,512,1542,546"/>
<area shape="poly" title=" " alt="" coords="1244,487,1334,506,1333,511,1243,492"/>
<area shape="poly" title=" " alt="" coords="344,362,476,369,625,385,667,394,666,399,624,391,476,374,343,367"/>
<area shape="poly" title=" " alt="" coords="268,344,286,315,313,279,348,245,390,219,452,197,516,184,582,177,647,176,768,186,864,202,863,207,767,191,647,181,582,182,517,189,453,202,392,224,352,249,317,283,291,318,272,347"/>
<area shape="rect" href="../../d2/d61/capabilities_8c.html#a1b699befb42c1321a6088fb948e148ba" title=" " alt="" coords="403,291,613,325"/>
<area shape="poly" title=" " alt="" coords="338,343,412,326,413,331,340,348"/>
<area shape="rect" href="../../d8/da1/seccomp-oci_8c.html#a1cd5004c8913a313ee7b35e8bbd27d50" title=" " alt="" coords="391,458,624,491"/>
<area shape="poly" title=" " alt="" coords="284,378,332,412,392,444,408,450,406,455,390,449,329,416,281,382"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a6c0f3a1b16c319c90fadb78ad09a5336" title=" " alt="" coords="447,124,569,158"/>
<area shape="poly" title=" " alt="" coords="266,344,283,309,310,263,346,216,389,175,430,154,433,159,393,179,350,220,314,266,288,311,270,347"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a6f77c1e493a8d84fc93bec1de3f871de" title=" " alt="" coords="440,400,576,434"/>
<area shape="poly" title=" " alt="" coords="340,377,425,396,424,402,338,383"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#aff8b6e0b00af342a873f29ed0161479d" title=" " alt="" coords="441,515,575,549"/>
<area shape="poly" title=" " alt="" coords="274,378,320,440,354,473,392,502,427,516,425,521,390,506,350,477,316,443,269,382"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#a5881608c3589830842d1db287f1f896e" title=" " alt="" coords="450,234,566,267"/>
<area shape="poly" title=" " alt="" coords="281,343,329,309,390,276,434,261,436,267,392,281,332,314,284,347"/>
<area shape="rect" href="../../d8/d14/capabilities_8h.html#ae865dd59489e27a32f181825180a296d" title=" " alt="" coords="702,316,787,350"/>
<area shape="poly" title=" " alt="" coords="614,317,687,324,686,330,613,322"/>
<area shape="rect" href="../../d8/d14/capabilities_8h.html#abf7e4e3c4c0bc644ea5e76a5e3326108" title=" " alt="" coords="703,259,786,293"/>
<area shape="poly" title=" " alt="" coords="613,291,688,281,688,286,614,296"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#aefdad32a1f287a539e1d6f6d31301e4e" title=" " alt="" coords="700,124,789,158"/>
<area shape="poly" title=" " alt="" coords="569,139,685,139,685,144,569,144"/>
<area shape="poly" title=" " alt="" coords="576,415,657,415,657,420,576,420"/>
<area shape="poly" title=" " alt="" coords="574,518,623,502,671,474,711,442,715,447,674,478,625,506,576,523"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a88ee3d42d3e892d3b5dd714d89b49505" title=" " alt="" coords="865,624,999,658"/>
<area shape="poly" title=" " alt="" coords="318,639,849,639,849,644,318,644"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a71525bf218f3fe2889a36b88e7b9964d" title=" " alt="" coords="1047,567,1273,601"/>
<area shape="poly" title=" " alt="" coords="999,633,1046,621,1114,603,1115,608,1048,627,1000,638"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb" title=" " alt="" coords="1333,684,1530,718"/>
<area shape="poly" title=" " alt="" coords="994,656,1047,668,1188,686,1318,695,1318,700,1187,691,1047,673,992,661"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077" title=" " alt="" coords="1104,739,1217,773"/>
<area shape="poly" title=" " alt="" coords="956,656,998,686,1048,716,1090,733,1088,738,1046,721,995,691,953,661"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="1066,624,1255,658"/>
<area shape="poly" title=" " alt="" coords="1000,639,1050,639,1050,644,1000,644"/>
<area shape="poly" title=" " alt="" coords="1247,564,1329,547,1330,552,1248,569"/>
<area shape="poly" title=" " alt="" coords="1047,603,978,622,976,616,1046,597"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="1590,656,1719,690"/>
<area shape="poly" title=" " alt="" coords="1530,686,1574,681,1574,686,1530,692"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a14d4e1fa83f245cd59f0c68f48c90d75" title=" " alt="" coords="1335,742,1528,775"/>
<area shape="poly" title=" " alt="" coords="1217,754,1319,755,1319,760,1217,759"/>
<area shape="poly" title=" " alt="" coords="1251,621,1272,611,1287,598,1295,584,1304,569,1320,555,1328,551,1330,555,1323,559,1308,573,1300,587,1291,601,1275,615,1253,626"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a941864296983cb342a79afe55055f8d3" title=" " alt="" coords="1355,570,1508,603"/>
<area shape="poly" title=" " alt="" coords="1247,621,1339,602,1340,608,1248,626"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07" title=" " alt="" coords="1333,627,1530,661"/>
<area shape="poly" title=" " alt="" coords="1255,640,1318,640,1318,645,1255,645"/>
<area shape="poly" title=" " alt="" coords="1530,654,1574,660,1574,665,1530,660"/>
</map>
</div>

</div>
</div>
<a id="a2a752afff1e548707b0cbec92c8e7512" name="a2a752afff1e548707b0cbec92c8e7512"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a752afff1e548707b0cbec92c8e7512">&#9670;&#160;</a></span>post_main()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void post_main </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a> *</td>          <td class="paramname"><span class="paramname"><em>t</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">2923</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2924</span>{</div>
<div class="line"><span class="lineno"> 2925</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="#ae076946d2fc6067e05a7851cad082a4a">apply_rlimits</a>()) {</div>
<div class="line"><span class="lineno"> 2926</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;error applying resource limits\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2927</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 2928</span>    }</div>
<div class="line"><span class="lineno"> 2929</span> </div>
<div class="line"><span class="lineno"> 2930</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.name)</div>
<div class="line"><span class="lineno"> 2931</span>        prctl(PR_SET_NAME, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.name, NULL, NULL, NULL);</div>
<div class="line"><span class="lineno"> 2932</span> </div>
<div class="line"><span class="lineno"> 2933</span>    <span class="keywordflow">if</span> (pipe(&amp;<a class="code hl_variable" href="#a541f86a9c230bc87b5e7e2c83e2a6d34">pipes</a>[0]) &lt; 0 || pipe(&amp;<a class="code hl_variable" href="#a541f86a9c230bc87b5e7e2c83e2a6d34">pipes</a>[2]) &lt; 0)</div>
<div class="line"><span class="lineno"> 2934</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(-1);</div>
<div class="line"><span class="lineno"> 2935</span> </div>
<div class="line"><span class="lineno"> 2936</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="#a0015ee3272db94af6db03ff79d543794">has_namespaces</a>()) {</div>
<div class="line"><span class="lineno"> 2937</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp; CLONE_NEWNS) {</div>
<div class="line"><span class="lineno"> 2938</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.extroot &amp;&amp; (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.user || <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.group)) {</div>
<div class="line"><span class="lineno"> 2939</span>                <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a31752c6608fbf56bb359ba109bdc6f6f">add_mount_bind</a>(<span class="stringliteral">&quot;/etc/passwd&quot;</span>, 1, -1);</div>
<div class="line"><span class="lineno"> 2940</span>                <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a31752c6608fbf56bb359ba109bdc6f6f">add_mount_bind</a>(<span class="stringliteral">&quot;/etc/group&quot;</span>, 1, -1);</div>
<div class="line"><span class="lineno"> 2941</span>            }</div>
<div class="line"><span class="lineno"> 2942</span> </div>
<div class="line"><span class="lineno"> 2943</span><span class="preprocessor">#if defined(__GLIBC__)</span></div>
<div class="line"><span class="lineno"> 2944</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.extroot)</div>
<div class="line"><span class="lineno"> 2945</span>                <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a31752c6608fbf56bb359ba109bdc6f6f">add_mount_bind</a>(<span class="stringliteral">&quot;/etc/nsswitch.conf&quot;</span>, 1, -1);</div>
<div class="line"><span class="lineno"> 2946</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2947</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.ns == -1) {</div>
<div class="line"><span class="lineno"> 2948</span>                <span class="keywordflow">if</span> (!(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp; CLONE_NEWNET)) {</div>
<div class="line"><span class="lineno"> 2949</span>                    <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a31752c6608fbf56bb359ba109bdc6f6f">add_mount_bind</a>(<span class="stringliteral">&quot;/etc/resolv.conf&quot;</span>, 1, 0);</div>
<div class="line"><span class="lineno"> 2950</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2951</span>                    <span class="comment">/* new mount namespace to provide /dev/resolv.conf.d */</span></div>
<div class="line"><span class="lineno"> 2952</span>                    <span class="keywordtype">char</span> hostdir[PATH_MAX];</div>
<div class="line"><span class="lineno"> 2953</span> </div>
<div class="line"><span class="lineno"> 2954</span>                    snprintf(hostdir, PATH_MAX, <span class="stringliteral">&quot;/tmp/resolv.conf-%s.d&quot;</span>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.name);</div>
<div class="line"><span class="lineno"> 2955</span>                    <a class="code hl_function" href="../../d0/d2b/libubox_2utils_8c.html#a9fb089901b41392a5ac197f3e18cc3f7">mkdir_p</a>(hostdir, 0755);</div>
<div class="line"><span class="lineno"> 2956</span>                    <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2">add_mount</a>(hostdir, <span class="stringliteral">&quot;/dev/resolv.conf.d&quot;</span>, NULL,</div>
<div class="line"><span class="lineno"> 2957</span>                        MS_BIND | MS_NOEXEC | MS_NOATIME | MS_NOSUID | MS_NODEV | MS_RDONLY, 0, NULL, 0);</div>
<div class="line"><span class="lineno"> 2958</span>                }</div>
<div class="line"><span class="lineno"> 2959</span>            }</div>
<div class="line"><span class="lineno"> 2960</span>            <span class="comment">/* default mounts */</span></div>
<div class="line"><span class="lineno"> 2961</span>            <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2">add_mount</a>(NULL, <span class="stringliteral">&quot;/dev&quot;</span>, <span class="stringliteral">&quot;tmpfs&quot;</span>, MS_NOATIME | MS_NOEXEC | MS_NOSUID, 0, <span class="stringliteral">&quot;size=1M&quot;</span>, -1);</div>
<div class="line"><span class="lineno"> 2962</span>            <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2">add_mount</a>(NULL, <span class="stringliteral">&quot;/dev/pts&quot;</span>, <span class="stringliteral">&quot;devpts&quot;</span>, MS_NOATIME | MS_NOEXEC | MS_NOSUID, 0, <span class="stringliteral">&quot;newinstance,ptmxmode=0666,mode=0620,gid=5&quot;</span>, 0);</div>
<div class="line"><span class="lineno"> 2963</span> </div>
<div class="line"><span class="lineno"> 2964</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.procfs || <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ocibundle) {</div>
<div class="line"><span class="lineno"> 2965</span>                <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2">add_mount</a>(<span class="stringliteral">&quot;proc&quot;</span>, <span class="stringliteral">&quot;/proc&quot;</span>, <span class="stringliteral">&quot;proc&quot;</span>, MS_NOATIME | MS_NODEV | MS_NOEXEC | MS_NOSUID, 0, NULL, -1);</div>
<div class="line"><span class="lineno"> 2966</span> </div>
<div class="line"><span class="lineno"> 2967</span>                <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2968</span><span class="comment">                 * hack to make /proc/sys/net read-write while the rest of /proc/sys is read-only</span></div>
<div class="line"><span class="lineno"> 2969</span><span class="comment">                 * which cannot be expressed with OCI spec, but happends to be very useful.</span></div>
<div class="line"><span class="lineno"> 2970</span><span class="comment">                 * Only apply it if &#39;/proc/sys&#39; is not already listed as mount, maskedPath or</span></div>
<div class="line"><span class="lineno"> 2971</span><span class="comment">                 * readonlyPath.</span></div>
<div class="line"><span class="lineno"> 2972</span><span class="comment">                 * If not running in a new network namespace, only make /proc/sys read-only.</span></div>
<div class="line"><span class="lineno"> 2973</span><span class="comment">                 * If running in a new network namespace, temporarily stash (ie. mount-bind)</span></div>
<div class="line"><span class="lineno"> 2974</span><span class="comment">                 * /proc/sys/net into (totally unrelated, but surely existing) /proc/self/net.</span></div>
<div class="line"><span class="lineno"> 2975</span><span class="comment">                 * Then we mount-bind /proc/sys read-only and then mount-move /proc/self/net into</span></div>
<div class="line"><span class="lineno"> 2976</span><span class="comment">                 * /proc/sys/net.</span></div>
<div class="line"><span class="lineno"> 2977</span><span class="comment">                 * This works because mounts are executed in incrementing strcmp() order and</span></div>
<div class="line"><span class="lineno"> 2978</span><span class="comment">                 * /proc/self/net appears there before /proc/sys/net and hence the operation</span></div>
<div class="line"><span class="lineno"> 2979</span><span class="comment">                 * succeeds as the bind-mount of /proc/self/net is performed first and then</span></div>
<div class="line"><span class="lineno"> 2980</span><span class="comment">                 * move-mount of /proc/sys/net follows because &#39;e&#39; preceeds &#39;y&#39; in the ASCII</span></div>
<div class="line"><span class="lineno"> 2981</span><span class="comment">                 * table (and in the alphabet).</span></div>
<div class="line"><span class="lineno"> 2982</span><span class="comment">                 */</span></div>
<div class="line"><span class="lineno"> 2983</span>                <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2">add_mount</a>(NULL, <span class="stringliteral">&quot;/proc/sys&quot;</span>, NULL, MS_BIND | MS_RDONLY, 0, NULL, -1))</div>
<div class="line"><span class="lineno"> 2984</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp; CLONE_NEWNET)</div>
<div class="line"><span class="lineno"> 2985</span>                        <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../d2/d5a/fs_8c.html#a28c0345ea0c2bb5b2e5815235849fd30">add_mount_inner</a>(<span class="stringliteral">&quot;/proc/self/net&quot;</span>, <span class="stringliteral">&quot;/proc/sys/net&quot;</span>, NULL, MS_MOVE, 0, NULL, -1))</div>
<div class="line"><span class="lineno"> 2986</span>                            <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a28c0345ea0c2bb5b2e5815235849fd30">add_mount_inner</a>(<span class="stringliteral">&quot;/proc/sys/net&quot;</span>, <span class="stringliteral">&quot;/proc/self/net&quot;</span>, NULL, MS_BIND, 0, NULL, -1);</div>
<div class="line"><span class="lineno"> 2987</span> </div>
<div class="line"><span class="lineno"> 2988</span>            }</div>
<div class="line"><span class="lineno"> 2989</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.sysfs || <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ocibundle)</div>
<div class="line"><span class="lineno"> 2990</span>                <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2">add_mount</a>(<span class="stringliteral">&quot;sysfs&quot;</span>, <span class="stringliteral">&quot;/sys&quot;</span>, <span class="stringliteral">&quot;sysfs&quot;</span>, MS_RELATIME | MS_NODEV | MS_NOEXEC | MS_NOSUID | MS_RDONLY, 0, NULL, -1);</div>
<div class="line"><span class="lineno"> 2991</span> </div>
<div class="line"><span class="lineno"> 2992</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ocibundle)</div>
<div class="line"><span class="lineno"> 2993</span>                <a class="code hl_function" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2">add_mount</a>(<span class="stringliteral">&quot;shm&quot;</span>, <span class="stringliteral">&quot;/dev/shm&quot;</span>, <span class="stringliteral">&quot;tmpfs&quot;</span>, MS_NOSUID | MS_NOEXEC | MS_NODEV, 0, <span class="stringliteral">&quot;mode=1777&quot;</span>, -1);</div>
<div class="line"><span class="lineno"> 2994</span> </div>
<div class="line"><span class="lineno"> 2995</span>        }</div>
<div class="line"><span class="lineno"> 2996</span> </div>
<div class="line"><span class="lineno"> 2997</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.pid != -1) {</div>
<div class="line"><span class="lineno"> 2998</span>            <a class="code hl_variable" href="#a3c32db21b181d5c2e2bc3b98674bd8cf">pidns_fd</a> = <a class="code hl_function" href="#ae3f4a6a40d174160d8d1fcd78515e4ea">ns_open_pid</a>(<span class="stringliteral">&quot;pid&quot;</span>, getpid());</div>
<div class="line"><span class="lineno"> 2999</span>            <a class="code hl_function" href="#ad16db5f10de76210ae8d78de47da352e">setns_open</a>(CLONE_NEWPID);</div>
<div class="line"><span class="lineno"> 3000</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3001</span>            <a class="code hl_variable" href="#a3c32db21b181d5c2e2bc3b98674bd8cf">pidns_fd</a> = -1;</div>
<div class="line"><span class="lineno"> 3002</span>        }</div>
<div class="line"><span class="lineno"> 3003</span> </div>
<div class="line"><span class="lineno"> 3004</span><span class="preprocessor">#ifdef CLONE_NEWTIME</span></div>
<div class="line"><span class="lineno"> 3005</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.time != -1) {</div>
<div class="line"><span class="lineno"> 3006</span>            timens_fd = <a class="code hl_function" href="#ae3f4a6a40d174160d8d1fcd78515e4ea">ns_open_pid</a>(<span class="stringliteral">&quot;time&quot;</span>, getpid());</div>
<div class="line"><span class="lineno"> 3007</span>            <a class="code hl_function" href="#ad16db5f10de76210ae8d78de47da352e">setns_open</a>(CLONE_NEWTIME);</div>
<div class="line"><span class="lineno"> 3008</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3009</span>            timens_fd = -1;</div>
<div class="line"><span class="lineno"> 3010</span>        }</div>
<div class="line"><span class="lineno"> 3011</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3012</span> </div>
<div class="line"><span class="lineno"> 3013</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp; CLONE_NEWUSER) {</div>
<div class="line"><span class="lineno"> 3014</span>            <span class="keywordflow">if</span> (prctl(PR_SET_SECUREBITS, SECBIT_NO_SETUID_FIXUP)) {</div>
<div class="line"><span class="lineno"> 3015</span>                <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;prctl(PR_SET_SECUREBITS) failed: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 3016</span>                <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 3017</span>            }</div>
<div class="line"><span class="lineno"> 3018</span>            <span class="keywordflow">if</span> (seteuid(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.root_map_uid)) {</div>
<div class="line"><span class="lineno"> 3019</span>                <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;seteuid(%d) failed: %m\n&quot;</span>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.root_map_uid);</div>
<div class="line"><span class="lineno"> 3020</span>                <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 3021</span>            }</div>
<div class="line"><span class="lineno"> 3022</span>        }</div>
<div class="line"><span class="lineno"> 3023</span> </div>
<div class="line"><span class="lineno"> 3024</span>        <a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a> = clone(<a class="code hl_function" href="#a0ec0440bd3676ab8e8d63f8ca3660b3a">exec_jail</a>, <a class="code hl_variable" href="#aad410c04420d9661f33117e672aee307">child_stack</a> + <a class="code hl_define" href="#a6423a880df59733d2d9b509c7718d3a9">STACK_SIZE</a>, SIGCHLD | (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp; (~<a class="code hl_define" href="#a9d5d88148a26086567c3731e2e5e110a">CLONE_NEWCGROUP</a>)), NULL);</div>
<div class="line"><span class="lineno"> 3025</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3026</span>        <a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a> = fork();</div>
<div class="line"><span class="lineno"> 3027</span>    }</div>
<div class="line"><span class="lineno"> 3028</span> </div>
<div class="line"><span class="lineno"> 3029</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 3030</span>        <span class="comment">/* parent process */</span></div>
<div class="line"><span class="lineno"> 3031</span>        <span class="keywordtype">char</span> sig_buf[1];</div>
<div class="line"><span class="lineno"> 3032</span> </div>
<div class="line"><span class="lineno"> 3033</span>        <a class="code hl_function" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb">uloop_process_add</a>(&amp;<a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>);</div>
<div class="line"><span class="lineno"> 3034</span>        <a class="code hl_variable" href="#a056d6abff975f4167ecd49617b5261ee">jail_running</a> = 1;</div>
<div class="line"><span class="lineno"> 3035</span>        <span class="keywordflow">if</span> (seteuid(0)) {</div>
<div class="line"><span class="lineno"> 3036</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;seteuid(%d) failed: %m\n&quot;</span>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.root_map_uid);</div>
<div class="line"><span class="lineno"> 3037</span>            <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 3038</span>        }</div>
<div class="line"><span class="lineno"> 3039</span> </div>
<div class="line"><span class="lineno"> 3040</span>        prctl(PR_SET_SECUREBITS, 0);</div>
<div class="line"><span class="lineno"> 3041</span> </div>
<div class="line"><span class="lineno"> 3042</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a3c32db21b181d5c2e2bc3b98674bd8cf">pidns_fd</a> != -1) {</div>
<div class="line"><span class="lineno"> 3043</span>            setns(<a class="code hl_variable" href="#a3c32db21b181d5c2e2bc3b98674bd8cf">pidns_fd</a>, CLONE_NEWPID);</div>
<div class="line"><span class="lineno"> 3044</span>            close(<a class="code hl_variable" href="#a3c32db21b181d5c2e2bc3b98674bd8cf">pidns_fd</a>);</div>
<div class="line"><span class="lineno"> 3045</span>        }</div>
<div class="line"><span class="lineno"> 3046</span><span class="preprocessor">#ifdef CLONE_NEWTIME</span></div>
<div class="line"><span class="lineno"> 3047</span>        <span class="keywordflow">if</span> (timens_fd != -1) {</div>
<div class="line"><span class="lineno"> 3048</span>            setns(timens_fd, CLONE_NEWTIME);</div>
<div class="line"><span class="lineno"> 3049</span>            close(timens_fd);</div>
<div class="line"><span class="lineno"> 3050</span>        }</div>
<div class="line"><span class="lineno"> 3051</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3052</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.net != -1)</div>
<div class="line"><span class="lineno"> 3053</span>            close(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.net);</div>
<div class="line"><span class="lineno"> 3054</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.ns != -1)</div>
<div class="line"><span class="lineno"> 3055</span>            close(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.ns);</div>
<div class="line"><span class="lineno"> 3056</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.ipc != -1)</div>
<div class="line"><span class="lineno"> 3057</span>            close(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.ipc);</div>
<div class="line"><span class="lineno"> 3058</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.uts != -1)</div>
<div class="line"><span class="lineno"> 3059</span>            close(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.uts);</div>
<div class="line"><span class="lineno"> 3060</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.user != -1)</div>
<div class="line"><span class="lineno"> 3061</span>            close(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.user);</div>
<div class="line"><span class="lineno"> 3062</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.cgroup != -1)</div>
<div class="line"><span class="lineno"> 3063</span>            close(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.setns.cgroup);</div>
<div class="line"><span class="lineno"> 3064</span>        close(<a class="code hl_variable" href="#a541f86a9c230bc87b5e7e2c83e2a6d34">pipes</a>[1]);</div>
<div class="line"><span class="lineno"> 3065</span>        close(<a class="code hl_variable" href="#a541f86a9c230bc87b5e7e2c83e2a6d34">pipes</a>[2]);</div>
<div class="line"><span class="lineno"> 3066</span>        <span class="keywordflow">if</span> (read(<a class="code hl_variable" href="#a541f86a9c230bc87b5e7e2c83e2a6d34">pipes</a>[0], sig_buf, 1) &lt; 1) {</div>
<div class="line"><span class="lineno"> 3067</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;can&#39;t read from child\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 3068</span>            <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(-1);</div>
<div class="line"><span class="lineno"> 3069</span>        }</div>
<div class="line"><span class="lineno"> 3070</span>        close(<a class="code hl_variable" href="#a541f86a9c230bc87b5e7e2c83e2a6d34">pipes</a>[0]);</div>
<div class="line"><span class="lineno"> 3071</span>        <a class="code hl_function" href="#ab22dc7688d950fcf927c8cbcfcdb15cd">set_oom_score_adj</a>();</div>
<div class="line"><span class="lineno"> 3072</span> </div>
<div class="line"><span class="lineno"> 3073</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ocibundle)</div>
<div class="line"><span class="lineno"> 3074</span>            <a class="code hl_function" href="../../db/d40/cgroups_8c.html#a48b36b1024ff2ddd591812dad1fad855">cgroups_apply</a>(<a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>);</div>
<div class="line"><span class="lineno"> 3075</span> </div>
<div class="line"><span class="lineno"> 3076</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp; CLONE_NEWUSER) {</div>
<div class="line"><span class="lineno"> 3077</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="#a5e111fe85d16008f130c765e511d670c">write_setgroups</a>(<a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, <span class="keyword">true</span>)) {</div>
<div class="line"><span class="lineno"> 3078</span>                <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;can&#39;t write setgroups\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 3079</span>                <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(-1);</div>
<div class="line"><span class="lineno"> 3080</span>            }</div>
<div class="line"><span class="lineno"> 3081</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.uidmap) {</div>
<div class="line"><span class="lineno"> 3082</span>                <span class="keywordtype">bool</span> has_gr = (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.gr_gid != -1);</div>
<div class="line"><span class="lineno"> 3083</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.pw_uid != -1) {</div>
<div class="line"><span class="lineno"> 3084</span>                    <a class="code hl_function" href="#aca23e4e8fd88ec02ca43121879a36702">write_single_uid_gid_map</a>(<a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, 0, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.pw_uid);</div>
<div class="line"><span class="lineno"> 3085</span>                    <a class="code hl_function" href="#aca23e4e8fd88ec02ca43121879a36702">write_single_uid_gid_map</a>(<a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, 1, has_gr?<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.gr_gid:<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.pw_gid);</div>
<div class="line"><span class="lineno"> 3086</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3087</span>                    <a class="code hl_function" href="#aca23e4e8fd88ec02ca43121879a36702">write_single_uid_gid_map</a>(<a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, 0, 65534);</div>
<div class="line"><span class="lineno"> 3088</span>                    <a class="code hl_function" href="#aca23e4e8fd88ec02ca43121879a36702">write_single_uid_gid_map</a>(<a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, 1, has_gr?<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.gr_gid:65534);</div>
<div class="line"><span class="lineno"> 3089</span>                }</div>
<div class="line"><span class="lineno"> 3090</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3091</span>                <a class="code hl_function" href="#a03b42a6e644fea8b163b6b51e0fd4a99">write_uid_gid_map</a>(<a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, 0, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.uidmap);</div>
<div class="line"><span class="lineno"> 3092</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.gidmap)</div>
<div class="line"><span class="lineno"> 3093</span>                    <a class="code hl_function" href="#a03b42a6e644fea8b163b6b51e0fd4a99">write_uid_gid_map</a>(<a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, 1, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.gidmap);</div>
<div class="line"><span class="lineno"> 3094</span>            }</div>
<div class="line"><span class="lineno"> 3095</span>        }</div>
<div class="line"><span class="lineno"> 3096</span> </div>
<div class="line"><span class="lineno"> 3097</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp; CLONE_NEWNET)</div>
<div class="line"><span class="lineno"> 3098</span>            <a class="code hl_function" href="../../db/d3d/netifd_8c.html#a086fe28fa898f797f9a657e63a3a95bd">jail_network_start</a>(<a class="code hl_variable" href="#a00f1e87fefda65b43a661aefc6f16566">parent_ctx</a>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.name, <a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>);</div>
<div class="line"><span class="lineno"> 3099</span> </div>
<div class="line"><span class="lineno"> 3100</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="#a67a452007801b15d82d00079f8e344f5">jail_writepid</a>(<a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>)) {</div>
<div class="line"><span class="lineno"> 3101</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to write pidfile: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 3102</span>            <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(-1);</div>
<div class="line"><span class="lineno"> 3103</span>        }</div>
<div class="line"><span class="lineno"> 3104</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a> == 0) {</div>
<div class="line"><span class="lineno"> 3105</span>        <span class="comment">/* fork child process */</span></div>
<div class="line"><span class="lineno"> 3106</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(<a class="code hl_function" href="#a0ec0440bd3676ab8e8d63f8ca3660b3a">exec_jail</a>(NULL));</div>
<div class="line"><span class="lineno"> 3107</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3108</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to clone/fork: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 3109</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 3110</span>    }</div>
<div class="line"><span class="lineno"> 3111</span>    <a class="code hl_function" href="#a1756d87ceab7e1c79fe7caf453cb102a">run_hooks</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.createRuntime, <a class="code hl_function" href="#a67b89ffa3ccdcc917716e1c48ed5d90c">post_create_runtime</a>);</div>
<div class="line"><span class="lineno"> 3112</span>}</div>
<div class="ttc" id="acgroups_8c_html_a48b36b1024ff2ddd591812dad1fad855"><div class="ttname"><a href="../../db/d40/cgroups_8c.html#a48b36b1024ff2ddd591812dad1fad855">cgroups_apply</a></div><div class="ttdeci">void cgroups_apply(pid_t pid)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d40/cgroups_8c_source.html#l00102">cgroups.c:102</a></div></div>
<div class="ttc" id="afs_8c_html_a28c0345ea0c2bb5b2e5815235849fd30"><div class="ttname"><a href="../../d2/d5a/fs_8c.html#a28c0345ea0c2bb5b2e5815235849fd30">add_mount_inner</a></div><div class="ttdeci">int add_mount_inner(const char *source, const char *target, const char *filesystemtype, unsigned long mountflags, unsigned long propflags, const char *optstr, int error)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5a/fs_8c_source.html#l00203">fs.c:203</a></div></div>
<div class="ttc" id="ajail_8c_html_a0015ee3272db94af6db03ff79d543794"><div class="ttname"><a href="#a0015ee3272db94af6db03ff79d543794">has_namespaces</a></div><div class="ttdeci">static bool has_namespaces(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00172">jail.c:172</a></div></div>
<div class="ttc" id="ajail_8c_html_a03b42a6e644fea8b163b6b51e0fd4a99"><div class="ttname"><a href="#a03b42a6e644fea8b163b6b51e0fd4a99">write_uid_gid_map</a></div><div class="ttdeci">static int write_uid_gid_map(pid_t child_pid, bool gidmap, char *mapstr)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00828">jail.c:828</a></div></div>
<div class="ttc" id="ajail_8c_html_a0ec0440bd3676ab8e8d63f8ca3660b3a"><div class="ttname"><a href="#a0ec0440bd3676ab8e8d63f8ca3660b3a">exec_jail</a></div><div class="ttdeci">static int exec_jail(void *arg)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01161">jail.c:1161</a></div></div>
<div class="ttc" id="ajail_8c_html_a3c32db21b181d5c2e2bc3b98674bd8cf"><div class="ttname"><a href="#a3c32db21b181d5c2e2bc3b98674bd8cf">pidns_fd</a></div><div class="ttdeci">static int pidns_fd</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02572">jail.c:2572</a></div></div>
<div class="ttc" id="ajail_8c_html_a5e111fe85d16008f130c765e511d670c"><div class="ttname"><a href="#a5e111fe85d16008f130c765e511d670c">write_setgroups</a></div><div class="ttdeci">static int write_setgroups(pid_t child_pid, bool allow)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00870">jail.c:870</a></div></div>
<div class="ttc" id="ajail_8c_html_a6423a880df59733d2d9b509c7718d3a9"><div class="ttname"><a href="#a6423a880df59733d2d9b509c7718d3a9">STACK_SIZE</a></div><div class="ttdeci">#define STACK_SIZE</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00071">jail.c:71</a></div></div>
<div class="ttc" id="ajail_8c_html_a67a452007801b15d82d00079f8e344f5"><div class="ttname"><a href="#a67a452007801b15d82d00079f8e344f5">jail_writepid</a></div><div class="ttdeci">static int jail_writepid(pid_t pid)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02518">jail.c:2518</a></div></div>
<div class="ttc" id="ajail_8c_html_a67b89ffa3ccdcc917716e1c48ed5d90c"><div class="ttname"><a href="#a67b89ffa3ccdcc917716e1c48ed5d90c">post_create_runtime</a></div><div class="ttdeci">static void post_create_runtime(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l03115">jail.c:3115</a></div></div>
<div class="ttc" id="ajail_8c_html_aad410c04420d9661f33117e672aee307"><div class="ttname"><a href="#aad410c04420d9661f33117e672aee307">child_stack</a></div><div class="ttdeci">static char child_stack[STACK_SIZE]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00165">jail.c:165</a></div></div>
<div class="ttc" id="ajail_8c_html_ab22dc7688d950fcf927c8cbcfcdb15cd"><div class="ttname"><a href="#ab22dc7688d950fcf927c8cbcfcdb15cd">set_oom_score_adj</a></div><div class="ttdeci">static int set_oom_score_adj(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02392">jail.c:2392</a></div></div>
<div class="ttc" id="ajail_8c_html_aca23e4e8fd88ec02ca43121879a36702"><div class="ttname"><a href="#aca23e4e8fd88ec02ca43121879a36702">write_single_uid_gid_map</a></div><div class="ttdeci">static int write_single_uid_gid_map(pid_t child_pid, bool gidmap, int id)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00849">jail.c:849</a></div></div>
<div class="ttc" id="ajail_8c_html_ae076946d2fc6067e05a7851cad082a4a"><div class="ttname"><a href="#ae076946d2fc6067e05a7851cad082a4a">apply_rlimits</a></div><div class="ttdeci">static int apply_rlimits(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00942">jail.c:942</a></div></div>
<div class="ttc" id="ajail_8c_html_ae3f4a6a40d174160d8d1fcd78515e4ea"><div class="ttname"><a href="#ae3f4a6a40d174160d8d1fcd78515e4ea">ns_open_pid</a></div><div class="ttdeci">int ns_open_pid(const char *nstype, const pid_t target_ns)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01329">jail.c:1329</a></div></div>
<div class="ttc" id="anetifd_8c_html_a086fe28fa898f797f9a657e63a3a95bd"><div class="ttname"><a href="../../db/d3d/netifd_8c.html#a086fe28fa898f797f9a657e63a3a95bd">jail_network_start</a></div><div class="ttdeci">int jail_network_start(struct ubus_context *new_ctx, char *new_jail_name, pid_t new_ns_pid)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d3d/netifd_8c_source.html#l00434">netifd.c:434</a></div></div>
<div class="ttc" id="auloop_8c_html_af511d1bcbdfcfaba211d4ae1b0930dbb"><div class="ttname"><a href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb">uloop_process_add</a></div><div class="ttdeci">int uloop_process_add(struct uloop_process *p)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d08/uloop_8c_source.html#l00391">uloop.c:391</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d5a/fs_8c_source.html#l00197">add_mount()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00219">add_mount_bind()</a>, <a class="el" href="../../d2/d5a/fs_8c_source.html#l00203">add_mount_inner()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00942">apply_rlimits()</a>, <a class="el" href="../../db/d40/cgroups_8c_source.html#l00102">cgroups_apply()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00165">child_stack</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00068">CLONE_NEWCGROUP</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01161">exec_jail()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00774">free_and_exit()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00172">has_namespaces()</a>, <a class="el" href="../../db/d3d/netifd_8c_source.html#l00434">jail_network_start()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01107">jail_process</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01085">jail_running</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02518">jail_writepid()</a>, <a class="el" href="../../d0/d2b/libubox_2utils_8c_source.html#l00161">mkdir_p()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01329">ns_open_pid()</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00167">parent_ctx</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00087">uloop_process::pid</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02572">pidns_fd</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01160">pipes</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l03115">post_create_runtime()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00512">run_hooks()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02392">set_oom_score_adj()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01067">setns_open()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00071">STACK_SIZE</a>, <a class="el" href="../../d1/d08/uloop_8c_source.html#l00391">uloop_process_add()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00870">write_setgroups()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00849">write_single_uid_gid_map()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00828">write_uid_gid_map()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a2a752afff1e548707b0cbec92c8e7512_cgraph.png" border="0" usemap="#add/d26/jail_8c_a2a752afff1e548707b0cbec92c8e7512_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a2a752afff1e548707b0cbec92c8e7512_cgraph" id="add/d26/jail_8c_a2a752afff1e548707b0cbec92c8e7512_cgraph">
<area shape="rect" title=" " alt="" coords="5,894,122,927"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a16e2b60a1b30b2a7791960d7c8ce15b2" title=" " alt="" coords="822,123,947,157"/>
<area shape="poly" title=" " alt="" coords="62,893,67,770,82,582,95,485,113,395,137,321,151,293,168,271,806,151,807,157,171,275,156,296,142,323,118,396,100,486,87,583,72,770,68,893"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a31752c6608fbf56bb359ba109bdc6f6f" title=" " alt="" coords="211,120,386,154"/>
<area shape="poly" title=" " alt="" coords="62,893,65,754,78,538,91,424,109,318,135,231,150,197,168,171,195,151,198,155,172,175,155,200,140,233,115,320,96,424,83,538,70,754,67,893"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a28c0345ea0c2bb5b2e5815235849fd30" title=" " alt="" coords="793,66,976,99"/>
<area shape="poly" title=" " alt="" coords="63,893,73,731,95,479,109,351,126,238,146,152,156,123,168,106,204,77,243,54,284,36,328,22,418,6,510,4,600,11,685,24,759,41,819,58,818,63,758,46,684,29,600,16,510,9,419,12,329,27,286,41,245,59,207,82,172,110,161,126,151,154,131,239,115,351,100,479,79,731,68,893"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#ae076946d2fc6067e05a7851cad082a4a" title=" " alt="" coords="229,286,368,319"/>
<area shape="poly" title=" " alt="" coords="63,893,69,780,86,610,100,522,117,441,140,374,153,348,168,329,189,313,213,304,215,309,191,318,172,332,158,351,145,376,122,442,105,523,91,611,75,780,68,893"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#a48b36b1024ff2ddd591812dad1fad855" title=" " alt="" coords="221,343,376,377"/>
<area shape="poly" title=" " alt="" coords="63,893,73,794,93,647,107,570,124,500,144,442,168,402,185,387,205,376,207,380,188,391,172,406,149,444,129,502,112,572,98,648,78,794,69,894"/>
<area shape="rect" href="../../d0/d2b/libubox_2utils_8c.html#a9fb089901b41392a5ac197f3e18cc3f7" title=" " alt="" coords="559,311,655,345"/>
<area shape="poly" title=" " alt="" coords="64,893,75,804,95,674,110,608,126,547,146,497,168,462,198,436,228,420,258,413,289,411,353,408,388,401,426,387,449,370,474,353,508,341,543,333,544,339,510,347,476,358,452,374,428,392,389,406,353,413,289,416,259,418,230,425,201,440,172,466,150,499,131,549,115,609,101,675,80,804,69,894"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a0ec0440bd3676ab8e8d63f8ca3660b3a" title=" " alt="" coords="249,535,348,569"/>
<area shape="poly" title=" " alt="" coords="74,892,276,580,280,583,78,895"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a0d1316d1e009899e8b8b735bb6ba70e3" title=" " alt="" coords="812,1060,957,1094"/>
<area shape="poly" title=" " alt="" coords="72,927,84,961,104,1003,133,1044,150,1062,171,1076,221,1094,289,1104,371,1109,460,1109,643,1099,797,1085,797,1090,644,1105,461,1114,371,1114,288,1110,219,1099,168,1081,147,1066,129,1048,99,1006,79,963,67,929"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#ad16db5f10de76210ae8d78de47da352e" title=" " alt="" coords="544,368,670,402"/>
<area shape="poly" title=" " alt="" coords="61,893,63,825,74,725,87,671,106,617,133,566,168,520,535,405,536,410,171,525,137,569,111,619,93,672,80,726,68,825,67,893"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a0015ee3272db94af6db03ff79d543794" title=" " alt="" coords="209,866,388,899"/>
<area shape="poly" title=" " alt="" coords="122,901,193,892,193,898,123,906"/>
<area shape="rect" href="../../db/d3d/netifd_8c.html#a086fe28fa898f797f9a657e63a3a95bd" title=" " alt="" coords="207,808,390,842"/>
<area shape="poly" title=" " alt="" coords="90,891,127,870,169,851,191,843,193,848,171,856,129,875,93,895"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#ae3f4a6a40d174160d8d1fcd78515e4ea" title=" " alt="" coords="539,982,675,1015"/>
<area shape="poly" title=" " alt="" coords="122,915,261,934,427,960,524,978,523,984,427,965,261,939,122,920"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a67a452007801b15d82d00079f8e344f5" title=" " alt="" coords="233,1032,364,1066"/>
<area shape="poly" title=" " alt="" coords="78,926,116,973,142,998,171,1019,218,1037,216,1042,168,1024,138,1002,112,977,74,929"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a67b89ffa3ccdcc917716e1c48ed5d90c" title=" " alt="" coords="194,975,403,1009"/>
<area shape="poly" title=" " alt="" coords="103,925,171,953,216,968,214,973,169,958,101,930"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a1756d87ceab7e1c79fe7caf453cb102a" title=" " alt="" coords="826,1168,943,1202"/>
<area shape="poly" title=" " alt="" coords="71,927,82,966,101,1017,130,1071,149,1094,171,1115,221,1130,322,1153,475,1185,549,1191,606,1191,738,1185,811,1184,811,1189,738,1190,606,1196,549,1196,475,1190,320,1158,220,1135,168,1119,145,1098,126,1073,96,1020,76,968,66,928"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#ab22dc7688d950fcf927c8cbcfcdb15cd" title=" " alt="" coords="202,1192,395,1226"/>
<area shape="poly" title=" " alt="" coords="69,927,77,976,94,1042,108,1077,125,1111,146,1143,171,1171,189,1184,186,1188,168,1175,142,1147,120,1114,103,1079,89,1043,72,977,64,928"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb" title=" " alt="" coords="200,1250,397,1283"/>
<area shape="poly" title=" " alt="" coords="67,928,71,987,85,1071,98,1116,116,1160,140,1201,171,1237,188,1248,185,1252,168,1240,136,1204,111,1163,93,1118,80,1072,66,988,62,928"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5e111fe85d16008f130c765e511d670c" title=" " alt="" coords="214,1307,383,1341"/>
<area shape="poly" title=" " alt="" coords="70,927,82,1006,104,1117,134,1225,152,1266,171,1294,201,1312,198,1317,168,1298,147,1269,129,1226,99,1118,77,1007,64,928"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#aca23e4e8fd88ec02ca43121879a36702" title=" " alt="" coords="170,1364,427,1398"/>
<area shape="poly" title=" " alt="" coords="69,927,80,1016,100,1144,114,1210,131,1270,150,1319,172,1351,174,1353,170,1357,168,1355,145,1321,126,1272,109,1211,95,1145,74,1017,64,928"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a03b42a6e644fea8b163b6b51e0fd4a99" title=" " alt="" coords="202,1422,395,1455"/>
<area shape="poly" title=" " alt="" coords="69,927,77,1026,96,1172,110,1247,127,1316,148,1371,172,1409,190,1422,187,1426,168,1412,143,1374,122,1317,105,1248,91,1173,72,1027,63,928"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a6a335418ee05d0ecbda2094c55408404" title=" " alt="" coords="1031,95,1165,129"/>
<area shape="poly" title=" " alt="" coords="947,129,1015,120,1016,125,948,134"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4824ede62a9ceedb153f039c5dc212f9" title=" " alt="" coords="515,120,699,154"/>
<area shape="poly" title=" " alt="" coords="386,134,499,134,499,140,386,140"/>
<area shape="poly" title=" " alt="" coords="699,135,806,136,806,142,699,141"/>
<area shape="poly" title=" " alt="" coords="976,92,1016,98,1015,103,975,98"/>
<area shape="rect" href="../../d3/dd8/cgroups-bpf_8c.html#a824c3ba6008ad58aefdeff33f8c36734" title=" " alt="" coords="500,230,713,263"/>
<area shape="poly" title=" " alt="" coords="376,349,402,341,426,330,440,316,449,302,457,287,473,272,484,266,487,271,477,277,462,290,453,304,445,320,428,334,404,346,377,354"/>
<area shape="poly" title=" " alt="" coords="376,349,543,332,543,337,377,354"/>
<area shape="poly" title=" " alt="" coords="557,312,552,302,559,292,578,286,607,284,638,287,656,293,654,298,637,292,607,290,579,292,562,297,557,302,562,309"/>
<area shape="poly" title=" " alt="" coords="348,558,444,578,560,606,668,641,711,660,740,680,777,722,807,770,831,821,850,873,873,971,884,1045,878,1045,868,972,845,874,826,823,803,772,773,726,737,684,708,665,666,646,559,611,443,583,347,563"/>
<area shape="poly" title=" " alt="" coords="347,541,388,528,425,506,441,485,448,463,455,441,473,419,499,403,528,393,530,398,502,408,477,423,460,443,453,465,446,487,429,510,390,533,349,546"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#ab97dc72992426f87762ca05057c651b3" title=" " alt="" coords="545,478,669,511"/>
<area shape="poly" title=" " alt="" coords="348,540,528,506,529,511,349,545"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae960d01033fb72572bc1aa539a501fe7" title=" " alt="" coords="552,535,662,569"/>
<area shape="poly" title=" " alt="" coords="348,549,536,549,536,554,348,554"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077" title=" " alt="" coords="550,810,663,843"/>
<area shape="poly" title=" " alt="" coords="309,568,330,614,366,677,415,742,444,771,476,796,505,810,536,819,534,824,503,815,474,801,441,775,411,746,362,680,326,617,304,570"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07" title=" " alt="" coords="786,590,983,623"/>
<area shape="poly" title=" " alt="" coords="347,538,386,524,426,506,439,495,448,483,458,472,474,463,546,439,607,430,667,438,739,463,779,485,814,515,843,546,866,575,862,578,839,550,811,518,776,489,737,468,666,443,607,436,548,444,476,468,461,476,452,487,443,498,428,510,388,529,348,543"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b" title=" " alt="" coords="1213,1034,1353,1067"/>
<area shape="poly" title=" " alt="" coords="957,1057,1030,1045,1098,1043,1165,1045,1197,1046,1197,1051,1165,1050,1098,1048,1031,1050,958,1062"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a61855620d1a0683f786486b1722d7dfa" title=" " alt="" coords="1045,1060,1151,1094"/>
<area shape="poly" title=" " alt="" coords="957,1074,1030,1074,1030,1080,957,1080"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2" title=" " alt="" coords="1042,1118,1154,1151"/>
<area shape="poly" title=" " alt="" coords="950,1092,1027,1113,1026,1118,949,1097"/>
<area shape="poly" title=" " alt="" coords="1151,1067,1197,1060,1198,1065,1152,1072"/>
<area shape="poly" title=" " alt="" coords="308,807,364,713,396,648,424,580,433,546,436,515,434,460,435,433,439,407,451,381,473,354,488,342,506,333,543,325,544,330,508,338,491,347,477,358,456,384,444,409,440,434,440,459,442,516,439,547,430,582,401,650,368,715,313,809"/>
<area shape="poly" title=" " alt="" coords="391,823,534,824,534,829,391,828"/>
<area shape="poly" title=" " alt="" coords="313,806,379,743,424,709,474,680,548,652,626,631,702,618,771,610,771,615,703,623,627,637,550,657,476,685,427,713,382,747,317,810"/>
<area shape="rect" href="../../db/d3d/netifd_8c.html#a236bb6b2255c0b3d555d8b5226c6884a" title=" " alt="" coords="503,695,711,729"/>
<area shape="poly" title=" " alt="" coords="329,805,394,771,474,737,496,731,497,736,476,742,396,776,331,810"/>
<area shape="rect" href="../../db/d3d/netifd_8c.html#a71698b19f7fdbb3ae922ac51f68e9793" title=" " alt="" coords="529,867,685,901"/>
<area shape="poly" title=" " alt="" coords="391,840,514,864,513,869,390,845"/>
<area shape="poly" title=" " alt="" coords="391,831,411,839,429,851,442,866,449,881,454,911,458,941,465,955,477,968,499,982,524,991,522,996,497,987,473,973,460,958,453,943,448,912,444,882,437,869,425,855,408,844,389,836"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a570d5b4ff73cb373a6ca0ac54a9726a0" title=" " alt="" coords="535,924,679,958"/>
<area shape="poly" title=" " alt="" coords="391,835,428,851,445,866,453,882,461,897,476,911,520,929,518,934,474,915,457,900,449,884,441,869,426,855,389,839"/>
<area shape="rect" href="../../db/d3d/netifd_8c.html#a54efb4f9d0b67d049b750dfe54212cce" title=" " alt="" coords="504,752,710,786"/>
<area shape="poly" title=" " alt="" coords="390,806,495,787,496,792,391,811"/>
<area shape="poly" title=" " alt="" coords="652,692,823,627,825,632,654,697"/>
<area shape="poly" title=" " alt="" coords="378,1007,475,1025,647,1049,797,1066,797,1071,646,1055,475,1030,377,1012"/>
<area shape="poly" title=" " alt="" coords="332,972,378,945,425,910,439,894,447,880,457,866,474,852,503,839,534,830,536,835,505,844,476,857,461,869,452,883,443,898,429,914,381,949,335,977"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a44e8c7d9c78045cd28f81b95fb3f2cf3" title=" " alt="" coords="475,1142,738,1175"/>
<area shape="poly" title=" " alt="" coords="404,1006,428,1018,445,1030,454,1042,463,1056,477,1070,520,1103,563,1131,560,1135,517,1107,473,1074,459,1059,450,1046,441,1034,426,1022,402,1011"/>
<area shape="poly" title=" " alt="" coords="672,1139,738,1120,814,1097,815,1102,739,1125,673,1144"/>
<area shape="poly" title=" " alt="" coords="739,1168,811,1175,810,1181,738,1174"/>
</map>
</div>

</div>
</div>
<a id="ab539f0664e4eb2dda9be701742add492" name="ab539f0664e4eb2dda9be701742add492"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab539f0664e4eb2dda9be701742add492">&#9670;&#160;</a></span>post_poststart()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void post_poststart </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l03147">3147</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3148</span>{</div>
<div class="line"><span class="lineno"> 3149</span>    <a class="code hl_function" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077">uloop_run</a>(); <span class="comment">/* idle here while jail is running */</span></div>
<div class="line"><span class="lineno"> 3150</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a056d6abff975f4167ecd49617b5261ee">jail_running</a>) {</div>
<div class="line"><span class="lineno"> 3151</span>        <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;uloop interrupted, killing jail process\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 3152</span>        kill(<a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, SIGTERM);</div>
<div class="line"><span class="lineno"> 3153</span>        <a class="code hl_function" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346">uloop_timeout_set</a>(&amp;<a class="code hl_variable" href="#aacb1a5c0057b0c69933163312d70e8fd">jail_process_timeout</a>, 1000);</div>
<div class="line"><span class="lineno"> 3154</span>        <a class="code hl_function" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077">uloop_run</a>();</div>
<div class="line"><span class="lineno"> 3155</span>    }</div>
<div class="line"><span class="lineno"> 3156</span>    <a class="code hl_function" href="../../d1/d08/uloop_8c.html#ac0bcdd57d004a600844745bd38e83a2d">uloop_done</a>();</div>
<div class="line"><span class="lineno"> 3157</span>    <a class="code hl_function" href="#a75a14e1ea35414c049cd975fb3e3f99c">poststop</a>();</div>
<div class="line"><span class="lineno"> 3158</span>}</div>
<div class="ttc" id="auloop_8c_html_ac0bcdd57d004a600844745bd38e83a2d"><div class="ttname"><a href="../../d1/d08/uloop_8c.html#ac0bcdd57d004a600844745bd38e83a2d">uloop_done</a></div><div class="ttdeci">void uloop_done(void)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d08/uloop_8c_source.html#l00686">uloop.c:686</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01107">jail_process</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01089">jail_process_timeout</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01085">jail_running</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00087">uloop_process::pid</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l03161">poststop()</a>, <a class="el" href="../../d1/d08/uloop_8c_source.html#l00686">uloop_done()</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00147">uloop_run()</a>, and <a class="el" href="../../d1/d08/uloop_8c_source.html#l00328">uloop_timeout_set()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l03132">pipe_send_start_container()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_ab539f0664e4eb2dda9be701742add492_cgraph.png" border="0" usemap="#add/d26/jail_8c_ab539f0664e4eb2dda9be701742add492_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_ab539f0664e4eb2dda9be701742add492_cgraph" id="add/d26/jail_8c_ab539f0664e4eb2dda9be701742add492_cgraph">
<area shape="rect" title=" " alt="" coords="5,316,159,350"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a75a14e1ea35414c049cd975fb3e3f99c" title=" " alt="" coords="207,207,308,240"/>
<area shape="poly" title=" " alt="" coords="109,313,215,246,218,251,112,318"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077" title=" " alt="" coords="846,344,959,378"/>
<area shape="poly" title=" " alt="" coords="159,333,830,356,830,361,159,338"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="1022,235,1211,268"/>
<area shape="poly" title=" " alt="" coords="159,321,292,310,445,304,686,304,773,300,860,292,1014,269,1015,274,861,297,773,306,686,309,445,309,292,315,159,327"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ac0bcdd57d004a600844745bd38e83a2d" title=" " alt="" coords="1053,571,1180,604"/>
<area shape="poly" title=" " alt="" coords="110,348,167,383,248,424,295,442,344,458,394,468,445,472,686,472,739,474,793,481,897,504,991,534,1064,562,1062,567,989,539,896,509,792,486,739,479,686,477,445,477,394,473,343,463,293,447,246,429,165,388,107,352"/>
<area shape="rect" href="../../db/d3d/netifd_8c.html#aeada94c74be21275dbafb9a8d9515e90" title=" " alt="" coords="356,92,536,126"/>
<area shape="poly" title=" " alt="" coords="286,204,403,132,406,136,288,208"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a3360eb012491304d4630403c5dc33ec9" title=" " alt="" coords="371,177,521,211"/>
<area shape="poly" title=" " alt="" coords="308,213,355,206,356,211,309,218"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a1756d87ceab7e1c79fe7caf453cb102a" title=" " alt="" coords="388,235,505,268"/>
<area shape="poly" title=" " alt="" coords="309,228,372,238,371,243,308,234"/>
<area shape="rect" href="../../db/d3d/netifd_8c.html#aecf17edd05dd1516fd1785ed6cc97d7c" title=" " alt="" coords="584,5,785,39"/>
<area shape="poly" title=" " alt="" coords="483,89,583,48,602,41,604,47,585,53,485,94"/>
<area shape="rect" href="../../db/d3d/netifd_8c.html#a71698b19f7fdbb3ae922ac51f68e9793" title=" " alt="" coords="606,63,763,96"/>
<area shape="poly" title=" " alt="" coords="537,95,591,88,591,94,537,100"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2" title=" " alt="" coords="628,120,741,154"/>
<area shape="poly" title=" " alt="" coords="537,117,613,126,612,131,537,122"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#af8ca2237342df92c699fbb2ddb5f390b" title=" " alt="" coords="833,35,972,68"/>
<area shape="poly" title=" " alt="" coords="786,33,817,37,817,43,785,38"/>
<area shape="poly" title=" " alt="" coords="763,67,817,60,818,65,763,72"/>
<area shape="poly" title=" " alt="" coords="518,174,613,151,614,156,519,179"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a61855620d1a0683f786486b1722d7dfa" title=" " alt="" coords="631,177,738,211"/>
<area shape="poly" title=" " alt="" coords="521,192,615,192,615,197,521,197"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a88ee3d42d3e892d3b5dd714d89b49505" title=" " alt="" coords="617,235,752,268"/>
<area shape="poly" title=" " alt="" coords="505,249,602,249,602,254,505,254"/>
<area shape="poly" title=" " alt="" coords="721,266,854,334,852,339,719,271"/>
<area shape="poly" title=" " alt="" coords="752,249,1006,249,1006,254,752,254"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a14d4e1fa83f245cd59f0c68f48c90d75" title=" " alt="" coords="1020,344,1213,378"/>
<area shape="poly" title=" " alt="" coords="959,358,1005,358,1005,364,959,364"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a18ed130af55f89035ca041f340a091f9" title=" " alt="" coords="1263,232,1505,266"/>
<area shape="poly" title=" " alt="" coords="1141,341,1194,307,1260,274,1277,268,1279,273,1262,279,1197,312,1144,346"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a5d07b4993342a59a1b6327d23a771d47" title=" " alt="" coords="1261,399,1507,432"/>
<area shape="poly" title=" " alt="" coords="1203,376,1284,392,1283,398,1202,381"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ab4fcc424426de9a075b7b4b6f390fd2e" title=" " alt="" coords="1263,289,1505,323"/>
<area shape="poly" title=" " alt="" coords="1202,341,1283,324,1284,329,1203,346"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a1d8cdbdb1ea8dad23288f6ec0b2ff005" title=" " alt="" coords="1292,513,1476,547"/>
<area shape="poly" title=" " alt="" coords="1132,377,1185,438,1221,472,1263,500,1278,507,1276,512,1260,504,1218,476,1181,441,1128,380"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a76f33118cba0a358482528fad8c0f4cd" title=" " alt="" coords="1626,204,1704,238"/>
<area shape="poly" title=" " alt="" coords="1505,234,1610,224,1610,229,1506,239"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a941864296983cb342a79afe55055f8d3" title=" " alt="" coords="1589,261,1741,295"/>
<area shape="poly" title=" " alt="" coords="1506,259,1574,266,1573,271,1505,264"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a49ba044023de765e2d9d14db25d1845b" title=" " alt="" coords="1556,401,1774,435"/>
<area shape="poly" title=" " alt="" coords="1507,414,1540,414,1540,420,1507,419"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="1877,373,1962,407"/>
<area shape="poly" title=" " alt="" coords="1774,403,1861,394,1861,399,1775,409"/>
<area shape="poly" title=" " alt="" coords="1475,286,1506,276,1529,261,1554,246,1610,229,1611,234,1556,251,1532,266,1508,281,1477,291"/>
<area shape="poly" title=" " alt="" coords="1505,291,1573,285,1574,290,1506,297"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="1555,344,1775,378"/>
<area shape="poly" title=" " alt="" coords="1475,321,1560,338,1559,343,1474,326"/>
<area shape="poly" title=" " alt="" coords="1776,371,1861,381,1861,386,1775,376"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#abe443fe3f794c14f0aaa0c5f18a27ddd" title=" " alt="" coords="1555,528,1775,562"/>
<area shape="poly" title=" " alt="" coords="1477,532,1539,536,1539,541,1477,538"/>
<area shape="poly" title=" " alt="" coords="1175,232,1243,216,1327,204,1418,202,1463,207,1507,217,1523,224,1533,232,1556,248,1575,255,1573,260,1553,253,1529,236,1520,228,1506,222,1462,212,1417,208,1327,209,1244,221,1176,237"/>
<area shape="poly" title=" " alt="" coords="1141,267,1194,302,1227,319,1262,333,1332,350,1404,360,1474,364,1539,365,1539,370,1474,370,1403,365,1331,355,1261,338,1225,324,1192,307,1138,271"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07" title=" " alt="" coords="1286,123,1482,156"/>
<area shape="poly" title=" " alt="" coords="1146,232,1198,202,1260,173,1300,159,1302,164,1262,178,1200,207,1148,236"/>
<area shape="poly" title=" " alt="" coords="1446,154,1612,203,1610,208,1444,160"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="1600,123,1730,156"/>
<area shape="poly" title=" " alt="" coords="1483,137,1585,137,1585,142,1483,142"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a13ca20f7af9aa4aa3057b1114e23e7f1" title=" " alt="" coords="1270,571,1498,604"/>
<area shape="poly" title=" " alt="" coords="1181,585,1255,585,1255,590,1181,590"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#afe30e87975d460220899f69103f90d0d" title=" " alt="" coords="1276,456,1492,490"/>
<area shape="poly" title=" " alt="" coords="1140,568,1193,533,1260,498,1277,492,1279,497,1262,503,1196,537,1143,573"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="1301,628,1467,662"/>
<area shape="poly" title=" " alt="" coords="1181,598,1288,622,1287,627,1180,604"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a28e87c6264a681dc2a422d32794416c5" title=" " alt="" coords="1280,728,1488,762"/>
<area shape="poly" title=" " alt="" coords="1148,603,1263,672,1341,718,1338,722,1260,676,1145,607"/>
<area shape="poly" title=" " alt="" coords="1481,568,1505,557,1530,538,1553,514,1631,443,1635,447,1557,517,1534,542,1508,562,1483,573"/>
<area shape="poly" title=" " alt="" coords="1484,453,1505,443,1520,430,1528,416,1537,401,1553,387,1561,382,1564,387,1556,391,1541,404,1533,418,1524,433,1508,447,1486,458"/>
<area shape="poly" title=" " alt="" coords="1467,626,1506,614,1564,591,1616,567,1618,571,1566,596,1508,619,1468,631"/>
<area shape="rect" href="../../d3/d91/uloop-epoll_8c.html#ae98d2f54596aacb1f0f176d0e565e2e2" title=" " alt="" coords="1573,613,1757,647"/>
<area shape="poly" title=" " alt="" coords="1468,638,1557,633,1557,638,1468,643"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aabc9ad24aad72332a1e4d9221ee472e4" title=" " alt="" coords="1563,728,1767,762"/>
<area shape="poly" title=" " alt="" coords="1488,742,1547,742,1547,748,1488,748"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a1651f5bc65e4fff991f6df6f997c6821" title=" " alt="" coords="1823,755,2015,788"/>
<area shape="poly" title=" " alt="" coords="1470,760,1555,772,1665,775,1775,772,1807,771,1807,776,1775,777,1665,780,1554,777,1469,765"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#accc698d934ee8aef79f735562f95c5fa" title=" " alt="" coords="1563,837,1767,871"/>
<area shape="poly" title=" " alt="" coords="1424,760,1556,816,1594,829,1593,835,1554,821,1422,765"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a57cfc499a638333604b2ab14b3a11a9b" title=" " alt="" coords="1557,671,1773,704"/>
<area shape="poly" title=" " alt="" coords="1469,725,1563,705,1565,711,1470,730"/>
<area shape="poly" title=" " alt="" coords="1768,753,1808,757,1807,762,1767,758"/>
</map>
</div>

</div>
</div>
<a id="a3360eb012491304d4630403c5dc33ec9" name="a3360eb012491304d4630403c5dc33ec9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3360eb012491304d4630403c5dc33ec9">&#9670;&#160;</a></span>post_poststop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void post_poststop </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l03170">3170</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3171</span>{</div>
<div class="line"><span class="lineno"> 3172</span>    <a class="code hl_function" href="#a61855620d1a0683f786486b1722d7dfa">free_opts</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 3173</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a00f1e87fefda65b43a661aefc6f16566">parent_ctx</a>)</div>
<div class="line"><span class="lineno"> 3174</span>        <a class="code hl_function" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2">ubus_free</a>(<a class="code hl_variable" href="#a00f1e87fefda65b43a661aefc6f16566">parent_ctx</a>);</div>
<div class="line"><span class="lineno"> 3175</span> </div>
<div class="line"><span class="lineno"> 3176</span>    exit(<a class="code hl_variable" href="#a176df615ae45a155128a6cc7ce716db8">jail_return_code</a>);</div>
<div class="line"><span class="lineno"> 3177</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l00254">free_opts()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01086">jail_return_code</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00167">parent_ctx</a>, and <a class="el" href="../../d4/db9/libubus_8c_source.html#l00378">ubus_free()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l03161">poststop()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a3360eb012491304d4630403c5dc33ec9_cgraph.png" border="0" usemap="#add/d26/jail_8c_a3360eb012491304d4630403c5dc33ec9_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a3360eb012491304d4630403c5dc33ec9_cgraph" id="add/d26/jail_8c_a3360eb012491304d4630403c5dc33ec9_cgraph">
<area shape="rect" title=" " alt="" coords="5,344,156,378"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a61855620d1a0683f786486b1722d7dfa" title=" " alt="" coords="207,229,313,263"/>
<area shape="poly" title=" " alt="" coords="107,341,218,269,221,274,110,346"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2" title=" " alt="" coords="204,372,316,406"/>
<area shape="poly" title=" " alt="" coords="157,370,189,375,188,380,156,375"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b" title=" " alt="" coords="392,5,532,39"/>
<area shape="poly" title=" " alt="" coords="263,228,274,191,294,142,323,92,341,68,362,48,377,39,380,43,366,52,345,72,327,95,298,145,279,193,268,230"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a7cdfa1304cca32224a444b6e84fac194" title=" " alt="" coords="394,63,530,96"/>
<area shape="poly" title=" " alt="" coords="267,227,303,168,330,134,362,105,378,96,381,101,366,110,334,138,307,171,272,230"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5127f557f43086299c2bf291618dcef5" title=" " alt="" coords="393,120,531,154"/>
<area shape="poly" title=" " alt="" coords="281,227,318,199,363,170,391,157,393,162,365,175,321,203,284,231"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a766dbc37dd9f160e1a3b8a9f19651b38" title=" " alt="" coords="645,148,792,182"/>
<area shape="poly" title=" " alt="" coords="312,227,363,214,503,189,629,172,630,177,504,194,365,219,314,232"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#abb68ed1aa9f416ea5f299d7672a3b5c1" title=" " alt="" coords="364,229,560,263"/>
<area shape="poly" title=" " alt="" coords="314,244,348,244,348,249,314,249"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5a2acf003db67e7475dcb66937cc12bb" title=" " alt="" coords="400,287,524,320"/>
<area shape="poly" title=" " alt="" coords="314,259,386,279,385,284,313,264"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5064c6dcd09eae061c30cba4146bee18" title=" " alt="" coords="403,344,522,378"/>
<area shape="poly" title=" " alt="" coords="279,262,317,297,365,331,389,341,387,346,363,335,313,301,276,266"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4b6f537dfef57c06536c73d6c7c2ff48" title=" " alt="" coords="399,401,525,435"/>
<area shape="poly" title=" " alt="" coords="271,262,306,324,333,359,366,388,386,399,383,404,362,392,329,362,302,327,266,265"/>
<area shape="poly" title=" " alt="" coords="532,142,630,152,629,158,532,147"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a7390a5f2c227d5ba53e2bd65afda1cfc" title=" " alt="" coords="379,459,546,492"/>
<area shape="poly" title=" " alt="" coords="289,404,324,425,365,445,380,451,378,456,363,450,322,430,286,408"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a58d1b624b96aa768608f45d390cc0d59" title=" " alt="" coords="645,401,792,435"/>
<area shape="poly" title=" " alt="" coords="540,455,629,435,630,440,541,461"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="635,459,802,492"/>
<area shape="poly" title=" " alt="" coords="546,473,620,473,620,478,546,478"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="608,516,829,550"/>
<area shape="poly" title=" " alt="" coords="541,490,626,509,625,515,540,496"/>
<area shape="rect" href="../../d3/d91/uloop-epoll_8c.html#ae98d2f54596aacb1f0f176d0e565e2e2" title=" " alt="" coords="894,401,1079,435"/>
<area shape="poly" title=" " alt="" coords="800,455,889,436,890,441,801,461"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#abe443fe3f794c14f0aaa0c5f18a27ddd" title=" " alt="" coords="877,459,1096,492"/>
<area shape="poly" title=" " alt="" coords="802,473,861,473,861,478,802,478"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="944,516,1029,550"/>
<area shape="poly" title=" " alt="" coords="829,530,928,530,928,536,829,536"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="1144,516,1238,550"/>
<area shape="poly" title=" " alt="" coords="1030,530,1128,530,1128,536,1030,536"/>
</map>
</div>

</div>
</div>
<a id="a292407d99b98bbc178b7760e2107725d" name="a292407d99b98bbc178b7760e2107725d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a292407d99b98bbc178b7760e2107725d">&#9670;&#160;</a></span>post_start_hook()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void post_start_hook </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01256">1256</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1257</span>{</div>
<div class="line"><span class="lineno"> 1258</span>    <span class="keywordtype">int</span> pw_uid, pw_gid, gr_gid;</div>
<div class="line"><span class="lineno"> 1259</span> </div>
<div class="line"><span class="lineno"> 1260</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1261</span><span class="comment">     * make sure setuid/setgid won&#39;t drop capabilities in case capabilities</span></div>
<div class="line"><span class="lineno"> 1262</span><span class="comment">     * have been specified explicitely.</span></div>
<div class="line"><span class="lineno"> 1263</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1264</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.capset.apply) {</div>
<div class="line"><span class="lineno"> 1265</span>        <span class="keywordflow">if</span> (prctl(PR_SET_SECUREBITS, SECBIT_NO_SETUID_FIXUP)) {</div>
<div class="line"><span class="lineno"> 1266</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;prctl(PR_SET_SECUREBITS) failed: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1267</span>            <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1268</span>        }</div>
<div class="line"><span class="lineno"> 1269</span>    }</div>
<div class="line"><span class="lineno"> 1270</span> </div>
<div class="line"><span class="lineno"> 1271</span>    <span class="comment">/* drop capabilities, retain those still needed to further setup jail */</span></div>
<div class="line"><span class="lineno"> 1272</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d61/capabilities_8c.html#a1b699befb42c1321a6088fb948e148ba">applyOCIcapabilities</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.capset, (1LLU &lt;&lt; CAP_SETGID) | (1LLU &lt;&lt; CAP_SETUID) | (1LLU &lt;&lt; CAP_SETPCAP)))</div>
<div class="line"><span class="lineno"> 1273</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1274</span> </div>
<div class="line"><span class="lineno"> 1275</span>    <span class="comment">/* use either cmdline-supplied user/group or uid/gid from OCI spec */</span></div>
<div class="line"><span class="lineno"> 1276</span>    <a class="code hl_function" href="#a6f77c1e493a8d84fc93bec1de3f871de">get_jail_user</a>(&amp;pw_uid, &amp;pw_gid, &amp;gr_gid);</div>
<div class="line"><span class="lineno"> 1277</span>    <a class="code hl_function" href="#aff8b6e0b00af342a873f29ed0161479d">set_jail_user</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.pw_uid?:pw_uid, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.pw_gid?:pw_gid, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.gr_gid?:gr_gid);</div>
<div class="line"><span class="lineno"> 1278</span> </div>
<div class="line"><span class="lineno"> 1279</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.additional_gids &amp;&amp;</div>
<div class="line"><span class="lineno"> 1280</span>        (setgroups(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.num_additional_gids, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.additional_gids) &lt; 0)) {</div>
<div class="line"><span class="lineno"> 1281</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;setgroups failed: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1282</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1283</span>    }</div>
<div class="line"><span class="lineno"> 1284</span> </div>
<div class="line"><span class="lineno"> 1285</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.set_umask)</div>
<div class="line"><span class="lineno"> 1286</span>        umask(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.umask);</div>
<div class="line"><span class="lineno"> 1287</span> </div>
<div class="line"><span class="lineno"> 1288</span>    <span class="comment">/* restore securebits back to normal (and lock them if not in userns) */</span></div>
<div class="line"><span class="lineno"> 1289</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.capset.apply) {</div>
<div class="line"><span class="lineno"> 1290</span>        <span class="keywordflow">if</span> (prctl(PR_SET_SECUREBITS, (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp; CLONE_NEWUSER)?0:</div>
<div class="line"><span class="lineno"> 1291</span>            SECBIT_KEEP_CAPS_LOCKED|SECBIT_NO_SETUID_FIXUP_LOCKED|SECBIT_NOROOT_LOCKED)) {</div>
<div class="line"><span class="lineno"> 1292</span>            <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;prctl(PR_SET_SECUREBITS) failed: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1293</span>            <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1294</span>        }</div>
<div class="line"><span class="lineno"> 1295</span>    }</div>
<div class="line"><span class="lineno"> 1296</span> </div>
<div class="line"><span class="lineno"> 1297</span>    <span class="comment">/* drop remaining capabilities to end up with specified sets */</span></div>
<div class="line"><span class="lineno"> 1298</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d2/d61/capabilities_8c.html#a1b699befb42c1321a6088fb948e148ba">applyOCIcapabilities</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.capset, 0))</div>
<div class="line"><span class="lineno"> 1299</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1300</span> </div>
<div class="line"><span class="lineno"> 1301</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.no_new_privs &amp;&amp; prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {</div>
<div class="line"><span class="lineno"> 1302</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;prctl(PR_SET_NO_NEW_PRIVS) failed: %m\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1303</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1304</span>    }</div>
<div class="line"><span class="lineno"> 1305</span> </div>
<div class="line"><span class="lineno"> 1306</span>    <span class="keywordtype">char</span> **envp = <a class="code hl_function" href="#a6c0f3a1b16c319c90fadb78ad09a5336">build_envp</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.seccomp, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.envp);</div>
<div class="line"><span class="lineno"> 1307</span>    <span class="keywordflow">if</span> (!envp)</div>
<div class="line"><span class="lineno"> 1308</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1309</span> </div>
<div class="line"><span class="lineno"> 1310</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.cwd &amp;&amp; chdir(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.cwd))</div>
<div class="line"><span class="lineno"> 1311</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1312</span> </div>
<div class="line"><span class="lineno"> 1313</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ociseccomp &amp;&amp; <a class="code hl_function" href="../../d8/da1/seccomp-oci_8c.html#a1cd5004c8913a313ee7b35e8bbd27d50">applyOCIlinuxseccomp</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.ociseccomp))</div>
<div class="line"><span class="lineno"> 1314</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1315</span> </div>
<div class="line"><span class="lineno"> 1316</span>    <a class="code hl_function" href="../../dc/d56/uloop_8h.html#a5881608c3589830842d1db287f1f896e">uloop_end</a>();</div>
<div class="line"><span class="lineno"> 1317</span>    <a class="code hl_function" href="#a61855620d1a0683f786486b1722d7dfa">free_opts</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1318</span>    <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#ab56f6599fb46785e4265a3033ba91aa6">INFO</a>(<span class="stringliteral">&quot;exec-ing %s\n&quot;</span>, *<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.jail_argv);</div>
<div class="line"><span class="lineno"> 1319</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.envp) <span class="comment">/* respect PATH if potentially set in ENV */</span></div>
<div class="line"><span class="lineno"> 1320</span>        execvpe(*<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.jail_argv, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.jail_argv, envp);</div>
<div class="line"><span class="lineno"> 1321</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1322</span>        execve(*<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.jail_argv, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.jail_argv, envp);</div>
<div class="line"><span class="lineno"> 1323</span> </div>
<div class="line"><span class="lineno"> 1324</span>    <span class="comment">/* we get there only if execve fails */</span></div>
<div class="line"><span class="lineno"> 1325</span>    <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to execve %s: %m\n&quot;</span>, *<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.jail_argv);</div>
<div class="line"><span class="lineno"> 1326</span>    exit(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1327</span>}</div>
<div class="ttc" id="acapabilities_8c_html_a1b699befb42c1321a6088fb948e148ba"><div class="ttname"><a href="../../d2/d61/capabilities_8c.html#a1b699befb42c1321a6088fb948e148ba">applyOCIcapabilities</a></div><div class="ttdeci">int applyOCIcapabilities(struct jail_capset ocicapset, uint64_t retain)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d61/capabilities_8c_source.html#l00120">capabilities.c:120</a></div></div>
<div class="ttc" id="ajail_8c_html_a6c0f3a1b16c319c90fadb78ad09a5336"><div class="ttname"><a href="#a6c0f3a1b16c319c90fadb78ad09a5336">build_envp</a></div><div class="ttdeci">static char ** build_envp(const char *seccomp, char **ocienvp)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00959">jail.c:959</a></div></div>
<div class="ttc" id="ajail_8c_html_aff8b6e0b00af342a873f29ed0161479d"><div class="ttname"><a href="#aff8b6e0b00af342a873f29ed0161479d">set_jail_user</a></div><div class="ttdeci">static void set_jail_user(int pw_uid, int user_gid, int gr_gid)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00924">jail.c:924</a></div></div>
<div class="ttc" id="aseccomp-oci_8c_html_a1cd5004c8913a313ee7b35e8bbd27d50"><div class="ttname"><a href="../../d8/da1/seccomp-oci_8c.html#a1cd5004c8913a313ee7b35e8bbd27d50">applyOCIlinuxseccomp</a></div><div class="ttdeci">int applyOCIlinuxseccomp(struct sock_fprog *prog)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da1/seccomp-oci_8c_source.html#l00430">seccomp-oci.c:430</a></div></div>
<div class="ttc" id="auloop_8h_html_a5881608c3589830842d1db287f1f896e"><div class="ttname"><a href="../../dc/d56/uloop_8h.html#a5881608c3589830842d1db287f1f896e">uloop_end</a></div><div class="ttdeci">static void uloop_end(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d56/uloop_8h_source.html#l00140">uloop.h:140</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d61/capabilities_8c_source.html#l00120">applyOCIcapabilities()</a>, <a class="el" href="../../d8/da1/seccomp-oci_8c_source.html#l00430">applyOCIlinuxseccomp()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00959">build_envp()</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00774">free_and_exit()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00254">free_opts()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00893">get_jail_user()</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00020">INFO</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00924">set_jail_user()</a>, and <a class="el" href="../../dc/d56/uloop_8h_source.html#l00140">uloop_end()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01239">post_jail_fs()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a292407d99b98bbc178b7760e2107725d_cgraph.png" border="0" usemap="#add/d26/jail_8c_a292407d99b98bbc178b7760e2107725d_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a292407d99b98bbc178b7760e2107725d_cgraph" id="add/d26/jail_8c_a292407d99b98bbc178b7760e2107725d_cgraph">
<area shape="rect" title=" " alt="" coords="5,231,173,264"/>
<area shape="rect" href="../../d2/d61/capabilities_8c.html#a1b699befb42c1321a6088fb948e148ba" title=" " alt="" coords="232,33,443,67"/>
<area shape="poly" title=" " alt="" coords="96,229,114,196,141,155,176,112,219,76,226,72,229,76,222,80,180,116,145,158,119,199,101,232"/>
<area shape="rect" href="../../d8/da1/seccomp-oci_8c.html#a1cd5004c8913a313ee7b35e8bbd27d50" title=" " alt="" coords="221,91,454,124"/>
<area shape="poly" title=" " alt="" coords="103,228,152,181,184,155,219,133,231,128,233,133,222,138,187,159,155,185,107,232"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a6c0f3a1b16c319c90fadb78ad09a5336" title=" " alt="" coords="276,148,399,182"/>
<area shape="poly" title=" " alt="" coords="136,228,220,198,263,184,265,189,222,203,138,233"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a0d1316d1e009899e8b8b735bb6ba70e3" title=" " alt="" coords="502,255,646,288"/>
<area shape="poly" title=" " alt="" coords="173,239,305,235,380,237,454,242,493,248,492,254,454,247,380,242,305,240,173,244"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a61855620d1a0683f786486b1722d7dfa" title=" " alt="" coords="697,399,804,432"/>
<area shape="poly" title=" " alt="" coords="106,263,154,313,186,338,222,358,259,370,310,381,436,396,569,406,682,411,682,416,569,411,435,401,309,386,258,376,220,363,183,343,150,316,102,267"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a6f77c1e493a8d84fc93bec1de3f871de" title=" " alt="" coords="269,257,406,291"/>
<area shape="poly" title=" " alt="" coords="173,254,254,263,253,268,173,259"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#aff8b6e0b00af342a873f29ed0161479d" title=" " alt="" coords="270,315,405,348"/>
<area shape="poly" title=" " alt="" coords="127,262,222,301,256,311,254,316,220,306,125,267"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#a5881608c3589830842d1db287f1f896e" title=" " alt="" coords="279,424,396,458"/>
<area shape="poly" title=" " alt="" coords="102,263,148,331,182,370,222,403,265,423,263,428,219,407,179,373,144,334,98,266"/>
<area shape="rect" href="../../d8/d14/capabilities_8h.html#ae865dd59489e27a32f181825180a296d" title=" " alt="" coords="532,63,616,96"/>
<area shape="poly" title=" " alt="" coords="443,61,517,70,516,75,443,66"/>
<area shape="rect" href="../../d8/d14/capabilities_8h.html#abf7e4e3c4c0bc644ea5e76a5e3326108" title=" " alt="" coords="533,5,615,39"/>
<area shape="poly" title=" " alt="" coords="443,35,517,26,518,31,443,40"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#aefdad32a1f287a539e1d6f6d31301e4e" title=" " alt="" coords="530,148,618,182"/>
<area shape="poly" title=" " alt="" coords="399,162,514,162,514,168,399,168"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b" title=" " alt="" coords="883,241,1023,275"/>
<area shape="poly" title=" " alt="" coords="647,266,867,258,868,264,647,272"/>
<area shape="poly" title=" " alt="" coords="598,287,718,386,715,391,595,291"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2" title=" " alt="" coords="694,187,807,220"/>
<area shape="poly" title=" " alt="" coords="619,252,690,224,692,229,621,257"/>
<area shape="poly" title=" " alt="" coords="759,397,795,341,822,310,853,284,867,276,870,281,856,288,825,314,799,345,763,400"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a7cdfa1304cca32224a444b6e84fac194" title=" " alt="" coords="885,356,1021,390"/>
<area shape="poly" title=" " alt="" coords="804,402,869,388,870,393,805,407"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5127f557f43086299c2bf291618dcef5" title=" " alt="" coords="884,413,1022,447"/>
<area shape="poly" title=" " alt="" coords="804,417,869,421,868,427,804,422"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a766dbc37dd9f160e1a3b8a9f19651b38" title=" " alt="" coords="1136,440,1283,474"/>
<area shape="poly" title=" " alt="" coords="784,430,818,445,855,457,924,467,994,470,1120,465,1120,470,994,475,923,472,854,462,816,450,782,435"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#abb68ed1aa9f416ea5f299d7672a3b5c1" title=" " alt="" coords="855,523,1051,556"/>
<area shape="poly" title=" " alt="" coords="770,431,808,466,856,501,882,514,879,519,853,506,804,470,766,435"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5a2acf003db67e7475dcb66937cc12bb" title=" " alt="" coords="891,580,1015,614"/>
<area shape="poly" title=" " alt="" coords="761,431,795,498,823,535,856,567,877,579,875,583,853,571,819,538,791,500,756,434"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5064c6dcd09eae061c30cba4146bee18" title=" " alt="" coords="893,637,1013,671"/>
<area shape="poly" title=" " alt="" coords="758,432,768,472,787,523,816,578,835,603,856,624,880,638,878,643,853,628,831,606,812,581,782,526,763,473,753,433"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4b6f537dfef57c06536c73d6c7c2ff48" title=" " alt="" coords="890,299,1016,332"/>
<area shape="poly" title=" " alt="" coords="771,396,808,368,853,341,874,333,876,337,856,346,811,373,774,400"/>
<area shape="poly" title=" " alt="" coords="1023,435,1120,445,1120,450,1022,440"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a7390a5f2c227d5ba53e2bd65afda1cfc" title=" " alt="" coords="869,184,1037,218"/>
<area shape="poly" title=" " alt="" coords="807,200,853,199,853,205,807,205"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a58d1b624b96aa768608f45d390cc0d59" title=" " alt="" coords="1136,184,1282,218"/>
<area shape="poly" title=" " alt="" coords="1037,198,1120,198,1120,204,1037,204"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="1126,241,1292,275"/>
<area shape="poly" title=" " alt="" coords="1032,216,1117,235,1115,240,1031,221"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="1099,127,1319,160"/>
<area shape="poly" title=" " alt="" coords="1031,181,1115,162,1117,167,1032,186"/>
<area shape="rect" href="../../d3/d91/uloop-epoll_8c.html#ae98d2f54596aacb1f0f176d0e565e2e2" title=" " alt="" coords="1385,212,1569,246"/>
<area shape="poly" title=" " alt="" coords="1293,246,1369,238,1370,243,1293,252"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#abe443fe3f794c14f0aaa0c5f18a27ddd" title=" " alt="" coords="1367,269,1587,303"/>
<area shape="poly" title=" " alt="" coords="1293,264,1352,270,1351,276,1293,270"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="1434,127,1520,160"/>
<area shape="poly" title=" " alt="" coords="1320,141,1419,141,1419,146,1320,146"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="1635,127,1729,160"/>
<area shape="poly" title=" " alt="" coords="1520,141,1619,141,1619,146,1520,146"/>
<area shape="poly" title=" " alt="" coords="406,271,486,270,486,275,406,276"/>
<area shape="poly" title=" " alt="" coords="404,313,453,301,494,290,496,295,455,306,405,318"/>
</map>
</div>

</div>
</div>
<a id="a75a14e1ea35414c049cd975fb3e3f99c" name="a75a14e1ea35414c049cd975fb3e3f99c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75a14e1ea35414c049cd975fb3e3f99c">&#9670;&#160;</a></span>poststop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void poststop </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l03161">3161</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3161</span>                           {</div>
<div class="line"><span class="lineno"> 3162</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp; CLONE_NEWNET) {</div>
<div class="line"><span class="lineno"> 3163</span>        setns(<a class="code hl_variable" href="#ac256367002c667bedef320ba8eff2aa0">netns_fd</a>, CLONE_NEWNET);</div>
<div class="line"><span class="lineno"> 3164</span>        <a class="code hl_function" href="../../db/d3d/netifd_8c.html#aeada94c74be21275dbafb9a8d9515e90">jail_network_stop</a>();</div>
<div class="line"><span class="lineno"> 3165</span>        close(<a class="code hl_variable" href="#ac256367002c667bedef320ba8eff2aa0">netns_fd</a>);</div>
<div class="line"><span class="lineno"> 3166</span>    }</div>
<div class="line"><span class="lineno"> 3167</span>    <a class="code hl_function" href="#a1756d87ceab7e1c79fe7caf453cb102a">run_hooks</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.poststop, <a class="code hl_function" href="#a3360eb012491304d4630403c5dc33ec9">post_poststop</a>);</div>
<div class="line"><span class="lineno"> 3168</span>}</div>
<div class="ttc" id="ajail_8c_html_a3360eb012491304d4630403c5dc33ec9"><div class="ttname"><a href="#a3360eb012491304d4630403c5dc33ec9">post_poststop</a></div><div class="ttdeci">static void post_poststop(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l03170">jail.c:3170</a></div></div>
<div class="ttc" id="ajail_8c_html_ac256367002c667bedef320ba8eff2aa0"><div class="ttname"><a href="#ac256367002c667bedef320ba8eff2aa0">netns_fd</a></div><div class="ttdeci">static int netns_fd</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02571">jail.c:2571</a></div></div>
<div class="ttc" id="anetifd_8c_html_aeada94c74be21275dbafb9a8d9515e90"><div class="ttname"><a href="../../db/d3d/netifd_8c.html#aeada94c74be21275dbafb9a8d9515e90">jail_network_stop</a></div><div class="ttdeci">int jail_network_stop(void)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d3d/netifd_8c_source.html#l00526">netifd.c:526</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../db/d3d/netifd_8c_source.html#l00526">jail_network_stop()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02571">netns_fd</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l03170">post_poststop()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00512">run_hooks()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01093">jail_process_handler()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l03147">post_poststart()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a75a14e1ea35414c049cd975fb3e3f99c_cgraph.png" border="0" usemap="#add/d26/jail_8c_a75a14e1ea35414c049cd975fb3e3f99c_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a75a14e1ea35414c049cd975fb3e3f99c_cgraph" id="add/d26/jail_8c_a75a14e1ea35414c049cd975fb3e3f99c_cgraph">
<area shape="rect" title=" " alt="" coords="5,565,107,599"/>
<area shape="rect" href="../../db/d3d/netifd_8c.html#aeada94c74be21275dbafb9a8d9515e90" title=" " alt="" coords="155,372,335,406"/>
<area shape="poly" title=" " alt="" coords="72,563,214,415,218,419,76,567"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a3360eb012491304d4630403c5dc33ec9" title=" " alt="" coords="170,565,320,599"/>
<area shape="poly" title=" " alt="" coords="107,580,154,580,154,585,107,585"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a1756d87ceab7e1c79fe7caf453cb102a" title=" " alt="" coords="186,780,304,814"/>
<area shape="poly" title=" " alt="" coords="74,598,221,767,217,770,70,601"/>
<area shape="rect" href="../../db/d3d/netifd_8c.html#aecf17edd05dd1516fd1785ed6cc97d7c" title=" " alt="" coords="383,180,583,214"/>
<area shape="poly" title=" " alt="" coords="266,369,381,275,447,222,450,226,385,279,269,373"/>
<area shape="rect" href="../../db/d3d/netifd_8c.html#a71698b19f7fdbb3ae922ac51f68e9793" title=" " alt="" coords="405,289,561,323"/>
<area shape="poly" title=" " alt="" coords="295,369,417,326,419,331,296,374"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2" title=" " alt="" coords="427,453,539,487"/>
<area shape="poly" title=" " alt="" coords="298,404,418,445,416,450,296,409"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#af8ca2237342df92c699fbb2ddb5f390b" title=" " alt="" coords="935,287,1075,320"/>
<area shape="poly" title=" " alt="" coords="584,188,646,188,716,193,788,202,859,220,884,233,907,249,957,277,955,281,904,254,881,237,857,225,787,208,716,198,646,194,584,194"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a4bba0979961750f86b8dc9915b2fa4d6" title=" " alt="" coords="640,235,849,268"/>
<area shape="poly" title=" " alt="" coords="568,212,646,228,645,233,567,217"/>
<area shape="rect" href="../../db/d55/libubus_8h.html#ad79f9793c3835ea8691fe377025c7de7" title=" " alt="" coords="676,8,813,42"/>
<area shape="poly" title=" " alt="" coords="498,178,553,123,590,92,630,64,668,45,671,50,633,68,593,96,556,127,502,182"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a8567c5497fc066b17da409d9b0512c54" title=" " alt="" coords="663,125,826,159"/>
<area shape="poly" title=" " alt="" coords="567,177,647,160,648,165,568,182"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#af8de35ec0673663c45f2aad7c876d329" title=" " alt="" coords="1220,259,1325,292"/>
<area shape="poly" title=" " alt="" coords="1075,294,1204,280,1204,285,1075,299"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a6f17715cbf1ce82b0981a452537b4dc6" title=" " alt="" coords="1182,316,1362,350"/>
<area shape="poly" title=" " alt="" coords="1075,308,1167,319,1166,324,1075,314"/>
<area shape="rect" href="../../d1/d30/blobmsg_8c.html#a5bf37ab2b48095b7fb16ac11449b08f6" title=" " alt="" coords="908,344,1102,378"/>
<area shape="poly" title=" " alt="" coords="777,267,836,298,907,330,923,336,921,341,905,335,834,303,774,271"/>
<area shape="rect" href="../../d2/de5/libubus-req_8c.html#a572cdb5570d677242d1bc90d2d592852" title=" " alt="" coords="923,5,1087,39"/>
<area shape="poly" title=" " alt="" coords="813,21,907,20,907,26,813,27"/>
<area shape="rect" href="../../d2/de5/libubus-req_8c.html#a42b839aa1a2ef9dd5abdba7c25400b4b" title=" " alt="" coords="1152,89,1392,123"/>
<area shape="poly" title=" " alt="" coords="1069,37,1105,48,1208,81,1206,86,1103,53,1068,42"/>
<area shape="poly" title=" " alt="" coords="828,157,859,176,877,199,884,222,891,244,908,266,924,277,921,282,904,269,886,246,879,223,873,201,856,180,825,162"/>
<area shape="poly" title=" " alt="" coords="818,157,859,176,874,188,883,201,892,212,907,221,960,238,1004,243,1049,237,1103,221,1144,204,1181,181,1242,132,1245,136,1184,185,1146,209,1105,226,1050,242,1004,248,959,244,905,226,888,216,879,204,870,192,856,180,815,162"/>
<area shape="rect" href="../../d8/d3c/blob_8h.html#ac8502f265053dcc41bf8b5ea1fd2dd33" title=" " alt="" coords="923,177,1087,211"/>
<area shape="poly" title=" " alt="" coords="827,156,908,172,907,177,826,161"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#ad9a92a327d8621e1eee7014bac19bc2b" title=" " alt="" coords="908,63,1102,96"/>
<area shape="poly" title=" " alt="" coords="817,122,916,98,918,103,818,127"/>
<area shape="rect" href="../../d2/de5/libubus-req_8c.html#a4cba0d855e6f3ed0fac6a0c6c41c8f49" title=" " alt="" coords="906,120,1104,154"/>
<area shape="poly" title=" " alt="" coords="827,138,890,137,891,142,827,143"/>
<area shape="poly" title=" " alt="" coords="562,303,919,301,919,307,562,308"/>
<area shape="poly" title=" " alt="" coords="561,287,645,269,646,275,562,292"/>
<area shape="poly" title=" " alt="" coords="511,287,547,260,581,225,596,194,601,166,608,138,617,124,630,111,664,99,734,81,909,40,910,45,735,86,665,104,633,115,621,128,613,140,607,167,601,196,586,228,551,264,514,291"/>
<area shape="poly" title=" " alt="" coords="510,287,702,165,704,170,513,291"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a58d1b624b96aa768608f45d390cc0d59" title=" " alt="" coords="932,428,1078,462"/>
<area shape="poly" title=" " alt="" coords="510,321,564,356,632,388,705,409,781,423,917,439,916,444,780,429,704,414,630,393,561,360,507,326"/>
<area shape="rect" href="../../dd/dad/blobmsg_8h.html#a381e9943751280e58fbbdf5f59f3bec2" title=" " alt="" coords="655,344,834,378"/>
<area shape="poly" title=" " alt="" coords="562,320,646,338,645,343,561,325"/>
<area shape="poly" title=" " alt="" coords="834,358,893,358,893,364,834,364"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a7390a5f2c227d5ba53e2bd65afda1cfc" title=" " alt="" coords="661,453,828,487"/>
<area shape="poly" title=" " alt="" coords="540,468,645,468,645,473,540,473"/>
<area shape="poly" title=" " alt="" coords="829,459,916,451,916,456,829,465"/>
<area shape="poly" title=" " alt="" coords="282,562,430,492,433,496,284,567"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a61855620d1a0683f786486b1722d7dfa" title=" " alt="" coords="430,677,536,711"/>
<area shape="poly" title=" " alt="" coords="284,597,433,668,430,673,282,602"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b" title=" " alt="" coords="674,907,815,940"/>
<area shape="poly" title=" " alt="" coords="494,710,513,749,544,798,584,850,607,873,633,893,660,907,658,912,630,898,604,877,580,854,539,801,509,751,490,713"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a7cdfa1304cca32224a444b6e84fac194" title=" " alt="" coords="676,511,813,544"/>
<area shape="poly" title=" " alt="" coords="498,675,552,620,589,588,630,561,661,547,663,552,633,566,593,593,556,623,501,679"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5127f557f43086299c2bf291618dcef5" title=" " alt="" coords="675,620,814,654"/>
<area shape="poly" title=" " alt="" coords="536,680,660,653,661,658,537,685"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a766dbc37dd9f160e1a3b8a9f19651b38" title=" " alt="" coords="931,592,1079,626"/>
<area shape="poly" title=" " alt="" coords="504,675,559,637,594,619,631,605,705,591,780,586,853,587,916,593,916,598,852,593,780,591,705,596,632,610,596,624,561,642,507,679"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#abb68ed1aa9f416ea5f299d7672a3b5c1" title=" " alt="" coords="646,677,843,711"/>
<area shape="poly" title=" " alt="" coords="537,692,631,692,631,697,537,697"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5a2acf003db67e7475dcb66937cc12bb" title=" " alt="" coords="682,735,807,768"/>
<area shape="poly" title=" " alt="" coords="537,703,667,732,666,737,536,708"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5064c6dcd09eae061c30cba4146bee18" title=" " alt="" coords="685,792,804,826"/>
<area shape="poly" title=" " alt="" coords="510,709,565,744,632,778,671,791,669,796,630,783,562,749,507,714"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4b6f537dfef57c06536c73d6c7c2ff48" title=" " alt="" coords="681,849,808,883"/>
<area shape="poly" title=" " alt="" coords="499,710,552,772,590,807,633,836,667,850,665,855,630,841,587,811,549,776,495,713"/>
<area shape="poly" title=" " alt="" coords="814,627,916,616,916,621,814,632"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a88ee3d42d3e892d3b5dd714d89b49505" title=" " alt="" coords="416,1049,550,1083"/>
<area shape="poly" title=" " alt="" coords="263,812,458,1035,454,1039,259,816"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a71525bf218f3fe2889a36b88e7b9964d" title=" " alt="" coords="631,1136,858,1170"/>
<area shape="poly" title=" " alt="" coords="506,1081,556,1105,618,1129,616,1134,553,1110,504,1086"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb" title=" " alt="" coords="646,964,843,998"/>
<area shape="poly" title=" " alt="" coords="524,1046,630,1006,653,1000,654,1005,632,1011,526,1051"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077" title=" " alt="" coords="688,1021,801,1055"/>
<area shape="poly" title=" " alt="" coords="550,1056,672,1043,673,1048,551,1062"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="650,1079,839,1112"/>
<area shape="poly" title=" " alt="" coords="551,1071,634,1080,634,1086,550,1076"/>
<area shape="poly" title=" " alt="" coords="709,1138,631,1115,564,1091,565,1086,632,1110,710,1133"/>
</map>
</div>

</div>
</div>
<a id="a15ffedabb70c5663ccda778a58da4f87" name="a15ffedabb70c5663ccda778a58da4f87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15ffedabb70c5663ccda778a58da4f87">&#9670;&#160;</a></span>pre_exec_jail()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void pre_exec_jail </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a> *</td>          <td class="paramname"><span class="paramname"><em>t</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01228">1228</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1229</span>{</div>
<div class="line"><span class="lineno"> 1230</span>    <span class="keywordflow">if</span> ((<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.namespace &amp; CLONE_NEWNS) &amp;&amp; <a class="code hl_function" href="#a2f273b0b45f3de3b40e828800395c913">build_jail_fs</a>()) {</div>
<div class="line"><span class="lineno"> 1231</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to build jail fs\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1232</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno"> 1233</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1234</span>        <a class="code hl_function" href="#a1756d87ceab7e1c79fe7caf453cb102a">run_hooks</a>(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.hooks.createContainer, <a class="code hl_function" href="#ab88c4a768e1c297fb6b3757942876398">post_jail_fs</a>);</div>
<div class="line"><span class="lineno"> 1235</span>    }</div>
<div class="line"><span class="lineno"> 1236</span>}</div>
<div class="ttc" id="ajail_8c_html_a2f273b0b45f3de3b40e828800395c913"><div class="ttname"><a href="#a2f273b0b45f3de3b40e828800395c913">build_jail_fs</a></div><div class="ttdeci">static int build_jail_fs(void)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00679">jail.c:679</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l00679">build_jail_fs()</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00774">free_and_exit()</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01239">post_jail_fs()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00512">run_hooks()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a15ffedabb70c5663ccda778a58da4f87_cgraph.png" border="0" usemap="#add/d26/jail_8c_a15ffedabb70c5663ccda778a58da4f87_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a15ffedabb70c5663ccda778a58da4f87_cgraph" id="add/d26/jail_8c_a15ffedabb70c5663ccda778a58da4f87_cgraph">
<area shape="rect" title=" " alt="" coords="5,555,143,588"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a2f273b0b45f3de3b40e828800395c913" title=" " alt="" coords="191,301,319,335"/>
<area shape="poly" title=" " alt="" coords="85,553,230,346,235,349,90,556"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a0d1316d1e009899e8b8b735bb6ba70e3" title=" " alt="" coords="1335,689,1480,723"/>
<area shape="poly" title=" " alt="" coords="143,561,388,538,550,527,722,518,894,516,1054,521,1189,536,1244,549,1289,565,1323,587,1352,616,1375,646,1393,674,1388,677,1371,649,1348,619,1319,591,1286,570,1242,554,1188,542,1053,526,894,521,723,524,550,532,388,544,143,567"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#ab88c4a768e1c297fb6b3757942876398" title=" " alt="" coords="642,635,764,668"/>
<area shape="poly" title=" " alt="" coords="113,586,151,601,191,613,309,633,428,644,538,649,627,650,627,656,537,655,428,650,309,638,190,618,149,606,111,591"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a1756d87ceab7e1c79fe7caf453cb102a" title=" " alt="" coords="864,580,981,614"/>
<area shape="poly" title=" " alt="" coords="143,571,848,592,848,597,143,576"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a76506091a3ac45cc3ce7bdf1c3c279c9" title=" " alt="" coords="400,399,534,432"/>
<area shape="poly" title=" " alt="" coords="281,333,321,360,368,385,386,392,384,397,366,390,318,364,278,338"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a08d9992cf8eb531a1783fd80c2af7630" title=" " alt="" coords="367,5,567,39"/>
<area shape="poly" title=" " alt="" coords="257,300,268,255,289,193,321,127,341,95,365,67,397,44,400,48,369,71,345,99,325,129,294,195,273,256,262,301"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a3b82670b51026fbff91952438dd301ac" title=" " alt="" coords="402,341,533,375"/>
<area shape="poly" title=" " alt="" coords="320,328,387,340,386,346,319,333"/>
<area shape="rect" href="../../d0/d2b/libubox_2utils_8c.html#a9fb089901b41392a5ac197f3e18cc3f7" title=" " alt="" coords="874,176,971,210"/>
<area shape="poly" title=" " alt="" coords="319,314,412,308,531,297,661,278,790,249,834,233,875,215,877,220,836,238,791,254,662,283,531,302,413,314,320,319"/>
<area shape="poly" title=" " alt="" coords="269,334,308,388,336,417,368,443,407,462,459,481,590,520,730,554,849,580,848,585,729,559,588,525,457,486,404,467,366,447,333,421,304,391,264,337"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a47cfef0db3b7b8feb6675dd2ee7e4d4e" title=" " alt="" coords="412,177,523,211"/>
<area shape="poly" title=" " alt="" coords="284,299,422,217,425,222,287,303"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#af49948409c11b79dd0b28ce038cdd592" title=" " alt="" coords="388,81,546,115"/>
<area shape="poly" title=" " alt="" coords="264,300,304,236,333,198,365,163,392,140,420,121,423,125,395,145,369,167,337,202,308,239,268,302"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#ab8805304877ae73abf20f1016d21de70" title=" " alt="" coords="1336,107,1479,140"/>
<area shape="poly" title=" " alt="" coords="568,28,791,49,1321,110,1320,115,790,54,568,33"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2" title=" " alt="" coords="1528,281,1640,315"/>
<area shape="poly" title=" " alt="" coords="1428,139,1556,268,1553,272,1424,143"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a7390a5f2c227d5ba53e2bd65afda1cfc" title=" " alt="" coords="1703,281,1870,315"/>
<area shape="poly" title=" " alt="" coords="1640,296,1687,296,1687,301,1640,301"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#af4fee5cb798e92300377ba06fda39a5b" title=" " alt="" coords="624,315,782,348"/>
<area shape="poly" title=" " alt="" coords="533,348,608,339,609,345,534,353"/>
<area shape="poly" title=" " alt="" coords="534,362,707,382,929,416,1040,438,1142,462,1228,490,1289,521,1327,556,1357,596,1381,638,1397,674,1392,676,1376,640,1353,599,1323,559,1286,526,1226,495,1141,468,1039,443,928,421,706,388,533,367"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a607ba83d17934834c11576f3761ac577" title=" " alt="" coords="647,424,759,458"/>
<area shape="poly" title=" " alt="" coords="534,373,568,384,647,415,645,420,566,389,532,378"/>
<area shape="poly" title=" " alt="" coords="535,366,569,384,621,480,689,620,685,622,616,482,565,388,532,371"/>
<area shape="poly" title=" " alt="" coords="751,312,789,293,844,256,889,218,893,222,847,260,792,298,754,317"/>
<area shape="poly" title=" " alt="" coords="883,177,879,167,884,157,899,151,922,149,947,152,961,158,959,163,946,157,922,155,900,157,888,161,884,167,888,175"/>
<area shape="poly" title=" " alt="" coords="1414,688,1567,328,1572,330,1419,690"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b" title=" " alt="" coords="1716,689,1856,723"/>
<area shape="poly" title=" " alt="" coords="1480,704,1701,704,1701,709,1480,709"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a61855620d1a0683f786486b1722d7dfa" title=" " alt="" coords="1531,891,1637,924"/>
<area shape="poly" title=" " alt="" coords="1426,722,1560,877,1556,881,1422,725"/>
<area shape="poly" title=" " alt="" coords="1588,889,1601,856,1621,814,1649,770,1686,732,1700,723,1703,728,1690,736,1654,773,1626,816,1606,858,1593,891"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a7cdfa1304cca32224a444b6e84fac194" title=" " alt="" coords="1718,976,1854,1010"/>
<area shape="poly" title=" " alt="" coords="1613,922,1689,962,1704,968,1702,973,1687,967,1611,927"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5127f557f43086299c2bf291618dcef5" title=" " alt="" coords="1717,1085,1855,1119"/>
<area shape="poly" title=" " alt="" coords="1594,924,1629,991,1656,1030,1690,1064,1708,1076,1705,1080,1686,1068,1652,1034,1624,994,1590,926"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a766dbc37dd9f160e1a3b8a9f19651b38" title=" " alt="" coords="1932,1059,2080,1092"/>
<area shape="poly" title=" " alt="" coords="1597,923,1634,973,1660,999,1689,1020,1730,1034,1787,1047,1917,1065,1917,1070,1787,1052,1728,1039,1687,1025,1656,1003,1630,976,1593,926"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#abb68ed1aa9f416ea5f299d7672a3b5c1" title=" " alt="" coords="1688,747,1884,780"/>
<area shape="poly" title=" " alt="" coords="1594,889,1631,839,1657,812,1687,789,1694,785,1697,789,1689,794,1660,816,1635,843,1598,892"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5a2acf003db67e7475dcb66937cc12bb" title=" " alt="" coords="1724,804,1848,838"/>
<area shape="poly" title=" " alt="" coords="1610,888,1646,867,1687,846,1709,838,1710,843,1689,851,1648,871,1613,893"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5064c6dcd09eae061c30cba4146bee18" title=" " alt="" coords="1727,861,1846,895"/>
<area shape="poly" title=" " alt="" coords="1637,897,1711,886,1712,892,1638,902"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4b6f537dfef57c06536c73d6c7c2ff48" title=" " alt="" coords="1723,919,1849,952"/>
<area shape="poly" title=" " alt="" coords="1638,912,1708,922,1707,927,1637,917"/>
<area shape="poly" title=" " alt="" coords="1855,1091,1917,1084,1918,1089,1856,1096"/>
<area shape="poly" title=" " alt="" coords="765,648,995,650,1141,658,1288,674,1331,683,1330,688,1287,679,1141,664,995,655,765,653"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a292407d99b98bbc178b7760e2107725d" title=" " alt="" coords="839,856,1006,890"/>
<area shape="poly" title=" " alt="" coords="723,667,895,843,892,847,719,671"/>
<area shape="poly" title=" " alt="" coords="764,634,848,613,849,618,765,639"/>
<area shape="poly" title=" " alt="" coords="943,853,991,818,1053,784,1116,762,1168,752,1221,745,1287,733,1322,725,1323,730,1288,738,1221,750,1169,757,1118,767,1055,789,994,822,946,858"/>
<area shape="poly" title=" " alt="" coords="931,889,946,929,971,981,1007,1032,1029,1054,1055,1072,1088,1086,1122,1096,1157,1100,1193,1099,1265,1087,1335,1063,1401,1031,1460,996,1549,932,1552,937,1463,1001,1403,1036,1337,1068,1266,1092,1193,1105,1157,1105,1121,1101,1086,1091,1053,1076,1026,1058,1003,1036,966,984,941,931,926,891"/>
<area shape="rect" href="../../d2/d61/capabilities_8c.html#a1b699befb42c1321a6088fb948e148ba" title=" " alt="" coords="1066,913,1276,947"/>
<area shape="poly" title=" " alt="" coords="999,888,1081,907,1079,912,998,893"/>
<area shape="rect" href="../../d8/da1/seccomp-oci_8c.html#a1cd5004c8913a313ee7b35e8bbd27d50" title=" " alt="" coords="1054,971,1287,1004"/>
<area shape="poly" title=" " alt="" coords="946,888,994,923,1055,957,1070,963,1068,968,1053,962,991,927,943,892"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a6c0f3a1b16c319c90fadb78ad09a5336" title=" " alt="" coords="1110,1028,1232,1062"/>
<area shape="poly" title=" " alt="" coords="936,888,983,951,1017,985,1055,1015,1096,1031,1094,1036,1053,1019,1013,990,979,954,932,892"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a6f77c1e493a8d84fc93bec1de3f871de" title=" " alt="" coords="1103,799,1239,832"/>
<area shape="poly" title=" " alt="" coords="998,853,1087,832,1088,837,999,858"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#aff8b6e0b00af342a873f29ed0161479d" title=" " alt="" coords="1104,856,1238,890"/>
<area shape="poly" title=" " alt="" coords="1006,870,1088,870,1088,876,1006,876"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#a5881608c3589830842d1db287f1f896e" title=" " alt="" coords="1113,689,1229,723"/>
<area shape="poly" title=" " alt="" coords="934,854,982,798,1016,767,1053,740,1097,720,1099,725,1055,744,1019,771,986,802,939,857"/>
<area shape="poly" title=" " alt="" coords="1237,796,1286,777,1329,754,1368,730,1371,734,1332,759,1288,782,1239,801"/>
<area shape="poly" title=" " alt="" coords="1237,862,1263,854,1286,843,1317,819,1345,790,1386,735,1391,738,1349,794,1321,823,1289,847,1265,859,1239,867"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a88ee3d42d3e892d3b5dd714d89b49505" title=" " alt="" coords="1104,580,1238,614"/>
<area shape="poly" title=" " alt="" coords="981,594,1088,594,1088,600,981,600"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a31752c6608fbf56bb359ba109bdc6f6f" title=" " alt="" coords="615,205,791,239"/>
<area shape="poly" title=" " alt="" coords="523,198,600,207,600,213,523,203"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#ab3f280d4a5a86fc2a2c0632a4a271ef8" title=" " alt="" coords="634,148,772,182"/>
<area shape="poly" title=" " alt="" coords="523,185,618,173,619,178,524,190"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a9a6c15b3db1b76232ac5ccf46cca0aef" title=" " alt="" coords="646,91,760,124"/>
<area shape="poly" title=" " alt="" coords="509,174,614,133,631,127,633,132,616,138,511,179"/>
<area shape="poly" title=" " alt="" coords="761,122,792,133,872,167,869,172,790,138,759,127"/>
<area shape="poly" title=" " alt="" coords="525,78,582,66,650,58,722,60,757,65,792,76,825,92,854,115,901,162,897,165,851,119,822,97,790,81,756,71,721,65,650,63,583,71,526,83"/>
</map>
</div>

</div>
</div>
<a id="abbfe748be98e9279f2002f167442f9b2" name="abbfe748be98e9279f2002f167442f9b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbfe748be98e9279f2002f167442f9b2">&#9670;&#160;</a></span>resolve_devtype()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static mode_t resolve_devtype </td>
          <td>(</td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>tstr</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02040">2040</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2041</span>{</div>
<div class="line"><span class="lineno"> 2042</span>    <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;c&quot;</span>, tstr) ||</div>
<div class="line"><span class="lineno"> 2043</span>        !strcmp(<span class="stringliteral">&quot;u&quot;</span>, tstr))</div>
<div class="line"><span class="lineno"> 2044</span>        <span class="keywordflow">return</span> S_IFCHR;</div>
<div class="line"><span class="lineno"> 2045</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;b&quot;</span>, tstr))</div>
<div class="line"><span class="lineno"> 2046</span>        <span class="keywordflow">return</span> S_IFBLK;</div>
<div class="line"><span class="lineno"> 2047</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;p&quot;</span>, tstr))</div>
<div class="line"><span class="lineno"> 2048</span>        <span class="keywordflow">return</span> S_IFIFO;</div>
<div class="line"><span class="lineno"> 2049</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2050</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2051</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02053">parseOCIdevices()</a>.</p>

</div>
</div>
<a id="a259f820c79f4b101ce41e26167ace63f" name="a259f820c79f4b101ce41e26167ace63f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a259f820c79f4b101ce41e26167ace63f">&#9670;&#160;</a></span>resolve_nstype()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int resolve_nstype </td>
          <td>(</td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>type</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01805">1805</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1805</span>                                      {</div>
<div class="line"><span class="lineno"> 1806</span>    <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;pid&quot;</span>, <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>))</div>
<div class="line"><span class="lineno"> 1807</span>        <span class="keywordflow">return</span> CLONE_NEWPID;</div>
<div class="line"><span class="lineno"> 1808</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;network&quot;</span>, <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>))</div>
<div class="line"><span class="lineno"> 1809</span>        <span class="keywordflow">return</span> CLONE_NEWNET;</div>
<div class="line"><span class="lineno"> 1810</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;net&quot;</span>, <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>))</div>
<div class="line"><span class="lineno"> 1811</span>        <span class="keywordflow">return</span> CLONE_NEWNET;</div>
<div class="line"><span class="lineno"> 1812</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;mount&quot;</span>, <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>))</div>
<div class="line"><span class="lineno"> 1813</span>        <span class="keywordflow">return</span> CLONE_NEWNS;</div>
<div class="line"><span class="lineno"> 1814</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;ipc&quot;</span>, <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>))</div>
<div class="line"><span class="lineno"> 1815</span>        <span class="keywordflow">return</span> CLONE_NEWIPC;</div>
<div class="line"><span class="lineno"> 1816</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;uts&quot;</span>, <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>))</div>
<div class="line"><span class="lineno"> 1817</span>        <span class="keywordflow">return</span> CLONE_NEWUTS;</div>
<div class="line"><span class="lineno"> 1818</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;user&quot;</span>, <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>))</div>
<div class="line"><span class="lineno"> 1819</span>        <span class="keywordflow">return</span> CLONE_NEWUSER;</div>
<div class="line"><span class="lineno"> 1820</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;cgroup&quot;</span>, <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>))</div>
<div class="line"><span class="lineno"> 1821</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="#a9d5d88148a26086567c3731e2e5e110a">CLONE_NEWCGROUP</a>;</div>
<div class="line"><span class="lineno"> 1822</span><span class="preprocessor">#ifdef CLONE_NEWTIME</span></div>
<div class="line"><span class="lineno"> 1823</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;time&quot;</span>, <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>))</div>
<div class="line"><span class="lineno"> 1824</span>        <span class="keywordflow">return</span> CLONE_NEWTIME;</div>
<div class="line"><span class="lineno"> 1825</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1826</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1827</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1828</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l00068">CLONE_NEWCGROUP</a>, and <a class="el" href="../../dd/d8f/udebug-proto_8h_source.html#l00000">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01888">jail_join_ns()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l01830">parseOCIlinuxns()</a>.</p>

</div>
</div>
<a id="a403387af16adfc17ce1cb6f14b82afb1" name="a403387af16adfc17ce1cb6f14b82afb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a403387af16adfc17ce1cb6f14b82afb1">&#9670;&#160;</a></span>resolve_rlimit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int resolve_rlimit </td>
          <td>(</td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>type</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01673">1673</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1673</span>                                      {</div>
<div class="line"><span class="lineno"> 1674</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rltype;</div>
<div class="line"><span class="lineno"> 1675</span> </div>
<div class="line"><span class="lineno"> 1676</span>    <span class="keywordflow">for</span> (rltype = 0; rltype &lt; RLIM_NLIMITS; ++rltype)</div>
<div class="line"><span class="lineno"> 1677</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#acd454d571192cedd0f8f512149290772">rlimit_names</a>[rltype] &amp;&amp;</div>
<div class="line"><span class="lineno"> 1678</span>            !strncmp(<span class="stringliteral">&quot;RLIMIT_&quot;</span>, <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, 7) &amp;&amp;</div>
<div class="line"><span class="lineno"> 1679</span>            !strcmp(<a class="code hl_variable" href="#acd454d571192cedd0f8f512149290772">rlimit_names</a>[rltype], <a class="code hl_variable" href="../../dd/d8f/udebug-proto_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a> + 7))</div>
<div class="line"><span class="lineno"> 1680</span>            <span class="keywordflow">return</span> rltype;</div>
<div class="line"><span class="lineno"> 1681</span> </div>
<div class="line"><span class="lineno"> 1682</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1683</span>}</div>
<div class="ttc" id="ajail_8c_html_acd454d571192cedd0f8f512149290772"><div class="ttname"><a href="#acd454d571192cedd0f8f512149290772">rlimit_names</a></div><div class="ttdeci">static const char *const rlimit_names[RLIM_NLIMITS]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01654">jail.c:1654</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l01654">rlimit_names</a>, and <a class="el" href="../../dd/d8f/udebug-proto_8h_source.html#l00000">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01686">parseOCIrlimit()</a>.</p>

</div>
</div>
<a id="a88ee3d42d3e892d3b5dd714d89b49505" name="a88ee3d42d3e892d3b5dd714d89b49505"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88ee3d42d3e892d3b5dd714d89b49505">&#9670;&#160;</a></span>run_hooklist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void run_hooklist </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00467">467</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  468</span>{</div>
<div class="line"><span class="lineno">  469</span>    <span class="keyword">struct </span><a class="code hl_struct" href="#da/d60/structhook__execvpe">hook_execvpe</a> *hook = *<a class="code hl_variable" href="#aa3d0fc71d58968708478752881b119c0">current_hook</a>;</div>
<div class="line"><span class="lineno">  470</span>    <span class="keyword">struct </span>stat s;</div>
<div class="line"><span class="lineno">  471</span> </div>
<div class="line"><span class="lineno">  472</span>    <span class="keywordflow">if</span> (!hook)</div>
<div class="line"><span class="lineno">  473</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="#a3acf3f6a478abce6022fca033743eb37">hook_return_cb</a>();</div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span>    <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;executing hook %s\n&quot;</span>, hook-&gt;<a class="code hl_variable" href="#ac39f04640b0f1f1967ffcd5aa5f158ae">file</a>);</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>    <span class="keywordflow">if</span> (stat(hook-&gt;<a class="code hl_variable" href="#ac39f04640b0f1f1967ffcd5aa5f158ae">file</a>, &amp;s))</div>
<div class="line"><span class="lineno">  478</span>        <a class="code hl_function" href="#a71525bf218f3fe2889a36b88e7b9964d">hook_process_handler</a>(&amp;<a class="code hl_variable" href="#a86b744573f5030d3689a980f0006e23a">hook_process</a>, ENOENT);</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>    <span class="keywordflow">if</span> (!((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)s.st_mode &amp; (S_IXUSR | S_IXGRP | S_IXOTH)))</div>
<div class="line"><span class="lineno">  481</span>        <a class="code hl_function" href="#a71525bf218f3fe2889a36b88e7b9964d">hook_process_handler</a>(&amp;<a class="code hl_variable" href="#a86b744573f5030d3689a980f0006e23a">hook_process</a>, EPERM);</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>    <a class="code hl_variable" href="#a7f85aa468b522508531e8c0bece6552c">hook_running</a> = 1;</div>
<div class="line"><span class="lineno">  484</span>    <a class="code hl_variable" href="#a86b744573f5030d3689a980f0006e23a">hook_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a> = fork();</div>
<div class="line"><span class="lineno">  485</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a86b744573f5030d3689a980f0006e23a">hook_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a> == 0) {</div>
<div class="line"><span class="lineno">  486</span>        <span class="comment">/* child */</span></div>
<div class="line"><span class="lineno">  487</span>        execve(hook-&gt;<a class="code hl_variable" href="#ac39f04640b0f1f1967ffcd5aa5f158ae">file</a>, hook-&gt;<a class="code hl_variable" href="#acff24ad419db504adfdff5c62987cd41">argv</a>, hook-&gt;<a class="code hl_variable" href="#a644aeb00b6756f5c6d4e3fdcc8263405">envp</a>);</div>
<div class="line"><span class="lineno">  488</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;execve error %m\n&quot;</span>);</div>
<div class="line"><span class="lineno">  489</span>        _exit(errno);</div>
<div class="line"><span class="lineno">  490</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a86b744573f5030d3689a980f0006e23a">hook_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a> &lt; 0) {</div>
<div class="line"><span class="lineno">  491</span>        <span class="comment">/* fork error */</span></div>
<div class="line"><span class="lineno">  492</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;hook fork error\n&quot;</span>);</div>
<div class="line"><span class="lineno">  493</span>        <a class="code hl_variable" href="#a7f85aa468b522508531e8c0bece6552c">hook_running</a> = 0;</div>
<div class="line"><span class="lineno">  494</span>        <a class="code hl_function" href="#a71525bf218f3fe2889a36b88e7b9964d">hook_process_handler</a>(&amp;<a class="code hl_variable" href="#a86b744573f5030d3689a980f0006e23a">hook_process</a>, errno);</div>
<div class="line"><span class="lineno">  495</span>    }</div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span>    <span class="comment">/* parent */</span></div>
<div class="line"><span class="lineno">  498</span>    <a class="code hl_function" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb">uloop_process_add</a>(&amp;<a class="code hl_variable" href="#a86b744573f5030d3689a980f0006e23a">hook_process</a>);</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>    <span class="keywordflow">if</span> (hook-&gt;<a class="code hl_variable" href="#a37421f3b655c25324cfed6f8c5f23476">timeout</a> &gt; 0)</div>
<div class="line"><span class="lineno">  501</span>        <a class="code hl_function" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346">uloop_timeout_set</a>(&amp;<a class="code hl_variable" href="#a78ac6aa6bcda14a353a7bbc5d31f7d59">hook_process_timeout</a>, 1000 * hook-&gt;<a class="code hl_variable" href="#a37421f3b655c25324cfed6f8c5f23476">timeout</a>);</div>
<div class="line"><span class="lineno">  502</span> </div>
<div class="line"><span class="lineno">  503</span>    <a class="code hl_function" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077">uloop_run</a>();</div>
<div class="line"><span class="lineno">  504</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a7f85aa468b522508531e8c0bece6552c">hook_running</a>) {</div>
<div class="line"><span class="lineno">  505</span>        <a class="code hl_define" href="../../da/d12/system-dummy_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>(<span class="stringliteral">&quot;uloop interrupted, killing jail process\n&quot;</span>);</div>
<div class="line"><span class="lineno">  506</span>        kill(<a class="code hl_variable" href="#a86b744573f5030d3689a980f0006e23a">hook_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>, SIGTERM);</div>
<div class="line"><span class="lineno">  507</span>        <a class="code hl_function" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346">uloop_timeout_set</a>(&amp;<a class="code hl_variable" href="#a78ac6aa6bcda14a353a7bbc5d31f7d59">hook_process_timeout</a>, 1000);</div>
<div class="line"><span class="lineno">  508</span>        <a class="code hl_function" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077">uloop_run</a>();</div>
<div class="line"><span class="lineno">  509</span>    }</div>
<div class="line"><span class="lineno">  510</span>}</div>
<div class="ttc" id="ajail_8c_html_a37421f3b655c25324cfed6f8c5f23476"><div class="ttname"><a href="#a37421f3b655c25324cfed6f8c5f23476">hook_execvpe::timeout</a></div><div class="ttdeci">int timeout</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00080">jail.c:80</a></div></div>
<div class="ttc" id="ajail_8c_html_a3acf3f6a478abce6022fca033743eb37"><div class="ttname"><a href="#a3acf3f6a478abce6022fca033743eb37">hook_return_cb</a></div><div class="ttdeci">static hook_return_handler hook_return_cb</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00429">jail.c:429</a></div></div>
<div class="ttc" id="ajail_8c_html_a71525bf218f3fe2889a36b88e7b9964d"><div class="ttname"><a href="#a71525bf218f3fe2889a36b88e7b9964d">hook_process_handler</a></div><div class="ttdeci">static void hook_process_handler(struct uloop_process *c, int ret)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00437">jail.c:437</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l00078">hook_execvpe::argv</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00427">current_hook</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00021">DEBUG</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00079">hook_execvpe::envp</a>, <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00077">hook_execvpe::file</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00457">hook_process</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00437">hook_process_handler()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00432">hook_process_timeout</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00429">hook_return_cb</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00425">hook_running</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00087">uloop_process::pid</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00080">hook_execvpe::timeout</a>, <a class="el" href="../../d1/d08/uloop_8c_source.html#l00391">uloop_process_add()</a>, <a class="el" href="../../dc/d56/uloop_8h_source.html#l00147">uloop_run()</a>, and <a class="el" href="../../d1/d08/uloop_8c_source.html#l00328">uloop_timeout_set()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00437">hook_process_handler()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00512">run_hooks()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a88ee3d42d3e892d3b5dd714d89b49505_cgraph.png" border="0" usemap="#add/d26/jail_8c_a88ee3d42d3e892d3b5dd714d89b49505_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a88ee3d42d3e892d3b5dd714d89b49505_cgraph" id="add/d26/jail_8c_a88ee3d42d3e892d3b5dd714d89b49505_cgraph">
<area shape="rect" title=" " alt="" coords="5,421,140,455"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a71525bf218f3fe2889a36b88e7b9964d" title=" " alt="" coords="188,421,414,455"/>
<area shape="poly" title=" " alt="" coords="140,444,172,444,172,450,140,449"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb" title=" " alt="" coords="462,503,658,536"/>
<area shape="poly" title=" " alt="" coords="137,453,188,465,322,488,447,504,446,510,321,493,187,470,136,458"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077" title=" " alt="" coords="244,276,358,310"/>
<area shape="poly" title=" " alt="" coords="95,419,186,355,253,315,256,320,189,359,98,423"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="466,352,655,386"/>
<area shape="poly" title=" " alt="" coords="134,418,187,406,323,386,450,374,450,379,324,392,188,411,135,423"/>
<area shape="poly" title=" " alt="" coords="187,432,156,432,156,427,187,427"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="1000,347,1220,380"/>
<area shape="poly" title=" " alt="" coords="414,451,528,461,663,465,808,459,881,450,951,437,1014,415,1068,386,1070,391,1016,420,952,442,881,456,808,464,663,471,527,466,414,456"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="1309,233,1394,267"/>
<area shape="poly" title=" " alt="" coords="1190,344,1219,333,1271,305,1315,274,1318,279,1273,310,1221,338,1192,349"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="1545,233,1639,267"/>
<area shape="poly" title=" " alt="" coords="1394,248,1529,248,1529,253,1394,253"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="1045,451,1175,484"/>
<area shape="poly" title=" " alt="" coords="659,508,951,481,1029,473,1030,478,952,486,659,513"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="1301,451,1402,484"/>
<area shape="poly" title=" " alt="" coords="1175,465,1285,465,1285,470,1175,470"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a14d4e1fa83f245cd59f0c68f48c90d75" title=" " alt="" coords="464,227,657,260"/>
<area shape="poly" title=" " alt="" coords="357,280,453,261,454,266,358,285"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a18ed130af55f89035ca041f340a091f9" title=" " alt="" coords="708,227,950,260"/>
<area shape="poly" title=" " alt="" coords="657,241,693,241,693,246,657,246"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a5d07b4993342a59a1b6327d23a771d47" title=" " alt="" coords="706,117,952,151"/>
<area shape="poly" title=" " alt="" coords="591,224,643,196,705,168,745,154,747,159,707,173,646,201,593,228"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ab4fcc424426de9a075b7b4b6f390fd2e" title=" " alt="" coords="708,284,950,318"/>
<area shape="poly" title=" " alt="" coords="643,258,733,278,731,283,642,264"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a1d8cdbdb1ea8dad23288f6ec0b2ff005" title=" " alt="" coords="737,60,921,94"/>
<area shape="poly" title=" " alt="" coords="572,225,625,164,663,131,705,103,721,95,723,100,708,107,666,135,629,168,576,228"/>
<area shape="rect" href="../../da/d23/list_8h.html#a6ff0e5eee443d7b27def83827340634d" title=" " alt="" coords="1052,232,1168,266"/>
<area shape="poly" title=" " alt="" coords="950,243,1036,245,1036,250,950,248"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a76f33118cba0a358482528fad8c0f4cd" title=" " alt="" coords="1071,289,1149,323"/>
<area shape="poly" title=" " alt="" coords="908,258,1056,292,1055,297,907,264"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a941864296983cb342a79afe55055f8d3" title=" " alt="" coords="1034,175,1186,208"/>
<area shape="poly" title=" " alt="" coords="923,223,1018,206,1019,211,924,229"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a49ba044023de765e2d9d14db25d1845b" title=" " alt="" coords="1001,117,1219,151"/>
<area shape="poly" title=" " alt="" coords="952,132,985,132,985,137,952,137"/>
<area shape="poly" title=" " alt="" coords="1193,149,1221,160,1274,189,1319,221,1316,226,1271,194,1219,165,1191,154"/>
<area shape="poly" title=" " alt="" coords="908,316,1017,340,1016,345,907,321"/>
<area shape="poly" title=" " alt="" coords="923,281,1036,260,1037,265,924,286"/>
<area shape="poly" title=" " alt="" coords="951,300,1055,302,1055,308,951,306"/>
<area shape="poly" title=" " alt="" coords="928,281,950,271,965,258,973,245,983,231,998,217,1018,207,1020,212,1001,222,987,234,978,248,969,262,953,275,930,286"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#abe443fe3f794c14f0aaa0c5f18a27ddd" title=" " alt="" coords="1482,5,1702,39"/>
<area shape="poly" title=" " alt="" coords="918,57,999,45,1123,34,1249,27,1467,20,1467,26,1249,32,1124,39,1000,50,919,62"/>
<area shape="rect" href="../../d3/d91/uloop-epoll_8c.html#a596fcfcf68883d7c7977ee295adf9625" title=" " alt="" coords="1010,60,1210,94"/>
<area shape="poly" title=" " alt="" coords="922,74,994,74,994,80,922,80"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="1268,60,1434,94"/>
<area shape="poly" title=" " alt="" coords="1210,74,1252,74,1252,80,1210,80"/>
<area shape="poly" title=" " alt="" coords="1428,57,1499,40,1500,46,1429,62"/>
<area shape="rect" href="../../d3/d91/uloop-epoll_8c.html#ae98d2f54596aacb1f0f176d0e565e2e2" title=" " alt="" coords="1500,63,1684,96"/>
<area shape="poly" title=" " alt="" coords="1435,75,1484,76,1484,81,1435,80"/>
<area shape="poly" title=" " alt="" coords="655,365,984,362,984,367,655,371"/>
<area shape="poly" title=" " alt="" coords="578,349,656,271,669,254,677,238,687,224,705,212,743,195,784,183,867,171,947,169,1018,174,1018,179,947,174,867,176,785,189,745,200,708,216,691,228,682,241,673,257,660,275,582,353"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07" title=" " alt="" coords="731,393,927,427"/>
<area shape="poly" title=" " alt="" coords="656,381,716,390,715,395,655,386"/>
<area shape="poly" title=" " alt="" coords="915,425,1030,449,1029,454,914,430"/>
<area shape="poly" title=" " alt="" coords="864,390,926,361,999,332,1055,315,1056,320,1001,337,928,366,866,395"/>
</map>
</div>

</div>
</div>
<a id="a1756d87ceab7e1c79fe7caf453cb102a" name="a1756d87ceab7e1c79fe7caf453cb102a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1756d87ceab7e1c79fe7caf453cb102a">&#9670;&#160;</a></span>run_hooks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void run_hooks </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="#da/d60/structhook__execvpe">hook_execvpe</a> **</td>          <td class="paramname"><span class="paramname"><em>hooklist</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a32654766df20ade7d77949ecf91a601e">hook_return_handler</a></td>          <td class="paramname"><span class="paramname"><em>return_cb</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00512">512</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  513</span>{</div>
<div class="line"><span class="lineno">  514</span>    <span class="keywordflow">if</span> (!hooklist)</div>
<div class="line"><span class="lineno">  515</span>        return_cb();</div>
<div class="line"><span class="lineno">  516</span> </div>
<div class="line"><span class="lineno">  517</span>    <a class="code hl_variable" href="#aa3d0fc71d58968708478752881b119c0">current_hook</a> = hooklist;</div>
<div class="line"><span class="lineno">  518</span>    <a class="code hl_variable" href="#a3acf3f6a478abce6022fca033743eb37">hook_return_cb</a> = return_cb;</div>
<div class="line"><span class="lineno">  519</span> </div>
<div class="line"><span class="lineno">  520</span>    <a class="code hl_function" href="#a88ee3d42d3e892d3b5dd714d89b49505">run_hooklist</a>();</div>
<div class="line"><span class="lineno">  521</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l00427">current_hook</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00429">hook_return_cb</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00467">run_hooklist()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00679">build_jail_fs()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l03132">pipe_send_start_container()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01239">post_jail_fs()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l03161">poststop()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l01228">pre_exec_jail()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_a1756d87ceab7e1c79fe7caf453cb102a_cgraph.png" border="0" usemap="#add/d26/jail_8c_a1756d87ceab7e1c79fe7caf453cb102a_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_a1756d87ceab7e1c79fe7caf453cb102a_cgraph" id="add/d26/jail_8c_a1756d87ceab7e1c79fe7caf453cb102a_cgraph">
<area shape="rect" title=" " alt="" coords="5,421,123,455"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a88ee3d42d3e892d3b5dd714d89b49505" title=" " alt="" coords="171,421,305,455"/>
<area shape="poly" title=" " alt="" coords="123,436,155,436,155,441,123,441"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a71525bf218f3fe2889a36b88e7b9964d" title=" " alt="" coords="353,421,579,455"/>
<area shape="poly" title=" " alt="" coords="306,444,338,444,338,450,306,449"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#af511d1bcbdfcfaba211d4ae1b0930dbb" title=" " alt="" coords="627,503,824,536"/>
<area shape="poly" title=" " alt="" coords="302,453,354,465,487,488,612,504,611,510,487,493,352,470,301,458"/>
<area shape="rect" href="../../dc/d56/uloop_8h.html#aba97081464ac3304fef640bcfc7d3077" title=" " alt="" coords="410,276,523,310"/>
<area shape="poly" title=" " alt="" coords="260,419,352,355,418,315,421,320,354,359,263,423"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="631,352,820,386"/>
<area shape="poly" title=" " alt="" coords="300,418,353,406,489,386,615,374,615,379,489,392,353,411,301,423"/>
<area shape="poly" title=" " alt="" coords="353,432,321,432,321,427,353,427"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="1165,347,1385,380"/>
<area shape="poly" title=" " alt="" coords="580,451,693,461,828,465,973,459,1046,450,1116,437,1179,415,1233,386,1236,391,1181,420,1118,442,1047,456,974,464,828,471,693,466,579,456"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="1474,233,1559,267"/>
<area shape="poly" title=" " alt="" coords="1356,344,1384,333,1436,305,1480,274,1483,279,1439,310,1386,338,1358,349"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="1710,233,1805,267"/>
<area shape="poly" title=" " alt="" coords="1559,248,1695,248,1695,253,1559,253"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="1211,451,1340,484"/>
<area shape="poly" title=" " alt="" coords="824,508,1117,481,1195,473,1195,478,1117,486,825,513"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="1466,451,1567,484"/>
<area shape="poly" title=" " alt="" coords="1340,465,1450,465,1450,470,1340,470"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a14d4e1fa83f245cd59f0c68f48c90d75" title=" " alt="" coords="629,227,822,260"/>
<area shape="poly" title=" " alt="" coords="523,280,618,261,619,266,524,285"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a18ed130af55f89035ca041f340a091f9" title=" " alt="" coords="874,227,1115,260"/>
<area shape="poly" title=" " alt="" coords="823,241,858,241,858,246,823,246"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a5d07b4993342a59a1b6327d23a771d47" title=" " alt="" coords="872,117,1117,151"/>
<area shape="poly" title=" " alt="" coords="756,224,809,196,871,168,911,154,913,159,873,173,811,201,758,228"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ab4fcc424426de9a075b7b4b6f390fd2e" title=" " alt="" coords="873,284,1116,318"/>
<area shape="poly" title=" " alt="" coords="808,258,898,278,897,283,807,264"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a1d8cdbdb1ea8dad23288f6ec0b2ff005" title=" " alt="" coords="902,60,1087,94"/>
<area shape="poly" title=" " alt="" coords="738,225,791,164,828,131,870,103,887,95,889,100,873,107,831,135,794,168,742,228"/>
<area shape="rect" href="../../da/d23/list_8h.html#a6ff0e5eee443d7b27def83827340634d" title=" " alt="" coords="1217,232,1333,266"/>
<area shape="poly" title=" " alt="" coords="1116,243,1201,245,1201,250,1116,248"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a76f33118cba0a358482528fad8c0f4cd" title=" " alt="" coords="1236,289,1314,323"/>
<area shape="poly" title=" " alt="" coords="1074,258,1222,292,1220,297,1073,264"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a941864296983cb342a79afe55055f8d3" title=" " alt="" coords="1199,175,1351,208"/>
<area shape="poly" title=" " alt="" coords="1089,223,1183,206,1184,211,1090,229"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a49ba044023de765e2d9d14db25d1845b" title=" " alt="" coords="1166,117,1384,151"/>
<area shape="poly" title=" " alt="" coords="1117,132,1151,132,1151,137,1117,137"/>
<area shape="poly" title=" " alt="" coords="1358,149,1386,160,1439,189,1484,221,1481,226,1437,194,1384,165,1356,154"/>
<area shape="poly" title=" " alt="" coords="1074,316,1182,340,1181,345,1073,321"/>
<area shape="poly" title=" " alt="" coords="1089,281,1201,260,1202,265,1090,286"/>
<area shape="poly" title=" " alt="" coords="1116,300,1221,302,1221,308,1116,306"/>
<area shape="poly" title=" " alt="" coords="1093,281,1116,271,1130,258,1139,245,1148,231,1164,217,1183,207,1186,212,1166,222,1152,234,1143,248,1134,262,1118,275,1096,286"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#abe443fe3f794c14f0aaa0c5f18a27ddd" title=" " alt="" coords="1648,5,1867,39"/>
<area shape="poly" title=" " alt="" coords="1083,57,1165,45,1289,34,1414,27,1632,20,1632,26,1414,32,1289,39,1165,50,1084,62"/>
<area shape="rect" href="../../d3/d91/uloop-epoll_8c.html#a596fcfcf68883d7c7977ee295adf9625" title=" " alt="" coords="1176,60,1375,94"/>
<area shape="poly" title=" " alt="" coords="1087,74,1160,74,1160,80,1087,80"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="1433,60,1600,94"/>
<area shape="poly" title=" " alt="" coords="1375,74,1418,74,1418,80,1375,80"/>
<area shape="poly" title=" " alt="" coords="1593,57,1665,40,1666,46,1594,62"/>
<area shape="rect" href="../../d3/d91/uloop-epoll_8c.html#ae98d2f54596aacb1f0f176d0e565e2e2" title=" " alt="" coords="1665,63,1850,96"/>
<area shape="poly" title=" " alt="" coords="1600,75,1650,76,1650,81,1600,80"/>
<area shape="poly" title=" " alt="" coords="820,365,1150,362,1150,367,820,371"/>
<area shape="poly" title=" " alt="" coords="744,349,822,271,834,254,843,238,853,224,870,212,909,195,949,183,1032,171,1113,169,1184,174,1183,179,1113,174,1033,176,950,189,911,200,873,216,857,228,847,241,839,257,826,275,748,353"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07" title=" " alt="" coords="896,393,1093,427"/>
<area shape="poly" title=" " alt="" coords="821,381,881,390,880,395,820,386"/>
<area shape="poly" title=" " alt="" coords="1081,425,1196,449,1195,454,1080,430"/>
<area shape="poly" title=" " alt="" coords="1029,390,1091,361,1164,332,1220,315,1222,320,1166,337,1093,366,1031,395"/>
</map>
</div>

</div>
</div>
<a id="aff8b6e0b00af342a873f29ed0161479d" name="aff8b6e0b00af342a873f29ed0161479d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff8b6e0b00af342a873f29ed0161479d">&#9670;&#160;</a></span>set_jail_user()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_jail_user </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>pw_uid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>user_gid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>gr_gid</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00924">924</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  925</span>{</div>
<div class="line"><span class="lineno">  926</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.user &amp;&amp; (user_gid != -1) &amp;&amp; initgroups(<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.user, user_gid)) {</div>
<div class="line"><span class="lineno">  927</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to initgroups() for user %s: %m\n&quot;</span>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.user);</div>
<div class="line"><span class="lineno">  928</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno">  929</span>    }</div>
<div class="line"><span class="lineno">  930</span> </div>
<div class="line"><span class="lineno">  931</span>    <span class="keywordflow">if</span> ((gr_gid != -1) &amp;&amp; setregid(gr_gid, gr_gid)) {</div>
<div class="line"><span class="lineno">  932</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to set group id %d: %m\n&quot;</span>, gr_gid);</div>
<div class="line"><span class="lineno">  933</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno">  934</span>    }</div>
<div class="line"><span class="lineno">  935</span> </div>
<div class="line"><span class="lineno">  936</span>    <span class="keywordflow">if</span> ((pw_uid != -1) &amp;&amp; setreuid(pw_uid, pw_uid)) {</div>
<div class="line"><span class="lineno">  937</span>        <a class="code hl_define" href="../../d8/d30/procd_2jail_2log_8h.html#a15378cd15bafb3a79061424b452497aa">ERROR</a>(<span class="stringliteral">&quot;failed to set user id %d: %m\n&quot;</span>, pw_uid);</div>
<div class="line"><span class="lineno">  938</span>        <a class="code hl_function" href="#a0d1316d1e009899e8b8b735bb6ba70e3">free_and_exit</a>(EXIT_FAILURE);</div>
<div class="line"><span class="lineno">  939</span>    }</div>
<div class="line"><span class="lineno">  940</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d30/procd_2jail_2log_8h_source.html#l00027">ERROR</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00774">free_and_exit()</a>, and <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01256">post_start_hook()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_aff8b6e0b00af342a873f29ed0161479d_cgraph.png" border="0" usemap="#add/d26/jail_8c_aff8b6e0b00af342a873f29ed0161479d_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_aff8b6e0b00af342a873f29ed0161479d_cgraph" id="add/d26/jail_8c_aff8b6e0b00af342a873f29ed0161479d_cgraph">
<area shape="rect" title=" " alt="" coords="5,203,140,236"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a0d1316d1e009899e8b8b735bb6ba70e3" title=" " alt="" coords="188,203,332,236"/>
<area shape="poly" title=" " alt="" coords="140,217,172,217,172,222,140,222"/>
<area shape="rect" href="../../db/d40/cgroups_8c.html#aee024037da9b0bf2d6313b0618a9337b" title=" " alt="" coords="568,5,709,39"/>
<area shape="poly" title=" " alt="" coords="284,200,391,128,463,85,539,48,553,42,555,47,541,53,466,90,394,132,286,204"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a61855620d1a0683f786486b1722d7dfa" title=" " alt="" coords="383,203,489,236"/>
<area shape="poly" title=" " alt="" coords="332,217,367,217,367,222,332,222"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a71987f233caf53482181b6eb504d46f2" title=" " alt="" coords="380,345,492,379"/>
<area shape="poly" title=" " alt="" coords="284,235,404,333,401,338,281,239"/>
<area shape="poly" title=" " alt="" coords="441,201,454,169,474,127,502,85,539,48,553,39,555,44,542,52,506,88,479,130,458,171,446,203"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a7cdfa1304cca32224a444b6e84fac194" title=" " alt="" coords="570,63,707,96"/>
<area shape="poly" title=" " alt="" coords="447,201,484,153,510,127,539,105,555,97,557,102,542,110,513,131,488,157,451,204"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5127f557f43086299c2bf291618dcef5" title=" " alt="" coords="569,120,708,154"/>
<area shape="poly" title=" " alt="" coords="473,200,539,170,573,157,575,162,541,175,475,204"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a766dbc37dd9f160e1a3b8a9f19651b38" title=" " alt="" coords="821,148,969,182"/>
<area shape="poly" title=" " alt="" coords="489,211,805,173,806,178,490,216"/>
<area shape="rect" href="../../d2/da6/elf_8c.html#abb68ed1aa9f416ea5f299d7672a3b5c1" title=" " alt="" coords="540,229,737,263"/>
<area shape="poly" title=" " alt="" coords="490,224,525,229,525,234,490,229"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5a2acf003db67e7475dcb66937cc12bb" title=" " alt="" coords="576,287,701,320"/>
<area shape="poly" title=" " alt="" coords="467,235,541,273,563,281,561,286,539,278,464,239"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a5064c6dcd09eae061c30cba4146bee18" title=" " alt="" coords="579,344,698,378"/>
<area shape="poly" title=" " alt="" coords="451,235,488,283,513,309,542,331,566,342,563,347,539,335,509,313,484,286,446,238"/>
<area shape="rect" href="../../d2/d5a/fs_8c.html#a4b6f537dfef57c06536c73d6c7c2ff48" title=" " alt="" coords="575,401,702,435"/>
<area shape="poly" title=" " alt="" coords="448,236,492,319,519,361,542,388,562,400,559,404,539,392,515,364,488,322,444,238"/>
<area shape="poly" title=" " alt="" coords="708,142,806,152,805,158,708,147"/>
<area shape="rect" href="../../d4/db9/libubus_8c.html#a7390a5f2c227d5ba53e2bd65afda1cfc" title=" " alt="" coords="555,459,722,492"/>
<area shape="poly" title=" " alt="" coords="456,377,493,412,542,445,552,450,549,455,539,450,490,416,452,381"/>
<area shape="rect" href="../../d4/da0/blob_8c.html#a58d1b624b96aa768608f45d390cc0d59" title=" " alt="" coords="822,401,968,435"/>
<area shape="poly" title=" " alt="" coords="716,455,806,435,807,440,718,461"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a73e0613a3dcdc677611d2fd6efdcca9c" title=" " alt="" coords="812,459,978,492"/>
<area shape="poly" title=" " alt="" coords="723,473,796,473,796,478,723,478"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="785,516,1005,550"/>
<area shape="poly" title=" " alt="" coords="718,490,802,509,801,515,716,496"/>
<area shape="rect" href="../../d3/d91/uloop-epoll_8c.html#ae98d2f54596aacb1f0f176d0e565e2e2" title=" " alt="" coords="1071,401,1255,435"/>
<area shape="poly" title=" " alt="" coords="976,455,1065,436,1066,441,977,461"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#abe443fe3f794c14f0aaa0c5f18a27ddd" title=" " alt="" coords="1053,459,1272,492"/>
<area shape="poly" title=" " alt="" coords="979,473,1037,473,1037,478,979,478"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="1120,516,1205,550"/>
<area shape="poly" title=" " alt="" coords="1006,530,1104,530,1104,536,1006,536"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="1320,516,1415,550"/>
<area shape="poly" title=" " alt="" coords="1206,530,1305,530,1305,536,1206,536"/>
</map>
</div>

</div>
</div>
<a id="ab22dc7688d950fcf927c8cbcfcdb15cd" name="ab22dc7688d950fcf927c8cbcfcdb15cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab22dc7688d950fcf927c8cbcfcdb15cd">&#9670;&#160;</a></span>set_oom_score_adj()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int set_oom_score_adj </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02392">2392</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2393</span>{</div>
<div class="line"><span class="lineno"> 2394</span>    <span class="keywordtype">int</span> f;</div>
<div class="line"><span class="lineno"> 2395</span>    <span class="keywordtype">char</span> fname[32];</div>
<div class="line"><span class="lineno"> 2396</span> </div>
<div class="line"><span class="lineno"> 2397</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.set_oom_score_adj)</div>
<div class="line"><span class="lineno"> 2398</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2399</span> </div>
<div class="line"><span class="lineno"> 2400</span>    snprintf(fname, <span class="keyword">sizeof</span>(fname), <span class="stringliteral">&quot;/proc/%u/oom_score_adj&quot;</span>, <a class="code hl_variable" href="#a02d170ed9179a61ee4049ed3ec9eadf1">jail_process</a>.<a class="code hl_variable" href="../../dc/d56/uloop_8h.html#a41e26562918b24966ac2e0d7906fb1b8">pid</a>);</div>
<div class="line"><span class="lineno"> 2401</span>    f = open(fname, O_WRONLY | O_TRUNC);</div>
<div class="line"><span class="lineno"> 2402</span>    <span class="keywordflow">if</span> (f &lt; 0)</div>
<div class="line"><span class="lineno"> 2403</span>        <span class="keywordflow">return</span> errno;</div>
<div class="line"><span class="lineno"> 2404</span> </div>
<div class="line"><span class="lineno"> 2405</span>    dprintf(f, <span class="stringliteral">&quot;%d&quot;</span>, <a class="code hl_variable" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>.oom_score_adj);</div>
<div class="line"><span class="lineno"> 2406</span>    close(f);</div>
<div class="line"><span class="lineno"> 2407</span> </div>
<div class="line"><span class="lineno"> 2408</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2409</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l01107">jail_process</a>, <a class="el" href="#ab6fdb9300031a4ac782a6a3a7ec742cd">opts</a>, and <a class="el" href="../../dc/d56/uloop_8h_source.html#l00087">uloop_process::pid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>.</p>

</div>
</div>
<a id="ad16db5f10de76210ae8d78de47da352e" name="ad16db5f10de76210ae8d78de47da352e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad16db5f10de76210ae8d78de47da352e">&#9670;&#160;</a></span>setns_open()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int setns_open </td>
          <td>(</td>
          <td class="paramtype">unsigned long</td>          <td class="paramname"><span class="paramname"><em>nstype</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01067">1067</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1068</span>{</div>
<div class="line"><span class="lineno"> 1069</span>    <span class="keywordtype">int</span> *fd = <a class="code hl_function" href="#a3aa34193a0ba95da6ede6aa8e16d726f">get_namespace_fd</a>(nstype);</div>
<div class="line"><span class="lineno"> 1070</span> </div>
<div class="line"><span class="lineno"> 1071</span>    assert(fd != NULL);</div>
<div class="line"><span class="lineno"> 1072</span> </div>
<div class="line"><span class="lineno"> 1073</span>    <span class="keywordflow">if</span> (*fd &lt; 0)</div>
<div class="line"><span class="lineno"> 1074</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1075</span> </div>
<div class="line"><span class="lineno"> 1076</span>    <span class="keywordflow">if</span> (setns(*fd, nstype) == -1) {</div>
<div class="line"><span class="lineno"> 1077</span>        close(*fd);</div>
<div class="line"><span class="lineno"> 1078</span>        <span class="keywordflow">return</span> errno;</div>
<div class="line"><span class="lineno"> 1079</span>    }</div>
<div class="line"><span class="lineno"> 1080</span> </div>
<div class="line"><span class="lineno"> 1081</span>    close(*fd);</div>
<div class="line"><span class="lineno"> 1082</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1083</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l01041">get_namespace_fd()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01161">exec_jail()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_ad16db5f10de76210ae8d78de47da352e_cgraph.png" border="0" usemap="#add/d26/jail_8c_ad16db5f10de76210ae8d78de47da352e_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_ad16db5f10de76210ae8d78de47da352e_cgraph" id="add/d26/jail_8c_ad16db5f10de76210ae8d78de47da352e_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,132,39"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a3aa34193a0ba95da6ede6aa8e16d726f" title=" " alt="" coords="180,5,374,39"/>
<area shape="poly" title=" " alt="" coords="132,20,164,20,164,25,132,25"/>
</map>
</div>

</div>
</div>
<a id="ab97dc72992426f87762ca05057c651b3" name="ab97dc72992426f87762ca05057c651b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab97dc72992426f87762ca05057c651b3">&#9670;&#160;</a></span>signals_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void signals_init </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01136">1136</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1137</span>{</div>
<div class="line"><span class="lineno"> 1138</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 1139</span>    sigset_t sigmask;</div>
<div class="line"><span class="lineno"> 1140</span> </div>
<div class="line"><span class="lineno"> 1141</span>    sigfillset(&amp;sigmask);</div>
<div class="line"><span class="lineno"> 1142</span>    <span class="keywordflow">for</span> (i = 0; i &lt; _NSIG; i++) {</div>
<div class="line"><span class="lineno"> 1143</span>        <span class="keyword">struct </span>sigaction s = { 0 };</div>
<div class="line"><span class="lineno"> 1144</span> </div>
<div class="line"><span class="lineno"> 1145</span>        <span class="keywordflow">if</span> (!sigismember(&amp;sigmask, i))</div>
<div class="line"><span class="lineno"> 1146</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1147</span>        <span class="keywordflow">if</span> ((i == SIGCHLD) || (i == SIGPIPE) || (i == SIGSEGV) || (i == SIGSTOP) || (i == SIGKILL))</div>
<div class="line"><span class="lineno"> 1148</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1149</span> </div>
<div class="line"><span class="lineno"> 1150</span>        s.sa_handler = <a class="code hl_function" href="#a4d20901cfe9adbe227505e368612346d">jail_handle_signal</a>;</div>
<div class="line"><span class="lineno"> 1151</span>        sigaction(i, &amp;s, NULL);</div>
<div class="line"><span class="lineno"> 1152</span>    }</div>
<div class="line"><span class="lineno"> 1153</span>}</div>
<div class="ttc" id="ajail_8c_html_a4d20901cfe9adbe227505e368612346d"><div class="ttname"><a href="#a4d20901cfe9adbe227505e368612346d">jail_handle_signal</a></div><div class="ttdeci">static void jail_handle_signal(int signo)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01117">jail.c:1117</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d26/jail_8c_source.html#l01117">jail_handle_signal()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01161">exec_jail()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l02583">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d26/jail_8c_ab97dc72992426f87762ca05057c651b3_cgraph.png" border="0" usemap="#add/d26/jail_8c_ab97dc72992426f87762ca05057c651b3_cgraph" alt=""/></div>
<map name="add/d26/jail_8c_ab97dc72992426f87762ca05057c651b3_cgraph" id="add/d26/jail_8c_ab97dc72992426f87762ca05057c651b3_cgraph">
<area shape="rect" title=" " alt="" coords="5,63,130,96"/>
<area shape="rect" href="../../dd/d26/jail_8c.html#a4d20901cfe9adbe227505e368612346d" title=" " alt="" coords="178,63,361,96"/>
<area shape="poly" title=" " alt="" coords="130,77,162,77,162,82,130,82"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#aeae1856255dccd537fd19cdda1cba346" title=" " alt="" coords="409,63,598,96"/>
<area shape="poly" title=" " alt="" coords="362,77,394,77,394,82,362,82"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a941864296983cb342a79afe55055f8d3" title=" " alt="" coords="680,5,833,39"/>
<area shape="poly" title=" " alt="" coords="580,59,665,40,666,45,582,65"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#ae60859ac8015e8f1381e56f5eaae0a07" title=" " alt="" coords="658,63,855,96"/>
<area shape="poly" title=" " alt="" coords="599,77,643,77,643,82,599,82"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a6231184d2f54ac1bc945ecb73c517d91" title=" " alt="" coords="646,120,867,154"/>
<area shape="poly" title=" " alt="" coords="582,94,665,113,664,119,580,100"/>
<area shape="rect" href="../../da/d23/list_8h.html#a5f3c4582c49b990c9fb4f5c83f8400d1" title=" " alt="" coords="915,5,1044,39"/>
<area shape="poly" title=" " alt="" coords="825,60,866,49,899,40,901,45,867,54,826,65"/>
<area shape="rect" href="../../d1/d08/uloop_8c.html#a76f33118cba0a358482528fad8c0f4cd" title=" " alt="" coords="940,63,1019,96"/>
<area shape="poly" title=" " alt="" coords="855,77,925,77,925,82,855,82"/>
<area shape="rect" href="../../da/d23/list_8h.html#a9d61a1a731a0cf44336e2ee9e45f712d" title=" " alt="" coords="1092,5,1193,39"/>
<area shape="poly" title=" " alt="" coords="1045,20,1076,20,1076,25,1045,25"/>
<area shape="rect" href="../../da/d23/list_8h.html#ab1708206f0f7e0a56550b35372203ba5" title=" " alt="" coords="937,120,1022,154"/>
<area shape="poly" title=" " alt="" coords="867,134,921,134,921,140,867,140"/>
<area shape="rect" href="../../da/d23/list_8h.html#ae0988579c6b622299ee0f79accbf0779" title=" " alt="" coords="1096,120,1190,154"/>
<area shape="poly" title=" " alt="" coords="1022,134,1080,134,1080,140,1022,140"/>
</map>
</div>

</div>
</div>
<a id="ad96d407a911fbb914fa8e4cfbf2faf0f" name="ad96d407a911fbb914fa8e4cfbf2faf0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad96d407a911fbb914fa8e4cfbf2faf0f">&#9670;&#160;</a></span>usage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void usage </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01001">1001</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1002</span>{</div>
<div class="line"><span class="lineno"> 1003</span>    fprintf(stderr, <span class="stringliteral">&quot;ujail &lt;options&gt; -- &lt;binary&gt; &lt;params ...&gt;\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1004</span>    fprintf(stderr, <span class="stringliteral">&quot;  -d &lt;num&gt;\tshow debug log (increase num to increase verbosity)\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1005</span>    fprintf(stderr, <span class="stringliteral">&quot;  -S &lt;file&gt;\tseccomp filter config\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1006</span>    fprintf(stderr, <span class="stringliteral">&quot;  -C &lt;file&gt;\tcapabilities drop config\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1007</span>    fprintf(stderr, <span class="stringliteral">&quot;  -c\t\tset PR_SET_NO_NEW_PRIVS\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1008</span>    fprintf(stderr, <span class="stringliteral">&quot;  -n &lt;name&gt;\tthe name of the jail\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1009</span>    fprintf(stderr, <span class="stringliteral">&quot;  -e &lt;var&gt;\timport environment variable\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1010</span>    fprintf(stderr, <span class="stringliteral">&quot;namespace jail options:\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1011</span>    fprintf(stderr, <span class="stringliteral">&quot;  -h &lt;hostname&gt;\tchange the hostname of the jail\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1012</span>    fprintf(stderr, <span class="stringliteral">&quot;  -N\t\tjail has network namespace\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1013</span>    fprintf(stderr, <span class="stringliteral">&quot;  -f\t\tjail has user namespace\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1014</span>    fprintf(stderr, <span class="stringliteral">&quot;  -F\t\tjail has cgroups namespace\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1015</span>    fprintf(stderr, <span class="stringliteral">&quot;  -r &lt;file&gt;\treadonly files that should be staged\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1016</span>    fprintf(stderr, <span class="stringliteral">&quot;  -w &lt;file&gt;\twriteable files that should be staged\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1017</span>    fprintf(stderr, <span class="stringliteral">&quot;  -p\t\tjail has /proc\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1018</span>    fprintf(stderr, <span class="stringliteral">&quot;  -s\t\tjail has /sys\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1019</span>    fprintf(stderr, <span class="stringliteral">&quot;  -l\t\tjail has /dev/log\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1020</span>    fprintf(stderr, <span class="stringliteral">&quot;  -u\t\tjail has a ubus socket\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1021</span>    fprintf(stderr, <span class="stringliteral">&quot;  -U &lt;name&gt;\tuser to run jailed process\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1022</span>    fprintf(stderr, <span class="stringliteral">&quot;  -G &lt;name&gt;\tgroup to run jailed process\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1023</span>    fprintf(stderr, <span class="stringliteral">&quot;  -o\t\tremont jail root (/) read only\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1024</span>    fprintf(stderr, <span class="stringliteral">&quot;  -R &lt;dir&gt;\texternal jail rootfs (system container)\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1025</span>    fprintf(stderr, <span class="stringliteral">&quot;  -O &lt;dir&gt;\tdirectory for r/w overlayfs\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1026</span>    fprintf(stderr, <span class="stringliteral">&quot;  -T &lt;size&gt;\tuse tmpfs r/w overlayfs with &lt;size&gt;\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1027</span>    fprintf(stderr, <span class="stringliteral">&quot;  -E\t\tfail if jail cannot be setup\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1028</span>    fprintf(stderr, <span class="stringliteral">&quot;  -y\t\tprovide jail console\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1029</span>    fprintf(stderr, <span class="stringliteral">&quot;  -J &lt;dir&gt;\tcreate container from OCI bundle\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1030</span>    fprintf(stderr, <span class="stringliteral">&quot;  -i\t\tstart container immediately\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1031</span>    fprintf(stderr, <span class="stringliteral">&quot;  -P &lt;pidfile&gt;\tcreate &lt;pidfile&gt;\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1032</span>    fprintf(stderr, <span class="stringliteral">&quot;\nWarning: by default root inside the jail is the same\n\</span></div>
<div class="line"><span class="lineno"> 1033</span><span class="stringliteral">and he has the same powers as root outside the jail,\n\</span></div>
<div class="line"><span class="lineno"> 1034</span><span class="stringliteral">thus he can escape the jail and/or break stuff.\n\</span></div>
<div class="line"><span class="lineno"> 1035</span><span class="stringliteral">Please use seccomp/capabilities (-S/-C) to restrict his powers\n\n\</span></div>
<div class="line"><span class="lineno"> 1036</span><span class="stringliteral">If you use none of the namespace jail options,\n\</span></div>
<div class="line"><span class="lineno"> 1037</span><span class="stringliteral">ujail will not use namespace/build a jail,\n\</span></div>
<div class="line"><span class="lineno"> 1038</span><span class="stringliteral">and will only drop capabilities/apply seccomp filter.\n\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1039</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d6/d5e/ustream-example_8c_source.html#l00133">main()</a>, and <a class="el" href="../../df/d02/json__script-example_8c_source.html#l00050">main()</a>.</p>

</div>
</div>
<a id="a5e111fe85d16008f130c765e511d670c" name="a5e111fe85d16008f130c765e511d670c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e111fe85d16008f130c765e511d670c">&#9670;&#160;</a></span>write_setgroups()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int write_setgroups </td>
          <td>(</td>
          <td class="paramtype">pid_t</td>          <td class="paramname"><span class="paramname"><em>child_pid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>allow</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00870">870</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  871</span>{</div>
<div class="line"><span class="lineno">  872</span>    <span class="keywordtype">int</span> setgroups_file;</div>
<div class="line"><span class="lineno">  873</span>    <span class="keywordtype">char</span> setgroups_path[64];</div>
<div class="line"><span class="lineno">  874</span> </div>
<div class="line"><span class="lineno">  875</span>    <span class="keywordflow">if</span> (snprintf(setgroups_path, <span class="keyword">sizeof</span>(setgroups_path), <span class="stringliteral">&quot;/proc/%d/setgroups&quot;</span>,</div>
<div class="line"><span class="lineno">  876</span>        child_pid) &lt; 0) {</div>
<div class="line"><span class="lineno">  877</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  878</span>    }</div>
<div class="line"><span class="lineno">  879</span> </div>
<div class="line"><span class="lineno">  880</span>    <span class="keywordflow">if</span> ((setgroups_file = open(setgroups_path, O_WRONLY)) &lt; 0) {</div>
<div class="line"><span class="lineno">  881</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  882</span>    }</div>
<div class="line"><span class="lineno">  883</span> </div>
<div class="line"><span class="lineno">  884</span>    <span class="keywordflow">if</span> (dprintf(setgroups_file, <span class="stringliteral">&quot;%s&quot;</span>, allow?<span class="stringliteral">&quot;allow&quot;</span>:<span class="stringliteral">&quot;deny&quot;</span>) == -1) {</div>
<div class="line"><span class="lineno">  885</span>        close(setgroups_file);</div>
<div class="line"><span class="lineno">  886</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  887</span>    }</div>
<div class="line"><span class="lineno">  888</span> </div>
<div class="line"><span class="lineno">  889</span>    close(setgroups_file);</div>
<div class="line"><span class="lineno">  890</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  891</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>.</p>

</div>
</div>
<a id="aca23e4e8fd88ec02ca43121879a36702" name="aca23e4e8fd88ec02ca43121879a36702"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca23e4e8fd88ec02ca43121879a36702">&#9670;&#160;</a></span>write_single_uid_gid_map()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int write_single_uid_gid_map </td>
          <td>(</td>
          <td class="paramtype">pid_t</td>          <td class="paramname"><span class="paramname"><em>child_pid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>gidmap</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>id</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00849">849</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  850</span>{</div>
<div class="line"><span class="lineno">  851</span>    <span class="keywordtype">int</span> map_file;</div>
<div class="line"><span class="lineno">  852</span>    <span class="keywordtype">char</span> map_path[64];</div>
<div class="line"><span class="lineno">  853</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *map_format = <span class="stringliteral">&quot;%d %d %d\n&quot;</span>;</div>
<div class="line"><span class="lineno">  854</span>    <span class="keywordflow">if</span> (snprintf(map_path, <span class="keyword">sizeof</span>(map_path), <span class="stringliteral">&quot;/proc/%d/%s&quot;</span>,</div>
<div class="line"><span class="lineno">  855</span>        child_pid, gidmap?<span class="stringliteral">&quot;gid_map&quot;</span>:<span class="stringliteral">&quot;uid_map&quot;</span>) &lt; 0)</div>
<div class="line"><span class="lineno">  856</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  857</span> </div>
<div class="line"><span class="lineno">  858</span>    <span class="keywordflow">if</span> ((map_file = open(map_path, O_WRONLY)) &lt; 0)</div>
<div class="line"><span class="lineno">  859</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  860</span> </div>
<div class="line"><span class="lineno">  861</span>    <span class="keywordflow">if</span> (dprintf(map_file, map_format, 0, <span class="keywordtype">id</span>, 1) &lt; 0) {</div>
<div class="line"><span class="lineno">  862</span>        close(map_file);</div>
<div class="line"><span class="lineno">  863</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  864</span>    }</div>
<div class="line"><span class="lineno">  865</span> </div>
<div class="line"><span class="lineno">  866</span>    close(map_file);</div>
<div class="line"><span class="lineno">  867</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  868</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>.</p>

</div>
</div>
<a id="a03b42a6e644fea8b163b6b51e0fd4a99" name="a03b42a6e644fea8b163b6b51e0fd4a99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03b42a6e644fea8b163b6b51e0fd4a99">&#9670;&#160;</a></span>write_uid_gid_map()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int write_uid_gid_map </td>
          <td>(</td>
          <td class="paramtype">pid_t</td>          <td class="paramname"><span class="paramname"><em>child_pid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>gidmap</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>mapstr</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00828">828</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  829</span>{</div>
<div class="line"><span class="lineno">  830</span>    <span class="keywordtype">int</span> map_file;</div>
<div class="line"><span class="lineno">  831</span>    <span class="keywordtype">char</span> map_path[64];</div>
<div class="line"><span class="lineno">  832</span> </div>
<div class="line"><span class="lineno">  833</span>    <span class="keywordflow">if</span> (snprintf(map_path, <span class="keyword">sizeof</span>(map_path), <span class="stringliteral">&quot;/proc/%d/%s&quot;</span>,</div>
<div class="line"><span class="lineno">  834</span>        child_pid, gidmap?<span class="stringliteral">&quot;gid_map&quot;</span>:<span class="stringliteral">&quot;uid_map&quot;</span>) &lt; 0)</div>
<div class="line"><span class="lineno">  835</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  836</span> </div>
<div class="line"><span class="lineno">  837</span>    <span class="keywordflow">if</span> ((map_file = open(map_path, O_WRONLY)) &lt; 0)</div>
<div class="line"><span class="lineno">  838</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  839</span> </div>
<div class="line"><span class="lineno">  840</span>    <span class="keywordflow">if</span> (dprintf(map_file, <span class="stringliteral">&quot;%s&quot;</span>, mapstr)) {</div>
<div class="line"><span class="lineno">  841</span>        close(map_file);</div>
<div class="line"><span class="lineno">  842</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  843</span>    }</div>
<div class="line"><span class="lineno">  844</span> </div>
<div class="line"><span class="lineno">  845</span>    close(map_file);</div>
<div class="line"><span class="lineno">  846</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  847</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a6cb0fbfbe5b1abc05003e2609fb7bc8c" name="a6cb0fbfbe5b1abc05003e2609fb7bc8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cb0fbfbe5b1abc05003e2609fb7bc8c">&#9670;&#160;</a></span>bb</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d8/d3c/blob_8h.html#d3/dcb/structblob__buf">blob_buf</a> bb</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02437">2437</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02438">handle_state()</a>.</p>

</div>
</div>
<a id="aad410c04420d9661f33117e672aee307" name="aad410c04420d9661f33117e672aee307"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad410c04420d9661f33117e672aee307">&#9670;&#160;</a></span>child_stack</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char child_stack[<a class="el" href="#a6423a880df59733d2d9b509c7718d3a9">STACK_SIZE</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00165">165</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>.</p>

</div>
</div>
<a id="a9942f1401f46e915dbfecc403324f562" name="a9942f1401f46e915dbfecc403324f562"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9942f1401f46e915dbfecc403324f562">&#9670;&#160;</a></span>console_fd</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int console_fd</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00169">169</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d1d/service_8c_source.html#l00858">container_handle_console()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00373">create_dev_console()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00351">pass_console()</a>.</p>

</div>
</div>
<a id="a8acd133e16a1d2f660965034ad651713" name="a8acd133e16a1d2f660965034ad651713"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8acd133e16a1d2f660965034ad651713">&#9670;&#160;</a></span>container_kill_attrs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a> container_kill_attrs[<a class="el" href="#a9b29769343da78881f442e657eb62b6eaa656c9648d631f597fe6ab93da6c8420">__CONTAINER_KILL_ATTR_MAX</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a9b29769343da78881f442e657eb62b6eaf6c2e8ccd2ffe9d627f296e938428c0b">CONTAINER_KILL_ATTR_SIGNAL</a>] = { <span class="stringliteral">&quot;signal&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">}</div>
<div class="ttc" id="ablobmsg_8h_html_a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a></div><div class="ttdeci">@ BLOBMSG_TYPE_INT32</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00031">blobmsg.h:31</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02484">2484</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2484</span>                                                                                     {</div>
<div class="line"><span class="lineno"> 2485</span>    [<a class="code hl_enumvalue" href="#a9b29769343da78881f442e657eb62b6eaf6c2e8ccd2ffe9d627f296e938428c0b">CONTAINER_KILL_ATTR_SIGNAL</a>] = { <span class="stringliteral">&quot;signal&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno"> 2486</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02489">container_handle_kill()</a>.</p>

</div>
</div>
<a id="af721c4badea07940f26ef4e8efa88e51" name="af721c4badea07940f26ef4e8efa88e51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af721c4badea07940f26ef4e8efa88e51">&#9670;&#160;</a></span>container_methods</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/d00/ubusd__obj_8h.html#d9/d8b/structubus__method">ubus_method</a> container_methods[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    <a class="code hl_define" href="../../db/d55/libubus_8h.html#ab3772ca422a2cdb9394098d7629c1473">UBUS_METHOD_NOARG</a>(<span class="stringliteral">&quot;start&quot;</span>, <a class="code hl_function" href="#a2d6c7c9ff5f0dc0ecd5af7f8c8ff2856">handle_start</a>),</div>
<div class="line">    <a class="code hl_define" href="../../db/d55/libubus_8h.html#ab3772ca422a2cdb9394098d7629c1473">UBUS_METHOD_NOARG</a>(<span class="stringliteral">&quot;state&quot;</span>, <a class="code hl_function" href="#ac6e6d6350c1d8807003c0cbc0bab22ba">handle_state</a>),</div>
<div class="line">    <a class="code hl_define" href="../../db/d55/libubus_8h.html#aac021711c90050abc4c65261f9799687">UBUS_METHOD</a>(<span class="stringliteral">&quot;kill&quot;</span>, <a class="code hl_function" href="#ae3670ecb9a71cd74f8a871ca3ff6f091">container_handle_kill</a>, <a class="code hl_variable" href="#a8acd133e16a1d2f660965034ad651713">container_kill_attrs</a>),</div>
<div class="line">}</div>
<div class="ttc" id="ajail_8c_html_a2d6c7c9ff5f0dc0ecd5af7f8c8ff2856"><div class="ttname"><a href="#a2d6c7c9ff5f0dc0ecd5af7f8c8ff2856">handle_start</a></div><div class="ttdeci">static int handle_start(struct ubus_context *ctx, struct ubus_object *obj, struct ubus_request_data *req, const char *method, struct blob_attr *msg)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02425">jail.c:2425</a></div></div>
<div class="ttc" id="ajail_8c_html_ac6e6d6350c1d8807003c0cbc0bab22ba"><div class="ttname"><a href="#ac6e6d6350c1d8807003c0cbc0bab22ba">handle_state</a></div><div class="ttdeci">static int handle_state(struct ubus_context *ctx, struct ubus_object *obj, struct ubus_request_data *req, const char *method, struct blob_attr *msg)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02438">jail.c:2438</a></div></div>
<div class="ttc" id="ajail_8c_html_ae3670ecb9a71cd74f8a871ca3ff6f091"><div class="ttname"><a href="#ae3670ecb9a71cd74f8a871ca3ff6f091">container_handle_kill</a></div><div class="ttdeci">static int container_handle_kill(struct ubus_context *ctx, struct ubus_object *obj, struct ubus_request_data *req, const char *method, struct blob_attr *msg)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02489">jail.c:2489</a></div></div>
<div class="ttc" id="alibubus_8h_html_aac021711c90050abc4c65261f9799687"><div class="ttname"><a href="../../db/d55/libubus_8h.html#aac021711c90050abc4c65261f9799687">UBUS_METHOD</a></div><div class="ttdeci">#define UBUS_METHOD(_name, _handler, _policy)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d55/libubus_8h_source.html#l00086">libubus.h:86</a></div></div>
<div class="ttc" id="alibubus_8h_html_ab3772ca422a2cdb9394098d7629c1473"><div class="ttname"><a href="../../db/d55/libubus_8h.html#ab3772ca422a2cdb9394098d7629c1473">UBUS_METHOD_NOARG</a></div><div class="ttdeci">#define UBUS_METHOD_NOARG(_name, _handler)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d55/libubus_8h_source.html#l00098">libubus.h:98</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02552">2552</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2552</span>                                                {</div>
<div class="line"><span class="lineno"> 2553</span>    <a class="code hl_define" href="../../db/d55/libubus_8h.html#ab3772ca422a2cdb9394098d7629c1473">UBUS_METHOD_NOARG</a>(<span class="stringliteral">&quot;start&quot;</span>, <a class="code hl_function" href="#a2d6c7c9ff5f0dc0ecd5af7f8c8ff2856">handle_start</a>),</div>
<div class="line"><span class="lineno"> 2554</span>    <a class="code hl_define" href="../../db/d55/libubus_8h.html#ab3772ca422a2cdb9394098d7629c1473">UBUS_METHOD_NOARG</a>(<span class="stringliteral">&quot;state&quot;</span>, <a class="code hl_function" href="#ac6e6d6350c1d8807003c0cbc0bab22ba">handle_state</a>),</div>
<div class="line"><span class="lineno"> 2555</span>    <a class="code hl_define" href="../../db/d55/libubus_8h.html#aac021711c90050abc4c65261f9799687">UBUS_METHOD</a>(<span class="stringliteral">&quot;kill&quot;</span>, <a class="code hl_function" href="#ae3670ecb9a71cd74f8a871ca3ff6f091">container_handle_kill</a>, <a class="code hl_variable" href="#a8acd133e16a1d2f660965034ad651713">container_kill_attrs</a>),</div>
<div class="line"><span class="lineno"> 2556</span>};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a450e41d3094b10b8997ca48a290d437f" name="a450e41d3094b10b8997ca48a290d437f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a450e41d3094b10b8997ca48a290d437f">&#9670;&#160;</a></span>container_object</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/d00/ubusd__obj_8h.html#d6/d75/structubus__object">ubus_object</a> container_object</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .type = &amp;<a class="code hl_variable" href="#a1b008aad908bf79f765da1b5d056324e">container_object_type</a>,</div>
<div class="line">    .<a class="code hl_variable" href="../../d9/d00/ubusd__obj_8h.html#a73400f69761b61903631e803f69dda5d">methods</a> = <a class="code hl_variable" href="#af721c4badea07940f26ef4e8efa88e51">container_methods</a>,</div>
<div class="line">    .n_methods = <a class="code hl_define" href="../../d8/d6a/test-blobmsg-types_8c.html#a6242a25f9d996f0cc4f4cdb911218b75">ARRAY_SIZE</a>(<a class="code hl_variable" href="#af721c4badea07940f26ef4e8efa88e51">container_methods</a>),</div>
<div class="line">}</div>
<div class="ttc" id="ajail_8c_html_a1b008aad908bf79f765da1b5d056324e"><div class="ttname"><a href="#a1b008aad908bf79f765da1b5d056324e">container_object_type</a></div><div class="ttdeci">static struct ubus_object_type container_object_type</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02558">jail.c:2558</a></div></div>
<div class="ttc" id="ajail_8c_html_af721c4badea07940f26ef4e8efa88e51"><div class="ttname"><a href="#af721c4badea07940f26ef4e8efa88e51">container_methods</a></div><div class="ttdeci">static struct ubus_method container_methods[]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02552">jail.c:2552</a></div></div>
<div class="ttc" id="atest-blobmsg-types_8c_html_a6242a25f9d996f0cc4f4cdb911218b75"><div class="ttname"><a href="../../d8/d6a/test-blobmsg-types_8c.html#a6242a25f9d996f0cc4f4cdb911218b75">ARRAY_SIZE</a></div><div class="ttdeci">#define ARRAY_SIZE(x)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d6a/test-blobmsg-types_8c_source.html#l00120">test-blobmsg-types.c:120</a></div></div>
<div class="ttc" id="aubusd__obj_8h_html_a73400f69761b61903631e803f69dda5d"><div class="ttname"><a href="../../d9/d00/ubusd__obj_8h.html#a73400f69761b61903631e803f69dda5d">ubus_object_type::methods</a></div><div class="ttdeci">const struct ubus_method * methods</div><div class="ttdef"><b>Definition</b> <a href="../../db/d55/libubus_8h_source.html#l00122">libubus.h:122</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02561">2561</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2561</span>                                             {</div>
<div class="line"><span class="lineno"> 2562</span>    .type = &amp;<a class="code hl_variable" href="#a1b008aad908bf79f765da1b5d056324e">container_object_type</a>,</div>
<div class="line"><span class="lineno"> 2563</span>    .<a class="code hl_variable" href="../../d9/d00/ubusd__obj_8h.html#a73400f69761b61903631e803f69dda5d">methods</a> = <a class="code hl_variable" href="#af721c4badea07940f26ef4e8efa88e51">container_methods</a>,</div>
<div class="line"><span class="lineno"> 2564</span>    .n_methods = <a class="code hl_define" href="../../d8/d6a/test-blobmsg-types_8c.html#a6242a25f9d996f0cc4f4cdb911218b75">ARRAY_SIZE</a>(<a class="code hl_variable" href="#af721c4badea07940f26ef4e8efa88e51">container_methods</a>),</div>
<div class="line"><span class="lineno"> 2565</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02583">main()</a>.</p>

</div>
</div>
<a id="a1b008aad908bf79f765da1b5d056324e" name="a1b008aad908bf79f765da1b5d056324e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b008aad908bf79f765da1b5d056324e">&#9670;&#160;</a></span>container_object_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/d00/ubusd__obj_8h.html#d4/d66/structubus__object__type">ubus_object_type</a> container_object_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">    <a class="code hl_define" href="../../db/d55/libubus_8h.html#a2537aa13909031a58e3d881d6670d68d">UBUS_OBJECT_TYPE</a>(<span class="stringliteral">&quot;container&quot;</span>, <a class="code hl_variable" href="#af721c4badea07940f26ef4e8efa88e51">container_methods</a>)</div>
<div class="ttc" id="alibubus_8h_html_a2537aa13909031a58e3d881d6670d68d"><div class="ttname"><a href="../../db/d55/libubus_8h.html#a2537aa13909031a58e3d881d6670d68d">UBUS_OBJECT_TYPE</a></div><div class="ttdeci">#define UBUS_OBJECT_TYPE(_name, _methods)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d55/libubus_8h_source.html#l00068">libubus.h:68</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02558">2558</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

</div>
</div>
<a id="aa3d0fc71d58968708478752881b119c0" name="aa3d0fc71d58968708478752881b119c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3d0fc71d58968708478752881b119c0">&#9670;&#160;</a></span>current_hook</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="#da/d60/structhook__execvpe">hook_execvpe</a>** current_hook = NULL</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00427">427</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00437">hook_process_handler()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00467">run_hooklist()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00512">run_hooks()</a>.</p>

</div>
</div>
<a id="ac3e1795766a80ec63b157951b4b9a7d4" name="ac3e1795766a80ec63b157951b4b9a7d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3e1795766a80ec63b157951b4b9a7d4">&#9670;&#160;</a></span>debug</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int debug = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00163">163</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00959">build_envp()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l02583">main()</a>.</p>

</div>
</div>
<a id="ac967e6b320d955511a5e66e36f579622" name="ac967e6b320d955511a5e66e36f579622"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac967e6b320d955511a5e66e36f579622">&#9670;&#160;</a></span>default_devices</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="#d5/db5/structmknod__args">mknod_args</a> default_devices[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    { .path = <span class="stringliteral">&quot;/dev/null&quot;</span>, .mode = (S_IFCHR|S_IRUSR|S_IWUSR|S_IRGRP|S_IWGRP|S_IROTH|S_IWOTH), .dev = <a class="code hl_define" href="#aa031dc6712613a6c64f5d8b26eb1baae">makedev</a>(1, 3) },</div>
<div class="line">    { .path = <span class="stringliteral">&quot;/dev/zero&quot;</span>, .mode = (S_IFCHR|S_IRUSR|S_IWUSR|S_IRGRP|S_IWGRP|S_IROTH|S_IWOTH), .dev = <a class="code hl_define" href="#aa031dc6712613a6c64f5d8b26eb1baae">makedev</a>(1, 5) },</div>
<div class="line">    { .path = <span class="stringliteral">&quot;/dev/full&quot;</span>, .mode = (S_IFCHR|S_IRUSR|S_IWUSR|S_IRGRP|S_IWGRP|S_IROTH|S_IWOTH), .dev = <a class="code hl_define" href="#aa031dc6712613a6c64f5d8b26eb1baae">makedev</a>(1, 7) },</div>
<div class="line">    { .path = <span class="stringliteral">&quot;/dev/random&quot;</span>, .mode = (S_IFCHR|S_IRUSR|S_IWUSR|S_IRGRP|S_IWGRP|S_IROTH|S_IWOTH), .dev = <a class="code hl_define" href="#aa031dc6712613a6c64f5d8b26eb1baae">makedev</a>(1, 8) },</div>
<div class="line">    { .path = <span class="stringliteral">&quot;/dev/urandom&quot;</span>, .mode = (S_IFCHR|S_IRUSR|S_IWUSR|S_IRGRP|S_IWGRP|S_IROTH|S_IWOTH), .dev = <a class="code hl_define" href="#aa031dc6712613a6c64f5d8b26eb1baae">makedev</a>(1, 9) },</div>
<div class="line">    { .path = <span class="stringliteral">&quot;/dev/tty&quot;</span>, .mode = (S_IFCHR|S_IRUSR|S_IWUSR|S_IRGRP|S_IWGRP), .dev = <a class="code hl_define" href="#aa031dc6712613a6c64f5d8b26eb1baae">makedev</a>(5, 0), .gid = 5 },</div>
<div class="line">    { 0 },</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00582">582</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  582</span>                                             {</div>
<div class="line"><span class="lineno">  583</span>    { .path = <span class="stringliteral">&quot;/dev/null&quot;</span>, .mode = (S_IFCHR|S_IRUSR|S_IWUSR|S_IRGRP|S_IWGRP|S_IROTH|S_IWOTH), .dev = <a class="code hl_define" href="#aa031dc6712613a6c64f5d8b26eb1baae">makedev</a>(1, 3) },</div>
<div class="line"><span class="lineno">  584</span>    { .path = <span class="stringliteral">&quot;/dev/zero&quot;</span>, .mode = (S_IFCHR|S_IRUSR|S_IWUSR|S_IRGRP|S_IWGRP|S_IROTH|S_IWOTH), .dev = <a class="code hl_define" href="#aa031dc6712613a6c64f5d8b26eb1baae">makedev</a>(1, 5) },</div>
<div class="line"><span class="lineno">  585</span>    { .path = <span class="stringliteral">&quot;/dev/full&quot;</span>, .mode = (S_IFCHR|S_IRUSR|S_IWUSR|S_IRGRP|S_IWGRP|S_IROTH|S_IWOTH), .dev = <a class="code hl_define" href="#aa031dc6712613a6c64f5d8b26eb1baae">makedev</a>(1, 7) },</div>
<div class="line"><span class="lineno">  586</span>    { .path = <span class="stringliteral">&quot;/dev/random&quot;</span>, .mode = (S_IFCHR|S_IRUSR|S_IWUSR|S_IRGRP|S_IWGRP|S_IROTH|S_IWOTH), .dev = <a class="code hl_define" href="#aa031dc6712613a6c64f5d8b26eb1baae">makedev</a>(1, 8) },</div>
<div class="line"><span class="lineno">  587</span>    { .path = <span class="stringliteral">&quot;/dev/urandom&quot;</span>, .mode = (S_IFCHR|S_IRUSR|S_IWUSR|S_IRGRP|S_IWGRP|S_IROTH|S_IWOTH), .dev = <a class="code hl_define" href="#aa031dc6712613a6c64f5d8b26eb1baae">makedev</a>(1, 9) },</div>
<div class="line"><span class="lineno">  588</span>    { .path = <span class="stringliteral">&quot;/dev/tty&quot;</span>, .mode = (S_IFCHR|S_IRUSR|S_IWUSR|S_IRGRP|S_IWGRP), .dev = <a class="code hl_define" href="#aa031dc6712613a6c64f5d8b26eb1baae">makedev</a>(5, 0), .gid = 5 },</div>
<div class="line"><span class="lineno">  589</span>    { 0 },</div>
<div class="line"><span class="lineno">  590</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00592">create_devices()</a>.</p>

</div>
</div>
<a id="a49b89154fcd9cd0089f8c4d9df354d1a" name="a49b89154fcd9cd0089f8c4d9df354d1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49b89154fcd9cd0089f8c4d9df354d1a">&#9670;&#160;</a></span>exit_from_child</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool exit_from_child</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00773">773</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01161">exec_jail()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00774">free_and_exit()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l02583">main()</a>.</p>

</div>
</div>
<a id="a86b744573f5030d3689a980f0006e23a" name="a86b744573f5030d3689a980f0006e23a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86b744573f5030d3689a980f0006e23a">&#9670;&#160;</a></span>hook_process</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dc/d56/uloop_8h.html#da/d43/structuloop__process">uloop_process</a> hook_process</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .cb = <a class="code hl_function" href="#a71525bf218f3fe2889a36b88e7b9964d">hook_process_handler</a>,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00457">457</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  457</span>                                           {</div>
<div class="line"><span class="lineno">  458</span>    .cb = <a class="code hl_function" href="#a71525bf218f3fe2889a36b88e7b9964d">hook_process_handler</a>,</div>
<div class="line"><span class="lineno">  459</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00461">hook_process_timeout_cb()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01117">jail_handle_signal()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00467">run_hooklist()</a>.</p>

</div>
</div>
<a id="a78ac6aa6bcda14a353a7bbc5d31f7d59" name="a78ac6aa6bcda14a353a7bbc5d31f7d59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78ac6aa6bcda14a353a7bbc5d31f7d59">&#9670;&#160;</a></span>hook_process_timeout</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a> hook_process_timeout</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .cb = <a class="code hl_function" href="#a4c2afa94c622fb838442b3f2b631f7c0">hook_process_timeout_cb</a>,</div>
<div class="line">}</div>
<div class="ttc" id="ajail_8c_html_a4c2afa94c622fb838442b3f2b631f7c0"><div class="ttname"><a href="#a4c2afa94c622fb838442b3f2b631f7c0">hook_process_timeout_cb</a></div><div class="ttdeci">static void hook_process_timeout_cb(struct uloop_timeout *t)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l00461">jail.c:461</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00432">432</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  432</span>                                                   {</div>
<div class="line"><span class="lineno">  433</span>    .cb = <a class="code hl_function" href="#a4c2afa94c622fb838442b3f2b631f7c0">hook_process_timeout_cb</a>,</div>
<div class="line"><span class="lineno">  434</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00437">hook_process_handler()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01117">jail_handle_signal()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00467">run_hooklist()</a>.</p>

</div>
</div>
<a id="a3acf3f6a478abce6022fca033743eb37" name="a3acf3f6a478abce6022fca033743eb37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3acf3f6a478abce6022fca033743eb37">&#9670;&#160;</a></span>hook_return_cb</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#a32654766df20ade7d77949ecf91a601e">hook_return_handler</a> hook_return_cb = NULL</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00429">429</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00467">run_hooklist()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00512">run_hooks()</a>.</p>

</div>
</div>
<a id="af1fb066316f676461bbd8e92a073b26c" name="af1fb066316f676461bbd8e92a073b26c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1fb066316f676461bbd8e92a073b26c">&#9670;&#160;</a></span>hook_return_code</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int hook_return_code = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00426">426</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00437">hook_process_handler()</a>.</p>

</div>
</div>
<a id="a7f85aa468b522508531e8c0bece6552c" name="a7f85aa468b522508531e8c0bece6552c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f85aa468b522508531e8c0bece6552c">&#9670;&#160;</a></span>hook_running</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int hook_running = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00425">425</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00437">hook_process_handler()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01117">jail_handle_signal()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00467">run_hooklist()</a>.</p>

</div>
</div>
<a id="af5e3a2bd12c4c9ed553bdacc21e97b65" name="af5e3a2bd12c4c9ed553bdacc21e97b65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5e3a2bd12c4c9ed553bdacc21e97b65">&#9670;&#160;</a></span>jail_oci_state</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int jail_oci_state = <a class="el" href="#a97f905ac94bfebd46e50e32c7389e6eba7d55a02065f2ef38d43d0c0858bee940">OCI_STATE_CREATED</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02419">2419</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02489">container_handle_kill()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02425">handle_start()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02438">handle_state()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l03132">pipe_send_start_container()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l03115">post_create_runtime()</a>.</p>

</div>
</div>
<a id="a02d170ed9179a61ee4049ed3ec9eadf1" name="a02d170ed9179a61ee4049ed3ec9eadf1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02d170ed9179a61ee4049ed3ec9eadf1">&#9670;&#160;</a></span>jail_process</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dc/d56/uloop_8h.html#da/d43/structuloop__process">uloop_process</a> jail_process</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .cb = <a class="code hl_function" href="#a152810934f1ea2bc2a73144a121e3b27">jail_process_handler</a>,</div>
<div class="line">}</div>
<div class="ttc" id="ajail_8c_html_a152810934f1ea2bc2a73144a121e3b27"><div class="ttname"><a href="#a152810934f1ea2bc2a73144a121e3b27">jail_process_handler</a></div><div class="ttdeci">static void jail_process_handler(struct uloop_process *c, int ret)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01093">jail.c:1093</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01107">1107</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1107</span>                                           {</div>
<div class="line"><span class="lineno"> 1108</span>    .cb = <a class="code hl_function" href="#a152810934f1ea2bc2a73144a121e3b27">jail_process_handler</a>,</div>
<div class="line"><span class="lineno"> 1109</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02489">container_handle_kill()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02438">handle_state()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01117">jail_handle_signal()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01111">jail_process_timeout_cb()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l03147">post_poststart()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l02392">set_oom_score_adj()</a>.</p>

</div>
</div>
<a id="aacb1a5c0057b0c69933163312d70e8fd" name="aacb1a5c0057b0c69933163312d70e8fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacb1a5c0057b0c69933163312d70e8fd">&#9670;&#160;</a></span>jail_process_timeout</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a> jail_process_timeout</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .cb = <a class="code hl_function" href="#ab5594c6291500b798715b5e124af342f">jail_process_timeout_cb</a>,</div>
<div class="line">}</div>
<div class="ttc" id="ajail_8c_html_ab5594c6291500b798715b5e124af342f"><div class="ttname"><a href="#ab5594c6291500b798715b5e124af342f">jail_process_timeout_cb</a></div><div class="ttdeci">static void jail_process_timeout_cb(struct uloop_timeout *t)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01111">jail.c:1111</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01089">1089</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1089</span>                                                   {</div>
<div class="line"><span class="lineno"> 1090</span>    .cb = <a class="code hl_function" href="#ab5594c6291500b798715b5e124af342f">jail_process_timeout_cb</a>,</div>
<div class="line"><span class="lineno"> 1091</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01117">jail_handle_signal()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01093">jail_process_handler()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l03147">post_poststart()</a>.</p>

</div>
</div>
<a id="a176df615ae45a155128a6cc7ce716db8" name="a176df615ae45a155128a6cc7ce716db8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a176df615ae45a155128a6cc7ce716db8">&#9670;&#160;</a></span>jail_return_code</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int jail_return_code = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01086">1086</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01093">jail_process_handler()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l03170">post_poststop()</a>.</p>

</div>
</div>
<a id="a45c79303cad1e1847d711c3946e93e85" name="a45c79303cad1e1847d711c3946e93e85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45c79303cad1e1847d711c3946e93e85">&#9670;&#160;</a></span>jail_root</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char jail_root[] = &quot;/tmp/ujail-XXXXXX&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00675">675</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00523">apply_sysctl()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00679">build_jail_fs()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00373">create_dev_console()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00788">enter_jail_fs()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00288">mount_overlay()</a>.</p>

</div>
</div>
<a id="a056d6abff975f4167ecd49617b5261ee" name="a056d6abff975f4167ecd49617b5261ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a056d6abff975f4167ecd49617b5261ee">&#9670;&#160;</a></span>jail_running</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int jail_running = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01085">1085</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01117">jail_handle_signal()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01093">jail_process_handler()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l03147">post_poststart()</a>.</p>

</div>
</div>
<a id="ac256367002c667bedef320ba8eff2aa0" name="ac256367002c667bedef320ba8eff2aa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac256367002c667bedef320ba8eff2aa0">&#9670;&#160;</a></span>netns_fd</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int netns_fd</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02571">2571</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/dda/interface_8c_source.html#l01199">interface_start_jail()</a>, <a class="el" href="../../dd/dda/interface_8c_source.html#l01212">interface_stop_jail()</a>, <a class="el" href="../../db/d3d/netifd_8c_source.html#l00434">jail_network_start()</a>, <a class="el" href="../../db/d3d/netifd_8c_source.html#l00349">netns_updown()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l03161">poststop()</a>, <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00088">system_link_netns_move()</a>, and <a class="el" href="../../da/d12/system-dummy_8c_source.html#l00100">system_netns_set()</a>.</p>

</div>
</div>
<a id="a20d3f1675d8e9e1f654efa2c1f974a91" name="a20d3f1675d8e9e1f654efa2c1f974a91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20d3f1675d8e9e1f654efa2c1f974a91">&#9670;&#160;</a></span>oci_devices_policy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a> oci_devices_policy[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da7552d79964c15ae667f2506ef74f8201">OCI_DEVICES_TYPE</a>] = { <span class="stringliteral">&quot;type&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5dabaa93214e7a6d28b48d2196358fd1123">OCI_DEVICES_PATH</a>] = { <span class="stringliteral">&quot;path&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5dadf9c76ed009a9d7998f869ddf0371767">OCI_DEVICES_MAJOR</a>] = { <span class="stringliteral">&quot;major&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da1841510f8919dcaed8f7e150611e6acf">OCI_DEVICES_MINOR</a>] = { <span class="stringliteral">&quot;minor&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da726450a129ef116d29282fe043688c00">OCI_DEVICES_FILEMODE</a>] = { <span class="stringliteral">&quot;fileMode&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da5b0d2d05d0ce566724d25dc7e751899d">OCI_DEVICES_UID</a>] = { <span class="stringliteral">&quot;uid&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da1201076fb774af33b8c73c518dcc1dfb">OCI_DEVICES_GID</a>] = { <span class="stringliteral">&quot;uid&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">}</div>
<div class="ttc" id="ablobmsg_8h_html_a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a></div><div class="ttdeci">@ BLOBMSG_TYPE_STRING</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00029">blobmsg.h:29</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02030">2030</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2030</span>                                                          {</div>
<div class="line"><span class="lineno"> 2031</span>    [<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da7552d79964c15ae667f2506ef74f8201">OCI_DEVICES_TYPE</a>] = { <span class="stringliteral">&quot;type&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno"> 2032</span>    [<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5dabaa93214e7a6d28b48d2196358fd1123">OCI_DEVICES_PATH</a>] = { <span class="stringliteral">&quot;path&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno"> 2033</span>    [<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5dadf9c76ed009a9d7998f869ddf0371767">OCI_DEVICES_MAJOR</a>] = { <span class="stringliteral">&quot;major&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno"> 2034</span>    [<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da1841510f8919dcaed8f7e150611e6acf">OCI_DEVICES_MINOR</a>] = { <span class="stringliteral">&quot;minor&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno"> 2035</span>    [<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da726450a129ef116d29282fe043688c00">OCI_DEVICES_FILEMODE</a>] = { <span class="stringliteral">&quot;fileMode&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno"> 2036</span>    [<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da5b0d2d05d0ce566724d25dc7e751899d">OCI_DEVICES_UID</a>] = { <span class="stringliteral">&quot;uid&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno"> 2037</span>    [<a class="code hl_enumvalue" href="#a81929fb3d21206b62f55bcb744f71d5da1201076fb774af33b8c73c518dcc1dfb">OCI_DEVICES_GID</a>] = { <span class="stringliteral">&quot;uid&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno"> 2038</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02053">parseOCIdevices()</a>.</p>

</div>
</div>
<a id="af55a6af095425b7521be3888c90b3e21" name="af55a6af095425b7521be3888c90b3e21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af55a6af095425b7521be3888c90b3e21">&#9670;&#160;</a></span>oci_hook_policy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a> oci_hook_policy[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2ab8282160b544f18b6b51d625957979a5">OCI_HOOK_PATH</a>] = { <span class="stringliteral">&quot;path&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2a95599181fee35581a14f13681c2cf66b">OCI_HOOK_ARGS</a>] = { <span class="stringliteral">&quot;args&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2a36845abacde1267489e7ef578cee4460">OCI_HOOK_ENV</a>] = { <span class="stringliteral">&quot;env&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2abb5b45a58a6262ff75e12bd0fe9d888d">OCI_HOOK_TIMEOUT</a>] = { <span class="stringliteral">&quot;timeout&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">}</div>
<div class="ttc" id="ablobmsg_8h_html_a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a></div><div class="ttdeci">@ BLOBMSG_TYPE_ARRAY</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00027">blobmsg.h:27</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01424">1424</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1424</span>                                                       {</div>
<div class="line"><span class="lineno"> 1425</span>    [<a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2ab8282160b544f18b6b51d625957979a5">OCI_HOOK_PATH</a>] = { <span class="stringliteral">&quot;path&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno"> 1426</span>    [<a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2a95599181fee35581a14f13681c2cf66b">OCI_HOOK_ARGS</a>] = { <span class="stringliteral">&quot;args&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno"> 1427</span>    [<a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2a36845abacde1267489e7ef578cee4460">OCI_HOOK_ENV</a>] = { <span class="stringliteral">&quot;env&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno"> 1428</span>    [<a class="code hl_enumvalue" href="#a26c0312ac66c00f31cf886616c48afa2abb5b45a58a6262ff75e12bd0fe9d888d">OCI_HOOK_TIMEOUT</a>] = { <span class="stringliteral">&quot;timeout&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno"> 1429</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01432">parseOCIhook()</a>.</p>

</div>
</div>
<a id="afb41c6cf00c1c377b5cfbad669347e5f" name="afb41c6cf00c1c377b5cfbad669347e5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb41c6cf00c1c377b5cfbad669347e5f">&#9670;&#160;</a></span>oci_hooks_policy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a> oci_hooks_policy[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266af862a8090db6d0f4c881c11e44f62f5c">OCI_HOOKS_PRESTART</a>] = { <span class="stringliteral">&quot;prestart&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a7cbf2aaa3aff3ed3c5619f1586102654">OCI_HOOKS_CREATERUNTIME</a>] = { <span class="stringliteral">&quot;createRuntime&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a81b8b437bed6d97716be572758d636f7">OCI_HOOKS_CREATECONTAINER</a>] = { <span class="stringliteral">&quot;createContainer&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a19b67b62f1e805e385a650b7a667ab2f">OCI_HOOKS_STARTCONTAINER</a>] = { <span class="stringliteral">&quot;startContainer&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a81b23e202b544376a4150805e7032081">OCI_HOOKS_POSTSTART</a>] = { <span class="stringliteral">&quot;poststart&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a038ea885ca857034d8682acb2ef0aa74">OCI_HOOKS_POSTSTOP</a>] = { <span class="stringliteral">&quot;poststop&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01509">1509</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1509</span>                                                        {</div>
<div class="line"><span class="lineno"> 1510</span>    [<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266af862a8090db6d0f4c881c11e44f62f5c">OCI_HOOKS_PRESTART</a>] = { <span class="stringliteral">&quot;prestart&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno"> 1511</span>    [<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a7cbf2aaa3aff3ed3c5619f1586102654">OCI_HOOKS_CREATERUNTIME</a>] = { <span class="stringliteral">&quot;createRuntime&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno"> 1512</span>    [<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a81b8b437bed6d97716be572758d636f7">OCI_HOOKS_CREATECONTAINER</a>] = { <span class="stringliteral">&quot;createContainer&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno"> 1513</span>    [<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a19b67b62f1e805e385a650b7a667ab2f">OCI_HOOKS_STARTCONTAINER</a>] = { <span class="stringliteral">&quot;startContainer&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno"> 1514</span>    [<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a81b23e202b544376a4150805e7032081">OCI_HOOKS_POSTSTART</a>] = { <span class="stringliteral">&quot;poststart&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno"> 1515</span>    [<a class="code hl_enumvalue" href="#aecd12a18eeb0ee701fc7b0efd5068266a038ea885ca857034d8682acb2ef0aa74">OCI_HOOKS_POSTSTOP</a>] = { <span class="stringliteral">&quot;poststop&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno"> 1516</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01518">parseOCIhooks()</a>.</p>

</div>
</div>
<a id="a14e8ea04063c41eec6c731c6db2f83ea" name="a14e8ea04063c41eec6c731c6db2f83ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14e8ea04063c41eec6c731c6db2f83ea">&#9670;&#160;</a></span>oci_linux_namespace_policy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a> oci_linux_namespace_policy[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a4efaf4e07364d6302f598569aa7e55dca3c772ed4692c1a6ee8cfd749e8f288b6">OCI_LINUX_NAMESPACE_TYPE</a>] = { <span class="stringliteral">&quot;type&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a4efaf4e07364d6302f598569aa7e55dca9f981c7082417182bd81726ea9348830">OCI_LINUX_NAMESPACE_PATH</a>] = { <span class="stringliteral">&quot;path&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01800">1800</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1800</span>                                                                  {</div>
<div class="line"><span class="lineno"> 1801</span>    [<a class="code hl_enumvalue" href="#a4efaf4e07364d6302f598569aa7e55dca3c772ed4692c1a6ee8cfd749e8f288b6">OCI_LINUX_NAMESPACE_TYPE</a>] = { <span class="stringliteral">&quot;type&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno"> 1802</span>    [<a class="code hl_enumvalue" href="#a4efaf4e07364d6302f598569aa7e55dca9f981c7082417182bd81726ea9348830">OCI_LINUX_NAMESPACE_PATH</a>] = { <span class="stringliteral">&quot;path&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno"> 1803</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01830">parseOCIlinuxns()</a>.</p>

</div>
</div>
<a id="aaa2a41087e75522879f336667608dcf2" name="aaa2a41087e75522879f336667608dcf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa2a41087e75522879f336667608dcf2">&#9670;&#160;</a></span>oci_linux_policy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a> oci_linux_policy[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a4c337c6cf54ff1755a2cc9145bcb29ba">OCI_LINUX_CGROUPSPATH</a>] = { <span class="stringliteral">&quot;cgroupsPath&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a6ed87e24d333274bcf07394e12eb0334">OCI_LINUX_RESOURCES</a>] = { <span class="stringliteral">&quot;resources&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002abaa0938b58a04b3660a37c8708610f7f">OCI_LINUX_SECCOMP</a>] = { <span class="stringliteral">&quot;seccomp&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002ad9d5c35f112531b3441718b70580ad3b">OCI_LINUX_SYSCTL</a>] = { <span class="stringliteral">&quot;sysctl&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a8a3a158fe5d2f0a652ef86cda72ab655">OCI_LINUX_NAMESPACES</a>] = { <span class="stringliteral">&quot;namespaces&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a1307500651c21f2451f25555fe3f45c9">OCI_LINUX_DEVICES</a>] = { <span class="stringliteral">&quot;devices&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a9d6ef21b01ed6532bff2ac2c28c5a075">OCI_LINUX_UIDMAPPINGS</a>] = { <span class="stringliteral">&quot;uidMappings&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002afd9a8d6225d58630adfdd9b127bd2b75">OCI_LINUX_GIDMAPPINGS</a>] = { <span class="stringliteral">&quot;gidMappings&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002af04b23cc25d65aa924674451e37742b5">OCI_LINUX_MASKEDPATHS</a>] = { <span class="stringliteral">&quot;maskedPaths&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a99685949d7e12300cde9533b69faec9d">OCI_LINUX_READONLYPATHS</a>] = { <span class="stringliteral">&quot;readonlyPaths&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a609592d1ea33a112dfe8ff3e6545d6c0">OCI_LINUX_ROOTFSPROPAGATION</a>] = { <span class="stringliteral">&quot;rootfsPropagation&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">}</div>
<div class="ttc" id="ablobmsg_8h_html_a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a></div><div class="ttdeci">@ BLOBMSG_TYPE_TABLE</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00028">blobmsg.h:28</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02184">2184</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2184</span>                                                        {</div>
<div class="line"><span class="lineno"> 2185</span>    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a4c337c6cf54ff1755a2cc9145bcb29ba">OCI_LINUX_CGROUPSPATH</a>] = { <span class="stringliteral">&quot;cgroupsPath&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno"> 2186</span>    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a6ed87e24d333274bcf07394e12eb0334">OCI_LINUX_RESOURCES</a>] = { <span class="stringliteral">&quot;resources&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line"><span class="lineno"> 2187</span>    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002abaa0938b58a04b3660a37c8708610f7f">OCI_LINUX_SECCOMP</a>] = { <span class="stringliteral">&quot;seccomp&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line"><span class="lineno"> 2188</span>    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002ad9d5c35f112531b3441718b70580ad3b">OCI_LINUX_SYSCTL</a>] = { <span class="stringliteral">&quot;sysctl&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line"><span class="lineno"> 2189</span>    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a8a3a158fe5d2f0a652ef86cda72ab655">OCI_LINUX_NAMESPACES</a>] = { <span class="stringliteral">&quot;namespaces&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno"> 2190</span>    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a1307500651c21f2451f25555fe3f45c9">OCI_LINUX_DEVICES</a>] = { <span class="stringliteral">&quot;devices&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno"> 2191</span>    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a9d6ef21b01ed6532bff2ac2c28c5a075">OCI_LINUX_UIDMAPPINGS</a>] = { <span class="stringliteral">&quot;uidMappings&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno"> 2192</span>    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002afd9a8d6225d58630adfdd9b127bd2b75">OCI_LINUX_GIDMAPPINGS</a>] = { <span class="stringliteral">&quot;gidMappings&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno"> 2193</span>    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002af04b23cc25d65aa924674451e37742b5">OCI_LINUX_MASKEDPATHS</a>] = { <span class="stringliteral">&quot;maskedPaths&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno"> 2194</span>    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a99685949d7e12300cde9533b69faec9d">OCI_LINUX_READONLYPATHS</a>] = { <span class="stringliteral">&quot;readonlyPaths&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno"> 2195</span>    [<a class="code hl_enumvalue" href="#a7ada2556f3c386db5f31969fb6d4d002a609592d1ea33a112dfe8ff3e6545d6c0">OCI_LINUX_ROOTFSPROPAGATION</a>] = { <span class="stringliteral">&quot;rootfsPropagation&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno"> 2196</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02198">parseOCIlinux()</a>.</p>

</div>
</div>
<a id="a387d39c38022d5a883597493a72e4dc6" name="a387d39c38022d5a883597493a72e4dc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a387d39c38022d5a883597493a72e4dc6">&#9670;&#160;</a></span>oci_linux_uidgidmap_policy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a> oci_linux_uidgidmap_policy[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a7be3c350b969aa7e666feec5231a0619">OCI_LINUX_UIDGIDMAP_CONTAINERID</a>] = { <span class="stringliteral">&quot;containerID&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a9d04002b30779f94d79d2998244f6ff2">OCI_LINUX_UIDGIDMAP_HOSTID</a>] = { <span class="stringliteral">&quot;hostID&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9af62eeb729d82816dca12d392f7c0242c">OCI_LINUX_UIDGIDMAP_SIZE</a>] = { <span class="stringliteral">&quot;size&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01958">1958</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1958</span>                                                                  {</div>
<div class="line"><span class="lineno"> 1959</span>    [<a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a7be3c350b969aa7e666feec5231a0619">OCI_LINUX_UIDGIDMAP_CONTAINERID</a>] = { <span class="stringliteral">&quot;containerID&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno"> 1960</span>    [<a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9a9d04002b30779f94d79d2998244f6ff2">OCI_LINUX_UIDGIDMAP_HOSTID</a>] = { <span class="stringliteral">&quot;hostID&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno"> 1961</span>    [<a class="code hl_enumvalue" href="#a34df7cc7f69a8ec535eec8a524dcbaf9af62eeb729d82816dca12d392f7c0242c">OCI_LINUX_UIDGIDMAP_SIZE</a>] = { <span class="stringliteral">&quot;size&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno"> 1962</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01964">parseOCIuidgidmappings()</a>.</p>

</div>
</div>
<a id="ad03397b5f24381749f1fbc6509cf6425" name="ad03397b5f24381749f1fbc6509cf6425"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad03397b5f24381749f1fbc6509cf6425">&#9670;&#160;</a></span>oci_policy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a> oci_policy[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a1fe8c34674764c6ec2f2d1984072c62d">OCI_VERSION</a>] = { <span class="stringliteral">&quot;ociVersion&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2ac4dfa375741e7a69482e70cd6895ee0b">OCI_HOSTNAME</a>] = { <span class="stringliteral">&quot;hostname&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2aeefd9fc5dfb29881871de9083a277396">OCI_PROCESS</a>] = { <span class="stringliteral">&quot;process&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2af6442ef34bfc169790d9429b2fd4e732">OCI_ROOT</a>] = { <span class="stringliteral">&quot;root&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a138e90c68b0f6df726b8169e93b96d08">OCI_MOUNTS</a>] = { <span class="stringliteral">&quot;mounts&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2ae5b76fcf322dc75c322e5ce6db99448d">OCI_HOOKS</a>] = { <span class="stringliteral">&quot;hooks&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a7dbca8874590bfff6d39937b3fa80dce">OCI_LINUX</a>] = { <span class="stringliteral">&quot;linux&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a13a552ae7da72cf7868d1e286ffc0921">OCI_ANNOTATIONS</a>] = { <span class="stringliteral">&quot;annotations&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02312">2312</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2312</span>                                                  {</div>
<div class="line"><span class="lineno"> 2313</span>    [<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a1fe8c34674764c6ec2f2d1984072c62d">OCI_VERSION</a>] = { <span class="stringliteral">&quot;ociVersion&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno"> 2314</span>    [<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2ac4dfa375741e7a69482e70cd6895ee0b">OCI_HOSTNAME</a>] = { <span class="stringliteral">&quot;hostname&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno"> 2315</span>    [<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2aeefd9fc5dfb29881871de9083a277396">OCI_PROCESS</a>] = { <span class="stringliteral">&quot;process&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line"><span class="lineno"> 2316</span>    [<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2af6442ef34bfc169790d9429b2fd4e732">OCI_ROOT</a>] = { <span class="stringliteral">&quot;root&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line"><span class="lineno"> 2317</span>    [<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a138e90c68b0f6df726b8169e93b96d08">OCI_MOUNTS</a>] = { <span class="stringliteral">&quot;mounts&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno"> 2318</span>    [<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2ae5b76fcf322dc75c322e5ce6db99448d">OCI_HOOKS</a>] = { <span class="stringliteral">&quot;hooks&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line"><span class="lineno"> 2319</span>    [<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a7dbca8874590bfff6d39937b3fa80dce">OCI_LINUX</a>] = { <span class="stringliteral">&quot;linux&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line"><span class="lineno"> 2320</span>    [<a class="code hl_enumvalue" href="#a25e50be5c73e0b2fab54944e68dd48c2a13a552ae7da72cf7868d1e286ffc0921">OCI_ANNOTATIONS</a>] = { <span class="stringliteral">&quot;annotations&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line"><span class="lineno"> 2321</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02323">parseOCI()</a>.</p>

</div>
</div>
<a id="a1b6d333d023b819f033d8012b14a51b2" name="a1b6d333d023b819f033d8012b14a51b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b6d333d023b819f033d8012b14a51b2">&#9670;&#160;</a></span>oci_process_policy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a> oci_process_policy[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a9d41d59732df8b5db30de6d8b498664c">OCI_PROCESS_ARGS</a>] = { <span class="stringliteral">&quot;args&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a71f60125a3d09ac0376911a3e0b0a6a4">OCI_PROCESS_CAPABILITIES</a>] = { <span class="stringliteral">&quot;capabilities&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a841ee5b5a8bc29fc281504adf23332a5">OCI_PROCESS_CWD</a>] = { <span class="stringliteral">&quot;cwd&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a1be2ada84df5442b9f201c6dc52b3068">OCI_PROCESS_ENV</a>] = { <span class="stringliteral">&quot;env&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8ac9d842b5fe7888be2ebaa9505332f6df">OCI_PROCESS_OOMSCOREADJ</a>] = { <span class="stringliteral">&quot;oomScoreAdj&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a7c18000948947c83ebfd4fab57779357">OCI_PROCESS_NONEWPRIVILEGES</a>] = { <span class="stringliteral">&quot;noNewPrivileges&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a65f050be4633329d0af340d88e209df6">BLOBMSG_TYPE_BOOL</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a43e16b4cc6c2d437a14b0bc14554127e">OCI_PROCESS_RLIMITS</a>] = { <span class="stringliteral">&quot;rlimits&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8ab48a2bacf241c851a118f8282a271e4d">OCI_PROCESS_TERMINAL</a>] = { <span class="stringliteral">&quot;terminal&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a65f050be4633329d0af340d88e209df6">BLOBMSG_TYPE_BOOL</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8ac638d97c005c1bae4270639b35443a6b">OCI_PROCESS_USER</a>] = { <span class="stringliteral">&quot;user&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line">}</div>
<div class="ttc" id="ablobmsg_8h_html_a9e3efca3093410d90ef04154aefde2c9a65f050be4633329d0af340d88e209df6"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a65f050be4633329d0af340d88e209df6">BLOBMSG_TYPE_BOOL</a></div><div class="ttdeci">@ BLOBMSG_TYPE_BOOL</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00034">blobmsg.h:34</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01729">1729</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1729</span>                                                          {</div>
<div class="line"><span class="lineno"> 1730</span>    [<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a9d41d59732df8b5db30de6d8b498664c">OCI_PROCESS_ARGS</a>] = { <span class="stringliteral">&quot;args&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno"> 1731</span>    [<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a71f60125a3d09ac0376911a3e0b0a6a4">OCI_PROCESS_CAPABILITIES</a>] = { <span class="stringliteral">&quot;capabilities&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line"><span class="lineno"> 1732</span>    [<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a841ee5b5a8bc29fc281504adf23332a5">OCI_PROCESS_CWD</a>] = { <span class="stringliteral">&quot;cwd&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno"> 1733</span>    [<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a1be2ada84df5442b9f201c6dc52b3068">OCI_PROCESS_ENV</a>] = { <span class="stringliteral">&quot;env&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno"> 1734</span>    [<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8ac9d842b5fe7888be2ebaa9505332f6df">OCI_PROCESS_OOMSCOREADJ</a>] = { <span class="stringliteral">&quot;oomScoreAdj&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno"> 1735</span>    [<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a7c18000948947c83ebfd4fab57779357">OCI_PROCESS_NONEWPRIVILEGES</a>] = { <span class="stringliteral">&quot;noNewPrivileges&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a65f050be4633329d0af340d88e209df6">BLOBMSG_TYPE_BOOL</a> },</div>
<div class="line"><span class="lineno"> 1736</span>    [<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8a43e16b4cc6c2d437a14b0bc14554127e">OCI_PROCESS_RLIMITS</a>] = { <span class="stringliteral">&quot;rlimits&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno"> 1737</span>    [<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8ab48a2bacf241c851a118f8282a271e4d">OCI_PROCESS_TERMINAL</a>] = { <span class="stringliteral">&quot;terminal&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a65f050be4633329d0af340d88e209df6">BLOBMSG_TYPE_BOOL</a> },</div>
<div class="line"><span class="lineno"> 1738</span>    [<a class="code hl_enumvalue" href="#a39b4e25c4e8f5fed29720be17a532fa8ac638d97c005c1bae4270639b35443a6b">OCI_PROCESS_USER</a>] = { <span class="stringliteral">&quot;user&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a32115da5d02a4fba2b0ddad9f3ff82a7">BLOBMSG_TYPE_TABLE</a> },</div>
<div class="line"><span class="lineno"> 1739</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01742">parseOCIprocess()</a>.</p>

</div>
</div>
<a id="ab2016d906e4123e8386859e6fca23ce6" name="ab2016d906e4123e8386859e6fca23ce6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2016d906e4123e8386859e6fca23ce6">&#9670;&#160;</a></span>oci_process_rlimit_policy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a> oci_process_rlimit_policy[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [<a class="code hl_enumvalue" href="#afb24d298ddd4bc4ff61aa333f07a574aa82cefaa500e6667fae114a7a427a70e8">OCI_PROCESS_RLIMIT_TYPE</a>] = { <span class="stringliteral">&quot;type&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#afb24d298ddd4bc4ff61aa333f07a574aa54aef840a8921bd694bd098d26909f5b">OCI_PROCESS_RLIMIT_SOFT</a>] = { <span class="stringliteral">&quot;soft&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9af8b6d39ebfe3b118d2cdee1c448d2bc7">BLOBMSG_CAST_INT64</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#afb24d298ddd4bc4ff61aa333f07a574aa7c4a1dc8832ab814f8153330af5c53c0">OCI_PROCESS_RLIMIT_HARD</a>] = { <span class="stringliteral">&quot;hard&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9af8b6d39ebfe3b118d2cdee1c448d2bc7">BLOBMSG_CAST_INT64</a> },</div>
<div class="line">}</div>
<div class="ttc" id="ablobmsg_8h_html_a9e3efca3093410d90ef04154aefde2c9af8b6d39ebfe3b118d2cdee1c448d2bc7"><div class="ttname"><a href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9af8b6d39ebfe3b118d2cdee1c448d2bc7">BLOBMSG_CAST_INT64</a></div><div class="ttdeci">@ BLOBMSG_CAST_INT64</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dad/blobmsg_8h_source.html#l00038">blobmsg.h:38</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01647">1647</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1647</span>                                                                 {</div>
<div class="line"><span class="lineno"> 1648</span>    [<a class="code hl_enumvalue" href="#afb24d298ddd4bc4ff61aa333f07a574aa82cefaa500e6667fae114a7a427a70e8">OCI_PROCESS_RLIMIT_TYPE</a>] = { <span class="stringliteral">&quot;type&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno"> 1649</span>    [<a class="code hl_enumvalue" href="#afb24d298ddd4bc4ff61aa333f07a574aa54aef840a8921bd694bd098d26909f5b">OCI_PROCESS_RLIMIT_SOFT</a>] = { <span class="stringliteral">&quot;soft&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9af8b6d39ebfe3b118d2cdee1c448d2bc7">BLOBMSG_CAST_INT64</a> },</div>
<div class="line"><span class="lineno"> 1650</span>    [<a class="code hl_enumvalue" href="#afb24d298ddd4bc4ff61aa333f07a574aa7c4a1dc8832ab814f8153330af5c53c0">OCI_PROCESS_RLIMIT_HARD</a>] = { <span class="stringliteral">&quot;hard&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9af8b6d39ebfe3b118d2cdee1c448d2bc7">BLOBMSG_CAST_INT64</a> },</div>
<div class="line"><span class="lineno"> 1651</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01686">parseOCIrlimit()</a>.</p>

</div>
</div>
<a id="a196324f45ead47d07841d5d61cae0d86" name="a196324f45ead47d07841d5d61cae0d86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a196324f45ead47d07841d5d61cae0d86">&#9670;&#160;</a></span>oci_process_user_policy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a> oci_process_user_policy[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004a727b3caff3f4f9c0226fde9a4add449b">OCI_PROCESS_USER_UID</a>] = { <span class="stringliteral">&quot;uid&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004aaa9867bd15bf6df72a6afbbca29bb0ea">OCI_PROCESS_USER_GID</a>] = { <span class="stringliteral">&quot;gid&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004abebde02748010be1f45e9986546d7d0c">OCI_PROCESS_USER_UMASK</a>] = { <span class="stringliteral">&quot;umask&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004a65c968275ec1a7c4233995f829810b73">OCI_PROCESS_USER_ADDITIONALGIDS</a>] = { <span class="stringliteral">&quot;additionalGids&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01581">1581</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1581</span>                                                               {</div>
<div class="line"><span class="lineno"> 1582</span>    [<a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004a727b3caff3f4f9c0226fde9a4add449b">OCI_PROCESS_USER_UID</a>] = { <span class="stringliteral">&quot;uid&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno"> 1583</span>    [<a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004aaa9867bd15bf6df72a6afbbca29bb0ea">OCI_PROCESS_USER_GID</a>] = { <span class="stringliteral">&quot;gid&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno"> 1584</span>    [<a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004abebde02748010be1f45e9986546d7d0c">OCI_PROCESS_USER_UMASK</a>] = { <span class="stringliteral">&quot;umask&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9acf0b8181117c037f7db537ed6270fafd">BLOBMSG_TYPE_INT32</a> },</div>
<div class="line"><span class="lineno"> 1585</span>    [<a class="code hl_enumvalue" href="#a8420dba71b9cc240cf981b0bef892004a65c968275ec1a7c4233995f829810b73">OCI_PROCESS_USER_ADDITIONALGIDS</a>] = { <span class="stringliteral">&quot;additionalGids&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a73b081b5b7befc2e98c585c25e9750f2">BLOBMSG_TYPE_ARRAY</a> },</div>
<div class="line"><span class="lineno"> 1586</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01588">parseOCIprocessuser()</a>.</p>

</div>
</div>
<a id="a6d120785be2672cecbeb820a30617ca3" name="a6d120785be2672cecbeb820a30617ca3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d120785be2672cecbeb820a30617ca3">&#9670;&#160;</a></span>oci_root_policy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/dad/blobmsg_8h.html#d3/d4d/structblobmsg__policy">blobmsg_policy</a> oci_root_policy[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [<a class="code hl_enumvalue" href="#afeaa6456e370d2eb59f5e139d9f8b00ca19d90db86bae071a8aa290b4aa7bbb1a">OCI_ROOT_PATH</a>] = { <span class="stringliteral">&quot;path&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line">    [<a class="code hl_enumvalue" href="#afeaa6456e370d2eb59f5e139d9f8b00ca5de1f8b436ee1fcb78d7aa9a8e2c5990">OCI_ROOT_READONLY</a>] = { <span class="stringliteral">&quot;readonly&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a65f050be4633329d0af340d88e209df6">BLOBMSG_TYPE_BOOL</a> },</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01371">1371</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1371</span>                                                       {</div>
<div class="line"><span class="lineno"> 1372</span>    [<a class="code hl_enumvalue" href="#afeaa6456e370d2eb59f5e139d9f8b00ca19d90db86bae071a8aa290b4aa7bbb1a">OCI_ROOT_PATH</a>] = { <span class="stringliteral">&quot;path&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a5947f0c748890838391aca89bc66ec53">BLOBMSG_TYPE_STRING</a> },</div>
<div class="line"><span class="lineno"> 1373</span>    [<a class="code hl_enumvalue" href="#afeaa6456e370d2eb59f5e139d9f8b00ca5de1f8b436ee1fcb78d7aa9a8e2c5990">OCI_ROOT_READONLY</a>] = { <span class="stringliteral">&quot;readonly&quot;</span>, <a class="code hl_enumvalue" href="../../dd/dad/blobmsg_8h.html#a9e3efca3093410d90ef04154aefde2c9a65f050be4633329d0af340d88e209df6">BLOBMSG_TYPE_BOOL</a> },</div>
<div class="line"><span class="lineno"> 1374</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01376">parseOCIroot()</a>.</p>

</div>
</div>
<a id="aa04cdf4d9bc5ac87bf39574fc9845918" name="aa04cdf4d9bc5ac87bf39574fc9845918"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa04cdf4d9bc5ac87bf39574fc9845918">&#9670;&#160;</a></span>ocibuf</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d8/d3c/blob_8h.html#d3/dcb/structblob__buf">blob_buf</a> ocibuf</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00159">159</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02323">parseOCI()</a>.</p>

</div>
</div>
<a id="af71983723dc8d0eeea681bdda36ef470" name="af71983723dc8d0eeea681bdda36ef470"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af71983723dc8d0eeea681bdda36ef470">&#9670;&#160;</a></span>old_umask</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">mode_t old_umask</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00677">677</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00679">build_jail_fs()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00788">enter_jail_fs()</a>.</p>

</div>
</div>
<a id="ab6fdb9300031a4ac782a6a3a7ec742cd" name="ab6fdb9300031a4ac782a6a3a7ec742cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6fdb9300031a4ac782a6a3a7ec742cd">&#9670;&#160;</a></span>[struct]</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct  { ... }  opts</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00942">apply_rlimits()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00523">apply_sysctl()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00679">build_jail_fs()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00592">create_devices()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00788">enter_jail_fs()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01161">exec_jail()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00774">free_and_exit()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00232">free_devices()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00254">free_opts()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00247">free_rlimits()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00216">free_sysctl()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01944">get_jail_root_user()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00893">get_jail_user()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01041">get_namespace_fd()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02438">handle_state()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00172">has_namespaces()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01117">jail_handle_signal()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01888">jail_join_ns()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02518">jail_writepid()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02583">main()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02323">parseOCI()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02053">parseOCIdevices()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01518">parseOCIhooks()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02198">parseOCIlinux()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01830">parseOCIlinuxns()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01742">parseOCIprocess()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01588">parseOCIprocessuser()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01686">parseOCIrlimit()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01376">parseOCIroot()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02125">parseOCIsysctl()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01964">parseOCIuidgidmappings()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00351">pass_console()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l03132">pipe_send_start_container()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l03115">post_create_runtime()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01239">post_jail_fs()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01256">post_start_hook()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l03161">poststop()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01228">pre_exec_jail()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l00924">set_jail_user()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l02392">set_oom_score_adj()</a>.</p>

</div>
</div>
<a id="a00f1e87fefda65b43a661aefc6f16566" name="a00f1e87fefda65b43a661aefc6f16566"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00f1e87fefda65b43a661aefc6f16566">&#9670;&#160;</a></span>parent_ctx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../db/d55/libubus_8h.html#df/d18/structubus__context">ubus_context</a>* parent_ctx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00167">167</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00774">free_and_exit()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02583">main()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l03170">post_poststop()</a>.</p>

</div>
</div>
<a id="a3c32db21b181d5c2e2bc3b98674bd8cf" name="a3c32db21b181d5c2e2bc3b98674bd8cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c32db21b181d5c2e2bc3b98674bd8cf">&#9670;&#160;</a></span>pidns_fd</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int pidns_fd</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02572">2572</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>.</p>

</div>
</div>
<a id="a541f86a9c230bc87b5e7e2c83e2a6d34" name="a541f86a9c230bc87b5e7e2c83e2a6d34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a541f86a9c230bc87b5e7e2c83e2a6d34">&#9670;&#160;</a></span>pipes</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pipes[4]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01160">1160</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01161">exec_jail()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l03132">pipe_send_start_container()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l03115">post_create_runtime()</a>, <a class="el" href="../../dd/d26/jail_8c_source.html#l01239">post_jail_fs()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l02923">post_main()</a>.</p>

</div>
</div>
<a id="a6910512e7075298176a67f026d6c25e8" name="a6910512e7075298176a67f026d6c25e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6910512e7075298176a67f026d6c25e8">&#9670;&#160;</a></span>post_main_timeout</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a> post_main_timeout</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .cb = <a class="code hl_function" href="#a2a752afff1e548707b0cbec92c8e7512">post_main</a>,</div>
<div class="line">}</div>
<div class="ttc" id="ajail_8c_html_a2a752afff1e548707b0cbec92c8e7512"><div class="ttname"><a href="#a2a752afff1e548707b0cbec92c8e7512">post_main</a></div><div class="ttdeci">static void post_main(struct uloop_timeout *t)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l02923">jail.c:2923</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02568">2568</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2568</span>                                                {</div>
<div class="line"><span class="lineno"> 2569</span>    .cb = <a class="code hl_function" href="#a2a752afff1e548707b0cbec92c8e7512">post_main</a>,</div>
<div class="line"><span class="lineno"> 2570</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02583">main()</a>.</p>

</div>
</div>
<a id="a8d6a59324899212d8504b098b976c894" name="a8d6a59324899212d8504b098b976c894"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d6a59324899212d8504b098b976c894">&#9670;&#160;</a></span>pre_exec_timeout</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a> pre_exec_timeout</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .cb = <a class="code hl_function" href="#a15ffedabb70c5663ccda778a58da4f87">pre_exec_jail</a>,</div>
<div class="line">}</div>
<div class="ttc" id="ajail_8c_html_a15ffedabb70c5663ccda778a58da4f87"><div class="ttname"><a href="#a15ffedabb70c5663ccda778a58da4f87">pre_exec_jail</a></div><div class="ttdeci">static void pre_exec_jail(struct uloop_timeout *t)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d26/jail_8c_source.html#l01228">jail.c:1228</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01156">1156</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1156</span>                                               {</div>
<div class="line"><span class="lineno"> 1157</span>    .cb = <a class="code hl_function" href="#a15ffedabb70c5663ccda778a58da4f87">pre_exec_jail</a>,</div>
<div class="line"><span class="lineno"> 1158</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01161">exec_jail()</a>.</p>

</div>
</div>
<a id="acd454d571192cedd0f8f512149290772" name="acd454d571192cedd0f8f512149290772"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd454d571192cedd0f8f512149290772">&#9670;&#160;</a></span>rlimit_names</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* const rlimit_names[RLIM_NLIMITS]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    [RLIMIT_AS] = <span class="stringliteral">&quot;AS&quot;</span>,</div>
<div class="line">    [RLIMIT_CORE] = <span class="stringliteral">&quot;CORE&quot;</span>,</div>
<div class="line">    [RLIMIT_CPU] = <span class="stringliteral">&quot;CPU&quot;</span>,</div>
<div class="line">    [RLIMIT_DATA] = <span class="stringliteral">&quot;DATA&quot;</span>,</div>
<div class="line">    [RLIMIT_FSIZE] = <span class="stringliteral">&quot;FSIZE&quot;</span>,</div>
<div class="line">    [RLIMIT_LOCKS] = <span class="stringliteral">&quot;LOCKS&quot;</span>,</div>
<div class="line">    [RLIMIT_MEMLOCK] = <span class="stringliteral">&quot;MEMLOCK&quot;</span>,</div>
<div class="line">    [RLIMIT_MSGQUEUE] = <span class="stringliteral">&quot;MSGQUEUE&quot;</span>,</div>
<div class="line">    [RLIMIT_NICE] = <span class="stringliteral">&quot;NICE&quot;</span>,</div>
<div class="line">    [RLIMIT_NOFILE] = <span class="stringliteral">&quot;NOFILE&quot;</span>,</div>
<div class="line">    [RLIMIT_NPROC] = <span class="stringliteral">&quot;NPROC&quot;</span>,</div>
<div class="line">    [RLIMIT_RSS] = <span class="stringliteral">&quot;RSS&quot;</span>,</div>
<div class="line">    [RLIMIT_RTPRIO] = <span class="stringliteral">&quot;RTPRIO&quot;</span>,</div>
<div class="line">    [RLIMIT_RTTIME] = <span class="stringliteral">&quot;RTTIME&quot;</span>,</div>
<div class="line">    [RLIMIT_SIGPENDING] = <span class="stringliteral">&quot;SIGPENDING&quot;</span>,</div>
<div class="line">    [RLIMIT_STACK] = <span class="stringliteral">&quot;STACK&quot;</span>,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l01654">1654</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1654</span>                                                      {</div>
<div class="line"><span class="lineno"> 1655</span>    [RLIMIT_AS] = <span class="stringliteral">&quot;AS&quot;</span>,</div>
<div class="line"><span class="lineno"> 1656</span>    [RLIMIT_CORE] = <span class="stringliteral">&quot;CORE&quot;</span>,</div>
<div class="line"><span class="lineno"> 1657</span>    [RLIMIT_CPU] = <span class="stringliteral">&quot;CPU&quot;</span>,</div>
<div class="line"><span class="lineno"> 1658</span>    [RLIMIT_DATA] = <span class="stringliteral">&quot;DATA&quot;</span>,</div>
<div class="line"><span class="lineno"> 1659</span>    [RLIMIT_FSIZE] = <span class="stringliteral">&quot;FSIZE&quot;</span>,</div>
<div class="line"><span class="lineno"> 1660</span>    [RLIMIT_LOCKS] = <span class="stringliteral">&quot;LOCKS&quot;</span>,</div>
<div class="line"><span class="lineno"> 1661</span>    [RLIMIT_MEMLOCK] = <span class="stringliteral">&quot;MEMLOCK&quot;</span>,</div>
<div class="line"><span class="lineno"> 1662</span>    [RLIMIT_MSGQUEUE] = <span class="stringliteral">&quot;MSGQUEUE&quot;</span>,</div>
<div class="line"><span class="lineno"> 1663</span>    [RLIMIT_NICE] = <span class="stringliteral">&quot;NICE&quot;</span>,</div>
<div class="line"><span class="lineno"> 1664</span>    [RLIMIT_NOFILE] = <span class="stringliteral">&quot;NOFILE&quot;</span>,</div>
<div class="line"><span class="lineno"> 1665</span>    [RLIMIT_NPROC] = <span class="stringliteral">&quot;NPROC&quot;</span>,</div>
<div class="line"><span class="lineno"> 1666</span>    [RLIMIT_RSS] = <span class="stringliteral">&quot;RSS&quot;</span>,</div>
<div class="line"><span class="lineno"> 1667</span>    [RLIMIT_RTPRIO] = <span class="stringliteral">&quot;RTPRIO&quot;</span>,</div>
<div class="line"><span class="lineno"> 1668</span>    [RLIMIT_RTTIME] = <span class="stringliteral">&quot;RTTIME&quot;</span>,</div>
<div class="line"><span class="lineno"> 1669</span>    [RLIMIT_SIGPENDING] = <span class="stringliteral">&quot;SIGPENDING&quot;</span>,</div>
<div class="line"><span class="lineno"> 1670</span>    [RLIMIT_STACK] = <span class="stringliteral">&quot;STACK&quot;</span>,</div>
<div class="line"><span class="lineno"> 1671</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l01673">resolve_rlimit()</a>.</p>

</div>
</div>
<a id="aed82975b7037d5fcacde3c08e54189c1" name="aed82975b7037d5fcacde3c08e54189c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed82975b7037d5fcacde3c08e54189c1">&#9670;&#160;</a></span>start_container_timeout</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dc/d56/uloop_8h.html#d8/d2b/structuloop__timeout">uloop_timeout</a> start_container_timeout</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .cb = <a class="code hl_function" href="#a44e8c7d9c78045cd28f81b95fb3f2cf3">pipe_send_start_container</a>,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l02421">2421</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2421</span>                                                      {</div>
<div class="line"><span class="lineno"> 2422</span>    .cb = <a class="code hl_function" href="#a44e8c7d9c78045cd28f81b95fb3f2cf3">pipe_send_start_container</a>,</div>
<div class="line"><span class="lineno"> 2423</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l02425">handle_start()</a>.</p>

</div>
</div>
<a id="a3ff424f2e02a1e7f39fc184b68114655" name="a3ff424f2e02a1e7f39fc184b68114655"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ff424f2e02a1e7f39fc184b68114655">&#9670;&#160;</a></span>tmpovdir</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char tmpovdir[] = &quot;/tmp/ujail-overlay-XXXXXX&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d26/jail_8c_source.html#l00676">676</a> of file <a class="el" href="../../dd/d26/jail_8c_source.html">jail.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d26/jail_8c_source.html#l00679">build_jail_fs()</a>, and <a class="el" href="../../dd/d26/jail_8c_source.html#l00788">enter_jail_fs()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
